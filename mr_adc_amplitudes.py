# Copyright 2023 Prism Developers. All Rights Reserved.
#
# Licensed under the GNU General Public License v3.0;
# you may not use this file except in compliance with the License.
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
# either express or implied.
#
# See the License file for the specific language governing
# permissions and limitations.
#
# Available at https://github.com/sokolov-group/prism
#
# Authors: Alexander Yu. Sokolov <alexander.y.sokolov@gmail.com>
#          Carlos E. V. de Moura <carlosevmoura@gmail.com>
#                  Ilia M. Mazin <ilia.mazin@gmail.com>
#              Donna H. Odhiambo <donna.odhiambo@proton.me>
#

import numpy as np
from functools import reduce

import prism.mr_adc_intermediates as mr_adc_intermediates
import prism.mr_adc_overlap as mr_adc_overlap
import prism.mr_adc_integrals as mr_adc_integrals

import prism.lib.logger as logger
import prism.lib.tools as tools


def compute_amplitudes(mr_adc):

    cput0 = (logger.process_clock(), logger.perf_counter())
    mr_adc.log.info("\nComputing NEVPT2 amplitudes...")

    # First-order amplitudes
    compute_t1_amplitudes(mr_adc)

    # Second-order amplitudes
    compute_t2_amplitudes(mr_adc)

    # Compute CVS amplitudes and remove non-CVS core integrals, amplitudes and unnecessary RDMs
    if mr_adc.method_type in ("cvs-ip", "cvs-ee"):
        compute_cvs_amplitudes(mr_adc)

    mr_adc.log.timer("computing amplitudes", *cput0)

def compute_t1_amplitudes(mr_adc):

    ncore = mr_adc.ncore
    ncas = mr_adc.ncas
    nelecas = mr_adc.nelecas
    nextern = mr_adc.nextern

    e_0p, e_p1p, e_m1p, e_0, e_p1, e_m1, e_p2, e_m2 = (0.0,) * 8

    # Create temporary files
    if mr_adc.outcore_expensive_tensors:
        mr_adc.tmpfile.t1 = tools.create_temp_file(mr_adc) # Non-core indices' amplitudes
        mr_adc.tmpfile.ct1 = tools.create_temp_file(mr_adc) # Core indices' amplitudes
    else:
        mr_adc.tmpfile.t1 = None
        mr_adc.tmpfile.ct1 = None

    # First-order amplitudes
    if mr_adc.method in ("mr-adc(1)", "mr-adc(2)", "mr-adc(2)-x", "mr-adc(2)-sx"):
        if ncore > 0 and nextern > 0 and ncas > 0:
            e_0p, mr_adc.t1.ce, mr_adc.t1.caea, mr_adc.t1.caae = compute_t1_0p(mr_adc)
        else:
            mr_adc.t1.ce = np.zeros((ncore, nextern))
            mr_adc.t1.caea = np.zeros((ncore, ncas, nextern, ncas))
            mr_adc.t1.caae = np.zeros((ncore, ncas, ncas, nextern))

        if ncore > 0 and ncas > 0:
            e_p1p, mr_adc.t1.ca, mr_adc.t1.caaa = compute_t1_p1p(mr_adc)
        else:
            mr_adc.t1.ca = np.zeros((ncore, ncas))
            mr_adc.t1.caaa = np.zeros((ncore, ncas, ncas, ncas))

        if nextern > 0 and ncas > 0:
            e_m1p, mr_adc.t1.ae, mr_adc.t1.aaae = compute_t1_m1p(mr_adc)
        else:
            mr_adc.t1.ae = np.zeros((ncas, nextern))
            mr_adc.t1.aaae = np.zeros((ncas, ncas, ncas, nextern))

    else:
        mr_adc.t1.ce = np.zeros((ncore, nextern))
        mr_adc.t1.caea = np.zeros((ncore, ncas, nextern, ncas))
        mr_adc.t1.caae = np.zeros((ncore, ncas, ncas, nextern))
        mr_adc.t1.ca = np.zeros((ncore, ncas))
        mr_adc.t1.caaa = np.zeros((ncore, ncas, ncas, ncas))
        mr_adc.t1.ae = np.zeros((ncas, nextern))
        mr_adc.t1.aaae = np.zeros((ncas, ncas, ncas, nextern))

    if ((mr_adc.method in ("mr-adc(2)", "mr-adc(2)-x", "mr-adc(2)-sx")) or
        (mr_adc.method == "mr-adc(1)" and mr_adc.method_type in ("ee", "cvs-ee"))):

        nelecas_total = 0
        if isinstance(nelecas, (list)):
            nelecas_total = sum(nelecas[0])
        else:
            nelecas_total = sum(nelecas)

        if ncore > 0 and nextern > 0:
            e_0, mr_adc.t1.ccee = compute_t1_0(mr_adc)
        else:
            mr_adc.t1.ccee = np.zeros((ncore, ncore, nextern, nextern))

        if ncore > 0 and nextern > 0 and ncas > 0:
            e_p1, mr_adc.t1.ccae = compute_t1_p1(mr_adc)
        else:
            mr_adc.t1.ccae = np.zeros((ncore, ncore, ncas, nextern))

        if ncore > 0 and nextern > 0 and ncas > 0 and nelecas_total > 0:
            e_m1, mr_adc.t1.caee = compute_t1_m1(mr_adc)
        else:
            mr_adc.t1.caee = np.zeros((ncore, ncas, nextern, nextern))

        if ncore > 0 and ncas > 0:
            e_p2, mr_adc.t1.ccaa = compute_t1_p2(mr_adc)
        else:
            mr_adc.t1.ccaa = np.zeros((ncore, ncore, ncas, ncas))

        if nextern > 0 and ncas > 0 and nelecas_total > 0:
            e_m2, mr_adc.t1.aaee = compute_t1_m2(mr_adc)
        else:
            mr_adc.t1.aaee = np.zeros((ncas, ncas, nextern, nextern))

    else:
        mr_adc.t1.ccee = np.zeros((ncore, ncore, nextern, nextern))
        mr_adc.t1.ccae = np.zeros((ncore, ncore, ncas, nextern))
        mr_adc.t1.caee = np.zeros((ncore, ncas, nextern, nextern))
        mr_adc.t1.ccaa = np.zeros((ncore, ncore, ncas, ncas))
        mr_adc.t1.aaee = np.zeros((ncas, ncas, nextern, nextern))

    e_corr = e_0p + e_p1p + e_m1p + e_0 + e_p1 + e_m1 + e_p2 + e_m2
    e_tot = mr_adc.e_casscf + e_corr

    mr_adc.log.log("\nCASSCF reference energy:                     %20.12f" % mr_adc.e_casscf)
    mr_adc.log.info("PC-NEVPT2 correlation energy:                %20.12f" % e_corr)
    mr_adc.log.log("Total PC-NEVPT2 energy:                      %20.12f\n" % e_tot)

def compute_t2_amplitudes(mr_adc):

    ncore = mr_adc.ncore
    ncas = mr_adc.ncas
    nextern = mr_adc.nextern
    nelecas = mr_adc.nelecas

    nelecas_total = 0
    if isinstance(nelecas, (list)):
        nelecas_total = sum(nelecas[0])
    else:
        nelecas_total = sum(nelecas)

    approx_trans_moments = mr_adc.approx_trans_moments

    # Approximate second-order amplitudes
    if mr_adc.method in ("mr-adc(2)", "mr-adc(2)-x", "mr-adc(2)-sx"):

        if (ncore > 0) and (nextern > 0) and not (approx_trans_moments):
            mr_adc.t2.ce = compute_t2_0p_singles(mr_adc)

        else:
            mr_adc.t2.ce = np.zeros((ncore, nextern))

        # EE and CVS-EE amplitudes 
        if mr_adc.method_type == "cvs-ee":

            if (ncas > 0) and (nextern > 0) and (nelecas_total > 0):
                mr_adc.t2.ae = compute_t2_m1p_singles(mr_adc)
            else:
                mr_adc.t2.ae = np.zeros((ncas, nextern))

            if (ncas > 0) and (nelecas_total > 0):
                mr_adc.t2.aa = compute_t2_0pp_singles(mr_adc)  
            else:
                mr_adc.t2.aa = np.zeros((ncas, ncas))

            if (ncore > 0) and (ncas > 0):
                mr_adc.t2.ca = compute_t2_p1p_singles(mr_adc) 
            else:
                mr_adc.t2.ca = np.zeros((ncore, ncas))

    else:
        mr_adc.t2.ce = np.zeros((ncore, nextern))

def compute_cvs_amplitudes(mr_adc):
    'Create CVS amplitudes tensors and remove core integrals, core amplitudes and RDMs not used in CVS calculations'

    cput0 = (logger.process_clock(), logger.perf_counter())
    mr_adc.log.extra("\nComputing CVS amplitudes...")

    if mr_adc.outcore_expensive_tensors:
        mr_adc.tmpfile.xt1 = tools.create_temp_file(mr_adc)
    else:
        mr_adc.tmpfile.xt1 = None
    tmpfile = mr_adc.tmpfile.xt1

    if mr_adc.method_type in ("cvs-ip", "cvs-ee"):

        # Variables from kernel
        ncvs = mr_adc.ncvs
        nval = mr_adc.nval
        ncore = mr_adc.ncore
        ncas = mr_adc.ncas
        nextern = mr_adc.nextern

        if mr_adc.method_type == "cvs-ip":
            del(mr_adc.rdm.ccccaaaa)

        if mr_adc.method in ("mr-adc(1)", "mr-adc(2)", "mr-adc(2)-x", "mr-adc(2)-sx"):
            mr_adc.t1.xe = np.ascontiguousarray(mr_adc.t1.ce[:ncvs, :])
            mr_adc.t1.ve = np.ascontiguousarray(mr_adc.t1.ce[ncvs:, :])
            del(mr_adc.t1.ce)

            mr_adc.t1.xaea = np.ascontiguousarray(mr_adc.t1.caea[:ncvs, :, :, :])
            mr_adc.t1.vaea = np.ascontiguousarray(mr_adc.t1.caea[ncvs:, :, :, :])
            del(mr_adc.t1.caea)

            mr_adc.t1.xaae = np.ascontiguousarray(mr_adc.t1.caae[:ncvs, :, :, :])
            mr_adc.t1.vaae = np.ascontiguousarray(mr_adc.t1.caae[ncvs:, :, :, :])
            del(mr_adc.t1.caae)

            mr_adc.t1.xa = np.ascontiguousarray(mr_adc.t1.ca[:ncvs, :])
            mr_adc.t1.va = np.ascontiguousarray(mr_adc.t1.ca[ncvs:, :])
            del(mr_adc.t1.ca)
            mr_adc.t1.xaaa = np.ascontiguousarray(mr_adc.t1.caaa[:ncvs, :, :, :])
            mr_adc.t1.vaaa = np.ascontiguousarray(mr_adc.t1.caaa[ncvs:, :, :, :])
            del(mr_adc.t1.caaa)
            mr_adc.t1.xxae = np.ascontiguousarray(mr_adc.t1.ccae[:ncvs, :ncvs, :, :])
            mr_adc.t1.xvae = np.ascontiguousarray(mr_adc.t1.ccae[:ncvs, ncvs:, :, :])
            mr_adc.t1.vxae = np.ascontiguousarray(mr_adc.t1.ccae[ncvs:, :ncvs, :, :])
            mr_adc.t1.vvae = np.ascontiguousarray(mr_adc.t1.ccae[ncvs:, ncvs:, :, :])
            del(mr_adc.t1.ccae)

            mr_adc.t1.xxaa = np.ascontiguousarray(mr_adc.t1.ccaa[:ncvs, :ncvs, :, :])
            mr_adc.t1.xvaa = np.ascontiguousarray(mr_adc.t1.ccaa[:ncvs, ncvs:, :, :])
            mr_adc.t1.vxaa = np.ascontiguousarray(mr_adc.t1.ccaa[ncvs:, :ncvs, :, :])
            mr_adc.t1.vvaa = np.ascontiguousarray(mr_adc.t1.ccaa[ncvs:, ncvs:, :, :])
            del(mr_adc.t1.ccaa)

            if mr_adc.method in ("mr-adc(2)", "mr-adc(2)-x", "mr-adc(2)-sx"): 
                mr_adc.t2.xe = np.ascontiguousarray(mr_adc.t2.ce[:ncvs, :])
                mr_adc.t2.ve = np.ascontiguousarray(mr_adc.t2.ce[ncvs:, :])
                del(mr_adc.t2.ce)

                if mr_adc.method_type == "cvs-ee":
                    mr_adc.t2.xa = np.ascontiguousarray(mr_adc.t2.ca[:ncvs, :])
                    mr_adc.t2.va = np.ascontiguousarray(mr_adc.t2.ca[ncvs:, :])
                    del(mr_adc.t2.ca)

            mr_adc.t1.xxee = tools.create_dataset('xxee', tmpfile, (ncvs, ncvs, nextern, nextern))
            mr_adc.t1.xvee = tools.create_dataset('xvee', tmpfile, (ncvs, nval, nextern, nextern))
            mr_adc.t1.vxee = tools.create_dataset('vxee', tmpfile, (nval, ncvs, nextern, nextern))
            mr_adc.t1.vvee = tools.create_dataset('vvee', tmpfile, (nval, nval, nextern, nextern))

            mr_adc.t1.xaee = tools.create_dataset('xaee', tmpfile, (ncvs, ncas, nextern, nextern))
            mr_adc.t1.vaee = tools.create_dataset('vaee', tmpfile, (nval, ncas, nextern, nextern))

            if ncore > 0 and nextern > 0:
                chunks = tools.calculate_chunks(mr_adc, nextern, [ncore, ncore, nextern])
                for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
                    cput1 = (logger.process_clock(), logger.perf_counter())
                    mr_adc.log.debug("t1.xxee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

                    mr_adc.t1.xxee[:,:,s_chunk:f_chunk] = mr_adc.t1.ccee[:ncvs, :ncvs, s_chunk:f_chunk, :]
                    tools.flush(tmpfile)
                    mr_adc.log.timer_debug("storing CVS t1.xxee", *cput1)

                for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
                    cput1 = (logger.process_clock(), logger.perf_counter())
                    mr_adc.log.debug("t1.xvee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

                    mr_adc.t1.xvee[:,:,s_chunk:f_chunk] = mr_adc.t1.ccee[:ncvs, ncvs:, s_chunk:f_chunk, :]
                    tools.flush(tmpfile)
                    mr_adc.log.timer_debug("storing CVS t1.xvee", *cput1)

                for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
                    cput1 = (logger.process_clock(), logger.perf_counter())
                    mr_adc.log.debug("t1.vxee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

                    mr_adc.t1.vxee[:,:,s_chunk:f_chunk] = mr_adc.t1.ccee[ncvs:, :ncvs, s_chunk:f_chunk, :]
                    tools.flush(tmpfile)
                    mr_adc.log.timer_debug("storing CVS t1.vxee", *cput1)

                for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
                    cput1 = (logger.process_clock(), logger.perf_counter())
                    mr_adc.log.debug("t1.vvee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

                    mr_adc.t1.vvee[:,:,s_chunk:f_chunk] = mr_adc.t1.ccee[ncvs:, ncvs:, s_chunk:f_chunk, :]
                    tools.flush(tmpfile)
                    mr_adc.log.timer_debug("storing CVS t1.vvee", *cput1)
            del(mr_adc.t1.ccee)

            if ncore > 0 and nextern > 0 and ncas > 0:
                chunks = tools.calculate_chunks(mr_adc, nextern, [ncore, ncas, nextern])
                for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
                    cput1 = (logger.process_clock(), logger.perf_counter())
                    mr_adc.log.debug("t1.xaee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

                    mr_adc.t1.xaee[:,:,s_chunk:f_chunk] = mr_adc.t1.caee[:ncvs, :, s_chunk:f_chunk]
                    tools.flush(tmpfile)
                    mr_adc.log.timer_debug("storing CVS t1.xaee", *cput1)

                for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
                    cput1 = (logger.process_clock(), logger.perf_counter())
                    mr_adc.log.debug("t1.vaee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

                    mr_adc.t1.vaee[:,:,s_chunk:f_chunk] = mr_adc.t1.caee[ncvs:, :, s_chunk:f_chunk]
                    tools.flush(tmpfile)
                    mr_adc.log.timer_debug("storing CVS t1.vaee", *cput1)
            del(mr_adc.t1.caee)

    if mr_adc.outcore_expensive_tensors:
        mr_adc.tmpfile.ct1.close()

    mr_adc.log.timer("computing CVS amplitudes", *cput0)

def compute_t1_0(mr_adc):

    cput0 = (logger.process_clock(), logger.perf_counter())
    mr_adc.log.extra("\nComputing T[0]^(1) amplitudes...")

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    ctmpfile = mr_adc.tmpfile.ct1

    # Variables from kernel
    ncore = mr_adc.ncore
    nextern = mr_adc.nextern

    ## Molecular Orbitals Energies
    e_core = mr_adc.mo_energy.c
    e_extern = mr_adc.mo_energy.e

    # Compute denominators
    d_ij = e_core[:,None] + e_core

    t1_ccee = tools.create_dataset('ccee', ctmpfile, (ncore, ncore, nextern, nextern))
    chunks = tools.calculate_chunks(mr_adc, nextern, [ncore, ncore, nextern], ntensors = 3)

    e_0 = 0.0
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("t1.ccee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_cece = mr_adc.v2e.cece[:,s_chunk:f_chunk]

        # Compute denominators
        d_ab = e_extern[s_chunk:f_chunk][:,None] + e_extern
        temp = -d_ij.reshape(-1,1) + d_ab.reshape(-1)
        temp = temp.reshape((ncore, ncore, -1, nextern))
        temp = temp**(-1)

        # Compute T[0] t1_ccee tensor: V1_0 / D2 = - < Psi_0 | a^{\dag}_I a^{\dag}_J a_B a_A V | Psi_0> / D2
        temp *= - einsum('IAJB->IJAB', v_cece, optimize = einsum_type)

        # Compute electronic correlation energy for T[0]
        e_0 += 2 * einsum('ijab,iajb', temp, v_cece, optimize = einsum_type)
        e_0 -= einsum('ijab,jaib', temp, v_cece, optimize = einsum_type)

        t1_ccee[:,:,s_chunk:f_chunk] = temp
        tools.flush(ctmpfile)
        mr_adc.log.timer_debug("computing t1.ccee", *cput1)

    mr_adc.log.extra("Norm of T[0]^(1):                            %20.12f" % np.linalg.norm(t1_ccee))
    mr_adc.log.info("Correlation energy [0]:                      %20.12f" % e_0)
    mr_adc.log.timer("computing T[0]^(1) amplitudes ", *cput0)

    return e_0, t1_ccee

def compute_t1_p1(mr_adc):

    cput0 = (logger.process_clock(), logger.perf_counter())
    mr_adc.log.extra("\nComputing T[+1]^(1) amplitudes...")

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    ncore = mr_adc.ncore
    nextern = mr_adc.nextern

    ## Molecular Orbitals Energies
    e_core = mr_adc.mo_energy.c
    e_extern = mr_adc.mo_energy.e

    ## Two-electron integrals
    v_cace = mr_adc.v2e.cace

    ## Reduced density matrices
    rdm_ca = mr_adc.rdm.ca

    # Compute K_ac matrix
    K_ac = mr_adc_intermediates.compute_K_ac(mr_adc)

    # Compute S^{-1/2} matrix: Orthogonalization and overlap truncation only in the active space
    S_p1_12_inv_act = mr_adc_overlap.compute_S12_p1(mr_adc)

    if hasattr(mr_adc.S12, "cca"):
        mr_adc.S12.cca = S_p1_12_inv_act.copy()

    # Compute K^{-1} matrix
    SKS = reduce(np.dot, (S_p1_12_inv_act.T, K_ac, S_p1_12_inv_act))
    evals, evecs = np.linalg.eigh(SKS)
    del(SKS)

    # Compute R.H.S. of the equation
    ## V tensor: - < Psi_0 | a^{\dag}_I a^{\dag}_J a_X a_A V | Psi_0>
    V1_p1 =- einsum('JXIA->IJAX', v_cace, optimize = einsum_type).copy()
    V1_p1 += 1/2 * einsum('JxIA,Xx->IJAX', v_cace, rdm_ca, optimize = einsum_type)

    ## Compute denominators
    d_ap = (e_extern[:,None] + evals).reshape(-1)
    d_ij = (e_core[:,None] + e_core).reshape(-1)

    d_apij = (d_ap[:,None] - d_ij).reshape(nextern, evals.shape[0], ncore, ncore)
    d_apij = d_apij**(-1)

    # Compute T[+1] amplitudes
    S_12_V_p1 = einsum("IJAX,Xm->IJAm", V1_p1, S_p1_12_inv_act, optimize = einsum_type)
    S_12_V_p1 = einsum("mp,IJAm->IJAp", evecs, S_12_V_p1, optimize = einsum_type)
    S_12_V_p1 = einsum("ApIJ,IJAp->IJAp", d_apij, S_12_V_p1, optimize = einsum_type)
    S_12_V_p1 = einsum("mp,IJAp->IJAm", evecs, S_12_V_p1, optimize = einsum_type)
    del(V1_p1, d_ap, d_ij, d_apij, evals, evecs)

    ## Compute T[+1] t1_ccae tensor
    t1_ccae = einsum("IJAm,Xm->JIXA", S_12_V_p1, S_p1_12_inv_act, optimize = einsum_type).copy()
    del(S_12_V_p1, S_p1_12_inv_act)

    # Compute electronic correlation energy for T[+1]
    e_p1 =- 2 * einsum('ijxa,jxia', t1_ccae, v_cace, optimize = einsum_type)
    e_p1 += 4 * einsum('ijxa,ixja', t1_ccae, v_cace, optimize = einsum_type)
    e_p1 += einsum('ijxa,jyia,xy', t1_ccae, v_cace, rdm_ca, optimize = einsum_type)
    e_p1 -= 2 * einsum('ijxa,iyja,xy', t1_ccae, v_cace, rdm_ca, optimize = einsum_type)

    mr_adc.log.extra("Norm of T[+1]^(1):                           %20.12f" % np.linalg.norm(t1_ccae))
    mr_adc.log.info("Correlation energy [+1]:                     %20.12f" % e_p1)
    mr_adc.log.timer("computing T[+1]^(1) amplitudes", *cput0)

    return e_p1, t1_ccae

def compute_t1_m1(mr_adc):

    cput0 = (logger.process_clock(), logger.perf_counter())
    mr_adc.log.extra("\nComputing T[-1]^(1) amplitudes...")

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    ctmpfile = mr_adc.tmpfile.ct1

    # Variables from kernel
    ncore = mr_adc.ncore
    ncas = mr_adc.ncas
    nextern = mr_adc.nextern

    ## Molecular Orbitals Energies
    e_core = mr_adc.mo_energy.c
    e_extern = mr_adc.mo_energy.e

    ## Two-electron integrals
    v_ceae = mr_adc.v2e.ceae

    ## Reduced density matrices
    rdm_ca = mr_adc.rdm.ca

    # Compute K_ca matrix
    K_ca = mr_adc_intermediates.compute_K_ca(mr_adc)

    # Compute S^{-1/2} matrix: Orthogonalization and overlap truncation only in the active space
    S_m1_12_inv_act = mr_adc_overlap.compute_S12_m1(mr_adc)

    if hasattr(mr_adc.S12, "cae"):
        mr_adc.S12.cae = S_m1_12_inv_act.copy()

    # Compute K^{-1} matrix
    SKS = reduce(np.dot, (S_m1_12_inv_act.T, K_ca, S_m1_12_inv_act))
    evals, evecs = np.linalg.eigh(SKS)
    del(SKS)

    # Compute R.H.S. of the equation
    ## Compute denominators
    d_ix = (e_core[:,None] - evals).reshape(-1)

    t1_caee = tools.create_dataset('caee', ctmpfile, (ncore, ncas, nextern, nextern))
    chunks = tools.calculate_chunks(mr_adc, nextern, [ncore, ncas, nextern], ntensors = 2)

    e_m1 = 0.0
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("t1.caee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Compute denominators
        d_ab = (e_extern[s_chunk:f_chunk][:,None] + e_extern).reshape(-1)
        d_abix = (d_ab[:,None] - d_ix).reshape(-1, nextern, ncore, evals.shape[0])
        d_abix = d_abix**(-1)

        ## V matrix: - < Psi_0 | a^{\dag}_I a^{\dag}_X a_B a_A V | Psi_0>
        V1_m1 =- 1/2 * einsum('IAxB,Xx->IXAB', v_ceae[:,s_chunk:f_chunk], rdm_ca, optimize = einsum_type)

        # Compute T[-1] amplitudes
        S_12_V_m1 = einsum("IXAB,Xm->ImAB", V1_m1, S_m1_12_inv_act, optimize = einsum_type)
        S_12_V_m1 = einsum("mp,ImAB->IpAB", evecs, S_12_V_m1, optimize = einsum_type)
        S_12_V_m1 = einsum("ABIp,IpAB->IpAB", d_abix, S_12_V_m1, optimize = einsum_type)
        S_12_V_m1 = einsum("mp,IpAB->ImAB", evecs, S_12_V_m1, optimize = einsum_type)
        del(V1_m1, d_abix)

        ## Compute T[-1] t1_caee tensor
        temp = einsum("ImAB,Xm->IXAB", S_12_V_m1, S_m1_12_inv_act, optimize = einsum_type).copy()
        del(S_12_V_m1)

        # Compute electronic correlation energy for T[-1]
        e_m1 += 2 * einsum('ixab,iayb,xy', temp, v_ceae[:,s_chunk:f_chunk], rdm_ca, optimize = einsum_type)
        e_m1 -= einsum('ixab,ibya,xy', temp, v_ceae[:,:,:,s_chunk:f_chunk], rdm_ca, optimize = einsum_type)

        t1_caee[:,:,s_chunk:f_chunk] = temp
        tools.flush(ctmpfile)
        mr_adc.log.timer_debug("computing t1.caee", *cput1)

    mr_adc.log.extra("Norm of T[-1]^(1):                           %20.12f" % np.linalg.norm(t1_caee))
    mr_adc.log.info("Correlation energy [-1]:                     %20.12f" % e_m1)
    mr_adc.log.timer("computing T[-1]^(1) amplitudes", *cput0)

    return e_m1, t1_caee

def compute_t1_p2(mr_adc):

    cput0 = (logger.process_clock(), logger.perf_counter())
    mr_adc.log.extra("\nComputing T[+2]^(1) amplitudes...")

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    ncore = mr_adc.ncore
    ncas = mr_adc.ncas

    ## Molecular Orbitals Energies
    e_core = mr_adc.mo_energy.c

    ## Two-electron integrals
    v_caca = mr_adc.v2e.caca

    ## Reduced density matrices
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa

    # Compute K_aaccc matrix
    K_aacc = mr_adc_intermediates.compute_K_aacc(mr_adc)

    # Compute S^{-1/2} matrix: Orthogonalization and overlap truncation only in the active space
    S_p2_12_inv_act = mr_adc_overlap.compute_S12_p2(mr_adc)

    # Compute K^{-1} matrix
    SKS = reduce(np.dot, (S_p2_12_inv_act.T, K_aacc, S_p2_12_inv_act))
    evals, evecs = np.linalg.eigh(SKS)
    del(SKS)

    # Compute R.H.S. of the equation
    ## V tensor: - < Psi_0 | a^{\dag}_I a^{\dag}_J a_Y a_X V | Psi_0>
    V1_p2 =- einsum('IXJY->IJXY', v_caca, optimize = einsum_type).copy()
    V1_p2 += 1/2 * einsum('IXJx,Yx->IJXY', v_caca, rdm_ca, optimize = einsum_type)
    V1_p2 += 1/2 * einsum('IxJY,Xx->IJXY', v_caca, rdm_ca, optimize = einsum_type)
    V1_p2 -= 1/3 * einsum('IxJy,XYxy->IJXY', v_caca, rdm_ccaa, optimize = einsum_type)
    V1_p2 -= 1/6 * einsum('IxJy,XYyx->IJXY', v_caca, rdm_ccaa, optimize = einsum_type)
    V1_p2 = V1_p2.reshape(ncore, ncore, ncas**2)

    # Compute denominators
    d_ij = (e_core[:,None] + e_core).reshape(-1)
    d_pij = (evals[:,None] - d_ij).reshape(evals.shape[0], ncore, ncore)
    d_pij = d_pij**(-1)

    # Compute T[+2] amplitudes
    S_12_V_p2 = einsum("IJX,Xm->IJm", V1_p2, S_p2_12_inv_act, optimize = einsum_type)
    S_12_V_p2 = einsum("mp,IJm->IJp", evecs, S_12_V_p2, optimize = einsum_type)
    S_12_V_p2 = einsum("pIJ,IJp->IJp", d_pij, S_12_V_p2, optimize = einsum_type)
    S_12_V_p2 = einsum("mp,IJp->IJm", evecs, S_12_V_p2, optimize = einsum_type)
    del(V1_p2, d_ij, d_pij, evals, evecs)

    ## Compute T[+2] t1_ccaa tensor
    t1_ccaa = einsum("IJm,Xm->IJX", S_12_V_p2, S_p2_12_inv_act, optimize = einsum_type)
    t1_ccaa = t1_ccaa.reshape(ncore, ncore, ncas, ncas)
    del(S_12_V_p2, S_p2_12_inv_act)

    # Compute electronic correlation energy for T[+2]
    e_p2  = 2 * einsum('ijxy,ixjy', t1_ccaa, v_caca, optimize = einsum_type)
    e_p2 -= einsum('ijxy,jxiy', t1_ccaa, v_caca, optimize = einsum_type)
    e_p2 += 1/2 * einsum('ijxy,izjw,xyzw', t1_ccaa, v_caca, rdm_ccaa, optimize = einsum_type)
    e_p2 += einsum('ijxy,iyjz,xz', t1_ccaa, v_caca, rdm_ca, optimize = einsum_type)
    e_p2 -= 2 * einsum('ijxy,ixjz,yz', t1_ccaa, v_caca, rdm_ca, optimize = einsum_type)

    mr_adc.log.extra("Norm of T[+2]^(1):                           %20.12f" % np.linalg.norm(t1_ccaa))
    mr_adc.log.info("Correlation energy [+2]:                     %20.12f" % e_p2)
    mr_adc.log.timer("computing T[+2]^(1) amplitudes", *cput0)

    return e_p2, t1_ccaa

def compute_t1_m2(mr_adc):

    cput0 = (logger.process_clock(), logger.perf_counter())
    mr_adc.log.extra("\nComputing T[-2]^(1) amplitudes...")

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    tmpfile = mr_adc.tmpfile.t1

    # Variables from kernel
    ncas = mr_adc.ncas
    nextern = mr_adc.nextern

    ## Molecular Orbitals Energies
    e_extern = mr_adc.mo_energy.e

    ## Reduced density matrices
    rdm_ccaa = mr_adc.rdm.ccaa

    # Compute K_ccaa matrix
    K_ccaa = mr_adc_intermediates.compute_K_ccaa(mr_adc)

    # Compute S^{-1/2} matrix: Orthogonalization and overlap truncation only in the active space
    S_m2_12_inv_act = mr_adc_overlap.compute_S12_m2(mr_adc)

    # Compute K^{-1} matrix
    SKS = reduce(np.dot, (S_m2_12_inv_act.T, K_ccaa, S_m2_12_inv_act))
    evals, evecs = np.linalg.eigh(SKS)
    del(SKS)

    # Compute R.H.S. of the equation
    t1_aaee = tools.create_dataset('aaee', tmpfile, (ncas, ncas, nextern, nextern))
    chunks = tools.calculate_chunks(mr_adc, nextern, [ncas, ncas, nextern], ntensors = 3)

    e_m2 = 0.0
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("t1.aaee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_aeae = mr_adc.v2e.aeae[:,s_chunk:f_chunk]

        ## Compute denominators
        d_ab = (e_extern[s_chunk:f_chunk][:,None] + e_extern).reshape(-1)
        d_abp = (d_ab[:,None] + evals).reshape(-1, nextern, evals.shape[0])
        d_abp = d_abp**(-1)

        ## V tensor: - < Psi_0 | a^{\dag}_X a^{\dag}_Y a_B a_A V | Psi_0>
        V1_m2 =- 1/3 * einsum('xAyB,XYxy->XYAB', v_aeae, rdm_ccaa, optimize = einsum_type)
        V1_m2 -= 1/6 * einsum('xAyB,XYyx->XYAB', v_aeae, rdm_ccaa, optimize = einsum_type)
        V1_m2 = V1_m2.reshape(ncas**2, -1, nextern)

        # Compute T[-2] amplitudes
        S_12_V_m2 = einsum("XAB,Xm->mAB", V1_m2, S_m2_12_inv_act, optimize = einsum_type)
        S_12_V_m2 = einsum("mp,mAB->pAB", evecs, S_12_V_m2, optimize = einsum_type)
        S_12_V_m2 = einsum("ABp,pAB->pAB", d_abp, S_12_V_m2, optimize = einsum_type)
        S_12_V_m2 = einsum("mp,pAB->mAB", evecs, S_12_V_m2, optimize = einsum_type)
        del(V1_m2)

        ## Compute T[-2] t1_aaee tensor
        temp = einsum("mAB,Xm->XAB", S_12_V_m2, S_m2_12_inv_act, optimize = einsum_type)
        temp = temp.reshape(ncas, ncas, -1, nextern)
        del(S_12_V_m2)

        # Compute electronic correlation energy for T[-2]
        e_m2 += 1/2 * einsum('xyab,zawb,xyzw', temp, v_aeae, rdm_ccaa, optimize = einsum_type)

        t1_aaee[:,:,s_chunk:f_chunk] = temp
        tools.flush(tmpfile)
        mr_adc.log.timer_debug("computing t1.aaee", *cput1)

    mr_adc.log.extra("Norm of T[-2]^(1):                           %20.12f" % np.linalg.norm(t1_aaee))
    mr_adc.log.info("Correlation energy [-2]:                     %20.12f" % e_m2)
    mr_adc.log.timer("computing T[-2]^(1) amplitudes", *cput0)

    return e_m2, t1_aaee

def compute_t1_0p(mr_adc):

    cput0 = (logger.process_clock(), logger.perf_counter())
    mr_adc.log.extra("\nComputing T[0']^(1) amplitudes...")

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    ncore = mr_adc.ncore
    ncas = mr_adc.ncas
    nextern = mr_adc.nextern

    ## Molecular Orbitals Energies
    e_core = mr_adc.mo_energy.c
    e_extern = mr_adc.mo_energy.e

    ## One-electron integrals
    h_ce = mr_adc.h1eff.ce

    ## Two-electron integrals
    v_caae = mr_adc.v2e.caae
    v_ceaa = mr_adc.v2e.ceaa

    ## Reduced density matrices
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa

    # Compute K_caca matrix
    K_caca = mr_adc_intermediates.compute_K_caca(mr_adc)

    # Compute S^{-1/2} matrix: Orthogonalization and overlap truncation only in the active space
    S_0p_12_inv_act = mr_adc_overlap.compute_S12_0p_gno_projector(mr_adc)

    # Compute K^{-1} matrix
    SKS = reduce(np.dot, (S_0p_12_inv_act[1:,:].T, K_caca, S_0p_12_inv_act[1:,:]))
    evals, evecs = np.linalg.eigh(SKS)
    del(SKS)

    # Compute R.H.S. of the equation
    ## V1 block: - < Psi_0 | a^{\dag}_I a_A V | Psi_0>
    V1_a_a =- einsum('IA->IA', h_ce, optimize = einsum_type).copy()
    V1_a_a -= einsum('IAxy,yx->IA', v_ceaa, rdm_ca, optimize = einsum_type)
    V1_a_a += 1/2 * einsum('IxyA,xy->IA', v_caae, rdm_ca, optimize = einsum_type)

    ## V2 block: - < Psi_0 | a^{\dag}_I a^{\dag}_X a_Y a_A V | Psi_0>
    V2_aa_aa =- 1/2 * einsum('IA,XY->IAXY', h_ce, rdm_ca, optimize = einsum_type)
    V2_aa_aa -= 1/2 * einsum('IAxY,Xx->IAXY', v_ceaa, rdm_ca, optimize = einsum_type)
    V2_aa_aa -= 1/2 * einsum('IAxy,XyYx->IAXY', v_ceaa, rdm_ccaa, optimize = einsum_type)
    V2_aa_aa += 1/2 * einsum('IYxA,Xx->IAXY', v_caae, rdm_ca, optimize = einsum_type)
    V2_aa_aa += 1/6 * einsum('IxyA,XxYy->IAXY', v_caae, rdm_ccaa, optimize = einsum_type)
    V2_aa_aa -= 1/6 * einsum('IxyA,XxyY->IAXY', v_caae, rdm_ccaa, optimize = einsum_type)

    V2_aa_bb =- 1/2 * einsum('IA,XY->IAXY', h_ce, rdm_ca, optimize = einsum_type)
    V2_aa_bb -= 1/2 * einsum('IAxY,Xx->IAXY', v_ceaa, rdm_ca, optimize = einsum_type)
    V2_aa_bb -= 1/2 * einsum('IAxy,XyYx->IAXY', v_ceaa, rdm_ccaa, optimize = einsum_type)
    V2_aa_bb += 1/3 * einsum('IxyA,XxYy->IAXY', v_caae, rdm_ccaa, optimize = einsum_type)
    V2_aa_bb += 1/6 * einsum('IxyA,XxyY->IAXY', v_caae, rdm_ccaa, optimize = einsum_type)

    V2_aa_aa = V2_aa_aa.reshape(ncore, nextern, -1)
    V2_aa_bb = V2_aa_bb.reshape(ncore, nextern, -1)

    ## Build V tensor
    dim_XY = ncas * ncas
    dim_act = 2 * dim_XY + 1

    V_aa_aa_i = 1
    V_aa_aa_f = V_aa_aa_i + dim_XY
    V_aa_bb_i = V_aa_aa_f
    V_aa_bb_f = V_aa_bb_i + dim_XY

    V_0p = np.zeros((ncore, nextern, dim_act))

    V_0p[:,:,0] = V1_a_a.copy()
    del(V1_a_a)

    V_0p[:,:,V_aa_aa_i:V_aa_aa_f] = V2_aa_aa.copy()
    V_0p[:,:,V_aa_bb_i:V_aa_bb_f] = V2_aa_bb.copy()
    del(V2_aa_aa, V2_aa_bb)

    ## Compute denominators
    d_ai = (e_extern[:,None] - e_core).reshape(-1)
    d_aip = (d_ai[:,None] + evals).reshape(nextern, ncore, -1)
    d_aip = d_aip**(-1)

    # Compute T[0'] amplitudes
    S_12_V_0p = einsum("iaP,Pm->iam", V_0p, S_0p_12_inv_act, optimize = einsum_type)
    S_12_V_0p = einsum("mp,iam->iap", evecs, S_12_V_0p, optimize = einsum_type)
    S_12_V_0p = einsum("aip,iap->iap", d_aip, S_12_V_0p, optimize = einsum_type)
    S_12_V_0p = einsum("mp,iap->iam", evecs, S_12_V_0p, optimize = einsum_type)
    del(V_0p, d_ai, d_aip, evals, evecs)

    ## Compute T[0'] t1_ce, t1_caea and t1_caae tensors
    t_0p = einsum("iam,Pm->iaP", S_12_V_0p, S_0p_12_inv_act, optimize = einsum_type)
    del(S_12_V_0p, S_0p_12_inv_act)

    ## Build T[0'] tensors
    t1_ce = t_0p[:,:,0].copy()
    t1_caea_aaaa = t_0p[:,:,V_aa_aa_i:V_aa_aa_f].reshape(ncore, nextern, ncas, ncas).transpose(0,2,1,3)
    t1_caea_abab = t_0p[:,:,V_aa_bb_i:V_aa_bb_f].reshape(ncore, nextern, ncas, ncas).transpose(0,2,1,3)

    t1_caea = t1_caea_abab
    t1_caae = (t1_caea_abab - t1_caea_aaaa).transpose(0,1,3,2).copy()
    del(t_0p, t1_caea_aaaa, t1_caea_abab)

    # Compute electronic correlation energy for T[0']
    e_0p  = 2 * einsum('ia,ia', h_ce, t1_ce, optimize = einsum_type)
    e_0p += 2 * einsum('ia,ixay,yx', h_ce, t1_caea, rdm_ca, optimize = einsum_type)
    e_0p -= einsum('ia,ixya,yx', h_ce, t1_caae, rdm_ca, optimize = einsum_type)
    e_0p += 2 * einsum('ia,iaxy,yx', t1_ce, v_ceaa, rdm_ca, optimize = einsum_type)
    e_0p -= einsum('ia,ixya,xy', t1_ce, v_caae, rdm_ca, optimize = einsum_type)
    e_0p += 2 * einsum('ixay,iazw,yzxw', t1_caea, v_ceaa, rdm_ccaa, optimize = einsum_type)
    e_0p += 2 * einsum('ixay,iazy,xz', t1_caea, v_ceaa, rdm_ca, optimize = einsum_type)
    e_0p -= einsum('ixay,izwa,ywxz', t1_caea, v_caae, rdm_ccaa, optimize = einsum_type)
    e_0p -= einsum('ixay,iyza,xz', t1_caea, v_caae, rdm_ca, optimize = einsum_type)
    e_0p -= einsum('ixya,iazw,yzxw', t1_caae, v_ceaa, rdm_ccaa, optimize = einsum_type)
    e_0p -= einsum('ixya,iazy,xz', t1_caae, v_ceaa, rdm_ca, optimize = einsum_type)
    e_0p -= einsum('ixya,izwa,ywzx', t1_caae, v_caae, rdm_ccaa, optimize = einsum_type)
    e_0p += 2 * einsum('ixya,iyza,xz', t1_caae, v_caae, rdm_ca, optimize = einsum_type)

    mr_adc.log.extra("Norm of T[0']^(1):                           %20.12f" % (np.linalg.norm(t1_ce) +
                                                                              np.linalg.norm(t1_caea)))
    mr_adc.log.info("Correlation energy [0']:                     %20.12f" % e_0p)
    mr_adc.log.timer("computing T[0']^(1) amplitudes", *cput0)

    return e_0p, t1_ce, t1_caea, t1_caae

def compute_t1_p1p(mr_adc):

    cput0 = (logger.process_clock(), logger.perf_counter())
    mr_adc.log.extra("\nComputing T[+1']^(1) amplitudes...")

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    ncore = mr_adc.ncore
    ncas = mr_adc.ncas

    ## Molecular Orbitals Energies
    e_core = mr_adc.mo_energy.c

    ## One-electron integrals
    h_ca = mr_adc.h1eff.ca

    ## Two-electron integrals
    v_caaa = mr_adc.v2e.caaa

    ## Reduced density matrices
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa
    rdm_cccaaa = mr_adc.rdm.cccaaa

    # Compute K_p1p matrix
    K_p1p = mr_adc_intermediates.compute_K_p1p(mr_adc)

    # Compute S^{-1/2} matrix: Orthogonalization and overlap truncation only in the active space
    S_p1p_12_inv_act = mr_adc_overlap.compute_S12_p1p_gno_projector(mr_adc)

    # Compute K^{-1} matrix
    SKS = reduce(np.dot, (S_p1p_12_inv_act.T, K_p1p, S_p1p_12_inv_act))
    evals, evecs = np.linalg.eigh(SKS)
    del(SKS)

    # Compute R.H.S. of the equation
    ## V1 block: - < Psi_0 | a^{\dag}_I a_X V | Psi_0>
    V1_a_a =- einsum('IX->IX', h_ca, optimize = einsum_type).copy()
    V1_a_a += 1/2 * einsum('Ix,Xx->IX', h_ca, rdm_ca, optimize = einsum_type)
    V1_a_a -= einsum('IXxy,xy->IX', v_caaa, rdm_ca, optimize = einsum_type)
    V1_a_a += 1/2 * einsum('IxyX,yx->IX', v_caaa, rdm_ca, optimize = einsum_type)
    V1_a_a += 1/2 * einsum('Ixyz,Xyxz->IX', v_caaa, rdm_ccaa, optimize = einsum_type)

    ## V2 block: - < Psi_0 | a^{\dag}_I a^{\dag}_X a_Y a_Z V | Psi_0>
    V2_aa_aa  = 1/2 * einsum('IY,XZ->IXYZ', h_ca, rdm_ca, optimize = einsum_type)
    V2_aa_aa -= 1/2 * einsum('IZ,XY->IXYZ', h_ca, rdm_ca, optimize = einsum_type)
    V2_aa_aa += 1/6 * einsum('Ix,XxYZ->IXYZ', h_ca, rdm_ccaa, optimize = einsum_type)
    V2_aa_aa -= 1/6 * einsum('Ix,XxZY->IXYZ', h_ca, rdm_ccaa, optimize = einsum_type)
    V2_aa_aa += 1/2 * einsum('IYxZ,Xx->IXYZ', v_caaa, rdm_ca, optimize = einsum_type)
    V2_aa_aa += 1/2 * einsum('IYxy,XyZx->IXYZ', v_caaa, rdm_ccaa, optimize = einsum_type)
    V2_aa_aa -= 1/2 * einsum('IZxY,Xx->IXYZ', v_caaa, rdm_ca, optimize = einsum_type)
    V2_aa_aa -= 1/2 * einsum('IZxy,XyYx->IXYZ', v_caaa, rdm_ccaa, optimize = einsum_type)
    V2_aa_aa -= 1/6 * einsum('IxyY,XxZy->IXYZ', v_caaa, rdm_ccaa, optimize = einsum_type)
    V2_aa_aa += 1/6 * einsum('IxyY,XxyZ->IXYZ', v_caaa, rdm_ccaa, optimize = einsum_type)
    V2_aa_aa += 1/6 * einsum('IxyZ,XxYy->IXYZ', v_caaa, rdm_ccaa, optimize = einsum_type)
    V2_aa_aa -= 1/6 * einsum('IxyZ,XxyY->IXYZ', v_caaa, rdm_ccaa, optimize = einsum_type)
    V2_aa_aa += 1/6 * einsum('Ixyz,XxzYZy->IXYZ', v_caaa, rdm_cccaaa, optimize = einsum_type)
    V2_aa_aa -= 1/6 * einsum('Ixyz,XxzZYy->IXYZ', v_caaa, rdm_cccaaa, optimize = einsum_type)

    V2_ab_ba =- 1/2 * einsum('IZ,XY->IXYZ', h_ca, rdm_ca, optimize = einsum_type)
    V2_ab_ba += 1/3 * einsum('Ix,XxYZ->IXYZ', h_ca, rdm_ccaa, optimize = einsum_type)
    V2_ab_ba += 1/6 * einsum('Ix,XxZY->IXYZ', h_ca, rdm_ccaa, optimize = einsum_type)
    V2_ab_ba -= 1/2 * einsum('IZxY,Xx->IXYZ', v_caaa, rdm_ca, optimize = einsum_type)
    V2_ab_ba -= 1/2 * einsum('IZxy,XyYx->IXYZ', v_caaa, rdm_ccaa, optimize = einsum_type)
    V2_ab_ba += 1/6 * einsum('IxyY,XxZy->IXYZ', v_caaa, rdm_ccaa, optimize = einsum_type)
    V2_ab_ba += 1/3 * einsum('IxyY,XxyZ->IXYZ', v_caaa, rdm_ccaa, optimize = einsum_type)
    V2_ab_ba += 1/3 * einsum('IxyZ,XxYy->IXYZ', v_caaa, rdm_ccaa, optimize = einsum_type)
    V2_ab_ba += 1/6 * einsum('IxyZ,XxyY->IXYZ', v_caaa, rdm_ccaa, optimize = einsum_type)
    V2_ab_ba += 1/3 * einsum('Ixyz,XxzYZy->IXYZ', v_caaa, rdm_cccaaa, optimize = einsum_type)
    V2_ab_ba += 1/6 * einsum('Ixyz,XxzZYy->IXYZ', v_caaa, rdm_cccaaa, optimize = einsum_type)

    ## Reshape tensors to matrix form
    tril_ind = np.tril_indices(ncas, k=-1)

    V2_aa_aa = V2_aa_aa[:,:,tril_ind[0],tril_ind[1]]

    V2_aa_aa = V2_aa_aa.reshape(ncore, -1)
    V2_ab_ba = V2_ab_ba.reshape(ncore, -1)

    ## Build V matrix
    dim_X = ncas
    dim_YWZ = ncas * ncas * ncas
    dim_tril_YWZ = ncas * ncas * (ncas - 1) // 2

    dim_act = dim_X + dim_tril_YWZ + dim_YWZ

    V_a_i = 0
    V_a_f = dim_X
    V_aaa_i = V_a_f
    V_aaa_f = V_aaa_i + dim_tril_YWZ
    V_bba_i = V_aaa_f
    V_bba_f = V_bba_i + dim_YWZ

    V_p1p = np.zeros((ncore, dim_act))

    V_p1p[:,V_a_i:V_a_f] = V1_a_a.copy()
    del(V1_a_a)

    V_p1p[:,V_aaa_i:V_aaa_f] = V2_aa_aa.copy()
    V_p1p[:,V_bba_i:V_bba_f] = V2_ab_ba.copy()
    del(V2_aa_aa, V2_ab_ba)

    ## Compute denominators
    d_ip = (-e_core[:,None] + evals)
    d_ip = d_ip**(-1)

    # Compute T[+1'] amplitudes
    S_12_V_p1p = einsum("iP,Pm->im", V_p1p, S_p1p_12_inv_act, optimize = einsum_type)
    S_12_V_p1p = einsum("mp,im->ip", evecs, S_12_V_p1p, optimize = einsum_type)
    S_12_V_p1p = einsum("ip,ip->ip", d_ip, S_12_V_p1p, optimize = einsum_type)
    S_12_V_p1p = einsum("mp,ip->im", evecs, S_12_V_p1p, optimize = einsum_type)
    del(V_p1p, d_ip, evals, evecs)

    ## Compute T[+1'] t1_ca and t1_caaa tensors
    t_p1p = einsum("Pm,im->iP", S_p1p_12_inv_act, S_12_V_p1p, optimize = einsum_type)
    del(S_p1p_12_inv_act, S_12_V_p1p)

    ## Build T[+1'] tensors
    t1_ca = t_p1p[:, V_a_i:V_a_f].copy()
    t1_caaa = t_p1p[:,V_bba_i: V_bba_f].reshape(ncore, ncas, ncas, ncas).copy()

    ## Transpose indices to the conventional order
    t1_caaa = t1_caaa.transpose(0,1,3,2).copy()
    del(t_p1p)

    # Compute electronic correlation energy for T[+1']
    e_p1p  = 2 * einsum('ix,ix', h_ca, t1_ca, optimize = einsum_type)
    e_p1p -= einsum('ix,iy,xy', h_ca, t1_ca, rdm_ca, optimize = einsum_type)
    e_p1p -= einsum('ix,iyzw,xyzw', h_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
    e_p1p -= einsum('ix,iyzx,zy', h_ca, t1_caaa, rdm_ca, optimize = einsum_type)
    e_p1p += 2 * einsum('ix,iyxz,zy', h_ca, t1_caaa, rdm_ca, optimize = einsum_type)
    e_p1p -= einsum('ix,iyzw,xzyw', t1_ca, v_caaa, rdm_ccaa, optimize = einsum_type)
    e_p1p -= einsum('ix,iyzx,yz', t1_ca, v_caaa, rdm_ca, optimize = einsum_type)
    e_p1p += 2 * einsum('ix,ixyz,zy', t1_ca, v_caaa, rdm_ca, optimize = einsum_type)
    e_p1p += 1/3 * einsum('ixyz,iwuv,xwvyzu', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
    e_p1p -= 2/3 * einsum('ixyz,iwuv,xwvzyu', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
    e_p1p -= einsum('ixyz,iwuz,yuwx', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
    e_p1p -= einsum('ixyz,izwu,ywxu', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
    e_p1p += 1/3 * einsum('ixyz,iwuv,xwvuzy', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
    e_p1p += 1/3 * einsum('ixyz,iwuv,xwvuyz', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
    e_p1p += 1/3 * einsum('ixyz,iwuv,xwvzuy', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
    e_p1p += 1/3 * einsum('ixyz,iwuv,xwvyuz', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
    e_p1p -= einsum('ixyz,iwuy,zuxw', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
    e_p1p -= einsum('ixyz,izwy,xw', t1_caaa, v_caaa, rdm_ca, optimize = einsum_type)
    e_p1p += 2 * einsum('ixyz,iywu,zwxu', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
    e_p1p += 2 * einsum('ixyz,iywz,xw', t1_caaa, v_caaa, rdm_ca, optimize = einsum_type)

    mr_adc.log.extra("Norm of T[+1']^(1):                          %20.12f" % (np.linalg.norm(t1_ca) +
                                                                              np.linalg.norm(t1_caaa)))
    mr_adc.log.info("Correlation energy [+1']:                    %20.12f" % e_p1p)
    mr_adc.log.timer("computing T[+1']^(1) amplitudes", *cput0)

    return e_p1p, t1_ca, t1_caaa

def compute_t1_m1p(mr_adc):

    cput0 = (logger.process_clock(), logger.perf_counter())
    mr_adc.log.extra("\nComputing T[-1']^(1) amplitudes...")

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    ncas = mr_adc.ncas
    nextern = mr_adc.nextern

    ## Molecular Orbitals Energies
    e_extern = mr_adc.mo_energy.e

    ## One-electron integrals
    h_ae = mr_adc.h1eff.ae

    ## Two-electron integrals
    v_aaae = mr_adc.v2e.aaae

    ## Reduced density matrices
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa
    rdm_cccaaa = mr_adc.rdm.cccaaa

    # Compute K_m1p matrix
    K_m1p = mr_adc_intermediates.compute_K_m1p(mr_adc)

    # Compute S^{-1/2} matrix: Orthogonalization and overlap truncation only in the active space
    S_m1p_12_inv_act = mr_adc_overlap.compute_S12_m1p_gno_projector(mr_adc)

    # Compute K^{-1} matrix
    SKS = reduce(np.dot, (S_m1p_12_inv_act.T, K_m1p, S_m1p_12_inv_act))
    evals, evecs = np.linalg.eigh(SKS)
    del(SKS)

    # Compute R.H.S. of the equation
    ## V1 block: - < Psi_0 | a^{\dag}_X a_A V | Psi_0>
    V1_a_a =- 1/2 * einsum('xA,Xx->XA', h_ae, rdm_ca, optimize = einsum_type)
    V1_a_a -= 1/2 * einsum('xyzA,Xyzx->XA', v_aaae, rdm_ccaa, optimize = einsum_type)

    ## V2 block: - < Psi_0 | a^{\dag}_X a^{\dag}_Y a_Z a_A V | Psi_0>
    V2_aa_aa  = 1/6 * einsum('xA,XYZx->XYZA', h_ae, rdm_ccaa, optimize = einsum_type)
    V2_aa_aa -= 1/6 * einsum('xA,XYxZ->XYZA', h_ae, rdm_ccaa, optimize = einsum_type)
    V2_aa_aa += 1/6 * einsum('xZyA,XYxy->XYZA', v_aaae, rdm_ccaa, optimize = einsum_type)
    V2_aa_aa -= 1/6 * einsum('xZyA,XYyx->XYZA', v_aaae, rdm_ccaa, optimize = einsum_type)
    V2_aa_aa += 1/6 * einsum('xyzA,XYyZzx->XYZA', v_aaae, rdm_cccaaa, optimize = einsum_type)
    V2_aa_aa -= 1/6 * einsum('xyzA,XYyzZx->XYZA', v_aaae, rdm_cccaaa, optimize = einsum_type)

    V2_ab_ba =- 1/6 * einsum('xA,XYZx->XYZA', h_ae, rdm_ccaa, optimize = einsum_type)
    V2_ab_ba -= 1/3 * einsum('xA,XYxZ->XYZA', h_ae, rdm_ccaa, optimize = einsum_type)
    V2_ab_ba -= 1/6 * einsum('xZyA,XYxy->XYZA', v_aaae, rdm_ccaa, optimize = einsum_type)
    V2_ab_ba -= 1/3 * einsum('xZyA,XYyx->XYZA', v_aaae, rdm_ccaa, optimize = einsum_type)
    V2_ab_ba += 1/6 * einsum('xyzA,XYyZxz->XYZA', v_aaae, rdm_cccaaa, optimize = einsum_type)
    V2_ab_ba += 1/6 * einsum('xyzA,XYyxZz->XYZA', v_aaae, rdm_cccaaa, optimize = einsum_type)
    V2_ab_ba += 1/6 * einsum('xyzA,XYyxzZ->XYZA', v_aaae, rdm_cccaaa, optimize = einsum_type)
    V2_ab_ba -= 1/6 * einsum('xyzA,XYyzZx->XYZA', v_aaae, rdm_cccaaa, optimize = einsum_type)
    V2_ab_ba += 1/6 * einsum('xyzA,XYyzxZ->XYZA', v_aaae, rdm_cccaaa, optimize = einsum_type)

    ## Reshape tensors to matrix form
    tril_ind = np.tril_indices(ncas, k=-1)

    V2_aa_aa = V2_aa_aa[tril_ind[0], tril_ind[1]]

    V2_aa_aa = V2_aa_aa.reshape(-1, nextern)
    V2_ab_ba = V2_ab_ba.reshape(-1, nextern)

    ## Build V matrix
    dim_X = ncas
    dim_YWZ = ncas * ncas * ncas
    dim_tril_YWZ = ncas * ncas * (ncas - 1) // 2

    dim_act = dim_X + dim_tril_YWZ + dim_YWZ

    V_a_i = 0
    V_a_f = dim_X
    V_aaa_i = V_a_f
    V_aaa_f = V_aaa_i + dim_tril_YWZ
    V_abb_i = V_aaa_f
    V_abb_f = V_abb_i + dim_YWZ

    V_m1p = np.zeros((dim_act, nextern))

    V_m1p[V_a_i:V_a_f, :] = V1_a_a.copy()
    del(V1_a_a)

    V_m1p[V_aaa_i:V_aaa_f, :] = V2_aa_aa.copy()
    V_m1p[V_abb_i:V_abb_f, :] = V2_ab_ba.copy()
    del(V2_aa_aa, V2_ab_ba)

    ## Compute denominators
    d_pa = (evals[:,None] + e_extern)
    d_pa = d_pa**(-1)

    # Compute T[-1'] amplitudes
    S_12_V_m1p = einsum("Pa,Pm->ma", V_m1p, S_m1p_12_inv_act, optimize = einsum_type)
    S_12_V_m1p = einsum("mp,ma->pa", evecs, S_12_V_m1p, optimize = einsum_type)
    S_12_V_m1p = einsum("pa,pa->pa", d_pa, S_12_V_m1p, optimize = einsum_type)
    S_12_V_m1p = einsum("mp,pa->ma", evecs, S_12_V_m1p, optimize = einsum_type)
    del(V_m1p, d_pa, evals, evecs)

    ## Compute T[-1'] t1_ae and t1_aaea tensors
    t_m1p = einsum("Pm,ma->Pa", S_m1p_12_inv_act, S_12_V_m1p, optimize = einsum_type)
    del(S_m1p_12_inv_act, S_12_V_m1p)

    ## Build T[-1'] tensors
    t1_ae = t_m1p[V_a_i:V_a_f, :].copy()
    t1_aaae = t_m1p[V_abb_i:V_abb_f, :].reshape(ncas, ncas, ncas, nextern).copy()
    t1_aaae = t1_aaae.transpose(1,0,2,3)
    del(t_m1p)

    # Compute electronic correlation energy for T[-1']
    e_m1p  = einsum('xa,ya,xy', h_ae, t1_ae, rdm_ca, optimize = einsum_type)
    e_m1p += einsum('xa,yzwa,xwzy', h_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    e_m1p += einsum('xa,yzwa,xzwy', t1_ae, v_aaae, rdm_ccaa, optimize = einsum_type)
    e_m1p -= 1/3 * einsum('xyza,wuva,zvwuyx', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
    e_m1p -= 1/3 * einsum('xyza,wuva,zvwxuy', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
    e_m1p += 2/3 * einsum('xyza,wuva,zvwxyu', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
    e_m1p -= 1/3 * einsum('xyza,wuva,zvwuxy', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
    e_m1p -= 1/3 * einsum('xyza,wuva,zvwyux', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
    e_m1p -= 1/3 * einsum('xyza,wuva,zvwyxu', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
    e_m1p += einsum('xyza,wzua,xywu', t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)

    mr_adc.log.extra("Norm of T[-1']^(1):                          %20.12f" % (np.linalg.norm(t1_ae) +
                                                                              np.linalg.norm(t1_aaae)))
    mr_adc.log.info("Correlation energy [-1']:                    %20.12f" % e_m1p)
    mr_adc.log.timer("computing T[-1']^(1) amplitudes", *cput0)

    return e_m1p, t1_ae, t1_aaae

def compute_t2_0p_singles(mr_adc):

    cput0 = (logger.process_clock(), logger.perf_counter())
    mr_adc.log.extra("Computing T[0']^(2) amplitudes...")

    # Import Prism interface
    interface = mr_adc.interface

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    ncore = mr_adc.ncore
    ncas = mr_adc.ncas
    nextern = mr_adc.nextern

    ## Molecular Orbitals Energies
    e_core = mr_adc.mo_energy.c
    e_extern = mr_adc.mo_energy.e

    ## One-electron integrals
    h_ca = mr_adc.h1eff.ca
    h_ce = mr_adc.h1eff.ce
    h_aa = mr_adc.h1eff.aa
    h_ae = mr_adc.h1eff.ae

    ## Two-electron integrals
    v_aaaa = mr_adc.v2e.aaaa

    v_ccca = mr_adc.v2e.ccca
    v_ccce = mr_adc.v2e.ccce

    v_ccaa = mr_adc.v2e.ccaa
    v_ccae = mr_adc.v2e.ccae

    v_caac = mr_adc.v2e.caac
    v_caec = mr_adc.v2e.caec

    v_cace = mr_adc.v2e.cace

    v_caaa = mr_adc.v2e.caaa
    v_ceae = mr_adc.v2e.ceae
    v_caae = mr_adc.v2e.caae
    v_ceaa = mr_adc.v2e.ceaa

    v_caea = mr_adc.v2e.caea

    v_aaae = mr_adc.v2e.aaae

    ## Amplitudes
    t1_ce = mr_adc.t1.ce
    t1_caea = mr_adc.t1.caea
    t1_caae = mr_adc.t1.caae

    t1_ca = mr_adc.t1.ca
    t1_caaa = mr_adc.t1.caaa

    t1_ae   = mr_adc.t1.ae
    t1_aaae = mr_adc.t1.aaae

    t1_ccae = mr_adc.t1.ccae
    t1_ccaa = mr_adc.t1.ccaa

    ## Reduced density matrices
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa
    rdm_cccaaa = mr_adc.rdm.cccaaa

    # Compute R.H.S. of the equation
    # V1 block: - 1/2 < Psi_0 | a^{\dag}_I a_A [V + H^{(1)}, T - T^\dag] | Psi_0 >
    V1  = einsum('Ix,xA->IA', h_ca, t1_ae, optimize = einsum_type)
    V1 += einsum('ix,IixA->IA', h_ca, t1_ccae, optimize = einsum_type)
    V1 -= 2 * einsum('ix,iIxA->IA', h_ca, t1_ccae, optimize = einsum_type)
    V1 -= einsum('xA,Ix->IA', h_ae, t1_ca, optimize = einsum_type)
    V1 += einsum('Iixy,ixAy->IA', t1_ccaa, v_caea, optimize = einsum_type)
    V1 -= 2 * einsum('Iixy,iyAx->IA', t1_ccaa, v_caea, optimize = einsum_type)
    V1 -= einsum('ijxA,iIjx->IA', t1_ccae, v_ccca, optimize = einsum_type)
    V1 += 2 * einsum('ijxA,jIix->IA', t1_ccae, v_ccca, optimize = einsum_type)
    V1 += einsum('ix,IixA->IA', t1_ca, v_ccae, optimize = einsum_type)
    V1 += einsum('ix,IxiA->IA', t1_ca, v_cace, optimize = einsum_type)
    V1 -= 2 * einsum('ix,ixAI->IA', t1_ca, v_caec, optimize = einsum_type)
    V1 -= 2 * einsum('ix,ixIA->IA', t1_ca, v_cace, optimize = einsum_type)
    V1 += 1/2 * einsum('A,IixA,ix->IA', e_extern, t1_ccae, t1_ca, optimize = einsum_type)
    V1 -= einsum('A,iIxA,ix->IA', e_extern, t1_ccae, t1_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('A,xA,Ix->IA', e_extern, t1_ae, t1_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,IixA,ix->IA', e_core, t1_ccae, t1_ca, optimize = einsum_type)
    V1 += einsum('I,iIxA,ix->IA', e_core, t1_ccae, t1_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,xA,Ix->IA', e_core, t1_ae, t1_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,IixA,ix->IA', e_core, t1_ccae, t1_ca, optimize = einsum_type)
    V1 += einsum('i,iIxA,ix->IA', e_core, t1_ccae, t1_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ix,IixA->IA', e_core, t1_ca, t1_ccae, optimize = einsum_type)
    V1 += einsum('i,ix,iIxA->IA', e_core, t1_ca, t1_ccae, optimize = einsum_type)
    V1 -= 1/2 * einsum('Ix,xyzA,zy->IA', h_ca, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 += einsum('Ix,yxzA,zy->IA', h_ca, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ix,IiyA,xy->IA', h_ca, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += einsum('ix,iIyA,xy->IA', h_ca, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= einsum('xA,Iyxz,yz->IA', h_ae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xA,Iyzx,yz->IA', h_ae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xy,IixA,iy->IA', h_aa, t1_ccae, t1_ca, optimize = einsum_type)
    V1 -= 2 * einsum('xy,iIxA,iy->IA', h_aa, t1_ccae, t1_ca, optimize = einsum_type)
    V1 += einsum('xy,xA,Iy->IA', h_aa, t1_ae, t1_ca, optimize = einsum_type)
    V1 += einsum('IixA,ixyz,zy->IA', t1_ccae, v_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('IixA,iyzw,xzyw->IA', t1_ccae, v_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('IixA,iyzx,yz->IA', t1_ccae, v_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Iixy,ixAz,yz->IA', t1_ccaa, v_caea, rdm_ca, optimize = einsum_type)
    V1 += einsum('Iixy,iyAz,xz->IA', t1_ccaa, v_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Iixy,izAw,xywz->IA', t1_ccaa, v_caea, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('Iixy,izAx,yz->IA', t1_ccaa, v_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Iixy,izAy,xz->IA', t1_ccaa, v_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Ix,xyzA,yz->IA', t1_ca, v_aaae, rdm_ca, optimize = einsum_type)
    V1 -= einsum('Ix,yzxA,zy->IA', t1_ca, v_aaae, rdm_ca, optimize = einsum_type)
    V1 -= einsum('Ixyz,wuyA,xwzu->IA', t1_caaa, v_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Ixyz,wuzA,xwyu->IA', t1_caaa, v_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Ixyz,wxuA,yzuw->IA', t1_caaa, v_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Ixyz,ywuA,xuzw->IA', t1_caaa, v_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Ixyz,ywzA,xw->IA', t1_caaa, v_aaae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Ixyz,zwuA,xuwy->IA', t1_caaa, v_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('Ixyz,zwyA,xw->IA', t1_caaa, v_aaae, rdm_ca, optimize = einsum_type)
    V1 -= 2 * einsum('iIxA,ixyz,zy->IA', t1_ccae, v_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('iIxA,iyzw,xzyw->IA', t1_ccae, v_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('iIxA,iyzx,yz->IA', t1_ccae, v_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('ijxA,iIjy,xy->IA', t1_ccae, v_ccca, rdm_ca, optimize = einsum_type)
    V1 -= einsum('ijxA,jIiy,xy->IA', t1_ccae, v_ccca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ix,IiyA,xy->IA', t1_ca, v_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ix,IyiA,xy->IA', t1_ca, v_cace, rdm_ca, optimize = einsum_type)
    V1 += einsum('ix,iyAI,xy->IA', t1_ca, v_caec, rdm_ca, optimize = einsum_type)
    V1 += einsum('ix,iyIA,xy->IA', t1_ca, v_cace, rdm_ca, optimize = einsum_type)
    V1 += einsum('ixAy,Iiyz,xz->IA', t1_caea, v_ccaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('ixAy,Iizw,ywxz->IA', t1_caea, v_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixAy,Izwi,yzxw->IA', t1_caea, v_caac, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixAy,Izyi,xz->IA', t1_caea, v_caac, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyA,Iiyz,xz->IA', t1_caae, v_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyA,Iizw,ywxz->IA', t1_caae, v_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyA,Izwi,yzwx->IA', t1_caae, v_caac, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('ixyA,Izyi,xz->IA', t1_caae, v_caac, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyz,IiwA,xwzy->IA', t1_caaa, v_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('ixyz,IiyA,xz->IA', t1_caaa, v_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyz,IizA,xy->IA', t1_caaa, v_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyz,IwiA,xwzy->IA', t1_caaa, v_cace, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('ixyz,IyiA,zx->IA', t1_caaa, v_cace, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyz,IziA,yx->IA', t1_caaa, v_cace, rdm_ca, optimize = einsum_type)
    V1 += einsum('ixyz,iwAI,xwzy->IA', t1_caaa, v_caec, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('ixyz,iwIA,xwzy->IA', t1_caaa, v_cace, rdm_ccaa, optimize = einsum_type)
    V1 -= 2 * einsum('ixyz,iyAI,xz->IA', t1_caaa, v_caec, rdm_ca, optimize = einsum_type)
    V1 -= 2 * einsum('ixyz,iyIA,zx->IA', t1_caaa, v_cace, rdm_ca, optimize = einsum_type)
    V1 += einsum('ixyz,izAI,xy->IA', t1_caaa, v_caec, rdm_ca, optimize = einsum_type)
    V1 += einsum('ixyz,izIA,yx->IA', t1_caaa, v_cace, rdm_ca, optimize = einsum_type)
    V1 += einsum('xA,Ixyz,yz->IA', t1_ae, v_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xA,Iyzx,zy->IA', t1_ae, v_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzA,Iwux,zwuy->IA', t1_aaae, v_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzA,Iwuy,zwxu->IA', t1_aaae, v_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzA,Iwzu,yxwu->IA', t1_aaae, v_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzA,Ixwu,zuyw->IA', t1_aaae, v_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzA,Ixwy,zw->IA', t1_aaae, v_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xyzA,Iywu,zuxw->IA', t1_aaae, v_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzA,Iywx,zw->IA', t1_aaae, v_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('A,IixA,iy,xy->IA', e_extern, t1_ccae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('A,IixA,iyxz,zy->IA', e_extern, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('A,IixA,iyzw,xyzw->IA', e_extern, t1_ccae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('A,IixA,iyzx,zy->IA', e_extern, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('A,iIxA,iy,xy->IA', e_extern, t1_ccae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= einsum('A,iIxA,iyxz,zy->IA', e_extern, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('A,iIxA,iyzw,xyzw->IA', e_extern, t1_ccae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('A,iIxA,iyzx,zy->IA', e_extern, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('A,xA,Iyxz,yz->IA', e_extern, t1_ae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('A,xA,Iyzx,yz->IA', e_extern, t1_ae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('A,xyzA,Iwux,zuwy->IA', e_extern, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('A,xyzA,Iwuy,zuxw->IA', e_extern, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('A,xyzA,Iwxu,zuyw->IA', e_extern, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('A,xyzA,Iwxy,zw->IA', e_extern, t1_aaae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('A,xyzA,Iwyu,zuxw->IA', e_extern, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('A,xyzA,Iwyx,zw->IA', e_extern, t1_aaae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('A,xyzA,Ix,zy->IA', e_extern, t1_aaae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('A,xyzA,Iy,zx->IA', e_extern, t1_aaae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('A,xyzA,Izwu,yxwu->IA', e_extern, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('I,IixA,iy,xy->IA', e_core, t1_ccae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,IixA,iyxz,zy->IA', e_core, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('I,IixA,iyzw,xyzw->IA', e_core, t1_ccae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('I,IixA,iyzx,zy->IA', e_core, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,iIxA,iy,xy->IA', e_core, t1_ccae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += einsum('I,iIxA,iyxz,zy->IA', e_core, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,iIxA,iyzw,xyzw->IA', e_core, t1_ccae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,iIxA,iyzx,zy->IA', e_core, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,xA,Iyxz,yz->IA', e_core, t1_ae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('I,xA,Iyzx,yz->IA', e_core, t1_ae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('I,xyzA,Iwux,zuwy->IA', e_core, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('I,xyzA,Iwuy,zuxw->IA', e_core, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('I,xyzA,Iwxu,zuyw->IA', e_core, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('I,xyzA,Iwxy,zw->IA', e_core, t1_aaae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,xyzA,Iwyu,zuxw->IA', e_core, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,xyzA,Iwyx,zw->IA', e_core, t1_aaae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('I,xyzA,Ix,zy->IA', e_core, t1_aaae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,xyzA,Iy,zx->IA', e_core, t1_aaae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('I,xyzA,Izwu,yxwu->IA', e_core, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('i,IixA,iy,xy->IA', e_core, t1_ccae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,IixA,iyxz,yz->IA', e_core, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('i,IixA,iyzw,xyzw->IA', e_core, t1_ccae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('i,IixA,iyzx,yz->IA', e_core, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= einsum('i,iIxA,iy,xy->IA', e_core, t1_ccae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += einsum('i,iIxA,iyxz,yz->IA', e_core, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= einsum('i,iIxA,iyzw,xyzw->IA', e_core, t1_ccae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,iIxA,iyzx,yz->IA', e_core, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ixyz,IiyA,xz->IA', e_core, t1_caaa, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ixyz,IizA,xy->IA', e_core, t1_caaa, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += einsum('i,ixyz,iIyA,xz->IA', e_core, t1_caaa, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ixyz,iIzA,xy->IA', e_core, t1_caaa, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,IixA,iz,yz->IA', h_aa, t1_ccae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,IixA,izwu,yzwu->IA', h_aa, t1_ccae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,IixA,izwy,wz->IA', h_aa, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xy,IixA,izyw,wz->IA', h_aa, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,Ixzw,uwvA,yuzv->IA', h_aa, t1_caaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,Ixzw,uzvA,yuwv->IA', h_aa, t1_caaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,Ixzw,wA,yz->IA', h_aa, t1_caaa, t1_ae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,Ixzw,wuvA,yuvz->IA', h_aa, t1_caaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,Ixzw,wzuA,yu->IA', h_aa, t1_caaa, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,Ixzw,zA,yw->IA', h_aa, t1_caaa, t1_ae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,Ixzw,zuvA,yuwv->IA', h_aa, t1_caaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,Ixzw,zwuA,yu->IA', h_aa, t1_caaa, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,Izwx,uvzA,ywuv->IA', h_aa, t1_caaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,Izwx,uwvA,yvzu->IA', h_aa, t1_caaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,Izwx,wA,yz->IA', h_aa, t1_caaa, t1_ae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Izwx,wuvA,yvzu->IA', h_aa, t1_caaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,Izxw,uvzA,ywvu->IA', h_aa, t1_caaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Izxw,uwvA,yvzu->IA', h_aa, t1_caaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Izxw,wA,yz->IA', h_aa, t1_caaa, t1_ae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Izxw,wuvA,yvuz->IA', h_aa, t1_caaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,iIxA,iz,yz->IA', h_aa, t1_ccae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,iIxA,izwu,yzwu->IA', h_aa, t1_ccae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xy,iIxA,izwy,wz->IA', h_aa, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 2 * einsum('xy,iIxA,izyw,wz->IA', h_aa, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,ix,IizA,yz->IA', h_aa, t1_ca, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,ix,iIzA,yz->IA', h_aa, t1_ca, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,ixzw,IiuA,yuwz->IA', h_aa, t1_caaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,ixzw,IiwA,yz->IA', h_aa, t1_caaa, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,ixzw,IizA,yw->IA', h_aa, t1_caaa, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,ixzw,iIuA,yuwz->IA', h_aa, t1_caaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,ixzw,iIwA,yz->IA', h_aa, t1_caaa, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += einsum('xy,ixzw,iIzA,yw->IA', h_aa, t1_caaa, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,izwx,IiuA,ywzu->IA', h_aa, t1_caaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,izwx,IiwA,yz->IA', h_aa, t1_caaa, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,izwx,iIuA,ywzu->IA', h_aa, t1_caaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('xy,izwx,iIwA,yz->IA', h_aa, t1_caaa, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,izxw,IiuA,ywuz->IA', h_aa, t1_caaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,izxw,IiwA,yz->IA', h_aa, t1_caaa, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,izxw,iIuA,ywuz->IA', h_aa, t1_caaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,izxw,iIwA,yz->IA', h_aa, t1_caaa, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,xA,Izwy,zw->IA', h_aa, t1_ae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xy,xA,Izyw,zw->IA', h_aa, t1_ae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,xzwA,Iuvy,wvuz->IA', h_aa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,xzwA,Iuvz,yuwv->IA', h_aa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,xzwA,Iuyv,wvzu->IA', h_aa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,xzwA,Iuyz,wu->IA', h_aa, t1_aaae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,xzwA,Iuzv,yuwv->IA', h_aa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xy,xzwA,Iuzy,wu->IA', h_aa, t1_aaae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,xzwA,Iwuv,yzvu->IA', h_aa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,xzwA,Iy,wz->IA', h_aa, t1_aaae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,xzwA,Iz,yw->IA', h_aa, t1_aaae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,zwxA,Iuvw,yvzu->IA', h_aa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,zwxA,Iuvz,yvuw->IA', h_aa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,zwxA,Iuwv,yvzu->IA', h_aa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,zwxA,Iuwz,yu->IA', h_aa, t1_aaae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,zwxA,Iuzv,yvwu->IA', h_aa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,zwxA,Iuzw,yu->IA', h_aa, t1_aaae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,zwxA,Iw,yz->IA', h_aa, t1_aaae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,zwxA,Iyuv,wzuv->IA', h_aa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,zwxA,Iz,yw->IA', h_aa, t1_aaae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,zxwA,Iuvy,wvzu->IA', h_aa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,zxwA,Iuvz,yuvw->IA', h_aa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xy,zxwA,Iuyv,wvzu->IA', h_aa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xy,zxwA,Iuyz,wu->IA', h_aa, t1_aaae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,zxwA,Iuzv,yuwv->IA', h_aa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,zxwA,Iuzy,wu->IA', h_aa, t1_aaae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,zxwA,Iwuv,yzuv->IA', h_aa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xy,zxwA,Iy,wz->IA', h_aa, t1_aaae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,zxwA,Iz,yw->IA', h_aa, t1_aaae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= einsum('ixAy,Iizw,zw,yx->IA', t1_caea, v_ccaa, rdm_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('ixAy,Izwi,wz,yx->IA', t1_caea, v_caac, rdm_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('ixyA,Iizw,zw,yx->IA', t1_caae, v_ccaa, rdm_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('ixyA,Izwi,wz,yx->IA', t1_caae, v_caac, rdm_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,IixA,iu,zuwy->IA', v_aaaa, t1_ccae, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,IixA,iuvs,zvsuwy->IA', v_aaaa, t1_ccae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,IixA,iuvs,zvsuyw->IA', v_aaaa, t1_ccae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,IixA,iuvs,zvswuy->IA', v_aaaa, t1_ccae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,IixA,iuvs,zvswyu->IA', v_aaaa, t1_ccae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,IixA,iuvs,zvsyuw->IA', v_aaaa, t1_ccae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,IixA,iuvs,zvsywu->IA', v_aaaa, t1_ccae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,IixA,iuvw,zvuy->IA', v_aaaa, t1_ccae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,IixA,iuvy,zvwu->IA', v_aaaa, t1_ccae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,IixA,iuwv,zvyu->IA', v_aaaa, t1_ccae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,IixA,iuwy,zu->IA', v_aaaa, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xyzw,IixA,iuyv,zvwu->IA', v_aaaa, t1_ccae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,IixA,iuyw,zu->IA', v_aaaa, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,IixA,iw,zy->IA', v_aaaa, t1_ccae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += einsum('xyzw,IixA,iy,zw->IA', v_aaaa, t1_ccae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,IixA,izuv,ywuv->IA', v_aaaa, t1_ccae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,Iuvx,stuA,ztswvy->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iuvx,svtA,zustwy->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iuvx,svtA,zustyw->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iuvx,svtA,zuswty->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,Iuvx,svtA,zuswyt->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iuvx,svtA,zusytw->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iuvx,svtA,zusywt->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Iuvx,vA,zuwy->IA', v_aaaa, t1_caaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuvx,vstA,zustwy->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuvx,vstA,zustyw->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuvx,vstA,zuswty->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iuvx,vstA,zuswyt->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuvx,vstA,zusytw->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuvx,vstA,zusywt->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuxv,stuA,ztsvwy->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuxv,stuA,ztsvyw->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuxv,stuA,ztswvy->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iuxv,stuA,ztswyv->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuxv,stuA,ztsyvw->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuxv,stuA,ztsywv->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuxv,svtA,zustwy->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuxv,svtA,zustyw->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuxv,svtA,zuswty->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iuxv,svtA,zuswyt->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuxv,svtA,zusytw->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuxv,svtA,zusywt->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iuxv,vA,zuwy->IA', v_aaaa, t1_caaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iuxv,vstA,zuswty->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,Iuxz,vsuA,ywsv->IA', v_aaaa, t1_caaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Ixuv,sutA,zvtswy->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Ixuv,sutA,zvtsyw->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Ixuv,sutA,zvtwsy->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,Ixuv,sutA,zvtwys->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Ixuv,sutA,zvtysw->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Ixuv,sutA,zvtyws->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Ixuv,svtA,zutswy->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Ixuv,svtA,zutsyw->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Ixuv,svtA,zutwsy->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Ixuv,svtA,zutwys->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Ixuv,svtA,zutysw->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Ixuv,svtA,zutyws->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Ixuv,uA,zvwy->IA', v_aaaa, t1_caaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Ixuv,ustA,zvtswy->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Ixuv,ustA,zvtsyw->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Ixuv,ustA,zvtwsy->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Ixuv,ustA,zvtwys->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Ixuv,ustA,zvtysw->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Ixuv,ustA,zvtyws->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,Ixuv,uvsA,zswy->IA', v_aaaa, t1_caaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,Ixuv,vA,zuwy->IA', v_aaaa, t1_caaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,Ixuv,vstA,zutwsy->IA', v_aaaa, t1_caaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Ixuv,vusA,zswy->IA', v_aaaa, t1_caaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iIxA,iu,zuwy->IA', v_aaaa, t1_ccae, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iIxA,iuvs,zvsuwy->IA', v_aaaa, t1_ccae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iIxA,iuvs,zvsuyw->IA', v_aaaa, t1_ccae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iIxA,iuvs,zvswuy->IA', v_aaaa, t1_ccae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,iIxA,iuvs,zvswyu->IA', v_aaaa, t1_ccae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iIxA,iuvs,zvsyuw->IA', v_aaaa, t1_ccae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iIxA,iuvs,zvsywu->IA', v_aaaa, t1_ccae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += einsum('xyzw,iIxA,iuvw,zvuy->IA', v_aaaa, t1_ccae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,iIxA,iuvy,zvwu->IA', v_aaaa, t1_ccae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,iIxA,iuwv,zvyu->IA', v_aaaa, t1_ccae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,iIxA,iuwy,zu->IA', v_aaaa, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 2 * einsum('xyzw,iIxA,iuyv,zvwu->IA', v_aaaa, t1_ccae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 2 * einsum('xyzw,iIxA,iuyw,zu->IA', v_aaaa, t1_ccae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xyzw,iIxA,iw,zy->IA', v_aaaa, t1_ccae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 2 * einsum('xyzw,iIxA,iy,zw->IA', v_aaaa, t1_ccae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,iIxA,izuv,ywuv->IA', v_aaaa, t1_ccae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuvx,IisA,zusvwy->IA', v_aaaa, t1_caaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuvx,IisA,zusvyw->IA', v_aaaa, t1_caaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuvx,IisA,zuswvy->IA', v_aaaa, t1_caaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,IisA,zuswyv->IA', v_aaaa, t1_caaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuvx,IisA,zusyvw->IA', v_aaaa, t1_caaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuvx,IisA,zusywv->IA', v_aaaa, t1_caaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iuvx,IivA,zuwy->IA', v_aaaa, t1_caaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,iIsA,zusvwy->IA', v_aaaa, t1_caaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,iIsA,zusvyw->IA', v_aaaa, t1_caaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,iIsA,zuswvy->IA', v_aaaa, t1_caaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,iuvx,iIsA,zuswyv->IA', v_aaaa, t1_caaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,iIsA,zusyvw->IA', v_aaaa, t1_caaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,iIsA,zusywv->IA', v_aaaa, t1_caaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= einsum('xyzw,iuvx,iIvA,zuwy->IA', v_aaaa, t1_caaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iuxv,IisA,zuswvy->IA', v_aaaa, t1_caaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iuxv,IivA,zuwy->IA', v_aaaa, t1_caaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iuxv,iIsA,zuswvy->IA', v_aaaa, t1_caaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iuxv,iIvA,zuwy->IA', v_aaaa, t1_caaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iuxz,IivA,ywvu->IA', v_aaaa, t1_caaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iuxz,iIvA,ywvu->IA', v_aaaa, t1_caaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ix,IiuA,zuwy->IA', v_aaaa, t1_ca, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,ix,iIuA,zuwy->IA', v_aaaa, t1_ca, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,ixuv,IisA,zvuwys->IA', v_aaaa, t1_caaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,ixuv,IiuA,zvwy->IA', v_aaaa, t1_caaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,ixuv,IivA,zuwy->IA', v_aaaa, t1_caaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,ixuv,iIsA,zvuwys->IA', v_aaaa, t1_caaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += einsum('xyzw,ixuv,iIuA,zvwy->IA', v_aaaa, t1_caaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,ixuv,iIvA,zuwy->IA', v_aaaa, t1_caaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,uvxA,Istu,zvswty->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uvxA,Istv,zustwy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uvxA,Istv,zustyw->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uvxA,Istv,zuswty->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uvxA,Istv,zuswyt->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uvxA,Istv,zusytw->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uvxA,Istv,zusywt->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,uvxA,Istz,ywtsuv->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,uvxA,Istz,ywtsvu->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,uvxA,Istz,ywtusv->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,uvxA,Istz,ywtuvs->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,uvxA,Istz,ywtvsu->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,uvxA,Istz,ywtvus->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uvxA,Isut,zvstwy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uvxA,Isut,zvstyw->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uvxA,Isut,zvswty->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uvxA,Isut,zvswyt->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uvxA,Isut,zvsytw->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uvxA,Isut,zvsywt->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,uvxA,Isuv,zswy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,uvxA,Isuz,ywvs->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uvxA,Isvt,zustwy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uvxA,Isvt,zustyw->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uvxA,Isvt,zuswty->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,uvxA,Isvt,zuswyt->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uvxA,Isvt,zusytw->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uvxA,Isvt,zusywt->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,uvxA,Isvu,zswy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,uvxA,Isvz,ywus->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,uvxA,Iszt,ywtuvs->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,uvxA,Iszu,ywsv->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,uvxA,Iszv,ywus->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,uvxA,Iu,zvwy->IA', v_aaaa, t1_aaae, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,uvxA,Iv,zuwy->IA', v_aaaa, t1_aaae, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uvxA,Iwst,zvusty->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uvxA,Iwst,zvusyt->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,uvxA,Iwst,zvutsy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uvxA,Iwst,zvutys->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uvxA,Iwst,zvuyst->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uvxA,Iwst,zvuyts->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,uvxA,Iyst,zvuwst->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,uvxA,Iz,ywuv->IA', v_aaaa, t1_aaae, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,uxvA,Istu,zvtwsy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,uxvA,Istw,zvtsuy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uxvA,Istw,zvtsyu->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uxvA,Istw,zvtusy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uxvA,Istw,zvtuys->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uxvA,Istw,zvtysu->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uxvA,Istw,zvtyus->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,uxvA,Isty,zvtwus->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,uxvA,Isut,zvtswy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,uxvA,Isut,zvtsyw->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,uxvA,Isut,zvtwsy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,uxvA,Isut,zvtwys->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,uxvA,Isut,zvtysw->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,uxvA,Isut,zvtyws->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,uxvA,Isuw,zvsy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,uxvA,Isuy,zvws->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,uxvA,Iswt,zvtyus->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,uxvA,Iswu,zvys->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,uxvA,Iswy,zvsu->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,uxvA,Isyt,zvtwus->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += einsum('xyzw,uxvA,Isyu,zvws->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,uxvA,Isyw,zvsu->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,uxvA,Iu,zvwy->IA', v_aaaa, t1_aaae, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uxvA,Ivst,zstuwy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uxvA,Ivst,zstuyw->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uxvA,Ivst,zstwuy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uxvA,Ivst,zstwyu->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uxvA,Ivst,zstyuw->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uxvA,Ivst,zstywu->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,uxvA,Iw,zvyu->IA', v_aaaa, t1_aaae, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,uxvA,Iy,zvwu->IA', v_aaaa, t1_aaae, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,uxvA,Izst,ywustv->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,uxvA,Izst,ywusvt->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,uxvA,Izst,ywutsv->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,uxvA,Izst,ywutvs->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,uxvA,Izst,ywuvst->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,uxvA,Izst,ywuvts->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,uxvA,Izsu,ywsv->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,uxvA,Izus,ywvs->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,xA,Iuvw,zvuy->IA', v_aaaa, t1_ae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,xA,Iuvy,zvwu->IA', v_aaaa, t1_ae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,xA,Iuwv,zvyu->IA', v_aaaa, t1_ae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,xA,Iuwy,zu->IA', v_aaaa, t1_ae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xyzw,xA,Iuyv,zvwu->IA', v_aaaa, t1_ae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,xA,Iuyw,zu->IA', v_aaaa, t1_ae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,xA,Iw,zy->IA', v_aaaa, t1_ae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += einsum('xyzw,xA,Iy,zw->IA', v_aaaa, t1_ae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,xA,Izuv,ywuv->IA', v_aaaa, t1_ae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuvA,Istu,zvtswy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuvA,Istu,zvtsyw->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuvA,Istu,zvtwsy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xuvA,Istu,zvtwys->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuvA,Istu,zvtysw->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuvA,Istu,zvtyws->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,xuvA,Istw,zvtsyu->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,xuvA,Isty,zvtsuw->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,xuvA,Isty,zvtswu->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,xuvA,Isty,zvtusw->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,xuvA,Isty,zvtuws->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,xuvA,Isty,zvtwsu->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,xuvA,Isty,zvtwus->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xuvA,Isut,zvtswy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xuvA,Isut,zvtsyw->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xuvA,Isut,zvtwsy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,xuvA,Isut,zvtwys->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xuvA,Isut,zvtysw->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xuvA,Isut,zvtyws->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += einsum('xyzw,xuvA,Isuw,zvsy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,xuvA,Isuy,zvws->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,xuvA,Iswt,zvtsuy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,xuvA,Iswt,zvtsyu->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,xuvA,Iswt,zvtusy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,xuvA,Iswt,zvtuys->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,xuvA,Iswt,zvtysu->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,xuvA,Iswt,zvtyus->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,xuvA,Iswu,zvsy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,xuvA,Iswy,zvus->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,xuvA,Isyt,zvtwus->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,xuvA,Isyu,zvws->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,xuvA,Isyw,zvsu->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,xuvA,Iu,zvwy->IA', v_aaaa, t1_aaae, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,xuvA,Ivst,zstwuy->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,xuvA,Iw,zvuy->IA', v_aaaa, t1_aaae, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,xuvA,Iy,zvwu->IA', v_aaaa, t1_aaae, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,xuvA,Izst,ywuvts->IA', v_aaaa, t1_aaae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,xuvA,Izsu,ywvs->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,xuvA,Izus,ywvs->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,zxuA,Iuvs,ywvs->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,zxuA,Ivsw,yvsu->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,zxuA,Ivsy,wvus->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,zxuA,Ivws,yvus->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,zxuA,Ivwy,uv->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xyzw,zxuA,Ivys,wvus->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,zxuA,Ivyw,uv->IA', v_aaaa, t1_aaae, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,zxuA,Iw,yu->IA', v_aaaa, t1_aaae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += einsum('xyzw,zxuA,Iy,wu->IA', v_aaaa, t1_aaae, t1_ca, rdm_ca, optimize = einsum_type)

    chunks = tools.calculate_chunks(mr_adc, nextern, [ncore, ncore, nextern], ntensors = 2)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("t1.ccee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Molecular Orbitals Energies
        e_extern = mr_adc.mo_energy.e[s_chunk:f_chunk]

        ## Amplitudes
        t1_ccee = mr_adc.t1.ccee[:,:,s_chunk:f_chunk]

        temp =- einsum('A,IiAa,ia->IA', e_extern, t1_ccee, t1_ce, optimize = einsum_type)
        temp -= einsum('A,IiAa,ixay,yx->IA', e_extern, t1_ccee, t1_caea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,IiAa,ixya,yx->IA', e_extern, t1_ccee, t1_caae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,iIAa,ia->IA', e_extern, t1_ccee, t1_ce, optimize = einsum_type)
        temp += 1/2 * einsum('A,iIAa,ixay,yx->IA', e_extern, t1_ccee, t1_caea, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,iIAa,ixya,yx->IA', e_extern, t1_ccee, t1_caae, rdm_ca, optimize = einsum_type)

        ## Molecular Orbitals Energies
        e_extern = mr_adc.mo_energy.e

        temp -= 2 * einsum('a,ia,IiAa->IA', e_extern, t1_ce, t1_ccee, optimize = einsum_type)
        temp -= 2 * einsum('a,ixay,IiAa,yx->IA', e_extern, t1_caea, t1_ccee, rdm_ca, optimize = einsum_type)
        temp += einsum('a,ixya,IiAa,yx->IA', e_extern, t1_caae, t1_ccee, rdm_ca, optimize = einsum_type)
        temp += einsum('a,ia,iIAa->IA', e_extern, t1_ce, t1_ccee, optimize = einsum_type)
        temp += einsum('a,ixay,iIAa,yx->IA', e_extern, t1_caea, t1_ccee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,ixya,iIAa,yx->IA', e_extern, t1_caae, t1_ccee, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('ia,IiAa->IA', h_ce, t1_ccee, optimize = einsum_type)
        temp += einsum('ia,iIAa->IA', h_ce, t1_ccee, optimize = einsum_type)
        temp += einsum('I,IiAa,ia->IA', e_core, t1_ccee, t1_ce, optimize = einsum_type)
        temp -= 1/2 * einsum('I,iIAa,ia->IA', e_core, t1_ccee, t1_ce, optimize = einsum_type)
        temp += einsum('I,IiAa,ixay,yx->IA', e_core, t1_ccee, t1_caea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,iIAa,ixay,yx->IA', e_core, t1_ccee, t1_caea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('I,iIAa,ixya,yx->IA', e_core, t1_ccee, t1_caae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,IiAa,ixya,yx->IA', e_core, t1_ccee, t1_caae, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('IiAa,iaxy,yx->IA', t1_ccee, v_ceaa, rdm_ca, optimize = einsum_type)
        temp += einsum('IiAa,ixya,xy->IA', t1_ccee, v_caae, rdm_ca, optimize = einsum_type)
        temp += einsum('xy,ixaz,IiAa,yz->IA', h_aa, t1_caea, t1_ccee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,ixza,IiAa,yz->IA', h_aa, t1_caae, t1_ccee, rdm_ca, optimize = einsum_type)
        temp -= einsum('xy,izax,IiAa,yz->IA', h_aa, t1_caea, t1_ccee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,izxa,IiAa,yz->IA', h_aa, t1_caae, t1_ccee, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyzw,iuax,IiAa,zuwy->IA', v_aaaa, t1_caea, t1_ccee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iuxa,IiAa,zuwy->IA', v_aaaa, t1_caae, t1_ccee, rdm_ccaa, optimize = einsum_type)
        temp += einsum('xyzw,ixau,IiAa,zuwy->IA', v_aaaa, t1_caea, t1_ccee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,ixua,IiAa,zuwy->IA', v_aaaa, t1_caae, t1_ccee, rdm_ccaa, optimize = einsum_type)
        temp += einsum('iIAa,iaxy,yx->IA', t1_ccee, v_ceaa, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iIAa,ixya,xy->IA', t1_ccee, v_caae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,ixaz,iIAa,yz->IA', h_aa, t1_caea, t1_ccee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,ixza,iIAa,yz->IA', h_aa, t1_caae, t1_ccee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,izax,iIAa,yz->IA', h_aa, t1_caea, t1_ccee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,izxa,iIAa,yz->IA', h_aa, t1_caae, t1_ccee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,iuax,iIAa,zuwy->IA', v_aaaa, t1_caea, t1_ccee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,iuxa,iIAa,zuwy->IA', v_aaaa, t1_caae, t1_ccee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,ixau,iIAa,zuwy->IA', v_aaaa, t1_caea, t1_ccee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,ixua,iIAa,zuwy->IA', v_aaaa, t1_caae, t1_ccee, rdm_ccaa, optimize = einsum_type)
        temp += 2 * einsum('ijAa,iIja->IA', t1_ccee, v_ccce, optimize = einsum_type)
        temp -= einsum('ijAa,jIia->IA', t1_ccee, v_ccce, optimize = einsum_type)
        temp += einsum('i,IiAa,ia->IA', e_core, t1_ccee, t1_ce, optimize = einsum_type)
        temp += einsum('i,ia,IiAa->IA', e_core, t1_ce, t1_ccee, optimize = einsum_type)
        temp += einsum('i,IiAa,ixay,xy->IA', e_core, t1_ccee, t1_caea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,IiAa,ixya,xy->IA', e_core, t1_ccee, t1_caae, rdm_ca, optimize = einsum_type)
        temp += einsum('i,ixay,IiAa,xy->IA', e_core, t1_caea, t1_ccee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,ixya,IiAa,xy->IA', e_core, t1_caae, t1_ccee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIAa,ia->IA', e_core, t1_ccee, t1_ce, optimize = einsum_type)
        temp -= 1/2 * einsum('i,ia,iIAa->IA', e_core, t1_ce, t1_ccee, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iIAa,ixay,xy->IA', e_core, t1_ccee, t1_caea, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,iIAa,ixya,xy->IA', e_core, t1_ccee, t1_caae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,ixay,iIAa,xy->IA', e_core, t1_caea, t1_ccee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,ixya,iIAa,xy->IA', e_core, t1_caae, t1_ccee, rdm_ca, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting t1.ccee", *cput1)
    del(t1_ccee)

    chunks = tools.calculate_chunks(mr_adc, nextern, [ncore, ncas, nextern], ntensors = 2)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("t1.caee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Molecular Orbitals Energies
        e_extern = mr_adc.mo_energy.e[s_chunk:f_chunk]

        ## Amplitudes
        t1_caee = mr_adc.t1.caee[:,:,:,s_chunk:f_chunk]

        temp  = 1/4 * einsum('A,IxaA,ya,xy->IA', e_extern, t1_caee, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,IxaA,yzwa,xwzy->IA', e_extern, t1_caee, t1_aaae, rdm_ccaa, optimize = einsum_type)

        ## Molecular Orbitals Energies
        e_extern = mr_adc.mo_energy.e

        temp += 1/2 * einsum('a,xa,IyaA,xy->IA', e_extern, t1_ae, t1_caee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,xyza,IwaA,zwxy->IA', e_extern, t1_aaae, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixaA,iIya,xy->IA', t1_caee, v_ccae, rdm_ca, optimize = einsum_type)
        temp += einsum('ixaA,Iyai,xy->IA', t1_caee, v_caec, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xa,IyaA,xy->IA', h_ae, t1_caee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxaA,ya,xy->IA', e_core, t1_caee, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,IxaA,yzwa,xwzy->IA', e_core, t1_caee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IxaA,za,yz->IA', h_aa, t1_caee, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,IxaA,zwua,yuwz->IA', h_aa, t1_caee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,xa,IzaA,yz->IA', h_aa, t1_ae, t1_caee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,xzwa,IuaA,yzwu->IA', h_aa, t1_aaae, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,zwxa,IuaA,yuzw->IA', h_aa, t1_aaae, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxaA,ua,zuwy->IA', v_aaaa, t1_caee, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxaA,uvsa,zvuswy->IA', v_aaaa, t1_caee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxaA,uvsa,zvusyw->IA', v_aaaa, t1_caee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxaA,uvsa,zvuwsy->IA', v_aaaa, t1_caee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxaA,uvsa,zvuwys->IA', v_aaaa, t1_caee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxaA,uvsa,zvuysw->IA', v_aaaa, t1_caee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,IxaA,uvsa,zvuyws->IA', v_aaaa, t1_caee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,IxaA,uvza,ywvu->IA', v_aaaa, t1_caee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,uvxa,IsaA,zuvwys->IA', v_aaaa, t1_aaae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,uxva,IsaA,zvswuy->IA', v_aaaa, t1_aaae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,xa,IuaA,zuwy->IA', v_aaaa, t1_ae, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,xuva,IsaA,zvsuwy->IA', v_aaaa, t1_aaae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,xuva,IsaA,zvsuyw->IA', v_aaaa, t1_aaae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,xuva,IsaA,zvswuy->IA', v_aaaa, t1_aaae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,xuva,IsaA,zvswyu->IA', v_aaaa, t1_aaae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,xuva,IsaA,zvsyuw->IA', v_aaaa, t1_aaae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,xuva,IsaA,zvsywu->IA', v_aaaa, t1_aaae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,zxua,IvaA,ywvu->IA', v_aaaa, t1_aaae, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('IxaA,yzwa,xzwy->IA', t1_caee, v_aaae, rdm_ccaa, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting t1.caee", *cput1)
    del(t1_caee)

    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("t1.caee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Molecular Orbitals Energies
        e_extern = mr_adc.mo_energy.e[s_chunk:f_chunk]

        ## Amplitudes
        t1_caee = mr_adc.t1.caee[:,:,s_chunk:f_chunk]

        temp =- 1/2 * einsum('A,IxAa,ya,xy->IA', e_extern, t1_caee, t1_ae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,IxAa,yzwa,xwzy->IA', e_extern, t1_caee, t1_aaae, rdm_ccaa, optimize = einsum_type)

        ## Molecular Orbitals Energies
        e_extern = mr_adc.mo_energy.e

        temp -= einsum('a,xa,IyAa,xy->IA', e_extern, t1_ae, t1_caee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,xyza,IwAa,zwxy->IA', e_extern, t1_aaae, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('ixAa,Iyai,xy->IA', t1_caee, v_caec, rdm_ca, optimize = einsum_type)
        temp += einsum('ixAa,iIya,xy->IA', t1_caee, v_ccae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xa,IyAa,xy->IA', h_ae, t1_caee, rdm_ca, optimize = einsum_type)
        temp -= einsum('IxAa,yzwa,xzwy->IA', t1_caee, v_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('I,IxAa,ya,xy->IA', e_core, t1_caee, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('I,IxAa,yzwa,xwzy->IA', e_core, t1_caee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IxAa,za,yz->IA', h_aa, t1_caee, t1_ae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,IxAa,zwua,yuwz->IA', h_aa, t1_caee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,xa,IzAa,yz->IA', h_aa, t1_ae, t1_caee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,xzwa,IuAa,yzwu->IA', h_aa, t1_aaae, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,zwxa,IuAa,yuzw->IA', h_aa, t1_aaae, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,zxwa,IuAa,yzuw->IA', h_aa, t1_aaae, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxAa,ua,zuwy->IA', v_aaaa, t1_caee, t1_ae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxAa,uvsa,zvuswy->IA', v_aaaa, t1_caee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxAa,uvsa,zvusyw->IA', v_aaaa, t1_caee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxAa,uvsa,zvuwsy->IA', v_aaaa, t1_caee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,IxAa,uvsa,zvuwys->IA', v_aaaa, t1_caee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxAa,uvsa,zvuysw->IA', v_aaaa, t1_caee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,IxAa,uvsa,zvuyws->IA', v_aaaa, t1_caee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,IxAa,uvza,ywvu->IA', v_aaaa, t1_caee, t1_aaae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,uvxa,IsAa,zuvwys->IA', v_aaaa, t1_aaae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,uxva,IsAa,zvswuy->IA', v_aaaa, t1_aaae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,xa,IuAa,zuwy->IA', v_aaaa, t1_ae, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,xuva,IsAa,zvsuwy->IA', v_aaaa, t1_aaae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,xuva,IsAa,zvsuyw->IA', v_aaaa, t1_aaae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,xuva,IsAa,zvswuy->IA', v_aaaa, t1_aaae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,xuva,IsAa,zvswyu->IA', v_aaaa, t1_aaae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,xuva,IsAa,zvsyuw->IA', v_aaaa, t1_aaae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,xuva,IsAa,zvsywu->IA', v_aaaa, t1_aaae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,zxua,IvAa,ywvu->IA', v_aaaa, t1_aaae, t1_caee, rdm_ccaa, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting t1.caee", *cput1)
    del(t1_caee)

    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("t1.caee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Amplitudes
        t1_caee = mr_adc.t1.caee[:,:,:,s_chunk:f_chunk]

        temp =- 1/4 * einsum('xy,zxwa,IuaA,yzuw->IA', h_aa, t1_aaae, t1_caee, rdm_ccaa, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting t1.caee", *cput1)
    del(t1_caee)

    chunks = tools.calculate_chunks(mr_adc, nextern, [ncas, ncas, nextern], ntensors = 2)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("t1.aaee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Amplitudes
        t1_aaee = mr_adc.t1.aaee[:,:,s_chunk:f_chunk]

        temp  = 1/2 * einsum('xyAa,Izaw,xyzw->IA', t1_aaee, v_caea, rdm_ccaa, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting t1.aaee", *cput1)
    del(t1_aaee)

    chunks = tools.calculate_chunks(mr_adc, nextern, [ncore, ncore, nextern], ntensors = 2)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.ccee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_ccee = mr_adc.v2e.ccee[:,:,s_chunk:f_chunk]

        temp =- 1/2 * einsum('ixya,iIAa,xy->IA', t1_caae, v_ccee, rdm_ca, optimize = einsum_type)
        temp += einsum('ia,iIAa->IA', t1_ce, v_ccee, optimize = einsum_type)
        temp += einsum('ixay,iIAa,xy->IA', t1_caea, v_ccee, rdm_ca, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.ccee", *cput1)
    del(v_ccee)

    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.ceec [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_ceec = mr_adc.v2e.ceec[:,s_chunk:f_chunk]

        temp  = einsum('ixya,IAai,xy->IA', t1_caae, v_ceec, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('ia,IAai->IA', t1_ce, v_ceec, optimize = einsum_type)
        temp -= 2 * einsum('ixay,IAai,xy->IA', t1_caea, v_ceec, rdm_ca, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.ceec", *cput1)
    del(v_ceec)

    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.cece [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_cece = mr_adc.v2e.cece[:,s_chunk:f_chunk]

        temp =- 1/2 * einsum('ixya,iAIa,yx->IA', t1_caae, v_cece, rdm_ca, optimize = einsum_type)
        temp += einsum('ia,iAIa->IA', t1_ce, v_cece, optimize = einsum_type)
        temp += einsum('ixay,iAIa,yx->IA', t1_caea, v_cece, rdm_ca, optimize = einsum_type)
        temp += einsum('ixya,IAia,yx->IA', t1_caae, v_cece, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('ia,IAia->IA', t1_ce, v_cece, optimize = einsum_type)
        temp -= 2 * einsum('ixay,IAia,yx->IA', t1_caea, v_cece, rdm_ca, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.cece", *cput1)
    del(v_cece)

    chunks = tools.calculate_chunks(mr_adc, nextern, [ncas, ncas, nextern], ntensors = 2)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.aaee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_aaee = mr_adc.v2e.aaee[:,:,s_chunk:f_chunk]

        temp  = 1/2 * einsum('Ixya,zwAa,xwyz->IA', t1_caae, v_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Ixya,zyAa,xz->IA', t1_caae, v_aaee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixya,zwAa,zw,xy->IA', t1_caae, v_aaee, rdm_ca, rdm_ca, optimize = einsum_type)
        temp -= einsum('Ixay,zwAa,xwyz->IA', t1_caea, v_aaee, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('Ixay,zyAa,xz->IA', t1_caea, v_aaee, rdm_ca, optimize = einsum_type)
        temp += einsum('Ixay,zwAa,zw,xy->IA', t1_caea, v_aaee, rdm_ca, rdm_ca, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.aaee", *cput1)
    del(v_aaee)

    chunks = tools.calculate_chunks(mr_adc, nextern, [ncas, ncas, nextern], ntensors = 2)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.aeea [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_aeea = mr_adc.v2e.aeea[:,s_chunk:f_chunk]

        temp =- einsum('Ixya,yAaz,xz->IA', t1_caae, v_aeea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ixya,zAaw,xzwy->IA', t1_caae, v_aeea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('Ixya,zAaw,wz,xy->IA', t1_caae, v_aeea, rdm_ca, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ixay,yAaz,xz->IA', t1_caea, v_aeea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ixay,zAaw,xzyw->IA', t1_caea, v_aeea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('Ixay,zAaw,wz,xy->IA', t1_caea, v_aeea, rdm_ca, rdm_ca, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.aeea", *cput1)
    del(v_aeea)

    chunks = tools.calculate_chunks(mr_adc, nextern, [ncas, ncas, nextern], ntensors = 2)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.caee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_caee = mr_adc.v2e.caee[:,:,s_chunk:f_chunk]

        temp  = einsum('Iixa,ixAa->IA', t1_ccae, v_caee, optimize = einsum_type)
        temp -= 2 * einsum('iIxa,ixAa->IA', t1_ccae, v_caee, optimize = einsum_type)
        temp -= 1/2 * einsum('Iixa,iyAa,xy->IA', t1_ccae, v_caee, rdm_ca, optimize = einsum_type)
        temp += einsum('iIxa,iyAa,xy->IA', t1_ccae, v_caee, rdm_ca, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.caee", *cput1)
    del(v_caee)

    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.caee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_caee = mr_adc.v2e.caee[:,:,:,s_chunk:f_chunk]

        temp  = 1/2 * einsum('xa,IyaA,xy->IA', t1_ae, v_caee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyza,IwaA,zwxy->IA', t1_aaae, v_caee, rdm_ccaa, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.caee", *cput1)
    del(v_caee)

    chunks = tools.calculate_chunks(mr_adc, nextern, [ncas, ncas, nextern], ntensors = 2)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.ceae [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_ceae = mr_adc.v2e.ceae[:,s_chunk:f_chunk]

        temp =- einsum('xa,IAya,xy->IA', t1_ae, v_ceae, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyza,IAwa,zwxy->IA', t1_aaae, v_ceae, rdm_ccaa, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.ceae", *cput1)
    del(v_ceae)

    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.ceae [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_ceae = mr_adc.v2e.ceae[:,:,:,s_chunk:f_chunk]

        temp  = 1/2 * einsum('xa,IayA,xy->IA', t1_ae, v_ceae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyza,IawA,zwxy->IA', t1_aaae, v_ceae, rdm_ccaa, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.ceae", *cput1)
    del(v_ceae)

    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.ceea [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_ceea = mr_adc.v2e.ceea[:,:,s_chunk:f_chunk]

        temp =- 2 * einsum('Iixa,iaAx->IA', t1_ccae, v_ceea, optimize = einsum_type)
        temp += einsum('iIxa,iaAx->IA', t1_ccae, v_ceea, optimize = einsum_type)
        temp += einsum('Iixa,iaAy,xy->IA', t1_ccae, v_ceea, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('iIxa,iaAy,xy->IA', t1_ccae, v_ceea, rdm_ca, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.ceea", *cput1)
    del(v_ceea)

    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.ceea [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_ceea = mr_adc.v2e.ceea[:,s_chunk:f_chunk]

        temp =- einsum('xa,IAay,xy->IA', t1_ae, v_ceea, rdm_ca, optimize = einsum_type)
        temp -= einsum('xyza,IAaw,zwxy->IA', t1_aaae, v_ceea, rdm_ccaa, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.ceea", *cput1)
    del(v_ceea)

    ## Amplitudes
    t1_ccee = mr_adc.t1.ccee
    t1_caee = mr_adc.t1.caee

    chunks = tools.calculate_chunks(mr_adc, nextern, [ncore, nextern, nextern], ntensors = 2)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.ceee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integral
        v_ceee = mr_adc.v2e.ceee[:, :, s_chunk:f_chunk]

        temp = einsum('Iiab,iaAb->IA', t1_ccee, v_ceee, optimize = einsum_type)
        temp -= 2 * einsum('Iiab,ibAa->IA', t1_ccee, v_ceee, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.ceee", *cput1)
    del(v_ceee)

    chunks = tools.calculate_chunks(mr_adc, nextern, [ncas, nextern, nextern], ntensors = 2)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.aeee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)
        
        ## Two-electron integral
        v_aeee = mr_adc.v2e.aeee[:, :, s_chunk:f_chunk]

        temp  = 1/2 * einsum('Ixab,yaAb,xy->IA', t1_caee, v_aeee, rdm_ca, optimize = einsum_type)
        temp -= einsum('Ixab,ybAa,xy->IA', t1_caee, v_aeee, rdm_ca, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.aeee", *cput1)
    del(v_aeee)

    if mr_adc.method_type == "cvs-ip":
        del mr_adc.v2e.ceee
        del mr_adc.v2e.aeee

    ## Molecular Orbitals Energies
    e_core = mr_adc.mo_energy.c

    ## Compute denominators
    d_ai = (e_extern[:,None] - e_core)
    d_ai = d_ai**(-1)

    # Compute T2[0'] t2_ce amplitudes
    t2_ce = einsum("ai,ia->ia", d_ai, V1, optimize = einsum_type)

    mr_adc.log.extra("Norm of T[0']^(2):                          %20.12f" % np.linalg.norm(t2_ce))
    mr_adc.log.timer("computing T[0']^(2) amplitudes", *cput0)

    return t2_ce

##TODO: chunking for t1_aaee post 4RDM intermediates
def compute_t2_m1p_singles(mr_adc):

    cput0 = (logger.process_clock(), logger.perf_counter())
    mr_adc.log.extra("\nComputing T[-1']^(2) amplitudes...")

    # Import Prism interface
    interface = mr_adc.interface

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    ncore = mr_adc.ncore
    ncas = mr_adc.ncas
    nextern = mr_adc.nextern

    ## Molecular Orbitals Energies
    e_core = mr_adc.mo_energy.c
    e_extern = mr_adc.mo_energy.e

    ## One-electron integrals
    h_ce = mr_adc.h1eff.ce
    h_ca = mr_adc.h1eff.ca
    h_ae = mr_adc.h1eff.ae
    h_aa = mr_adc.h1eff.aa

    ## Two-electron integrals
    v_aaaa = mr_adc.v2e.aaaa

    v_caca = mr_adc.v2e.caca
    
    v_cace = mr_adc.v2e.cace
    
    v_caaa = mr_adc.v2e.caaa
    v_caae = mr_adc.v2e.caae
    v_ceaa = mr_adc.v2e.ceaa
    
    v_caea = mr_adc.v2e.caea
    
    v_aaae = mr_adc.v2e.aaae

    ## Amplitudes
    t1_ce = mr_adc.t1.ce
    t1_caea = mr_adc.t1.caea
    t1_caae = mr_adc.t1.caae

    t1_ca = mr_adc.t1.ca
    t1_caaa = mr_adc.t1.caaa

    t1_ae   = mr_adc.t1.ae
    t1_aaae = mr_adc.t1.aaae
    t1_aaee = mr_adc.t1.aaee

    t1_ccae = mr_adc.t1.ccae
    t1_ccaa = mr_adc.t1.ccaa

    ## Reduced density matrices
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa
    rdm_cccaaa = mr_adc.rdm.cccaaa
    rdm_ccccaaaa = mr_adc.rdm.ccccaaaa

    # Compute K_ca matrix
    K_ca = mr_adc_intermediates.compute_K_ca(mr_adc)
    
    # Compute S^{-1/2} matrix: Orthogonalization and overlap truncation only in the active space
    S_m1_12_inv_act = mr_adc_overlap.compute_S12_m1(mr_adc)

    # Compute K^{-1} matrix
    SKS = reduce(np.dot, (S_m1_12_inv_act.T, K_ca, S_m1_12_inv_act))
    evals, evecs = np.linalg.eigh(SKS)
    del(SKS)

    # Compute R.H.S. of the equation
    # V1 block: - 1/2 < Psi_0 | a^{\dag}_X a_A [V + H^{(1)}, T - T^\dag] | Psi_0 >
    V1  = 1/2 * einsum('iA,ix,Xx->XA', h_ce, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('iA,ixyz,Xxyz->XA', h_ce, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('ix,iA,Xx->XA', h_ca, t1_ce, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('ix,iyAx,Xy->XA', h_ca, t1_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('ix,iyAz,Xzxy->XA', h_ca, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('ix,iyxA,Xy->XA', h_ca, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('ix,iyzA,Xzyx->XA', h_ca, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xa,yzAa,Xxyz->XA', h_ae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('iA,ixyz,Xyxz->XA', t1_ce, v_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('ijxA,ixjy,Xy->XA', t1_ccae, v_caca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ijxA,jxiy,Xy->XA', t1_ccae, v_caca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ijxA,jyiz,Xxyz->XA', t1_ccae, v_caca, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('ijxy,ixjA,Xy->XA', t1_ccaa, v_cace, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ijxy,jxiA,Xy->XA', t1_ccaa, v_cace, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ijxy,jziA,Xzxy->XA', t1_ccaa, v_cace, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('ix,iAyx,Xy->XA', t1_ca, v_ceaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('ix,iAyz,Xzxy->XA', t1_ca, v_ceaa, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('ix,ixAy,Xy->XA', t1_ca, v_caea, rdm_ca, optimize = einsum_type)
    V1 -= einsum('ix,ixyA,Xy->XA', t1_ca, v_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('ix,iyAx,Xy->XA', t1_ca, v_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('ix,iyAz,Xxzy->XA', t1_ca, v_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('ix,iyzA,Xyzx->XA', t1_ca, v_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('ixAy,iyzw,Xzxw->XA', t1_caea, v_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('ixAy,izwu,Xywuxz->XA', t1_caea, v_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('ixAy,izwu,Xywuzx->XA', t1_caea, v_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('ixAy,izwu,Xywxuz->XA', t1_caea, v_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('ixAy,izwu,Xywxzu->XA', t1_caea, v_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('ixAy,izwu,Xywzux->XA', t1_caea, v_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('ixAy,izwu,Xywzxu->XA', t1_caea, v_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('ixAy,izwy,Xwzx->XA', t1_caea, v_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('ixyA,iyzw,Xzxw->XA', t1_caae, v_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('ixyA,izwu,Xywxzu->XA', t1_caae, v_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('ixyA,izwy,Xwxz->XA', t1_caae, v_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('ixyz,iAwu,Xxuyzw->XA', t1_caaa, v_ceaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('ixyz,iAwy,Xxwz->XA', t1_caaa, v_ceaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('ixyz,iAwz,Xxyw->XA', t1_caaa, v_ceaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/3 * einsum('ixyz,iwAu,Xyzuwx->XA', t1_caaa, v_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('ixyz,iwAu,Xyzuxw->XA', t1_caaa, v_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('ixyz,iwAu,Xyzwux->XA', t1_caaa, v_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('ixyz,iwAu,Xyzwxu->XA', t1_caaa, v_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('ixyz,iwAu,Xyzxuw->XA', t1_caaa, v_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('ixyz,iwAu,Xyzxwu->XA', t1_caaa, v_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('ixyz,iwAy,Xzwx->XA', t1_caaa, v_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('ixyz,iwAz,Xyxw->XA', t1_caaa, v_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('ixyz,iwuA,Xxwuyz->XA', t1_caaa, v_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('ixyz,iwuA,Xxwuzy->XA', t1_caaa, v_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('ixyz,iwuA,Xxwyuz->XA', t1_caaa, v_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('ixyz,iwuA,Xxwyzu->XA', t1_caaa, v_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('ixyz,iwuA,Xxwzuy->XA', t1_caaa, v_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('ixyz,iwuA,Xxwzyu->XA', t1_caaa, v_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= einsum('ixyz,iyAw,Xzwx->XA', t1_caaa, v_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('ixyz,iyAz,Xx->XA', t1_caaa, v_caea, rdm_ca, optimize = einsum_type)
    V1 -= einsum('ixyz,iywA,Xxwz->XA', t1_caaa, v_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('ixyz,izAw,Xywx->XA', t1_caaa, v_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('ixyz,izAy,Xx->XA', t1_caaa, v_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('ixyz,izwA,Xxwy->XA', t1_caaa, v_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyAa,zwua,Xuzxyw->XA', t1_aaee, v_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('A,iA,ix,Xx->XA', e_extern, t1_ce, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('A,iA,ixyz,Xxyz->XA', e_extern, t1_ce, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('A,ijxA,ijxy,Xy->XA', e_extern, t1_ccae, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('A,ijxA,jixy,Xy->XA', e_extern, t1_ccae, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('A,ijxA,jiyz,Xxyz->XA', e_extern, t1_ccae, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('A,ixAy,iy,Xx->XA', e_extern, t1_caea, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('A,ixAy,iz,Xyzx->XA', e_extern, t1_caea, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('A,ixAy,izwu,Xyzuwx->XA', e_extern, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('A,ixAy,izwu,Xyzuxw->XA', e_extern, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('A,ixAy,izwu,Xyzwux->XA', e_extern, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('A,ixAy,izwu,Xyzwxu->XA', e_extern, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('A,ixAy,izwu,Xyzxuw->XA', e_extern, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('A,ixAy,izwu,Xyzxwu->XA', e_extern, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('A,ixAy,izwy,Xzwx->XA', e_extern, t1_caea, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('A,ixAy,izyw,Xzxw->XA', e_extern, t1_caea, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('A,ixyA,iy,Xx->XA', e_extern, t1_caae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('A,ixyA,iz,Xyxz->XA', e_extern, t1_caae, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('A,ixyA,izwu,Xyzxwu->XA', e_extern, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('A,ixyA,izwy,Xzxw->XA', e_extern, t1_caae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('A,ixyA,izyw,Xzxw->XA', e_extern, t1_caae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('A,xyAa,za,Xzxy->XA', e_extern, t1_aaee, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('A,xyAa,zwua,Xwzuxy->XA', e_extern, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('A,xyAa,zwua,Xwzuyx->XA', e_extern, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('A,xyAa,zwua,Xwzxuy->XA', e_extern, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('A,xyAa,zwua,Xwzxyu->XA', e_extern, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('A,xyAa,zwua,Xwzyux->XA', e_extern, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('A,xyAa,zwua,Xwzyxu->XA', e_extern, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('a,xa,yzAa,Xxyz->XA', e_extern, t1_ae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('a,xyza,wuAa,Xyxuwz->XA', e_extern, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('a,xyza,wuAa,Xyxuzw->XA', e_extern, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 -= 5/12 * einsum('a,xyza,wuAa,Xyxwuz->XA', e_extern, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('a,xyza,wuAa,Xyxwzu->XA', e_extern, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('a,xyza,wuAa,Xyxzuw->XA', e_extern, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('a,xyza,wuAa,Xyxzwu->XA', e_extern, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,iA,ix,Xx->XA', e_core, t1_ce, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,iA,ixyz,Xxyz->XA', e_core, t1_ce, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ijxA,ijxy,Xy->XA', e_core, t1_ccae, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ijxA,ijyx,Xy->XA', e_core, t1_ccae, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ijxA,ijyz,Xxzy->XA', e_core, t1_ccae, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ijxy,ijxA,Xy->XA', e_core, t1_ccaa, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ijxy,ijyA,Xx->XA', e_core, t1_ccaa, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ijxy,ijzA,Xzyx->XA', e_core, t1_ccaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ijxy,jixA,Xy->XA', e_core, t1_ccaa, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ijxy,jiyA,Xx->XA', e_core, t1_ccaa, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ijxy,jizA,Xzxy->XA', e_core, t1_ccaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('i,ix,iyAx,Xy->XA', e_core, t1_ca, t1_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('i,ix,iyxA,Xy->XA', e_core, t1_ca, t1_caae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('i,ixAy,ixzw,Xyzw->XA', e_core, t1_caea, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('i,ixAy,iy,Xx->XA', e_core, t1_caea, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ixAy,iz,Xyzx->XA', e_core, t1_caea, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/6 * einsum('i,ixAy,izwu,Xyzuwx->XA', e_core, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('i,ixAy,izwu,Xyzuxw->XA', e_core, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('i,ixAy,izwu,Xyzwux->XA', e_core, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('i,ixAy,izwu,Xyzwxu->XA', e_core, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('i,ixAy,izwu,Xyzxuw->XA', e_core, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('i,ixAy,izwu,Xyzxwu->XA', e_core, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('i,ixAy,izwy,Xzwx->XA', e_core, t1_caea, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('i,ixAy,izyw,Xzxw->XA', e_core, t1_caea, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('i,ixyA,ixzw,Xywz->XA', e_core, t1_caae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('i,ixyA,iy,Xx->XA', e_core, t1_caae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ixyA,iz,Xyxz->XA', e_core, t1_caae, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ixyA,izwu,Xyzxwu->XA', e_core, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('i,ixyA,izwy,Xzxw->XA', e_core, t1_caae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('i,ixyA,izyw,Xzxw->XA', e_core, t1_caae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('i,ixyz,iwAy,Xxwz->XA', e_core, t1_caaa, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('i,ixyz,iwAz,Xxyw->XA', e_core, t1_caaa, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('i,ixyz,iwyA,Xxwz->XA', e_core, t1_caaa, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('i,ixyz,iwzA,Xxwy->XA', e_core, t1_caaa, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ixyz,ixAw,Xwyz->XA', e_core, t1_caaa, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ixyz,ixwA,Xwzy->XA', e_core, t1_caaa, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('i,jixA,ijxy,Xy->XA', e_core, t1_ccae, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,jixA,ijyx,Xy->XA', e_core, t1_ccae, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,jixA,ijyz,Xxyz->XA', e_core, t1_ccae, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xy,ijxA,ijyz,Xz->XA', h_aa, t1_ccae, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,ijxA,jiyz,Xz->XA', h_aa, t1_ccae, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,ijxA,jizw,Xyzw->XA', h_aa, t1_ccae, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,ijxz,ijwA,Xwzy->XA', h_aa, t1_ccaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,ijxz,ijzA,Xy->XA', h_aa, t1_ccaa, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,ijxz,jiwA,Xwyz->XA', h_aa, t1_ccaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,ijxz,jizA,Xy->XA', h_aa, t1_ccaa, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,ix,iA,Xy->XA', h_aa, t1_ca, t1_ce, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,ix,izAw,Xwyz->XA', h_aa, t1_ca, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,ix,izwA,Xwzy->XA', h_aa, t1_ca, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,ixAz,iw,Xzwy->XA', h_aa, t1_caea, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,ixAz,iwuv,Xzwuvy->XA', h_aa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xy,ixAz,iwuv,Xzwuyv->XA', h_aa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,ixAz,iwuv,Xzwvuy->XA', h_aa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,ixAz,iwuv,Xzwvyu->XA', h_aa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,ixAz,iwuv,Xzwyuv->XA', h_aa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,ixAz,iwuv,Xzwyvu->XA', h_aa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,ixAz,iwuz,Xwuy->XA', h_aa, t1_caea, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,ixAz,iwzu,Xwyu->XA', h_aa, t1_caea, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,ixAz,iz,Xy->XA', h_aa, t1_caea, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,ixzA,iw,Xzyw->XA', h_aa, t1_caae, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,ixzA,iwuv,Xzwyuv->XA', h_aa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,ixzA,iwuz,Xwyu->XA', h_aa, t1_caae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,ixzA,iwzu,Xwyu->XA', h_aa, t1_caae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,ixzA,iz,Xy->XA', h_aa, t1_caae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,ixzw,iA,Xyzw->XA', h_aa, t1_caaa, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,ixzw,iuAv,Xyvzwu->XA', h_aa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,ixzw,iuAw,Xyzu->XA', h_aa, t1_caaa, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,ixzw,iuAz,Xyuw->XA', h_aa, t1_caaa, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xy,ixzw,iuvA,Xyvuwz->XA', h_aa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,ixzw,iuvA,Xyvuzw->XA', h_aa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,ixzw,iuvA,Xyvwuz->XA', h_aa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,ixzw,iuvA,Xyvwzu->XA', h_aa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,ixzw,iuvA,Xyvzuw->XA', h_aa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,ixzw,iuvA,Xyvzwu->XA', h_aa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,ixzw,iuwA,Xyuz->XA', h_aa, t1_caaa, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,ixzw,iuzA,Xyuw->XA', h_aa, t1_caaa, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,izAx,iw,Xywz->XA', h_aa, t1_caea, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,izAx,iwuv,Xywuvz->XA', h_aa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xy,izAx,iwuv,Xywuzv->XA', h_aa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,izAx,iwuv,Xywvuz->XA', h_aa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,izAx,iwuv,Xywvzu->XA', h_aa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,izAx,iwuv,Xywzuv->XA', h_aa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,izAx,iwuv,Xywzvu->XA', h_aa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,izAx,iwuy,Xwuz->XA', h_aa, t1_caea, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,izAx,iwyu,Xwzu->XA', h_aa, t1_caea, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,izAx,iy,Xz->XA', h_aa, t1_caea, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,izwx,iA,Xzwy->XA', h_aa, t1_caaa, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,izwx,iuAv,Xzvuwy->XA', h_aa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,izwx,iuAv,Xzvuyw->XA', h_aa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,izwx,iuAv,Xzvwuy->XA', h_aa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xy,izwx,iuAv,Xzvwyu->XA', h_aa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,izwx,iuAv,Xzvyuw->XA', h_aa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,izwx,iuAv,Xzvywu->XA', h_aa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,izwx,iuAw,Xzuy->XA', h_aa, t1_caaa, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,izwx,iuvA,Xzvuyw->XA', h_aa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,izwx,iuwA,Xzuy->XA', h_aa, t1_caaa, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,izxA,iw,Xyzw->XA', h_aa, t1_caae, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,izxA,iwuv,Xywzuv->XA', h_aa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,izxA,iwuy,Xwzu->XA', h_aa, t1_caae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('xy,izxA,iwyu,Xwzu->XA', h_aa, t1_caae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('xy,izxA,iy,Xz->XA', h_aa, t1_caae, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,izxw,iA,Xzyw->XA', h_aa, t1_caaa, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,izxw,iuAv,Xzvywu->XA', h_aa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,izxw,iuAw,Xzyu->XA', h_aa, t1_caaa, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xy,izxw,iuvA,Xzvuwy->XA', h_aa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,izxw,iuvA,Xzvuyw->XA', h_aa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,izxw,iuvA,Xzvwuy->XA', h_aa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,izxw,iuvA,Xzvwyu->XA', h_aa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,izxw,iuvA,Xzvyuw->XA', h_aa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,izxw,iuvA,Xzvywu->XA', h_aa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,izxw,iuwA,Xzuy->XA', h_aa, t1_caaa, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,xa,zwAa,Xyzw->XA', h_aa, t1_ae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,xzAa,wa,Xwyz->XA', h_aa, t1_aaee, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,xzAa,wuva,Xuwyzv->XA', h_aa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,xzwa,uvAa,Xyzuvw->XA', h_aa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xy,xzwa,uvAa,Xyzuwv->XA', h_aa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,xzwa,uvAa,Xyzvuw->XA', h_aa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,xzwa,uvAa,Xyzvwu->XA', h_aa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,xzwa,uvAa,Xyzwuv->XA', h_aa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,xzwa,uvAa,Xyzwvu->XA', h_aa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,zwxa,uvAa,Xzwuyv->XA', h_aa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,zxAa,wa,Xwzy->XA', h_aa, t1_aaee, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,zxAa,wuva,Xuwvyz->XA', h_aa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,zxAa,wuva,Xuwvzy->XA', h_aa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,zxAa,wuva,Xuwyvz->XA', h_aa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,zxAa,wuva,Xuwyzv->XA', h_aa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,zxAa,wuva,Xuwzvy->XA', h_aa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xy,zxAa,wuva,Xuwzyv->XA', h_aa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,zxwa,uvAa,Xyzuvw->XA', h_aa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,ijxA,ijwu,Xyuz->XA', v_aaaa, t1_ccae, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,ijxA,ijyu,Xwuz->XA', v_aaaa, t1_ccae, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,ijxA,ijyw,Xz->XA', v_aaaa, t1_ccae, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ijxA,jiuv,Xywuvz->XA', v_aaaa, t1_ccae, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,ijxA,jiwu,Xyzu->XA', v_aaaa, t1_ccae, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,ijxA,jiyu,Xwuz->XA', v_aaaa, t1_ccae, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,ijxA,jiyw,Xz->XA', v_aaaa, t1_ccae, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ijxu,ijuA,Xzyw->XA', v_aaaa, t1_ccaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,ijxu,ijvA,Xzvuwy->XA', v_aaaa, t1_ccaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ijxu,ijvA,Xzvuyw->XA', v_aaaa, t1_ccaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ijxu,ijvA,Xzvwuy->XA', v_aaaa, t1_ccaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ijxu,ijvA,Xzvwyu->XA', v_aaaa, t1_ccaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ijxu,ijvA,Xzvyuw->XA', v_aaaa, t1_ccaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ijxu,ijvA,Xzvywu->XA', v_aaaa, t1_ccaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,ijxu,jiuA,Xzyw->XA', v_aaaa, t1_ccaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ijxu,jivA,Xzvywu->XA', v_aaaa, t1_ccaa, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ijxz,jiuA,Xuyw->XA', v_aaaa, t1_ccaa, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuAx,iv,Xywuvz->XA', v_aaaa, t1_caea, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuAx,iv,Xywuzv->XA', v_aaaa, t1_caea, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,iuAx,iv,Xywvuz->XA', v_aaaa, t1_caea, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuAx,iv,Xywvzu->XA', v_aaaa, t1_caea, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuAx,iv,Xywzuv->XA', v_aaaa, t1_caea, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuAx,iv,Xywzvu->XA', v_aaaa, t1_caea, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/24 * einsum('xyzw,iuAx,ivst,Xywvstzu->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuAx,ivst,Xywvsuzt->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/24 * einsum('xyzw,iuAx,ivst,Xywvsztu->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuAx,ivst,Xywvszut->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/24 * einsum('xyzw,iuAx,ivst,Xywvtszu->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/24 * einsum('xyzw,iuAx,ivst,Xywvtuzs->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/24 * einsum('xyzw,iuAx,ivst,Xywvtzsu->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/24 * einsum('xyzw,iuAx,ivst,Xywvtzus->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/48 * einsum('xyzw,iuAx,ivst,Xywvustz->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/48 * einsum('xyzw,iuAx,ivst,Xywvuszt->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/48 * einsum('xyzw,iuAx,ivst,Xywvutsz->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/48 * einsum('xyzw,iuAx,ivst,Xywvutzs->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,iuAx,ivst,Xywvuzst->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,iuAx,ivst,Xywvuzts->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,iuAx,ivst,Xywvzstu->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,iuAx,ivst,Xywvzsut->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,iuAx,ivst,Xywvztsu->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,iuAx,ivst,Xywvztus->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,iuAx,ivst,Xywvzust->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,iuAx,ivst,Xywvzuts->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,iuAx,ivsw,Xyvsuz->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuAx,ivsw,Xyvszu->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuAx,ivsw,Xyvusz->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuAx,ivsw,Xyvuzs->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuAx,ivsw,Xyvzsu->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuAx,ivsw,Xyvzus->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iuAx,ivsy,Xwvszu->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iuAx,ivws,Xyvzus->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iuAx,ivwy,Xvzu->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuAx,ivys,Xwvsuz->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuAx,ivys,Xwvszu->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuAx,ivys,Xwvusz->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,iuAx,ivys,Xwvuzs->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuAx,ivys,Xwvzsu->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuAx,ivys,Xwvzus->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iuAx,ivyw,Xvuz->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iuAx,iw,Xyzu->XA', v_aaaa, t1_caea, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iuAx,iy,Xwuz->XA', v_aaaa, t1_caea, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iuAx,izvs,Xywvus->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,iuvx,iA,Xzuvwy->XA', v_aaaa, t1_caaa, t1_ce, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuvx,iA,Xzuvyw->XA', v_aaaa, t1_caaa, t1_ce, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuvx,iA,Xzuwvy->XA', v_aaaa, t1_caaa, t1_ce, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuvx,iA,Xzuwyv->XA', v_aaaa, t1_caaa, t1_ce, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuvx,iA,Xzuyvw->XA', v_aaaa, t1_caaa, t1_ce, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuvx,iA,Xzuywv->XA', v_aaaa, t1_caaa, t1_ce, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,iuvx,isAt,Xzutvwys->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,iuvx,isAt,Xzutvyws->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/24 * einsum('xyzw,iuvx,isAt,Xzutwsvy->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/24 * einsum('xyzw,iuvx,isAt,Xzutwsyv->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/24 * einsum('xyzw,iuvx,isAt,Xzutwvsy->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,isAt,Xzutwvys->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/24 * einsum('xyzw,iuvx,isAt,Xzutwysv->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,isAt,Xzutwyvs->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,iuvx,isAt,Xzutysvw->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,iuvx,isAt,Xzutyswv->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,iuvx,isAt,Xzutyvsw->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,iuvx,isAt,Xzutywsv->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,iuvx,isAv,Xzuswy->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuvx,isAv,Xzusyw->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuvx,isAv,Xzuwsy->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuvx,isAv,Xzuwys->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuvx,isAv,Xzuysw->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuvx,isAv,Xzuyws->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,iuvx,istA,Xzutswvy->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,iuvx,istA,Xzutsyvw->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,iuvx,istA,Xzutvwsy->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,iuvx,istA,Xzutvwys->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,iuvx,istA,Xzutvysw->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,iuvx,istA,Xzutvyws->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,iuvx,istA,Xzutwsyv->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,iuvx,istA,Xzutwyvs->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,iuvx,istA,Xzutyswv->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iuvx,istA,Xzutywsv->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,iuvx,istA,Xzutywvs->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,iuvx,isvA,Xzuswy->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,iuvx,isvA,Xzusyw->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,iuvx,isvA,Xzuwsy->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,iuvx,isvA,Xzuwys->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,iuvx,isvA,Xzuysw->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,iuvx,isvA,Xzuyws->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,iuxA,iv,Xywuvz->XA', v_aaaa, t1_caae, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/60 * einsum('xyzw,iuxA,ivst,Xywvstzu->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/240 * einsum('xyzw,iuxA,ivst,Xywvsuzt->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/60 * einsum('xyzw,iuxA,ivst,Xywvsztu->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/240 * einsum('xyzw,iuxA,ivst,Xywvszut->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/60 * einsum('xyzw,iuxA,ivst,Xywvtszu->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/80 * einsum('xyzw,iuxA,ivst,Xywvtuzs->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/60 * einsum('xyzw,iuxA,ivst,Xywvtzsu->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/80 * einsum('xyzw,iuxA,ivst,Xywvtzus->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/240 * einsum('xyzw,iuxA,ivst,Xywvustz->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 13/60 * einsum('xyzw,iuxA,ivst,Xywvuszt->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/240 * einsum('xyzw,iuxA,ivst,Xywvutsz->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/120 * einsum('xyzw,iuxA,ivst,Xywvutzs->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/30 * einsum('xyzw,iuxA,ivst,Xywvuzst->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/120 * einsum('xyzw,iuxA,ivst,Xywvuzts->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/120 * einsum('xyzw,iuxA,ivst,Xywvzstu->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/80 * einsum('xyzw,iuxA,ivst,Xywvzsut->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/120 * einsum('xyzw,iuxA,ivst,Xywvztsu->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 13/240 * einsum('xyzw,iuxA,ivst,Xywvztus->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/80 * einsum('xyzw,iuxA,ivst,Xywvzust->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 13/240 * einsum('xyzw,iuxA,ivst,Xywvzuts->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iuxA,ivsw,Xyvusz->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuxA,ivsy,Xwvsuz->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuxA,ivsy,Xwvszu->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuxA,ivsy,Xwvusz->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,iuxA,ivsy,Xwvuzs->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuxA,ivsy,Xwvzsu->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuxA,ivsy,Xwvzus->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuxA,ivws,Xyvsuz->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuxA,ivws,Xyvszu->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuxA,ivws,Xyvusz->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,iuxA,ivws,Xyvuzs->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuxA,ivws,Xyvzsu->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuxA,ivws,Xyvzus->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iuxA,ivwy,Xvuz->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,iuxA,ivys,Xwvsuz->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,iuxA,ivys,Xwvszu->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,iuxA,ivys,Xwvusz->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 2/3 * einsum('xyzw,iuxA,ivys,Xwvuzs->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,iuxA,ivys,Xwvzsu->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,iuxA,ivys,Xwvzus->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= einsum('xyzw,iuxA,ivyw,Xvuz->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iuxA,iw,Xyuz->XA', v_aaaa, t1_caae, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('xyzw,iuxA,iy,Xwuz->XA', v_aaaa, t1_caae, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxA,izvs,Xywsuv->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxA,izvs,Xywsvu->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxA,izvs,Xywusv->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuxA,izvs,Xywuvs->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxA,izvs,Xywvsu->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxA,izvs,Xywvus->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,iuxv,iA,Xzuywv->XA', v_aaaa, t1_caaa, t1_ce, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,iuxv,isAt,Xzutywvs->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,iuxv,isAv,Xzuyws->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,iuxv,istA,Xzutswvy->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,iuxv,istA,Xzutsyvw->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,iuxv,istA,Xzutwsvy->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,iuxv,istA,Xzutwyvs->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,iuxv,istA,Xzutysvw->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,iuxv,istA,Xzutywvs->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,iuxv,isvA,Xzuswy->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuxv,isvA,Xzusyw->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuxv,isvA,Xzuwsy->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuxv,isvA,Xzuwys->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuxv,isvA,Xzuysw->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuxv,isvA,Xzuyws->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,iuxz,iA,Xuyw->XA', v_aaaa, t1_caaa, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuxz,ivAs,Xusvwy->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuxz,ivAs,Xusvyw->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuxz,ivAs,Xuswvy->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuxz,ivAs,Xuswyv->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuxz,ivAs,Xusyvw->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,iuxz,ivAs,Xusywv->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,iuxz,ivsA,Xusvwy->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,ix,iA,Xzyw->XA', v_aaaa, t1_ca, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,ix,iuAv,Xzvywu->XA', v_aaaa, t1_ca, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,ix,iuvA,Xzvuwy->XA', v_aaaa, t1_ca, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ix,iuvA,Xzvuyw->XA', v_aaaa, t1_ca, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ix,iuvA,Xzvwuy->XA', v_aaaa, t1_ca, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ix,iuvA,Xzvwyu->XA', v_aaaa, t1_ca, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ix,iuvA,Xzvyuw->XA', v_aaaa, t1_ca, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ix,iuvA,Xzvywu->XA', v_aaaa, t1_ca, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ixAu,iu,Xzyw->XA', v_aaaa, t1_caea, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,ixAu,iv,Xzuvwy->XA', v_aaaa, t1_caea, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixAu,iv,Xzuvyw->XA', v_aaaa, t1_caea, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixAu,iv,Xzuwvy->XA', v_aaaa, t1_caea, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixAu,iv,Xzuwyv->XA', v_aaaa, t1_caea, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixAu,iv,Xzuyvw->XA', v_aaaa, t1_caea, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixAu,iv,Xzuywv->XA', v_aaaa, t1_caea, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/96 * einsum('xyzw,ixAu,ivst,Xzuvstwy->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/96 * einsum('xyzw,ixAu,ivst,Xzuvstyw->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/32 * einsum('xyzw,ixAu,ivst,Xzuvswty->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixAu,ivst,Xzuvswyt->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 5/96 * einsum('xyzw,ixAu,ivst,Xzuvsytw->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixAu,ivst,Xzuvsywt->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/96 * einsum('xyzw,ixAu,ivst,Xzuvtswy->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/96 * einsum('xyzw,ixAu,ivst,Xzuvtsyw->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/32 * einsum('xyzw,ixAu,ivst,Xzuvtwsy->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/24 * einsum('xyzw,ixAu,ivst,Xzuvtwys->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 5/96 * einsum('xyzw,ixAu,ivst,Xzuvtysw->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/24 * einsum('xyzw,ixAu,ivst,Xzuvtyws->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/48 * einsum('xyzw,ixAu,ivst,Xzuvwsty->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 5/32 * einsum('xyzw,ixAu,ivst,Xzuvwsyt->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/48 * einsum('xyzw,ixAu,ivst,Xzuvwtsy->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/32 * einsum('xyzw,ixAu,ivst,Xzuvwtys->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 11/96 * einsum('xyzw,ixAu,ivst,Xzuvwyst->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/96 * einsum('xyzw,ixAu,ivst,Xzuvwyts->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 5/48 * einsum('xyzw,ixAu,ivst,Xzuvystw->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/32 * einsum('xyzw,ixAu,ivst,Xzuvyswt->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 5/48 * einsum('xyzw,ixAu,ivst,Xzuvytsw->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 3/32 * einsum('xyzw,ixAu,ivst,Xzuvytws->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/96 * einsum('xyzw,ixAu,ivst,Xzuvywst->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 5/96 * einsum('xyzw,ixAu,ivst,Xzuvywts->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,ixAu,ivsu,Xzvswy->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixAu,ivsu,Xzvsyw->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixAu,ivsu,Xzvwsy->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixAu,ivsu,Xzvwys->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixAu,ivsu,Xzvysw->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixAu,ivsu,Xzvyws->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ixAu,ivsz,Xuvsyw->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ixAu,ivus,Xzvyws->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ixAu,ivuz,Xvyw->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixAu,ivzs,Xuvswy->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixAu,ivzs,Xuvsyw->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixAu,ivzs,Xuvwsy->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,ixAu,ivzs,Xuvwys->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixAu,ivzs,Xuvysw->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixAu,ivzs,Xuvyws->XA', v_aaaa, t1_caea, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ixAu,ivzu,Xvwy->XA', v_aaaa, t1_caea, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ixAu,iz,Xuwy->XA', v_aaaa, t1_caea, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,ixuA,iu,Xzyw->XA', v_aaaa, t1_caae, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ixuA,iv,Xzuywv->XA', v_aaaa, t1_caae, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/120 * einsum('xyzw,ixuA,ivst,Xzuvstwy->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/120 * einsum('xyzw,ixuA,ivst,Xzuvstyw->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/160 * einsum('xyzw,ixuA,ivst,Xzuvswty->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,ixuA,ivst,Xzuvswyt->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/160 * einsum('xyzw,ixuA,ivst,Xzuvsytw->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,ixuA,ivst,Xzuvsywt->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/120 * einsum('xyzw,ixuA,ivst,Xzuvtswy->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/120 * einsum('xyzw,ixuA,ivst,Xzuvtsyw->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/160 * einsum('xyzw,ixuA,ivst,Xzuvtwsy->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,ixuA,ivst,Xzuvtwys->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/160 * einsum('xyzw,ixuA,ivst,Xzuvtysw->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,ixuA,ivst,Xzuvtyws->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/480 * einsum('xyzw,ixuA,ivst,Xzuvwsty->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/160 * einsum('xyzw,ixuA,ivst,Xzuvwsyt->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/480 * einsum('xyzw,ixuA,ivst,Xzuvwtsy->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/160 * einsum('xyzw,ixuA,ivst,Xzuvwtys->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/240 * einsum('xyzw,ixuA,ivst,Xzuvwyst->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/240 * einsum('xyzw,ixuA,ivst,Xzuvwyts->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/480 * einsum('xyzw,ixuA,ivst,Xzuvystw->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/160 * einsum('xyzw,ixuA,ivst,Xzuvyswt->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/480 * einsum('xyzw,ixuA,ivst,Xzuvytsw->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/160 * einsum('xyzw,ixuA,ivst,Xzuvytws->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 59/240 * einsum('xyzw,ixuA,ivst,Xzuvywst->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/240 * einsum('xyzw,ixuA,ivst,Xzuvywts->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ixuA,ivsu,Xzvyws->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixuA,ivsz,Xuvswy->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixuA,ivsz,Xuvsyw->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixuA,ivsz,Xuvwsy->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixuA,ivsz,Xuvwys->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,ixuA,ivsz,Xuvysw->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixuA,ivsz,Xuvyws->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,ixuA,ivus,Xzvyws->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,ixuA,ivuz,Xvyw->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ixuA,ivzs,Xuvyws->XA', v_aaaa, t1_caae, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ixuA,ivzu,Xvyw->XA', v_aaaa, t1_caae, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ixuA,iz,Xuyw->XA', v_aaaa, t1_caae, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ixuv,iA,Xywuvz->XA', v_aaaa, t1_caaa, t1_ce, rdm_cccaaa, optimize = einsum_type)
    V1 -= 7/48 * einsum('xyzw,ixuv,isAt,Xywtuvzs->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 5/48 * einsum('xyzw,ixuv,isAt,Xywtuzvs->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 5/48 * einsum('xyzw,ixuv,isAt,Xywtvuzs->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 5/48 * einsum('xyzw,ixuv,isAt,Xywtvzus->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixuv,isAt,Xywtzsuv->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixuv,isAt,Xywtzsvu->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixuv,isAt,Xywtzusv->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/48 * einsum('xyzw,ixuv,isAt,Xywtzuvs->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixuv,isAt,Xywtzvsu->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/48 * einsum('xyzw,ixuv,isAt,Xywtzvus->XA', v_aaaa, t1_caaa, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,ixuv,isAu,Xywsvz->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixuv,isAu,Xywszv->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixuv,isAu,Xywvsz->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixuv,isAu,Xywvzs->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixuv,isAu,Xywzsv->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixuv,isAu,Xywzvs->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ixuv,isAv,Xywusz->XA', v_aaaa, t1_caaa, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 41/480 * einsum('xyzw,ixuv,istA,Xywtsuzv->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 19/480 * einsum('xyzw,ixuv,istA,Xywtsvzu->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 13/160 * einsum('xyzw,ixuv,istA,Xywtszuv->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/160 * einsum('xyzw,ixuv,istA,Xywtszvu->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,ixuv,istA,Xywtusvz->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/80 * einsum('xyzw,ixuv,istA,Xywtuszv->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,ixuv,istA,Xywtuvsz->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 13/160 * einsum('xyzw,ixuv,istA,Xywtuvzs->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 19/240 * einsum('xyzw,ixuv,istA,Xywtuzsv->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 41/480 * einsum('xyzw,ixuv,istA,Xywtuzvs->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,ixuv,istA,Xywtvsuz->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 17/80 * einsum('xyzw,ixuv,istA,Xywtvszu->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,ixuv,istA,Xywtvusz->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 13/160 * einsum('xyzw,ixuv,istA,Xywtvuzs->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 11/240 * einsum('xyzw,ixuv,istA,Xywtvzsu->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 41/480 * einsum('xyzw,ixuv,istA,Xywtvzus->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,ixuv,istA,Xywtzsuv->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 61/480 * einsum('xyzw,ixuv,istA,Xywtzsvu->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,ixuv,istA,Xywtzusv->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/240 * einsum('xyzw,ixuv,istA,Xywtzuvs->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 61/480 * einsum('xyzw,ixuv,istA,Xywtzvsu->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/240 * einsum('xyzw,ixuv,istA,Xywtzvus->XA', v_aaaa, t1_caaa, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,ixuv,isuA,Xywsvz->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,ixuv,isuA,Xywszv->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,ixuv,isuA,Xywvsz->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,ixuv,isuA,Xywvzs->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,ixuv,isuA,Xywzsv->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,ixuv,isuA,Xywzvs->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,ixuv,isvA,Xywsuz->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixuv,isvA,Xywszu->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixuv,isvA,Xywusz->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixuv,isvA,Xywuzs->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixuv,isvA,Xywzsu->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,ixuv,isvA,Xywzus->XA', v_aaaa, t1_caaa, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,uvxa,stAa,Xzuvstwy->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,uvxa,stAa,Xzuvstyw->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/40 * einsum('xyzw,uvxa,stAa,Xzuvswty->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 43/480 * einsum('xyzw,uvxa,stAa,Xzuvswyt->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 3/80 * einsum('xyzw,uvxa,stAa,Xzuvsytw->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 47/480 * einsum('xyzw,uvxa,stAa,Xzuvsywt->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/160 * einsum('xyzw,uvxa,stAa,Xzuvtswy->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/160 * einsum('xyzw,uvxa,stAa,Xzuvtsyw->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/40 * einsum('xyzw,uvxa,stAa,Xzuvtwsy->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 17/480 * einsum('xyzw,uvxa,stAa,Xzuvtwys->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 3/80 * einsum('xyzw,uvxa,stAa,Xzuvtysw->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 13/480 * einsum('xyzw,uvxa,stAa,Xzuvtyws->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/160 * einsum('xyzw,uvxa,stAa,Xzuvwsty->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 11/120 * einsum('xyzw,uvxa,stAa,Xzuvwsyt->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 19/480 * einsum('xyzw,uvxa,stAa,Xzuvwtsy->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/240 * einsum('xyzw,uvxa,stAa,Xzuvwtys->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 29/480 * einsum('xyzw,uvxa,stAa,Xzuvwyst->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 31/480 * einsum('xyzw,uvxa,stAa,Xzuvwyts->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/160 * einsum('xyzw,uvxa,stAa,Xzuvystw->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 11/120 * einsum('xyzw,uvxa,stAa,Xzuvyswt->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 19/480 * einsum('xyzw,uvxa,stAa,Xzuvytsw->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/240 * einsum('xyzw,uvxa,stAa,Xzuvytws->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 59/480 * einsum('xyzw,uvxa,stAa,Xzuvywst->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,uvxa,stAa,Xzuvywts->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uxAa,va,Xzvuwy->XA', v_aaaa, t1_aaee, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uxAa,va,Xzvuyw->XA', v_aaaa, t1_aaee, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uxAa,va,Xzvwuy->XA', v_aaaa, t1_aaee, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uxAa,va,Xzvwyu->XA', v_aaaa, t1_aaee, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uxAa,va,Xzvyuw->XA', v_aaaa, t1_aaee, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uxAa,va,Xzvywu->XA', v_aaaa, t1_aaee, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/120 * einsum('xyzw,uxAa,vsta,Xzsvtwuy->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/120 * einsum('xyzw,uxAa,vsta,Xzsvtwyu->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/120 * einsum('xyzw,uxAa,vsta,Xzsvtyuw->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/120 * einsum('xyzw,uxAa,vsta,Xzsvtywu->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/240 * einsum('xyzw,uxAa,vsta,Xzsvutwy->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/240 * einsum('xyzw,uxAa,vsta,Xzsvutyw->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/120 * einsum('xyzw,uxAa,vsta,Xzsvuwty->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/60 * einsum('xyzw,uxAa,vsta,Xzsvuwyt->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/120 * einsum('xyzw,uxAa,vsta,Xzsvuytw->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 2/15 * einsum('xyzw,uxAa,vsta,Xzsvuywt->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/240 * einsum('xyzw,uxAa,vsta,Xzsvwtuy->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/240 * einsum('xyzw,uxAa,vsta,Xzsvwtyu->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/30 * einsum('xyzw,uxAa,vsta,Xzsvwuty->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 11/120 * einsum('xyzw,uxAa,vsta,Xzsvwuyt->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/40 * einsum('xyzw,uxAa,vsta,Xzsvwytu->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/10 * einsum('xyzw,uxAa,vsta,Xzsvwyut->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 17/240 * einsum('xyzw,uxAa,vsta,Xzsvytuw->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 17/240 * einsum('xyzw,uxAa,vsta,Xzsvytwu->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 3/40 * einsum('xyzw,uxAa,vsta,Xzsvyutw->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/20 * einsum('xyzw,uxAa,vsta,Xzsvyuwt->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/15 * einsum('xyzw,uxAa,vsta,Xzsvywtu->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/120 * einsum('xyzw,uxAa,vsta,Xzsvywut->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,uxAa,vsza,Xvsuwy->XA', v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 3/16 * einsum('xyzw,uxva,stAa,Xywustzv->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,uxva,stAa,Xywusztv->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,uxva,stAa,Xywutszv->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,uxva,stAa,Xywutzsv->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,uxva,stAa,Xywuzstv->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,uxva,stAa,Xywuztsv->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,xa,uvAa,Xywuvz->XA', v_aaaa, t1_ae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,xuAa,va,Xzvywu->XA', v_aaaa, t1_aaee, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,xuAa,vsta,Xzsvtwuy->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,xuAa,vsta,Xzsvtwyu->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,xuAa,vsta,Xzsvtyuw->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,xuAa,vsta,Xzsvtywu->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/60 * einsum('xyzw,xuAa,vsta,Xzsvutwy->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/60 * einsum('xyzw,xuAa,vsta,Xzsvutyw->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,xuAa,vsta,Xzsvuwty->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,xuAa,vsta,Xzsvuwyt->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,xuAa,vsta,Xzsvuytw->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,xuAa,vsta,Xzsvuywt->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 3/160 * einsum('xyzw,xuAa,vsta,Xzsvwtuy->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 3/160 * einsum('xyzw,xuAa,vsta,Xzsvwtyu->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,xuAa,vsta,Xzsvwuty->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,xuAa,vsta,Xzsvwuyt->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/240 * einsum('xyzw,xuAa,vsta,Xzsvwytu->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/240 * einsum('xyzw,xuAa,vsta,Xzsvwyut->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 3/160 * einsum('xyzw,xuAa,vsta,Xzsvytuw->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 3/160 * einsum('xyzw,xuAa,vsta,Xzsvytwu->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,xuAa,vsta,Xzsvyutw->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,xuAa,vsta,Xzsvyuwt->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/240 * einsum('xyzw,xuAa,vsta,Xzsvywtu->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 59/240 * einsum('xyzw,xuAa,vsta,Xzsvywut->XA', v_aaaa, t1_aaee, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,xuAa,vsza,Xvsuwy->XA', v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,xuAa,vsza,Xvsuyw->XA', v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,xuAa,vsza,Xvswuy->XA', v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,xuAa,vsza,Xvswyu->XA', v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,xuAa,vsza,Xvsyuw->XA', v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,xuAa,vsza,Xvsywu->XA', v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/24 * einsum('xyzw,xuva,stAa,Xywustzv->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuva,stAa,Xywusvzt->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/24 * einsum('xyzw,xuva,stAa,Xywusztv->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,xuva,stAa,Xywuszvt->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/24 * einsum('xyzw,xuva,stAa,Xywutszv->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/24 * einsum('xyzw,xuva,stAa,Xywutvzs->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/24 * einsum('xyzw,xuva,stAa,Xywutzsv->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/24 * einsum('xyzw,xuva,stAa,Xywutzvs->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/48 * einsum('xyzw,xuva,stAa,Xywuvstz->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/48 * einsum('xyzw,xuva,stAa,Xywuvszt->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/48 * einsum('xyzw,xuva,stAa,Xywuvtsz->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/48 * einsum('xyzw,xuva,stAa,Xywuvtzs->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,xuva,stAa,Xywuvzst->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,xuva,stAa,Xywuvzts->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,xuva,stAa,Xywuzstv->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,xuva,stAa,Xywuzsvt->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,xuva,stAa,Xywuztsv->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,xuva,stAa,Xywuztvs->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,xuva,stAa,Xywuzvst->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,xuva,stAa,Xywuzvts->XA', v_aaaa, t1_aaae, t1_aaee, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,xzAa,ua,Xuyw->XA', v_aaaa, t1_aaee, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,xzAa,uvsa,Xvuswy->XA', v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,xzAa,uvsa,Xvusyw->XA', v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,xzAa,uvsa,Xvuwsy->XA', v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,xzAa,uvsa,Xvuwys->XA', v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,xzAa,uvsa,Xvuysw->XA', v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,xzAa,uvsa,Xvuyws->XA', v_aaaa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,zxua,vsAa,Xywsuv->XA', v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,zxua,vsAa,Xywsvu->XA', v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,zxua,vsAa,Xywusv->XA', v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,zxua,vsAa,Xywuvs->XA', v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 += 3/16 * einsum('xyzw,zxua,vsAa,Xywvsu->XA', v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,zxua,vsAa,Xywvus->XA', v_aaaa, t1_aaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)

    chunks = tools.calculate_chunks(mr_adc, nextern, [ncore, ncore, nextern], ntensors = 2)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.cece [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_cece = mr_adc.v2e.cece[:, s_chunk:f_chunk]

        temp  = einsum('ijxa,iAja,Xx->XA', t1_ccae, v_cece, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ijxa,jAia,Xx->XA', t1_ccae, v_cece, rdm_ca, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.cece", *cput1)
    del(v_cece)

    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("t1.ccee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Molecular Orbitals Energies
        e_extern_A = mr_adc.mo_energy.e[s_chunk:f_chunk]

        ## Amplitudes
        t1_ccee = mr_adc.t1.ccee[:, :, s_chunk:f_chunk]

        temp  = einsum('ijAa,ixja,Xx->XA', t1_ccee, v_cace, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('ijAa,jxia,Xx->XA', t1_ccee, v_cace, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('A,ijAa,ijxa,Xx->XA', e_extern_A, t1_ccee, t1_ccae, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('A,ijAa,jixa,Xx->XA', e_extern_A, t1_ccee, t1_ccae, rdm_ca, optimize = einsum_type)
        temp += einsum('a,ijxa,ijAa,Xx->XA', e_extern, t1_ccae, t1_ccee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,ijxa,jiAa,Xx->XA', e_extern, t1_ccae, t1_ccee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,ijAa,ijxa,Xx->XA', e_core, t1_ccee, t1_ccae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,ijAa,jixa,Xx->XA', e_core, t1_ccee, t1_ccae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,ijxa,ijAa,Xx->XA', e_core, t1_ccae, t1_ccee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,ijxa,jiAa,Xx->XA', e_core, t1_ccae, t1_ccee, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,jiAa,ijxa,Xx->XA', e_core, t1_ccee, t1_ccae, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,jiAa,jixa,Xx->XA', e_core, t1_ccee, t1_ccae, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,jixa,ijAa,Xx->XA', e_core, t1_ccae, t1_ccee, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,jixa,jiAa,Xx->XA', e_core, t1_ccae, t1_ccee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,ijxa,ijAa,Xy->XA', h_aa, t1_ccae, t1_ccee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,ijxa,jiAa,Xy->XA', h_aa, t1_ccae, t1_ccee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,ijxa,ijAa,Xzyw->XA', v_aaaa, t1_ccae, t1_ccee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,ijxa,jiAa,Xzyw->XA', v_aaaa, t1_ccae, t1_ccee, rdm_ccaa, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting t1.ccee", *cput1)
    del(t1_ccee, e_extern_A)

    chunks = tools.calculate_chunks(mr_adc, nextern, [ncore, ncas, nextern], ntensors = 2)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.caee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_caee = mr_adc.v2e.caee[:, :, s_chunk:f_chunk]

        temp  = 1/2 * einsum('ia,ixAa,Xx->XA', t1_ce, v_caee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixay,iyAa,Xx->XA', t1_caea, v_caee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixay,izAa,Xyzx->XA', t1_caea, v_caee, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('ixya,iyAa,Xx->XA', t1_caae, v_caee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixya,izAa,Xyxz->XA', t1_caae, v_caee, rdm_ccaa, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.caee", *cput1)
    del(v_caee)

    chunks = tools.calculate_chunks(mr_adc, nextern, [ncore, ncas, nextern], ntensors = 3)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("t1.caee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Molecular Orbitals Energies
        e_extern_A = mr_adc.mo_energy.e[s_chunk:f_chunk]

        ## Amplitudes
        t1_caee = mr_adc.t1.caee[:, :, s_chunk:f_chunk, :]

        temp  = 1/2 * einsum('ia,ixAa,Xx->XA', h_ce, t1_caee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixAa,iayz,Xyxz->XA', t1_caee, v_ceaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixAa,iyza,Xzyx->XA', t1_caee, v_caae, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,ixAa,ia,Xx->XA', e_extern_A, t1_caee, t1_ce, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('A,ixAa,iyaz,Xyxz->XA', e_extern_A, t1_caee, t1_caea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,ixAa,iyza,Xyzx->XA', e_extern_A, t1_caee, t1_caae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,ia,ixAa,Xx->XA', e_extern, t1_ce, t1_caee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,ixay,izAa,Xxzy->XA', e_extern, t1_caea, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,ixya,izAa,Xxyz->XA', e_extern, t1_caae, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,ia,ixAa,Xx->XA', e_core, t1_ce, t1_caee, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,ixAa,ia,Xx->XA', e_core, t1_caee, t1_ce, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('i,ixAa,iyaz,Xyxz->XA', e_core, t1_caee, t1_caea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,ixAa,iyza,Xyzx->XA', e_core, t1_caee, t1_caae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,ixay,izAa,Xxzy->XA', e_core, t1_caea, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,ixya,izAa,Xxyz->XA', e_core, t1_caae, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,ixAa,ia,Xy->XA', h_aa, t1_caee, t1_ce, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,ixAa,izaw,Xzyw->XA', h_aa, t1_caee, t1_caea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,ixAa,izwa,Xzwy->XA', h_aa, t1_caee, t1_caae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,ixaz,iwAa,Xywz->XA', h_aa, t1_caea, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,ixza,iwAa,Xyzw->XA', h_aa, t1_caae, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,izax,iwAa,Xzwy->XA', h_aa, t1_caea, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,izxa,iwAa,Xzyw->XA', h_aa, t1_caae, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,iuax,ivAa,Xzuvwy->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,iuax,ivAa,Xzuvyw->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,iuax,ivAa,Xzuwvy->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,iuax,ivAa,Xzuwyv->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,iuax,ivAa,Xzuyvw->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,iuax,ivAa,Xzuywv->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,iuxa,ivAa,Xzuywv->XA', v_aaaa, t1_caae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,ixAa,ia,Xzyw->XA', v_aaaa, t1_caee, t1_ce, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,ixAa,iuav,Xzuywv->XA', v_aaaa, t1_caee, t1_caea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,ixAa,iuaz,Xuyw->XA', v_aaaa, t1_caee, t1_caea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,ixAa,iuva,Xzuvwy->XA', v_aaaa, t1_caee, t1_caae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,ixAa,iuva,Xzuvyw->XA', v_aaaa, t1_caee, t1_caae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,ixAa,iuva,Xzuwvy->XA', v_aaaa, t1_caee, t1_caae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,ixAa,iuva,Xzuwyv->XA', v_aaaa, t1_caee, t1_caae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,ixAa,iuva,Xzuyvw->XA', v_aaaa, t1_caee, t1_caae, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,ixAa,iuva,Xzuywv->XA', v_aaaa, t1_caee, t1_caae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,ixAa,iuza,Xuwy->XA', v_aaaa, t1_caee, t1_caae, rdm_ccaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,ixau,ivAa,Xywuvz->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,ixau,ivAa,Xywuzv->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,ixau,ivAa,Xywvuz->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,ixau,ivAa,Xywvzu->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,ixau,ivAa,Xywzuv->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,ixau,ivAa,Xywzvu->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,ixua,ivAa,Xywuvz->XA', v_aaaa, t1_caae, t1_caee, rdm_cccaaa, optimize = einsum_type)

        ## Amplitudes
        t1_caee = mr_adc.t1.caee[:, :, :, s_chunk:f_chunk]

        temp -= einsum('ia,ixaA,Xx->XA', h_ce, t1_caee, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixaA,iayz,Xyxz->XA', t1_caee, v_ceaa, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixaA,iyza,Xzxy->XA', t1_caee, v_caae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('A,ixaA,ia,Xx->XA', e_extern_A, t1_caee, t1_ce, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('A,ixaA,iyaz,Xyxz->XA', e_extern_A, t1_caee, t1_caea, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('A,ixaA,iyza,Xyxz->XA', e_extern_A, t1_caee, t1_caae, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('a,ia,ixaA,Xx->XA', e_extern, t1_ce, t1_caee, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,ixay,izaA,Xxzy->XA', e_extern, t1_caea, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,ixya,izaA,Xxzy->XA', e_extern, t1_caae, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,ia,ixaA,Xx->XA', e_core, t1_ce, t1_caee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,ixaA,ia,Xx->XA', e_core, t1_caee, t1_ce, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('i,ixaA,iyaz,Xyxz->XA', e_core, t1_caee, t1_caea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,ixaA,iyza,Xyxz->XA', e_core, t1_caee, t1_caae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('i,ixay,izaA,Xxzy->XA', e_core, t1_caea, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('i,ixya,izaA,Xxzy->XA', e_core, t1_caae, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,ixaA,ia,Xy->XA', h_aa, t1_caee, t1_ce, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,ixaA,izaw,Xzyw->XA', h_aa, t1_caee, t1_caea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,ixaA,izwa,Xzyw->XA', h_aa, t1_caee, t1_caae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,ixaz,iwaA,Xywz->XA', h_aa, t1_caea, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,ixza,iwaA,Xywz->XA', h_aa, t1_caae, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,izax,iwaA,Xzwy->XA', h_aa, t1_caea, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,izxa,iwaA,Xzwy->XA', h_aa, t1_caae, t1_caee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyzw,iuax,ivaA,Xzuvwy->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,iuax,ivaA,Xzuvyw->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,iuax,ivaA,Xzuwvy->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,iuax,ivaA,Xzuwyv->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,iuax,ivaA,Xzuyvw->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,iuax,ivaA,Xzuywv->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyzw,iuxa,ivaA,Xzuvwy->XA', v_aaaa, t1_caae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,iuxa,ivaA,Xzuvyw->XA', v_aaaa, t1_caae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,iuxa,ivaA,Xzuwvy->XA', v_aaaa, t1_caae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,iuxa,ivaA,Xzuwyv->XA', v_aaaa, t1_caae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,iuxa,ivaA,Xzuyvw->XA', v_aaaa, t1_caae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,iuxa,ivaA,Xzuywv->XA', v_aaaa, t1_caae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,ixaA,ia,Xzyw->XA', v_aaaa, t1_caee, t1_ce, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,ixaA,iuav,Xzuywv->XA', v_aaaa, t1_caee, t1_caea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,ixaA,iuaz,Xuyw->XA', v_aaaa, t1_caee, t1_caea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,ixaA,iuva,Xzuywv->XA', v_aaaa, t1_caee, t1_caae, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,ixaA,iuza,Xuyw->XA', v_aaaa, t1_caee, t1_caae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,ixau,ivaA,Xywuvz->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,ixau,ivaA,Xywuzv->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/3 * einsum('xyzw,ixau,ivaA,Xywvuz->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,ixau,ivaA,Xywvzu->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,ixau,ivaA,Xywzuv->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,ixau,ivaA,Xywzvu->XA', v_aaaa, t1_caea, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,ixua,ivaA,Xywuvz->XA', v_aaaa, t1_caae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,ixua,ivaA,Xywuzv->XA', v_aaaa, t1_caae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,ixua,ivaA,Xywvuz->XA', v_aaaa, t1_caae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,ixua,ivaA,Xywvzu->XA', v_aaaa, t1_caae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,ixua,ivaA,Xywzuv->XA', v_aaaa, t1_caae, t1_caee, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,ixua,ivaA,Xywzvu->XA', v_aaaa, t1_caae, t1_caee, rdm_cccaaa, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting t1.caee", *cput1)
    del(t1_caee, e_extern_A)

    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.ceae [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_ceae = mr_adc.v2e.ceae[:, s_chunk:f_chunk, :, :]

        temp  = 1/2 * einsum('ia,iAxa,Xx->XA', t1_ce, v_ceae, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixay,iAza,Xxzy->XA', t1_caea, v_ceae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixya,iAza,Xxyz->XA', t1_caae, v_ceae, rdm_ccaa, optimize = einsum_type)
        
        ## Two-electron integrals
        v_ceae = mr_adc.v2e.ceae[:, :, :, s_chunk:f_chunk]

        temp -= einsum('ia,iaxA,Xx->XA', t1_ce, v_ceae, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixay,iazA,Xxzy->XA', t1_caea, v_ceae, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixya,iazA,Xxzy->XA', t1_caae, v_ceae, rdm_ccaa, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.ceae", *cput1)
    del(v_ceae)

    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.ceea [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_ceea = mr_adc.v2e.ceea[:, :, s_chunk:f_chunk]

        temp =- einsum('ia,iaAx,Xx->XA', t1_ce, v_ceea, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixay,iaAy,Xx->XA', t1_caea, v_ceea, rdm_ca, optimize = einsum_type)
        temp -= einsum('ixay,iaAz,Xyzx->XA', t1_caea, v_ceea, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('ixya,iaAy,Xx->XA', t1_caae, v_ceea, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixya,iaAz,Xyzx->XA', t1_caae, v_ceea, rdm_ccaa, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.ceea", *cput1)
    del(v_ceea)

    chunks = tools.calculate_chunks(mr_adc, nextern, [ncore, nextern, nextern], ntensors = 2)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.ceee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_ceee = mr_adc.v2e.ceee[:, :, s_chunk:f_chunk]

        ## Amplitude
        t1_caee = mr_adc.t1.caee

        temp =- einsum('ixab,iaAb,Xx->XA', t1_caee, v_ceee, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('ixab,ibAa,Xx->XA', t1_caee, v_ceee, rdm_ca, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.ceee", *cput1)
    del(v_ceee, t1_caee)

    chunks = tools.calculate_chunks(mr_adc, nextern, [ncas, ncas, nextern], ntensors = 2)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.aaee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_aaee = mr_adc.v2e.aaee[:, :, s_chunk:f_chunk]

        temp =- 1/2 * einsum('xa,yzAa,Xyxz->XA', t1_ae, v_aaee, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyza,wuAa,Xzwyxu->XA', t1_aaae, v_aaee, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyza,wzAa,Xwyx->XA', t1_aaae, v_aaee, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xa,yzAa,yz,Xx->XA', t1_ae, v_aaee, rdm_ca, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyza,wuAa,wu,Xzyx->XA', t1_aaae, v_aaee, rdm_ca, rdm_ccaa, optimize = einsum_type)
 
        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.aaee", *cput1)
    del(v_aaee)

    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.aeae [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_aeae = mr_adc.v2e.aeae[:, s_chunk:f_chunk]

        temp =- 1/2 * einsum('xa,yAza,Xxyz->XA', t1_ae, v_aeae, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyza,wAua,Xyxwuz->XA', t1_aaae, v_aeae, rdm_cccaaa, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.aeae", *cput1)
    del(v_aeae)

    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.aeea [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_aeea = mr_adc.v2e.aeea[:, s_chunk:f_chunk]

        temp =- 1/2 * einsum('xa,yAaz,Xzyx->XA', t1_ae, v_aeea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/3 * einsum('xyza,wAau,Xzuwxy->XA', t1_aaae, v_aeea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyza,wAau,Xzuwyx->XA', t1_aaae, v_aeea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyza,wAau,Xzuxwy->XA', t1_aaae, v_aeea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyza,wAau,Xzuxyw->XA', t1_aaae, v_aeea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyza,wAau,Xzuywx->XA', t1_aaae, v_aeea, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('xyza,wAau,Xzuyxw->XA', t1_aaae, v_aeea, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyza,zAaw,Xwxy->XA', t1_aaae, v_aeea, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xa,yAaz,zy,Xx->XA', t1_ae, v_aeea, rdm_ca, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xyza,wAau,uw,Xzyx->XA', t1_aaae, v_aeea, rdm_ca, rdm_ccaa, optimize = einsum_type)

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.aeea", *cput1)
    del(v_aeea)

    chunks = tools.calculate_chunks(mr_adc, nextern, [ncas, nextern, nextern], ntensors = 2)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.aeee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Two-electron integrals
        v_aeee = mr_adc.v2e.aeee[:, :, s_chunk:f_chunk]
    
        temp =- 1/2 * einsum('xyab,zbAa,Xzxy->XA', t1_aaee, v_aeee, rdm_ccaa, optimize = einsum_type) 

        V1[:, s_chunk:f_chunk] += temp
        mr_adc.log.timer_debug("contracting v2e.aeee", *cput1)
    del(v_aeee)

    S_12_V = np.einsum("Pa,Pm->ma", V1, S_m1_12_inv_act)
    S_12_V = np.einsum("mp,ma->pa", evecs, S_12_V)

    # Compute denominators
    d_pa = (evals[:,None] + e_extern)
    d_pa = d_pa**(-1)

    S_12_V *= d_pa
    S_12_V = np.einsum("mp,pa->ma", evecs, S_12_V)

    # Compute T2[-1'] t2_ae amplitudes
    t2_ae = np.einsum("Pm,ma->Pa", S_m1_12_inv_act, S_12_V)

    mr_adc.log.extra("Norm of T[-1']^(2):                          %20.12f" % np.linalg.norm(t2_ae))
    mr_adc.log.timer("computing T[-1']^(2) amplitudes", *cput0)

    return t2_ae

def compute_t2_p1p_singles(mr_adc):

    cput0 = (logger.process_clock(), logger.perf_counter())
    mr_adc.log.extra("\nComputing T[+1']^(2) amplitudes...")

    # Import Prism interface
    interface = mr_adc.interface

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    ncore = mr_adc.ncore
    ncas = mr_adc.ncas
    nextern = mr_adc.nextern

    ## Molecular Orbitals Energies
    e_core = mr_adc.mo_energy.c
    e_extern = mr_adc.mo_energy.e

    ## One-electron integrals
    h_ce = mr_adc.h1eff.ce
    h_ca = mr_adc.h1eff.ca
    h_ae = mr_adc.h1eff.ae
    h_aa = mr_adc.h1eff.aa

    ## Two-electron integrals
    v_aaaa = mr_adc.v2e.aaaa
    
    v_ccce = mr_adc.v2e.ccce
    v_ccca = mr_adc.v2e.ccca
    
    v_caca = mr_adc.v2e.caca    
    v_ccaa = mr_adc.v2e.ccaa
    v_caac = mr_adc.v2e.caac    
 
    v_cace = mr_adc.v2e.cace 
    v_ccae = mr_adc.v2e.ccae
    v_caec = mr_adc.v2e.caec
    
    v_caaa = mr_adc.v2e.caaa

    v_caae = mr_adc.v2e.caae
    v_ceaa = mr_adc.v2e.ceaa 
    v_caea = mr_adc.v2e.caea
    
    v_aaae = mr_adc.v2e.aaae
    
    ## Amplitudes
    t1_ce = mr_adc.t1.ce
    t1_caea = mr_adc.t1.caea
    t1_caae = mr_adc.t1.caae

    t1_ca = mr_adc.t1.ca
    t1_caaa = mr_adc.t1.caaa

    t1_ae   = mr_adc.t1.ae
    t1_aaae = mr_adc.t1.aaae

    t1_ccae = mr_adc.t1.ccae
    t1_ccaa = mr_adc.t1.ccaa

    ## Reduced density matrices
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa
    rdm_cccaaa = mr_adc.rdm.cccaaa
    rdm_ccccaaaa = mr_adc.rdm.ccccaaaa

    # Compute K_ac matrix
    K_p1p = mr_adc_intermediates.compute_K_ac(mr_adc)
    
    # Compute S^{-1/2} matrix: Orthogonalization and overlap truncation only in the active space
    S_p1p_12_inv_act = mr_adc_overlap.compute_S12_p1(mr_adc)

    # Compute K^{-1} matrix
    SKS = reduce(np.dot, (S_p1p_12_inv_act.T, K_p1p, S_p1p_12_inv_act))
    evals, evecs = np.linalg.eigh(SKS)
    del(SKS)

    # Compute R.H.S. of the equation
    # V1 block: - 1/2 < Psi_0 | a^{\dag}_I a_X  [V + H^{(1)}, T - T^\dag] | Psi_0 > 
    V1 =- einsum('Ia,Xa->IX', h_ce, t1_ae, optimize = einsum_type)
    V1 -= einsum('Xa,Ia->IX', h_ae, t1_ce, optimize = einsum_type)
    V1 -= 2 * einsum('ia,IiXa->IX', h_ce, t1_ccae, optimize = einsum_type)
    V1 += einsum('ia,iIXa->IX', h_ce, t1_ccae, optimize = einsum_type)
    V1 -= 2 * einsum('ix,IiXx->IX', h_ca, t1_ccaa, optimize = einsum_type)
    V1 += einsum('ix,IixX->IX', h_ca, t1_ccaa, optimize = einsum_type)
    V1 -= 2 * einsum('Iixa,iaXx->IX', t1_ccae, v_ceaa, optimize = einsum_type)
    V1 += einsum('Iixa,ixXa->IX', t1_ccae, v_caae, optimize = einsum_type)
    V1 += einsum('Iixy,ixXy->IX', t1_ccaa, v_caaa, optimize = einsum_type)
    V1 -= 2 * einsum('Iixy,iyXx->IX', t1_ccaa, v_caaa, optimize = einsum_type)
    V1 += einsum('iIxa,iaXx->IX', t1_ccae, v_ceaa, optimize = einsum_type)
    V1 -= 2 * einsum('iIxa,ixXa->IX', t1_ccae, v_caae, optimize = einsum_type)
    V1 -= 2 * einsum('iXax,Ixia->IX', t1_caea, v_cace, optimize = einsum_type)
    V1 += einsum('iXax,ixIa->IX', t1_caea, v_cace, optimize = einsum_type)
    V1 += einsum('iXxa,Ixia->IX', t1_caae, v_cace, optimize = einsum_type)
    V1 -= 2 * einsum('iXxa,ixIa->IX', t1_caae, v_cace, optimize = einsum_type)
    V1 += einsum('iXxy,Ixiy->IX', t1_caaa, v_caca, optimize = einsum_type)
    V1 -= 2 * einsum('iXxy,Iyix->IX', t1_caaa, v_caca, optimize = einsum_type)
    V1 -= 2 * einsum('ia,IXai->IX', t1_ce, v_caec, optimize = einsum_type)
    V1 -= 2 * einsum('ia,IXia->IX', t1_ce, v_cace, optimize = einsum_type)
    V1 += einsum('ia,iIXa->IX', t1_ce, v_ccae, optimize = einsum_type)
    V1 += einsum('ia,iXIa->IX', t1_ce, v_cace, optimize = einsum_type)
    V1 += 2 * einsum('ijXa,iIja->IX', t1_ccae, v_ccce, optimize = einsum_type)
    V1 -= einsum('ijXa,jIia->IX', t1_ccae, v_ccce, optimize = einsum_type)
    V1 += 2 * einsum('ijXx,iIjx->IX', t1_ccaa, v_ccca, optimize = einsum_type)
    V1 -= einsum('ijXx,jIix->IX', t1_ccaa, v_ccca, optimize = einsum_type)
    V1 -= 2 * einsum('ix,IXix->IX', t1_ca, v_caca, optimize = einsum_type)
    V1 -= 2 * einsum('ix,IXxi->IX', t1_ca, v_caac, optimize = einsum_type)
    V1 += einsum('ix,IixX->IX', t1_ca, v_ccaa, optimize = einsum_type)
    V1 += einsum('ix,IxiX->IX', t1_ca, v_caca, optimize = einsum_type)
    V1 += 1/2 * einsum('I,Ia,Xa->IX', e_core, t1_ce, t1_ae, optimize = einsum_type)
    V1 += einsum('I,IiXa,ia->IX', e_core, t1_ccae, t1_ce, optimize = einsum_type)
    V1 += einsum('I,IiXx,ix->IX', e_core, t1_ccaa, t1_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,IixX,ix->IX', e_core, t1_ccaa, t1_ca, optimize = einsum_type)
    V1 += einsum('I,Iixa,iXax->IX', e_core, t1_ccae, t1_caea, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,Iixa,iXxa->IX', e_core, t1_ccae, t1_caae, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,Iixy,iXxy->IX', e_core, t1_ccaa, t1_caaa, optimize = einsum_type)
    V1 += einsum('I,Iixy,iXyx->IX', e_core, t1_ccaa, t1_caaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,iIXa,ia->IX', e_core, t1_ccae, t1_ce, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,iIxa,iXax->IX', e_core, t1_ccae, t1_caea, optimize = einsum_type)
    V1 += einsum('I,iIxa,iXxa->IX', e_core, t1_ccae, t1_caae, optimize = einsum_type)
    V1 -= einsum('a,Xa,Ia->IX', e_extern, t1_ae, t1_ce, optimize = einsum_type)
    V1 -= 2 * einsum('a,iXax,Iixa->IX', e_extern, t1_caea, t1_ccae, optimize = einsum_type)
    V1 += einsum('a,iXax,iIxa->IX', e_extern, t1_caea, t1_ccae, optimize = einsum_type)
    V1 += einsum('a,iXxa,Iixa->IX', e_extern, t1_caae, t1_ccae, optimize = einsum_type)
    V1 -= 2 * einsum('a,iXxa,iIxa->IX', e_extern, t1_caae, t1_ccae, optimize = einsum_type)
    V1 -= 2 * einsum('a,ia,IiXa->IX', e_extern, t1_ce, t1_ccae, optimize = einsum_type)
    V1 += einsum('a,ia,iIXa->IX', e_extern, t1_ce, t1_ccae, optimize = einsum_type)
    V1 += einsum('i,IiXa,ia->IX', e_core, t1_ccae, t1_ce, optimize = einsum_type)
    V1 += einsum('i,IiXx,ix->IX', e_core, t1_ccaa, t1_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,IixX,ix->IX', e_core, t1_ccaa, t1_ca, optimize = einsum_type)
    V1 += einsum('i,Iixa,iXax->IX', e_core, t1_ccae, t1_caea, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,Iixa,iXxa->IX', e_core, t1_ccae, t1_caae, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,Iixy,iXxy->IX', e_core, t1_ccaa, t1_caaa, optimize = einsum_type)
    V1 += einsum('i,Iixy,iXyx->IX', e_core, t1_ccaa, t1_caaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,iIXa,ia->IX', e_core, t1_ccae, t1_ce, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,iIxa,iXax->IX', e_core, t1_ccae, t1_caea, optimize = einsum_type)
    V1 += einsum('i,iIxa,iXxa->IX', e_core, t1_ccae, t1_caae, optimize = einsum_type)
    V1 += einsum('i,iXax,Iixa->IX', e_core, t1_caea, t1_ccae, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,iXax,iIxa->IX', e_core, t1_caea, t1_ccae, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,iXxa,Iixa->IX', e_core, t1_caae, t1_ccae, optimize = einsum_type)
    V1 += einsum('i,iXxa,iIxa->IX', e_core, t1_caae, t1_ccae, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,iXxy,Iixy->IX', e_core, t1_caaa, t1_ccaa, optimize = einsum_type)
    V1 += einsum('i,iXxy,Iiyx->IX', e_core, t1_caaa, t1_ccaa, optimize = einsum_type)
    V1 += einsum('i,ia,IiXa->IX', e_core, t1_ce, t1_ccae, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ia,iIXa->IX', e_core, t1_ce, t1_ccae, optimize = einsum_type)
    V1 += einsum('i,ix,IiXx->IX', e_core, t1_ca, t1_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ix,IixX->IX', e_core, t1_ca, t1_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Ia,Xxya,xy->IX', h_ce, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 -= einsum('Ia,xXya,xy->IX', h_ce, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Ia,xa,Xx->IX', h_ce, t1_ae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Ia,xyza,Xzyx->IX', h_ce, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('Xa,Ixay,xy->IX', h_ae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xa,Ixya,xy->IX', h_ae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += einsum('ia,Iixa,Xx->IX', h_ce, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ia,iIxa,Xx->IX', h_ce, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += einsum('ix,IiXy,xy->IX', h_ca, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ix,Iixy,Xy->IX', h_ca, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ix,IiyX,xy->IX', h_ca, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('ix,Iiyx,Xy->IX', h_ca, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ix,Iiyz,Xxyz->IX', h_ca, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xa,Ia,Xx->IX', h_ae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 -= einsum('xa,IyXa,xy->IX', h_ae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xa,IyaX,xy->IX', h_ae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xa,Iyaz,Xyxz->IX', h_ae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xa,Iyza,Xyzx->IX', h_ae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('Xx,Iixa,ia->IX', h_aa, t1_ccae, t1_ce, optimize = einsum_type)
    V1 -= einsum('Xx,Iixy,iy->IX', h_aa, t1_ccaa, t1_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xx,Iiyx,iy->IX', h_aa, t1_ccaa, t1_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xx,iIxa,ia->IX', h_aa, t1_ccae, t1_ce, optimize = einsum_type)
    V1 += einsum('Xx,ixay,Iiya->IX', h_aa, t1_caea, t1_ccae, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xx,ixay,iIya->IX', h_aa, t1_caea, t1_ccae, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xx,ixya,Iiya->IX', h_aa, t1_caae, t1_ccae, optimize = einsum_type)
    V1 += einsum('Xx,ixya,iIya->IX', h_aa, t1_caae, t1_ccae, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xx,ixyz,Iiyz->IX', h_aa, t1_caaa, t1_ccaa, optimize = einsum_type)
    V1 += einsum('Xx,ixyz,Iizy->IX', h_aa, t1_caaa, t1_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xx,xa,Ia->IX', h_aa, t1_ae, t1_ce, optimize = einsum_type)
    V1 -= 2 * einsum('xy,IiXx,iy->IX', h_aa, t1_ccaa, t1_ca, optimize = einsum_type)
    V1 += einsum('xy,IixX,iy->IX', h_aa, t1_ccaa, t1_ca, optimize = einsum_type)
    V1 -= 2 * einsum('xy,Iixa,iXay->IX', h_aa, t1_ccae, t1_caea, optimize = einsum_type)
    V1 += einsum('xy,Iixa,iXya->IX', h_aa, t1_ccae, t1_caae, optimize = einsum_type)
    V1 += einsum('xy,Iixz,iXyz->IX', h_aa, t1_ccaa, t1_caaa, optimize = einsum_type)
    V1 -= 2 * einsum('xy,Iixz,iXzy->IX', h_aa, t1_ccaa, t1_caaa, optimize = einsum_type)
    V1 -= 2 * einsum('xy,Iizx,iXyz->IX', h_aa, t1_ccaa, t1_caaa, optimize = einsum_type)
    V1 += einsum('xy,Iizx,iXzy->IX', h_aa, t1_ccaa, t1_caaa, optimize = einsum_type)
    V1 += einsum('xy,iIxa,iXay->IX', h_aa, t1_ccae, t1_caea, optimize = einsum_type)
    V1 -= 2 * einsum('xy,iIxa,iXya->IX', h_aa, t1_ccae, t1_caae, optimize = einsum_type)
    V1 += 1/2 * einsum('Ia,Xxya,yx->IX', t1_ce, v_aaae, rdm_ca, optimize = einsum_type)
    V1 -= einsum('Ia,xyXa,xy->IX', t1_ce, v_aaae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Ia,xyza,Xyzx->IX', t1_ce, v_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 2 * einsum('IiXa,iaxy,xy->IX', t1_ccae, v_ceaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('IiXa,ixya,yx->IX', t1_ccae, v_caae, rdm_ca, optimize = einsum_type)
    V1 -= 2 * einsum('IiXx,ixyz,yz->IX', t1_ccaa, v_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('IiXx,iyzw,xzyw->IX', t1_ccaa, v_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('IiXx,iyzx,zy->IX', t1_ccaa, v_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('IixX,ixyz,yz->IX', t1_ccaa, v_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('IixX,iyzw,xzyw->IX', t1_ccaa, v_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('IixX,iyzx,zy->IX', t1_ccaa, v_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('Iixa,iaXy,xy->IX', t1_ccae, v_ceaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('Iixa,iayx,Xy->IX', t1_ccae, v_ceaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('Iixa,iayz,Xzxy->IX', t1_ccae, v_ceaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Iixa,ixya,Xy->IX', t1_ccae, v_caae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Iixa,iyXa,xy->IX', t1_ccae, v_caae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Iixa,iyza,Xyxz->IX', t1_ccae, v_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Iixy,ixXz,yz->IX', t1_ccaa, v_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Iixy,ixzw,Xwyz->IX', t1_ccaa, v_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Iixy,ixzy,Xz->IX', t1_ccaa, v_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('Iixy,iyXz,xz->IX', t1_ccaa, v_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('Iixy,iyzw,Xwxz->IX', t1_ccaa, v_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('Iixy,iyzx,Xz->IX', t1_ccaa, v_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Iixy,izXw,xywz->IX', t1_ccaa, v_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('Iixy,izXx,yz->IX', t1_ccaa, v_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Iixy,izXy,xz->IX', t1_ccaa, v_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Iixy,izwu,Xzuxyw->IX', t1_ccaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Iixy,izwx,Xzwy->IX', t1_ccaa, v_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Iixy,izwy,Xzxw->IX', t1_ccaa, v_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('IxXa,yzwa,xzwy->IX', t1_caae, v_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('IxaX,yzwa,xzwy->IX', t1_caea, v_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Ixay,Xyza,xz->IX', t1_caea, v_aaae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Ixay,Xzwa,xzyw->IX', t1_caea, v_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('Ixay,zwXa,xwyz->IX', t1_caea, v_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/3 * einsum('Ixay,zwua,Xxwuyz->IX', t1_caea, v_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('Ixay,zwua,Xxwuzy->IX', t1_caea, v_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('Ixay,zwua,Xxwyuz->IX', t1_caea, v_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('Ixay,zwua,Xxwyzu->IX', t1_caea, v_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('Ixay,zwua,Xxwzuy->IX', t1_caea, v_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('Ixay,zwua,Xxwzyu->IX', t1_caea, v_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= einsum('Ixay,zyXa,xz->IX', t1_caea, v_aaae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Ixay,zywa,Xxwz->IX', t1_caea, v_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('Ixya,Xyza,xz->IX', t1_caae, v_aaae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Ixya,Xzwa,xzwy->IX', t1_caae, v_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Ixya,zwXa,xwyz->IX', t1_caae, v_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Ixya,zwua,Xxwyuz->IX', t1_caae, v_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Ixya,zyXa,xz->IX', t1_caae, v_aaae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Ixya,zywa,Xxzw->IX', t1_caae, v_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('Xa,Iaxy,xy->IX', t1_ae, v_ceaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xa,Ixya,yx->IX', t1_ae, v_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxya,Iazw,xwyz->IX', t1_aaae, v_ceaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxya,Iazy,xz->IX', t1_aaae, v_ceaa, rdm_ca, optimize = einsum_type)
    V1 -= einsum('Xxya,Iyza,xz->IX', t1_aaae, v_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxya,Izwa,xzwy->IX', t1_aaae, v_caae, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('iIXa,iaxy,xy->IX', t1_ccae, v_ceaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('iIXa,ixya,yx->IX', t1_ccae, v_caae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('iIxa,iaXy,xy->IX', t1_ccae, v_ceaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('iIxa,iayx,Xy->IX', t1_ccae, v_ceaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('iIxa,iayz,Xzxy->IX', t1_ccae, v_ceaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('iIxa,ixya,Xy->IX', t1_ccae, v_caae, rdm_ca, optimize = einsum_type)
    V1 += einsum('iIxa,iyXa,xy->IX', t1_ccae, v_caae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('iIxa,iyza,Xyzx->IX', t1_ccae, v_caae, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('iXax,Iyia,xy->IX', t1_caea, v_cace, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('iXax,iyIa,xy->IX', t1_caea, v_cace, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('iXxa,Iyia,xy->IX', t1_caae, v_cace, rdm_ca, optimize = einsum_type)
    V1 += einsum('iXxa,iyIa,xy->IX', t1_caae, v_cace, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('iXxy,Ixiz,yz->IX', t1_caaa, v_caca, rdm_ca, optimize = einsum_type)
    V1 += einsum('iXxy,Iyiz,xz->IX', t1_caaa, v_caca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('iXxy,Iziw,yxzw->IX', t1_caaa, v_caca, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('iXxy,Izix,yz->IX', t1_caaa, v_caca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('iXxy,Iziy,xz->IX', t1_caaa, v_caca, rdm_ca, optimize = einsum_type)
    V1 += einsum('ia,Ixai,Xx->IX', t1_ce, v_caec, rdm_ca, optimize = einsum_type)
    V1 += einsum('ia,Ixia,Xx->IX', t1_ce, v_cace, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ia,iIxa,Xx->IX', t1_ce, v_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ia,ixIa,Xx->IX', t1_ce, v_cace, rdm_ca, optimize = einsum_type)
    V1 -= einsum('ijXx,iIjy,xy->IX', t1_ccaa, v_ccca, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('ijXx,jIiy,xy->IX', t1_ccaa, v_ccca, rdm_ca, optimize = einsum_type)
    V1 -= einsum('ijxa,iIja,Xx->IX', t1_ccae, v_ccce, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('ijxa,jIia,Xx->IX', t1_ccae, v_ccce, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('ijxy,iIjx,Xy->IX', t1_ccaa, v_ccca, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('ijxy,iIjz,Xzxy->IX', t1_ccaa, v_ccca, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('ijxy,jIix,Xy->IX', t1_ccaa, v_ccca, rdm_ca, optimize = einsum_type)
    V1 += einsum('ix,IXiy,xy->IX', t1_ca, v_caca, rdm_ca, optimize = einsum_type)
    V1 += einsum('ix,IXyi,xy->IX', t1_ca, v_caac, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ix,Iixy,Xy->IX', t1_ca, v_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ix,IiyX,xy->IX', t1_ca, v_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ix,Iiyz,Xyxz->IX', t1_ca, v_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('ix,Ixiy,Xy->IX', t1_ca, v_caca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ix,IyiX,xy->IX', t1_ca, v_caca, rdm_ca, optimize = einsum_type)
    V1 += einsum('ix,Iyix,Xy->IX', t1_ca, v_caca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ix,Iyiz,Xxyz->IX', t1_ca, v_caca, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('ix,Iyxi,Xy->IX', t1_ca, v_caac, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ix,Iyzi,Xzyx->IX', t1_ca, v_caac, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixXa,Iyai,xy->IX', t1_caae, v_caec, rdm_ca, optimize = einsum_type)
    V1 += einsum('ixXa,iIya,xy->IX', t1_caae, v_ccae, rdm_ca, optimize = einsum_type)
    V1 += einsum('ixXy,Iiyz,xz->IX', t1_caaa, v_ccaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('ixXy,Iizw,ywxz->IX', t1_caaa, v_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixXy,Izwi,yzxw->IX', t1_caaa, v_caac, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixXy,Izyi,xz->IX', t1_caaa, v_caac, rdm_ca, optimize = einsum_type)
    V1 += einsum('ixaX,Iyai,xy->IX', t1_caea, v_caec, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixaX,iIya,xy->IX', t1_caea, v_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 2 * einsum('ixay,IXai,yx->IX', t1_caea, v_caec, rdm_ca, optimize = einsum_type)
    V1 -= 2 * einsum('ixay,IXia,xy->IX', t1_caea, v_cace, rdm_ca, optimize = einsum_type)
    V1 += einsum('ixay,Iyia,Xx->IX', t1_caea, v_cace, rdm_ca, optimize = einsum_type)
    V1 += einsum('ixay,Izai,Xxzy->IX', t1_caea, v_caec, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('ixay,Izia,Xyzx->IX', t1_caea, v_cace, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('ixay,iIXa,yx->IX', t1_caea, v_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixay,iIza,Xxzy->IX', t1_caea, v_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('ixay,iXIa,xy->IX', t1_caea, v_cace, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixay,iyIa,Xx->IX', t1_caea, v_cace, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixay,izIa,Xyzx->IX', t1_caea, v_cace, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyX,Iiyz,xz->IX', t1_caaa, v_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyX,Iizw,ywxz->IX', t1_caaa, v_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyX,Izwi,yzwx->IX', t1_caaa, v_caac, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('ixyX,Izyi,xz->IX', t1_caaa, v_caac, rdm_ca, optimize = einsum_type)
    V1 += einsum('ixya,IXai,yx->IX', t1_caae, v_caec, rdm_ca, optimize = einsum_type)
    V1 += einsum('ixya,IXia,xy->IX', t1_caae, v_cace, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixya,Iyia,Xx->IX', t1_caae, v_cace, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixya,Izai,Xxzy->IX', t1_caae, v_caec, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixya,Izia,Xyzx->IX', t1_caae, v_cace, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixya,iIXa,yx->IX', t1_caae, v_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixya,iIza,Xxyz->IX', t1_caae, v_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixya,iXIa,xy->IX', t1_caae, v_cace, rdm_ca, optimize = einsum_type)
    V1 += einsum('ixya,iyIa,Xx->IX', t1_caae, v_cace, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixya,izIa,Xyxz->IX', t1_caae, v_cace, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('ixyz,IXiw,xwzy->IX', t1_caaa, v_caca, rdm_ccaa, optimize = einsum_type)
    V1 -= 2 * einsum('ixyz,IXiy,xz->IX', t1_caaa, v_caca, rdm_ca, optimize = einsum_type)
    V1 += einsum('ixyz,IXiz,xy->IX', t1_caaa, v_caca, rdm_ca, optimize = einsum_type)
    V1 += einsum('ixyz,IXwi,xwzy->IX', t1_caaa, v_caac, rdm_ccaa, optimize = einsum_type)
    V1 -= 2 * einsum('ixyz,IXyi,zx->IX', t1_caaa, v_caac, rdm_ca, optimize = einsum_type)
    V1 += einsum('ixyz,IXzi,yx->IX', t1_caaa, v_caac, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyz,IiwX,xwzy->IX', t1_caaa, v_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyz,Iiwu,Xxwyzu->IX', t1_caaa, v_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += einsum('ixyz,IiyX,zx->IX', t1_caaa, v_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyz,Iiyw,Xxwz->IX', t1_caaa, v_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyz,IizX,yx->IX', t1_caaa, v_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyz,Iizw,Xxyw->IX', t1_caaa, v_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyz,IwiX,xwzy->IX', t1_caaa, v_caca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyz,Iwiu,Xyzwux->IX', t1_caaa, v_caca, rdm_cccaaa, optimize = einsum_type)
    V1 += einsum('ixyz,Iwiy,Xzwx->IX', t1_caaa, v_caca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyz,Iwiz,Xywx->IX', t1_caaa, v_caca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/6 * einsum('ixyz,Iwui,Xxuwyz->IX', t1_caaa, v_caac, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('ixyz,Iwui,Xxuwzy->IX', t1_caaa, v_caac, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('ixyz,Iwui,Xxuywz->IX', t1_caaa, v_caac, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('ixyz,Iwui,Xxuyzw->IX', t1_caaa, v_caac, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('ixyz,Iwui,Xxuzwy->IX', t1_caaa, v_caac, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('ixyz,Iwui,Xxuzyw->IX', t1_caaa, v_caac, rdm_cccaaa, optimize = einsum_type)
    V1 += einsum('ixyz,Iwyi,Xxwz->IX', t1_caaa, v_caac, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyz,Iwzi,Xxwy->IX', t1_caaa, v_caac, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('ixyz,IyiX,xz->IX', t1_caaa, v_caca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyz,Iyiw,Xzwx->IX', t1_caaa, v_caca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyz,Iyiz,Xx->IX', t1_caaa, v_caca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyz,IziX,xy->IX', t1_caaa, v_caca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('ixyz,Iziw,Xyxw->IX', t1_caaa, v_caca, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('ixyz,Iziy,Xx->IX', t1_caaa, v_caca, rdm_ca, optimize = einsum_type)
    V1 -= einsum('xXya,Iazw,xwyz->IX', t1_aaae, v_ceaa, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('xXya,Iazy,xz->IX', t1_aaae, v_ceaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xXya,Iyza,xz->IX', t1_aaae, v_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xXya,Izwa,xzyw->IX', t1_aaae, v_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('xa,IXay,xy->IX', t1_ae, v_caea, rdm_ca, optimize = einsum_type)
    V1 -= einsum('xa,IXya,xy->IX', t1_ae, v_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xa,IayX,xy->IX', t1_ae, v_ceaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xa,Iayz,Xyxz->IX', t1_ae, v_ceaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xa,IyaX,xy->IX', t1_ae, v_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xa,Iyaz,Xxyz->IX', t1_ae, v_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xa,Iyza,Xzyx->IX', t1_ae, v_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyXa,Izaw,xyzw->IX', t1_aaae, v_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('xyza,IXaw,zwxy->IX', t1_aaae, v_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('xyza,IXwa,zwxy->IX', t1_aaae, v_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyza,IawX,zwxy->IX', t1_aaae, v_ceaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyza,Iawu,Xzwyxu->IX', t1_aaae, v_ceaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyza,Iawz,Xwyx->IX', t1_aaae, v_ceaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyza,IwaX,zwxy->IX', t1_aaae, v_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyza,Iwau,Xyxwuz->IX', t1_aaae, v_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyza,Iwua,Xzuwxy->IX', t1_aaae, v_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyza,Iwua,Xzuwyx->IX', t1_aaae, v_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyza,Iwua,Xzuxwy->IX', t1_aaae, v_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyza,Iwua,Xzuxyw->IX', t1_aaae, v_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyza,Iwua,Xzuywx->IX', t1_aaae, v_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyza,Iwua,Xzuyxw->IX', t1_aaae, v_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyza,Izwa,Xwxy->IX', t1_aaae, v_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 2 * einsum('Xxyz,iy,Iixz->IX', v_aaaa, t1_ca, t1_ccaa, optimize = einsum_type)
    V1 += einsum('Xxyz,iy,Iizx->IX', v_aaaa, t1_ca, t1_ccaa, optimize = einsum_type)
    V1 -= 2 * einsum('xyzw,Iixz,iXwy->IX', v_aaaa, t1_ccaa, t1_caaa, optimize = einsum_type)
    V1 += einsum('xyzw,Iixz,iXyw->IX', v_aaaa, t1_ccaa, t1_caaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('I,Ia,Xxya,xy->IX', e_core, t1_ce, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('I,Ia,xXya,xy->IX', e_core, t1_ce, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('I,Ia,xa,Xx->IX', e_core, t1_ce, t1_ae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('I,Ia,xyza,Xzyx->IX', e_core, t1_ce, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('I,IiXa,ixay,xy->IX', e_core, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,IiXa,ixya,xy->IX', e_core, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,IiXx,iy,xy->IX', e_core, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += einsum('I,IiXx,iyxz,yz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,IiXx,iyzw,xyzw->IX', e_core, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,IiXx,iyzx,yz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('I,IixX,iy,xy->IX', e_core, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,IixX,iyxz,yz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('I,IixX,iyzw,xyzw->IX', e_core, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('I,IixX,iyzx,yz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,Iixa,iXay,xy->IX', e_core, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('I,Iixa,iXya,xy->IX', e_core, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,Iixa,ia,Xx->IX', e_core, t1_ccae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,Iixa,iyax,Xy->IX', e_core, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,Iixa,iyaz,Xzxy->IX', e_core, t1_ccae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('I,Iixa,iyxa,Xy->IX', e_core, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('I,Iixa,iyza,Xzxy->IX', e_core, t1_ccae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('I,Iixy,iXxz,yz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,Iixy,iXyz,xz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('I,Iixy,iXzw,xywz->IX', e_core, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,Iixy,iXzx,yz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('I,Iixy,iXzy,xz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('I,Iixy,ix,Xy->IX', e_core, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,Iixy,iy,Xx->IX', e_core, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('I,Iixy,iz,Xzxy->IX', e_core, t1_ccaa, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('I,Iixy,izwu,Xwuxyz->IX', e_core, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('I,Iixy,izwx,Xwzy->IX', e_core, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('I,Iixy,izwy,Xwxz->IX', e_core, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('I,Iixy,izxw,Xwyz->IX', e_core, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('I,Iixy,izxy,Xz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,Iixy,izyw,Xwxz->IX', e_core, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,Iixy,izyx,Xz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('I,IxXa,ya,xy->IX', e_core, t1_caae, t1_ae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('I,IxXa,yzwa,xwzy->IX', e_core, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('I,IxaX,ya,xy->IX', e_core, t1_caea, t1_ae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('I,IxaX,yzwa,xwzy->IX', e_core, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('I,Ixay,Xa,xy->IX', e_core, t1_caea, t1_ae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('I,Ixay,Xzwa,xwyz->IX', e_core, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('I,Ixay,Xzya,xz->IX', e_core, t1_caea, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('I,Ixay,zXwa,xwyz->IX', e_core, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('I,Ixay,zXya,xz->IX', e_core, t1_caea, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('I,Ixay,za,Xxzy->IX', e_core, t1_caea, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('I,Ixay,zwua,Xxuwyz->IX', e_core, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('I,Ixay,zwua,Xxuwzy->IX', e_core, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('I,Ixay,zwua,Xxuywz->IX', e_core, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('I,Ixay,zwua,Xxuyzw->IX', e_core, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('I,Ixay,zwua,Xxuzwy->IX', e_core, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('I,Ixay,zwua,Xxuzyw->IX', e_core, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('I,Ixay,zwya,Xxwz->IX', e_core, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('I,Ixya,Xa,xy->IX', e_core, t1_caae, t1_ae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('I,Ixya,Xzwa,xwzy->IX', e_core, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('I,Ixya,Xzya,xz->IX', e_core, t1_caae, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('I,Ixya,zXwa,xwyz->IX', e_core, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('I,Ixya,zXya,xz->IX', e_core, t1_caae, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('I,Ixya,za,Xxyz->IX', e_core, t1_caae, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('I,Ixya,zwua,Xxuywz->IX', e_core, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('I,Ixya,zwya,Xxzw->IX', e_core, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,iIXa,ixay,xy->IX', e_core, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('I,iIXa,ixya,xy->IX', e_core, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('I,iIxa,iXay,xy->IX', e_core, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,iIxa,iXya,xy->IX', e_core, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('I,iIxa,ia,Xx->IX', e_core, t1_ccae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('I,iIxa,iyax,Xy->IX', e_core, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('I,iIxa,iyaz,Xzxy->IX', e_core, t1_ccae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('I,iIxa,iyxa,Xy->IX', e_core, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('I,iIxa,iyza,Xzyx->IX', e_core, t1_ccae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('a,Xa,Ixay,xy->IX', e_extern, t1_ae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('a,Xa,Ixya,xy->IX', e_extern, t1_ae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('a,Xxya,Ia,xy->IX', e_extern, t1_aaae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('a,Xxya,Izaw,xwyz->IX', e_extern, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('a,Xxya,Izay,xz->IX', e_extern, t1_aaae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('a,Xxya,Izwa,xwzy->IX', e_extern, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('a,Xxya,Izya,xz->IX', e_extern, t1_aaae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += einsum('a,iXax,Iiya,xy->IX', e_extern, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('a,iXax,iIya,xy->IX', e_extern, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('a,iXxa,Iiya,xy->IX', e_extern, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += einsum('a,iXxa,iIya,xy->IX', e_extern, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += einsum('a,ia,Iixa,Xx->IX', e_extern, t1_ce, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('a,ia,iIxa,Xx->IX', e_extern, t1_ce, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 2 * einsum('a,ixay,IiXa,yx->IX', e_extern, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += einsum('a,ixay,Iiya,Xx->IX', e_extern, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += einsum('a,ixay,Iiza,Xyzx->IX', e_extern, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('a,ixay,iIXa,yx->IX', e_extern, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('a,ixay,iIya,Xx->IX', e_extern, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('a,ixay,iIza,Xyzx->IX', e_extern, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('a,ixya,IiXa,yx->IX', e_extern, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('a,ixya,Iiya,Xx->IX', e_extern, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('a,ixya,Iiza,Xyzx->IX', e_extern, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('a,ixya,iIXa,yx->IX', e_extern, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += einsum('a,ixya,iIya,Xx->IX', e_extern, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('a,ixya,iIza,Xyxz->IX', e_extern, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('a,xXya,Ia,xy->IX', e_extern, t1_aaae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 -= einsum('a,xXya,Izaw,xwyz->IX', e_extern, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('a,xXya,Izay,xz->IX', e_extern, t1_aaae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('a,xXya,Izwa,xwyz->IX', e_extern, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('a,xXya,Izya,xz->IX', e_extern, t1_aaae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('a,xa,Ia,Xx->IX', e_extern, t1_ae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 -= einsum('a,xa,IyXa,xy->IX', e_extern, t1_ae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('a,xa,IyaX,xy->IX', e_extern, t1_ae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('a,xa,Iyaz,Xyxz->IX', e_extern, t1_ae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('a,xa,Iyza,Xyzx->IX', e_extern, t1_ae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('a,xyza,Ia,Xzyx->IX', e_extern, t1_aaae, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('a,xyza,IwXa,zwxy->IX', e_extern, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('a,xyza,IwaX,zwxy->IX', e_extern, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('a,xyza,Iwau,Xzwyxu->IX', e_extern, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('a,xyza,Iwaz,Xwyx->IX', e_extern, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/3 * einsum('a,xyza,Iwua,Xzwuxy->IX', e_extern, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('a,xyza,Iwua,Xzwuyx->IX', e_extern, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('a,xyza,Iwua,Xzwxuy->IX', e_extern, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('a,xyza,Iwua,Xzwxyu->IX', e_extern, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('a,xyza,Iwua,Xzwyux->IX', e_extern, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('a,xyza,Iwua,Xzwyxu->IX', e_extern, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('a,xyza,Iwza,Xwxy->IX', e_extern, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('i,IiXa,ixay,xy->IX', e_core, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,IiXa,ixya,xy->IX', e_core, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 -= einsum('i,IiXx,iy,xy->IX', e_core, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += einsum('i,IiXx,iyxz,yz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= einsum('i,IiXx,iyzw,xyzw->IX', e_core, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,IiXx,iyzx,yz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('i,IixX,iy,xy->IX', e_core, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,IixX,iyxz,yz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('i,IixX,iyzw,xyzw->IX', e_core, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('i,IixX,iyzx,yz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,Iixa,iXay,xy->IX', e_core, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,Iixa,iXya,xy->IX', e_core, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,Iixa,ia,Xx->IX', e_core, t1_ccae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,Iixa,iyax,Xy->IX', e_core, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,Iixa,iyaz,Xzxy->IX', e_core, t1_ccae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('i,Iixa,iyxa,Xy->IX', e_core, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,Iixa,iyza,Xzxy->IX', e_core, t1_ccae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('i,Iixy,iXxz,yz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,Iixy,iXyz,xz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('i,Iixy,iXzw,xywz->IX', e_core, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,Iixy,iXzx,yz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,Iixy,iXzy,xz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,Iixy,ix,Xy->IX', e_core, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,Iixy,iy,Xx->IX', e_core, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('i,Iixy,iz,Xzxy->IX', e_core, t1_ccaa, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('i,Iixy,izwu,Xwuxyz->IX', e_core, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('i,Iixy,izwx,Xwzy->IX', e_core, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('i,Iixy,izwy,Xwxz->IX', e_core, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('i,Iixy,izxw,Xwyz->IX', e_core, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('i,Iixy,izxy,Xz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,Iixy,izyw,Xwxz->IX', e_core, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,Iixy,izyx,Xz->IX', e_core, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,iIXa,ixay,xy->IX', e_core, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,iIXa,ixya,xy->IX', e_core, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,iIxa,iXay,xy->IX', e_core, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,iIxa,iXya,xy->IX', e_core, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,iIxa,ia,Xx->IX', e_core, t1_ccae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,iIxa,iyax,Xy->IX', e_core, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,iIxa,iyaz,Xzxy->IX', e_core, t1_ccae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,iIxa,iyxa,Xy->IX', e_core, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,iIxa,iyza,Xzyx->IX', e_core, t1_ccae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,iXax,Iiya,xy->IX', e_core, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,iXax,iIya,xy->IX', e_core, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,iXxa,Iiya,xy->IX', e_core, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,iXxa,iIya,xy->IX', e_core, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,iXxy,Iixz,yz->IX', e_core, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,iXxy,Iiyz,xz->IX', e_core, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,iXxy,Iizx,yz->IX', e_core, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,iXxy,Iizy,xz->IX', e_core, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ia,Iixa,Xx->IX', e_core, t1_ce, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ia,iIxa,Xx->IX', e_core, t1_ce, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ix,Iixy,Xy->IX', e_core, t1_ca, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ix,Iiyx,Xy->IX', e_core, t1_ca, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('i,ixay,IiXa,xy->IX', e_core, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ixay,Iiya,Xx->IX', e_core, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ixay,Iiza,Xyzx->IX', e_core, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ixay,iIXa,xy->IX', e_core, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ixay,iIya,Xx->IX', e_core, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ixay,iIza,Xyzx->IX', e_core, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ixya,IiXa,xy->IX', e_core, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ixya,Iiya,Xx->IX', e_core, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ixya,Iiza,Xyzx->IX', e_core, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ixya,iIXa,xy->IX', e_core, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ixya,iIya,Xx->IX', e_core, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ixya,iIza,Xyxz->IX', e_core, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('i,ixyz,IiXy,xz->IX', e_core, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ixyz,IiXz,xy->IX', e_core, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ixyz,Iiwy,Xzwx->IX', e_core, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ixyz,Iiwz,Xywx->IX', e_core, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ixyz,IiyX,xz->IX', e_core, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ixyz,Iiyw,Xzwx->IX', e_core, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ixyz,Iiyz,Xx->IX', e_core, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ixyz,IizX,xy->IX', e_core, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('i,ixyz,Iizw,Xyxw->IX', e_core, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('i,ixyz,Iizy,Xx->IX', e_core, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= einsum('Xx,Iixa,iyaz,yz->IX', h_aa, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xx,Iixa,iyza,yz->IX', h_aa, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xx,Iixy,iz,yz->IX', h_aa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xx,Iixy,izwu,yzwu->IX', h_aa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xx,Iixy,izwy,zw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= einsum('Xx,Iixy,izyw,zw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xx,Iiyx,iz,yz->IX', h_aa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xx,Iiyx,izwu,yzwu->IX', h_aa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xx,Iiyx,izwy,zw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xx,Iiyx,izyw,zw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xx,Iyax,za,yz->IX', h_aa, t1_caea, t1_ae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xx,Iyax,zwua,yuwz->IX', h_aa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xx,Iyxa,za,yz->IX', h_aa, t1_caae, t1_ae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xx,Iyxa,zwua,yuwz->IX', h_aa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xx,iIxa,iyaz,yz->IX', h_aa, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xx,iIxa,iyza,yz->IX', h_aa, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xx,ixay,Iiza,yz->IX', h_aa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xx,ixay,iIza,yz->IX', h_aa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xx,ixya,Iiza,yz->IX', h_aa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xx,ixya,iIza,yz->IX', h_aa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xx,ixyz,Iiwu,zywu->IX', h_aa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xx,ixyz,Iiwy,zw->IX', h_aa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xx,ixyz,Iiwz,yw->IX', h_aa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xx,ixyz,Iiyw,zw->IX', h_aa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xx,ixyz,Iizw,yw->IX', h_aa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xx,xa,Iyaz,yz->IX', h_aa, t1_ae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xx,xa,Iyza,yz->IX', h_aa, t1_ae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xx,xyza,Ia,yz->IX', h_aa, t1_aaae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xx,xyza,Iwau,yuzw->IX', h_aa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xx,xyza,Iwaz,yw->IX', h_aa, t1_aaae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xx,xyza,Iwua,yuwz->IX', h_aa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xx,xyza,Iwza,yw->IX', h_aa, t1_aaae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xx,yxza,Ia,yz->IX', h_aa, t1_aaae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xx,yxza,Iwau,yuzw->IX', h_aa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xx,yxza,Iwaz,yw->IX', h_aa, t1_aaae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xx,yxza,Iwua,yuzw->IX', h_aa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xx,yxza,Iwza,yw->IX', h_aa, t1_aaae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,IiXx,iz,yz->IX', h_aa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,IiXx,izwu,yzwu->IX', h_aa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xy,IiXx,izwy,wz->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 2 * einsum('xy,IiXx,izyw,wz->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,IixX,iz,yz->IX', h_aa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,IixX,izwu,yzwu->IX', h_aa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,IixX,izwy,wz->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xy,IixX,izyw,wz->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,Iixa,iXaz,yz->IX', h_aa, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Iixa,iXza,yz->IX', h_aa, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,Iixa,ia,Xy->IX', h_aa, t1_ccae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,Iixa,izaw,Xwyz->IX', h_aa, t1_ccae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xy,Iixa,izay,Xz->IX', h_aa, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Iixa,izwa,Xwyz->IX', h_aa, t1_ccae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,Iixa,izya,Xz->IX', h_aa, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Iixz,iXwu,yzuw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xy,Iixz,iXwy,zw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Iixz,iXwz,yw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,Iixz,iXyw,zw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,Iixz,iXzw,yw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Iixz,iw,Xwyz->IX', h_aa, t1_ccaa, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Iixz,iwuv,Xuvyzw->IX', h_aa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,Iixz,iwuy,Xuwz->IX', h_aa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Iixz,iwuz,Xuyw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,Iixz,iwyu,Xuzw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,Iixz,iwyz,Xw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,Iixz,iwzu,Xuyw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xy,Iixz,iwzy,Xw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,Iixz,iy,Xz->IX', h_aa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,Iixz,iz,Xy->IX', h_aa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Iizx,iXwu,yzwu->IX', h_aa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,Iizx,iXwy,zw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,Iizx,iXwz,yw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xy,Iizx,iXyw,zw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Iizx,iXzw,yw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Iizx,iw,Xwzy->IX', h_aa, t1_ccaa, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,Iizx,iwuv,Xuvwyz->IX', h_aa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,Iizx,iwuv,Xuvwzy->IX', h_aa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,Iizx,iwuv,Xuvywz->IX', h_aa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,Iizx,iwuv,Xuvyzw->IX', h_aa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,Iizx,iwuv,Xuvzwy->IX', h_aa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xy,Iizx,iwuv,Xuvzyw->IX', h_aa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,Iizx,iwuy,Xuzw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Iizx,iwuz,Xuwy->IX', h_aa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xy,Iizx,iwyu,Xuzw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xy,Iizx,iwyz,Xw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Iizx,iwzu,Xuyw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,Iizx,iwzy,Xw->IX', h_aa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xy,Iizx,iy,Xz->IX', h_aa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Iizx,iz,Xy->IX', h_aa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,IxXa,za,yz->IX', h_aa, t1_caae, t1_ae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,IxXa,zwua,yuwz->IX', h_aa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,IxaX,za,yz->IX', h_aa, t1_caea, t1_ae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,IxaX,zwua,yuwz->IX', h_aa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,Ixaz,Xa,yz->IX', h_aa, t1_caea, t1_ae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Ixaz,Xwua,yuzw->IX', h_aa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Ixaz,Xwza,yw->IX', h_aa, t1_caea, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,Ixaz,wXua,yuzw->IX', h_aa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,Ixaz,wXza,yw->IX', h_aa, t1_caea, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Ixaz,wa,Xywz->IX', h_aa, t1_caea, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,Ixaz,wuva,Xyvuwz->IX', h_aa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xy,Ixaz,wuva,Xyvuzw->IX', h_aa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,Ixaz,wuva,Xyvwuz->IX', h_aa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,Ixaz,wuva,Xyvwzu->IX', h_aa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,Ixaz,wuva,Xyvzuw->IX', h_aa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,Ixaz,wuva,Xyvzwu->IX', h_aa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Ixaz,wuza,Xyuw->IX', h_aa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Ixza,Xa,yz->IX', h_aa, t1_caae, t1_ae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Ixza,Xwua,yuwz->IX', h_aa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,Ixza,Xwza,yw->IX', h_aa, t1_caae, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Ixza,wXua,yuzw->IX', h_aa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Ixza,wXza,yw->IX', h_aa, t1_caae, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Ixza,wa,Xyzw->IX', h_aa, t1_caae, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Ixza,wuva,Xyvzuw->IX', h_aa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Ixza,wuza,Xywu->IX', h_aa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,Izax,Xa,yz->IX', h_aa, t1_caea, t1_ae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,Izax,Xwua,ywzu->IX', h_aa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,Izax,Xwya,zw->IX', h_aa, t1_caea, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,Izax,wXua,ywzu->IX', h_aa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('xy,Izax,wXya,zw->IX', h_aa, t1_caea, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,Izax,wa,Xzwy->IX', h_aa, t1_caea, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,Izax,wuva,Xzvuwy->IX', h_aa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xy,Izax,wuva,Xzvuyw->IX', h_aa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,Izax,wuva,Xzvwuy->IX', h_aa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,Izax,wuva,Xzvwyu->IX', h_aa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,Izax,wuva,Xzvyuw->IX', h_aa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,Izax,wuva,Xzvywu->IX', h_aa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,Izax,wuya,Xzuw->IX', h_aa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,Izxa,Xa,yz->IX', h_aa, t1_caae, t1_ae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,Izxa,Xwua,ywuz->IX', h_aa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('xy,Izxa,Xwya,zw->IX', h_aa, t1_caae, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,Izxa,wXua,ywzu->IX', h_aa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,Izxa,wXya,zw->IX', h_aa, t1_caae, t1_aaae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,Izxa,wa,Xzyw->IX', h_aa, t1_caae, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,Izxa,wuva,Xzvyuw->IX', h_aa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,Izxa,wuya,Xzwu->IX', h_aa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Xxza,Ia,yz->IX', h_aa, t1_aaae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Xxza,Iwau,yuzw->IX', h_aa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Xxza,Iwaz,yw->IX', h_aa, t1_aaae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,Xxza,Iwua,yuwz->IX', h_aa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,Xxza,Iwza,yw->IX', h_aa, t1_aaae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,Xzxa,Ia,yz->IX', h_aa, t1_aaae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,Xzxa,Iwau,ywzu->IX', h_aa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,Xzxa,Iwua,ywuz->IX', h_aa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,iIxa,iXaz,yz->IX', h_aa, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,iIxa,iXza,yz->IX', h_aa, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,iIxa,ia,Xy->IX', h_aa, t1_ccae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,iIxa,izaw,Xwyz->IX', h_aa, t1_ccae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,iIxa,izay,Xz->IX', h_aa, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,iIxa,izwa,Xwzy->IX', h_aa, t1_ccae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xy,iIxa,izya,Xz->IX', h_aa, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,iXax,Iiza,yz->IX', h_aa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,iXax,iIza,yz->IX', h_aa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,iXxa,Iiza,yz->IX', h_aa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,iXxa,iIza,yz->IX', h_aa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,iXxz,Iiwu,yzuw->IX', h_aa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,iXxz,Iiwz,yw->IX', h_aa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,iXxz,Iizw,yw->IX', h_aa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,iXzx,Iiwu,yzwu->IX', h_aa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,iXzx,Iiwz,yw->IX', h_aa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,iXzx,Iizw,yw->IX', h_aa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,ix,IiXz,yz->IX', h_aa, t1_ca, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,ix,IizX,yz->IX', h_aa, t1_ca, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,ix,Iizw,Xyzw->IX', h_aa, t1_ca, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xy,ixaz,IiXa,yz->IX', h_aa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,ixaz,Iiwa,Xzwy->IX', h_aa, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,ixaz,Iiza,Xy->IX', h_aa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,ixaz,iIXa,yz->IX', h_aa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,ixaz,iIwa,Xzwy->IX', h_aa, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,ixaz,iIza,Xy->IX', h_aa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,ixza,IiXa,yz->IX', h_aa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,ixza,Iiwa,Xzwy->IX', h_aa, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,ixza,Iiza,Xy->IX', h_aa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,ixza,iIXa,yz->IX', h_aa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,ixza,iIwa,Xzyw->IX', h_aa, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,ixza,iIza,Xy->IX', h_aa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,ixzw,IiXu,yuwz->IX', h_aa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,ixzw,IiXw,yz->IX', h_aa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xy,ixzw,IiXz,yw->IX', h_aa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,ixzw,IiuX,yuwz->IX', h_aa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,ixzw,Iiuv,Xwzuyv->IX', h_aa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,ixzw,Iiuw,Xzuy->IX', h_aa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,ixzw,Iiuz,Xwuy->IX', h_aa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,ixzw,IiwX,yz->IX', h_aa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,ixzw,Iiwu,Xzyu->IX', h_aa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,ixzw,Iiwz,Xy->IX', h_aa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,ixzw,IizX,yw->IX', h_aa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,ixzw,Iizu,Xwuy->IX', h_aa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,ixzw,Iizw,Xy->IX', h_aa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= einsum('xy,izax,IiXa,yz->IX', h_aa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,izax,Iiwa,Xywz->IX', h_aa, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,izax,iIXa,yz->IX', h_aa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,izax,iIwa,Xywz->IX', h_aa, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,izwx,IiXu,ywzu->IX', h_aa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('xy,izwx,IiXw,yz->IX', h_aa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,izwx,IiuX,ywzu->IX', h_aa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,izwx,Iiuv,Xywuvz->IX', h_aa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xy,izwx,Iiuv,Xywuzv->IX', h_aa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,izwx,Iiuv,Xywvuz->IX', h_aa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,izwx,Iiuv,Xywvzu->IX', h_aa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,izwx,Iiuv,Xywzuv->IX', h_aa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,izwx,Iiuv,Xywzvu->IX', h_aa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,izwx,Iiuw,Xyuz->IX', h_aa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,izwx,IiwX,yz->IX', h_aa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,izwx,Iiwu,Xyuz->IX', h_aa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,izxa,IiXa,yz->IX', h_aa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,izxa,Iiwa,Xywz->IX', h_aa, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,izxa,iIXa,yz->IX', h_aa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,izxa,iIwa,Xyzw->IX', h_aa, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,izxw,IiXu,ywuz->IX', h_aa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,izxw,IiXw,yz->IX', h_aa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,izxw,IiuX,ywuz->IX', h_aa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,izxw,Iiuv,Xywuvz->IX', h_aa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,izxw,Iiuw,Xyuz->IX', h_aa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,izxw,IiwX,yz->IX', h_aa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,izxw,Iiwu,Xyzu->IX', h_aa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,xXza,Ia,yz->IX', h_aa, t1_aaae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,xXza,Iwau,yuzw->IX', h_aa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,xXza,Iwaz,yw->IX', h_aa, t1_aaae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,xXza,Iwua,yuzw->IX', h_aa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,xXza,Iwza,yw->IX', h_aa, t1_aaae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,xa,Ia,Xy->IX', h_aa, t1_ae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,xa,IzXa,yz->IX', h_aa, t1_ae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,xa,IzaX,yz->IX', h_aa, t1_ae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,xa,Izaw,Xzyw->IX', h_aa, t1_ae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,xa,Izwa,Xzwy->IX', h_aa, t1_ae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,xzwa,Ia,Xwzy->IX', h_aa, t1_aaae, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,xzwa,IuXa,yzwu->IX', h_aa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,xzwa,IuaX,yzwu->IX', h_aa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,xzwa,Iuav,Xwuvyz->IX', h_aa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,xzwa,Iuav,Xwuvzy->IX', h_aa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,xzwa,Iuav,Xwuyvz->IX', h_aa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,xzwa,Iuav,Xwuyzv->IX', h_aa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,xzwa,Iuav,Xwuzvy->IX', h_aa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xy,xzwa,Iuav,Xwuzyv->IX', h_aa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,xzwa,Iuaw,Xuzy->IX', h_aa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,xzwa,Iuva,Xwuvyz->IX', h_aa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,xzwa,Iuwa,Xuyz->IX', h_aa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,zXxa,Ia,yz->IX', h_aa, t1_aaae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,zXxa,Iwau,ywzu->IX', h_aa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,zXxa,Iwua,ywzu->IX', h_aa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,zwxa,Ia,Xywz->IX', h_aa, t1_aaae, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xy,zwxa,IuXa,yuzw->IX', h_aa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,zwxa,IuaX,yuzw->IX', h_aa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xy,zwxa,Iuav,Xyuwzv->IX', h_aa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,zwxa,Iuva,Xyuvwz->IX', h_aa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xy,zwxa,Iuva,Xyuvzw->IX', h_aa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,zwxa,Iuva,Xyuwvz->IX', h_aa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,zwxa,Iuva,Xyuwzv->IX', h_aa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,zwxa,Iuva,Xyuzvw->IX', h_aa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xy,zwxa,Iuva,Xyuzwv->IX', h_aa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,zxwa,Ia,Xwyz->IX', h_aa, t1_aaae, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xy,zxwa,IuXa,yzuw->IX', h_aa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,zxwa,IuaX,yzuw->IX', h_aa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,zxwa,Iuav,Xwuyzv->IX', h_aa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,zxwa,Iuaw,Xuyz->IX', h_aa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,zxwa,Iuva,Xwuvyz->IX', h_aa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xy,zxwa,Iuva,Xwuvzy->IX', h_aa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,zxwa,Iuva,Xwuyvz->IX', h_aa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,zxwa,Iuva,Xwuyzv->IX', h_aa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,zxwa,Iuva,Xwuzvy->IX', h_aa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xy,zxwa,Iuva,Xwuzyv->IX', h_aa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xy,zxwa,Iuwa,Xuzy->IX', h_aa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('ix,Iiyz,yz,Xx->IX', t1_ca, v_ccaa, rdm_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('ix,Iyzi,zy,Xx->IX', t1_ca, v_caac, rdm_ca, rdm_ca, optimize = einsum_type)
    V1 -= einsum('ixXy,Iizw,zw,yx->IX', t1_caaa, v_ccaa, rdm_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('ixXy,Izwi,wz,yx->IX', t1_caaa, v_caac, rdm_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('ixyX,Iizw,zw,yx->IX', t1_caaa, v_ccaa, rdm_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('ixyX,Izwi,wz,yx->IX', t1_caaa, v_caac, rdm_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('ixyz,Iiwu,wu,Xxyz->IX', t1_caaa, v_ccaa, rdm_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('ixyz,Iwui,uw,Xxyz->IX', t1_caaa, v_caac, rdm_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iiwx,iu,ywzu->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iiwx,iuvs,ywuzvs->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iiwx,iuvw,yuzv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,Iiwx,iuwv,yuzv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,Iiwx,iw,yz->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,Iiwx,izuv,ywvu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,Iiwx,izuw,yu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,Iiwx,izwu,yu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iiwz,iu,ywux->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,Iiwz,iuvs,ywusvx->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,Iiwz,iuvs,ywusxv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,Iiwz,iuvs,ywuvsx->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('Xxyz,Iiwz,iuvs,ywuvxs->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,Iiwz,iuvs,ywuxsv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,Iiwz,iuvs,ywuxvs->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iiwz,iuvw,yuvx->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iiwz,iuwv,yuxv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iiwz,iw,yx->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= einsum('Xxyz,Iixa,ia,yz->IX', v_aaaa, t1_ccae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 -= einsum('Xxyz,Iixa,iwau,ywzu->IX', v_aaaa, t1_ccae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,Iixa,iwua,ywzu->IX', v_aaaa, t1_ccae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('Xxyz,Iixa,izaw,yw->IX', v_aaaa, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,Iixa,izwa,yw->IX', v_aaaa, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,Iixw,iu,ywzu->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,Iixw,iuvs,ywuzvs->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,Iixw,iuvw,yuzv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('Xxyz,Iixw,iuwv,yuzv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('Xxyz,Iixw,iw,yz->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,Iixw,izuv,ywvu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,Iixw,izuw,yu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('Xxyz,Iixw,izwu,yu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,Iixz,iw,yw->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,Iixz,iwuv,ywuv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,Iiza,ia,yx->IX', v_aaaa, t1_ccae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,Iiza,iwau,ywxu->IX', v_aaaa, t1_ccae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iiza,iwua,ywxu->IX', v_aaaa, t1_ccae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iizw,iu,ywxu->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iizw,iuvs,ywuxvs->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iizw,iuvw,yuxv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,Iizw,iuwv,yuxv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,Iizw,iw,yx->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iizx,iw,yw->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iizx,iwuv,ywuv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,Iwax,ua,yuzw->IX', v_aaaa, t1_caea, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,Iwax,uvsa,yvuzws->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iwax,uzva,yuwv->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iwax,za,yw->IX', v_aaaa, t1_caea, t1_ae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iwax,zuva,yuvw->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,Iwaz,ua,yuwx->IX', v_aaaa, t1_caea, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('Xxyz,Iwaz,uvsa,yvuswx->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('Xxyz,Iwaz,uvsa,yvusxw->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('Xxyz,Iwaz,uvsa,yvuwsx->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('Xxyz,Iwaz,uvsa,yvuwxs->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('Xxyz,Iwaz,uvsa,yvuxsw->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('Xxyz,Iwaz,uvsa,yvuxws->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,Iwxa,ua,yuzw->IX', v_aaaa, t1_caae, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,Iwxa,uvsa,yvuzws->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,Iwxa,uzva,yuwv->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,Iwxa,za,yw->IX', v_aaaa, t1_caae, t1_ae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,Iwxa,zuva,yuvw->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,Iwza,ua,yuxw->IX', v_aaaa, t1_caae, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,Iwza,uvsa,yvuxws->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iyaw,ua,xzuw->IX', v_aaaa, t1_caea, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,Iyaw,uvsa,xzsuvw->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,Iyaw,uvsa,xzsuwv->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,Iyaw,uvsa,xzsvuw->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('Xxyz,Iyaw,uvsa,xzsvwu->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,Iyaw,uvsa,xzswuv->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,Iyaw,uvsa,xzswvu->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iyaw,uvwa,xzvu->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iywa,ua,xzwu->IX', v_aaaa, t1_caae, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iywa,uvsa,xzswvu->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,Iywa,uvwa,xzuv->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,iIxa,ia,yz->IX', v_aaaa, t1_ccae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,iIxa,iwau,ywzu->IX', v_aaaa, t1_ccae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,iIxa,iwua,ywzu->IX', v_aaaa, t1_ccae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,iIxa,izaw,yw->IX', v_aaaa, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,iIxa,izwa,yw->IX', v_aaaa, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,iIza,ia,yx->IX', v_aaaa, t1_ccae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,iIza,iwau,ywxu->IX', v_aaaa, t1_ccae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,iIza,iwua,ywux->IX', v_aaaa, t1_ccae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,iway,Iiua,xzuw->IX', v_aaaa, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 2 * einsum('Xxyz,iway,Iixa,zw->IX', v_aaaa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += einsum('Xxyz,iway,Iiza,xw->IX', v_aaaa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,iway,iIua,xzuw->IX', v_aaaa, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('Xxyz,iway,iIxa,zw->IX', v_aaaa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,iway,iIza,xw->IX', v_aaaa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,iwuy,Iiuv,xzvw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('Xxyz,iwuy,Iiux,zw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,iwuy,Iiuz,xw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,iwuy,Iivs,xzusvw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,iwuy,Iivs,xzuswv->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,iwuy,Iivs,xzuvsw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('Xxyz,iwuy,Iivs,xzuvws->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,iwuy,Iivs,xzuwsv->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,iwuy,Iivs,xzuwvs->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,iwuy,Iivu,xzvw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,iwuy,Iivx,zuwv->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,iwuy,Iivz,xuvw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 2 * einsum('Xxyz,iwuy,Iixu,zw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('Xxyz,iwuy,Iixv,zuwv->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('Xxyz,iwuy,Iixz,uw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('Xxyz,iwuy,Iizu,xw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,iwuy,Iizv,xuwv->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,iwuy,Iizx,uw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,iwya,Iiua,xzuw->IX', v_aaaa, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('Xxyz,iwya,Iixa,zw->IX', v_aaaa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,iwya,Iiza,xw->IX', v_aaaa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,iwya,iIua,xzwu->IX', v_aaaa, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,iwya,iIxa,zw->IX', v_aaaa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += einsum('Xxyz,iwya,iIza,xw->IX', v_aaaa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,iwyu,Iiuv,xzwv->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,iwyu,Iiux,zw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('Xxyz,iwyu,Iiuz,xw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,iwyu,Iivs,xzuvsw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,iwyu,Iivu,xzvw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,iwyu,Iivx,zuvw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('Xxyz,iwyu,Iivz,xuvw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('Xxyz,iwyu,Iixu,zw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('Xxyz,iwyu,Iixv,zuvw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 2 * einsum('Xxyz,iwyu,Iixz,uw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,iwyu,Iizu,xw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,iwyu,Iizv,xuvw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('Xxyz,iwyu,Iizx,uw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,ixaw,Iiua,yuzw->IX', v_aaaa, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('Xxyz,ixaw,Iiwa,yz->IX', v_aaaa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,ixaw,Iiza,yw->IX', v_aaaa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,ixaw,iIua,yuzw->IX', v_aaaa, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,ixaw,iIwa,yz->IX', v_aaaa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,ixaw,iIza,yw->IX', v_aaaa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,ixwa,Iiua,yuzw->IX', v_aaaa, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,ixwa,Iiwa,yz->IX', v_aaaa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,ixwa,Iiza,yw->IX', v_aaaa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,ixwa,iIua,yuzw->IX', v_aaaa, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('Xxyz,ixwa,iIwa,yz->IX', v_aaaa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,ixwa,iIza,yw->IX', v_aaaa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,ixwu,Iiuv,yvzw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('Xxyz,ixwu,Iiuw,yz->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,ixwu,Iiuz,yw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/12 * einsum('Xxyz,ixwu,Iivs,yvsuwz->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('Xxyz,ixwu,Iivs,yvsuzw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('Xxyz,ixwu,Iivs,yvswuz->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('Xxyz,ixwu,Iivs,yvswzu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('Xxyz,ixwu,Iivs,yvszuw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('Xxyz,ixwu,Iivs,yvszwu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,ixwu,Iivu,yvzw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,ixwu,Iivw,yvzu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,ixwu,Iivz,yvwu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,ixwu,Iiwu,yz->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,ixwu,Iiwv,yvzu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,ixwu,Iiwz,yu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,ixwu,Iizu,yw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,ixwu,Iizv,yvuw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,ixwu,Iizw,yu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,iy,Iiwu,xzwu->IX', v_aaaa, t1_ca, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,iy,Iiwx,zw->IX', v_aaaa, t1_ca, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('Xxyz,iy,Iiwz,xw->IX', v_aaaa, t1_ca, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('Xxyz,iy,Iixw,zw->IX', v_aaaa, t1_ca, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,iy,Iizw,xw->IX', v_aaaa, t1_ca, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,izaw,Iiua,yuwx->IX', v_aaaa, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,izaw,Iiwa,yx->IX', v_aaaa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,izaw,iIua,yuwx->IX', v_aaaa, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,izaw,iIwa,yx->IX', v_aaaa, t1_caea, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,izwa,Iiua,yuwx->IX', v_aaaa, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,izwa,Iiwa,yx->IX', v_aaaa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,izwa,iIua,yuxw->IX', v_aaaa, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,izwa,iIwa,yx->IX', v_aaaa, t1_caae, t1_ccae, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,izwu,Iiuv,yvxw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,izwu,Iiuw,yx->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,izwu,Iivs,yvsuxw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,izwu,Iivu,yvwx->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('Xxyz,izwu,Iivw,yvux->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,izwu,Iiwu,yx->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,izwu,Iiwv,yvux->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,wuya,Ia,xzuw->IX', v_aaaa, t1_aaae, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('Xxyz,wuya,Ivas,xzvuws->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,wuya,Ivax,zvwu->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,wuya,Ivaz,xvuw->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('Xxyz,wuya,Ivsa,xzvsuw->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('Xxyz,wuya,Ivsa,xzvswu->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('Xxyz,wuya,Ivsa,xzvusw->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('Xxyz,wuya,Ivsa,xzvuws->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('Xxyz,wuya,Ivsa,xzvwsu->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('Xxyz,wuya,Ivsa,xzvwus->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= einsum('Xxyz,wuya,Ivxa,zvwu->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,wuya,Ivza,xvwu->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,wxua,Ia,ywzu->IX', v_aaaa, t1_aaae, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,wxua,Ivas,ywszuv->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,wxua,Ivau,ywzv->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,wxua,Ivaz,ywvu->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,wxua,Ivsa,ywszuv->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,wxua,Ivua,ywzv->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,wxua,Ivza,ywvu->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,wzua,Ia,ywxu->IX', v_aaaa, t1_aaae, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,wzua,Ivas,ywsxuv->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,wzua,Ivau,ywxv->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,wzua,Ivsa,ywsuvx->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,wzua,Ivsa,ywsuxv->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('Xxyz,wzua,Ivsa,ywsvux->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,wzua,Ivsa,ywsvxu->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,wzua,Ivsa,ywsxuv->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,wzua,Ivsa,ywsxvu->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,wzua,Ivua,ywvx->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,xa,Ia,yz->IX', v_aaaa, t1_ae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,xa,Iwau,yuzw->IX', v_aaaa, t1_ae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,xa,Iwaz,yw->IX', v_aaaa, t1_ae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,xa,Iwua,yuzw->IX', v_aaaa, t1_ae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,xa,Iwza,yw->IX', v_aaaa, t1_ae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,xwua,Ia,ywzu->IX', v_aaaa, t1_aaae, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,xwua,Ivas,ywszuv->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,xwua,Ivau,ywzv->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,xwua,Ivaz,ywvu->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,xwua,Ivsa,ywsuvz->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,xwua,Ivsa,ywsuzv->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,xwua,Ivsa,ywsvuz->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,xwua,Ivsa,ywsvzu->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,xwua,Ivsa,ywszuv->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('Xxyz,xwua,Ivsa,ywszvu->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,xwua,Ivua,ywzv->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,xwua,Ivza,ywuv->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,xzwa,Ia,yw->IX', v_aaaa, t1_aaae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,xzwa,Iuav,yvwu->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,xzwa,Iuaw,yu->IX', v_aaaa, t1_aaae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,xzwa,Iuva,yvuw->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,xzwa,Iuwa,yu->IX', v_aaaa, t1_aaae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,za,Ia,yx->IX', v_aaaa, t1_ae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,za,Iwau,yuxw->IX', v_aaaa, t1_ae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,za,Iwua,yuwx->IX', v_aaaa, t1_ae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,zwua,Ia,ywux->IX', v_aaaa, t1_aaae, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,zwua,Ivas,ywsuvx->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('Xxyz,zwua,Ivas,ywsuxv->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,zwua,Ivas,ywsvux->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,zwua,Ivas,ywsvxu->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,zwua,Ivas,ywsxuv->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('Xxyz,zwua,Ivas,ywsxvu->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,zwua,Ivau,ywvx->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,zwua,Ivsa,ywsuvx->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,zwua,Ivua,ywxv->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,zxwa,Ia,yw->IX', v_aaaa, t1_aaae, t1_ce, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,zxwa,Iuav,yvwu->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('Xxyz,zxwa,Iuaw,yu->IX', v_aaaa, t1_aaae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,zxwa,Iuva,yvwu->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('Xxyz,zxwa,Iuwa,yu->IX', v_aaaa, t1_aaae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,IiXx,iu,zuwy->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,IiXx,iuvs,zvsuwy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,IiXx,iuvs,zvsuyw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,IiXx,iuvs,zvswuy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,IiXx,iuvs,zvswyu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,IiXx,iuvs,zvsyuw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,IiXx,iuvs,zvsywu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += einsum('xyzw,IiXx,iuvw,zvuy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,IiXx,iuvy,zvwu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,IiXx,iuwv,zvyu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,IiXx,iuwy,zu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 2 * einsum('xyzw,IiXx,iuyv,zvwu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 2 * einsum('xyzw,IiXx,iuyw,zu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xyzw,IiXx,iw,zy->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 2 * einsum('xyzw,IiXx,iy,zw->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,IiXx,izuv,ywuv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iiux,iXuv,zvwy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iiux,iXuw,zy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xyzw,Iiux,iXuy,zw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iiux,iXvs,zsvuwy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iiux,iXvs,zsvuyw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iiux,iXvs,zsvwuy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iiux,iXvs,zsvwyu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iiux,iXvs,zsvyuw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iiux,iXvs,zsvywu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Iiux,iXvu,zvwy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iiux,iXvw,zvuy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iiux,iXvy,zvwu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,Iiux,iXwu,zy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iiux,iXwv,zvyu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iiux,iXwy,zu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 2 * einsum('xyzw,Iiux,iXyu,zw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xyzw,Iiux,iXyv,zvwu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,Iiux,iXyw,zu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iiux,iu,Xzyw->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iiux,iv,Xzvuwy->IX', v_aaaa, t1_ccaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iiux,iv,Xzvuyw->IX', v_aaaa, t1_ccaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iiux,iv,Xzvwuy->IX', v_aaaa, t1_ccaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iiux,iv,Xzvwyu->IX', v_aaaa, t1_ccaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iiux,iv,Xzvyuw->IX', v_aaaa, t1_ccaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iiux,iv,Xzvywu->IX', v_aaaa, t1_ccaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/240 * einsum('xyzw,Iiux,ivst,Xzstuvwy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/240 * einsum('xyzw,Iiux,ivst,Xzstuvyw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/120 * einsum('xyzw,Iiux,ivst,Xzstuwvy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/60 * einsum('xyzw,Iiux,ivst,Xzstuwyv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/120 * einsum('xyzw,Iiux,ivst,Xzstuyvw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 2/15 * einsum('xyzw,Iiux,ivst,Xzstuywv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/120 * einsum('xyzw,Iiux,ivst,Xzstvwuy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/120 * einsum('xyzw,Iiux,ivst,Xzstvwyu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/120 * einsum('xyzw,Iiux,ivst,Xzstvyuw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/120 * einsum('xyzw,Iiux,ivst,Xzstvywu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/30 * einsum('xyzw,Iiux,ivst,Xzstwuvy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 11/120 * einsum('xyzw,Iiux,ivst,Xzstwuyv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/240 * einsum('xyzw,Iiux,ivst,Xzstwvuy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/240 * einsum('xyzw,Iiux,ivst,Xzstwvyu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/10 * einsum('xyzw,Iiux,ivst,Xzstwyuv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/40 * einsum('xyzw,Iiux,ivst,Xzstwyvu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 3/40 * einsum('xyzw,Iiux,ivst,Xzstyuvw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/20 * einsum('xyzw,Iiux,ivst,Xzstyuwv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 17/240 * einsum('xyzw,Iiux,ivst,Xzstyvuw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 17/240 * einsum('xyzw,Iiux,ivst,Xzstyvwu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/120 * einsum('xyzw,Iiux,ivst,Xzstywuv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/15 * einsum('xyzw,Iiux,ivst,Xzstywvu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iiux,ivsu,Xzsvwy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iiux,ivsu,Xzsvyw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iiux,ivsu,Xzswvy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iiux,ivsu,Xzswyv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iiux,ivsu,Xzsyvw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iiux,ivsu,Xzsywv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iiux,ivsw,Xzsuvy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iiux,ivsy,Xzsuvw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,Iiux,ivsy,Xzsuwv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iiux,ivsy,Xzsvuw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iiux,ivsy,Xzsvwu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iiux,ivsy,Xzswuv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iiux,ivsy,Xzswvu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iiux,ivus,Xzsywv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iiux,ivuw,Xzyv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iiux,ivuy,Xzvw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iiux,ivws,Xzsuvy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,Iiux,ivws,Xzsuyv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iiux,ivws,Xzsvuy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iiux,ivws,Xzsvyu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iiux,ivws,Xzsyuv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iiux,ivws,Xzsyvu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iiux,ivwu,Xzvy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iiux,ivwy,Xzuv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,Iiux,ivys,Xzsuvw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 2/3 * einsum('xyzw,Iiux,ivys,Xzsuwv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,Iiux,ivys,Xzsvuw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,Iiux,ivys,Xzsvwu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,Iiux,ivys,Xzswuv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,Iiux,ivys,Xzswvu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += einsum('xyzw,Iiux,ivyu,Xzvw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,Iiux,ivyw,Xzuv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iiux,iw,Xzuy->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,Iiux,iy,Xzuw->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,Iiux,izuv,Xvyw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,Iiux,izvs,Xsvuwy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,Iiux,izvu,Xvwy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,IixX,iu,zuwy->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,IixX,iuvs,zvsuwy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,IixX,iuvs,zvsuyw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,IixX,iuvs,zvswuy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,IixX,iuvs,zvswyu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,IixX,iuvs,zvsyuw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,IixX,iuvs,zvsywu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,IixX,iuvw,zvuy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,IixX,iuvy,zvwu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,IixX,iuwv,zvyu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,IixX,iuwy,zu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xyzw,IixX,iuyv,zvwu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,IixX,iuyw,zu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,IixX,iw,zy->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += einsum('xyzw,IixX,iy,zw->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,IixX,izuv,ywuv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Iixa,iXau,zuwy->IX', v_aaaa, t1_ccae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,Iixa,iXaw,zy->IX', v_aaaa, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 2 * einsum('xyzw,Iixa,iXay,zw->IX', v_aaaa, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iixa,iXua,zuwy->IX', v_aaaa, t1_ccae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixa,iXwa,zy->IX', v_aaaa, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += einsum('xyzw,Iixa,iXya,zw->IX', v_aaaa, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Iixa,ia,Xzyw->IX', v_aaaa, t1_ccae, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Iixa,iuav,Xzvywu->IX', v_aaaa, t1_ccae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += einsum('xyzw,Iixa,iuaw,Xzyu->IX', v_aaaa, t1_ccae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,Iixa,iuay,Xzuw->IX', v_aaaa, t1_ccae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iixa,iuva,Xzvywu->IX', v_aaaa, t1_ccae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixa,iuwa,Xzyu->IX', v_aaaa, t1_ccae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixa,iuya,Xzuw->IX', v_aaaa, t1_ccae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixa,izau,Xuyw->IX', v_aaaa, t1_ccae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,Iixa,izua,Xuyw->IX', v_aaaa, t1_ccae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Iixu,iXuv,zvwy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,Iixu,iXuw,zy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 2 * einsum('xyzw,Iixu,iXuy,zw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iixu,iXvs,zsvwyu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iixu,iXvu,zvwy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixu,iXvw,zvyu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,Iixu,iXvy,zvwu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixu,iXwu,zy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixu,iXwv,zvuy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,Iixu,iXwy,zu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xyzw,Iixu,iXyu,zw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixu,iXyv,zvwu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixu,iXyw,zu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Iixu,iu,Xzyw->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iixu,iv,Xzvywu->IX', v_aaaa, t1_ccaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/60 * einsum('xyzw,Iixu,ivst,Xzstuvwy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/60 * einsum('xyzw,Iixu,ivst,Xzstuvyw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,Iixu,ivst,Xzstuwvy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,Iixu,ivst,Xzstuwyv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,Iixu,ivst,Xzstuyvw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,Iixu,ivst,Xzstuywv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,Iixu,ivst,Xzstvwuy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,Iixu,ivst,Xzstvwyu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,Iixu,ivst,Xzstvyuw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,Iixu,ivst,Xzstvywu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,Iixu,ivst,Xzstwuvy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,Iixu,ivst,Xzstwuyv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 3/160 * einsum('xyzw,Iixu,ivst,Xzstwvuy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 3/160 * einsum('xyzw,Iixu,ivst,Xzstwvyu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/240 * einsum('xyzw,Iixu,ivst,Xzstwyuv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/240 * einsum('xyzw,Iixu,ivst,Xzstwyvu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,Iixu,ivst,Xzstyuvw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,Iixu,ivst,Xzstyuwv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 3/160 * einsum('xyzw,Iixu,ivst,Xzstyvuw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 3/160 * einsum('xyzw,Iixu,ivst,Xzstyvwu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 59/240 * einsum('xyzw,Iixu,ivst,Xzstywuv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/240 * einsum('xyzw,Iixu,ivst,Xzstywvu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iixu,ivsu,Xzsywv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iixu,ivsw,Xzsuvy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iixu,ivsw,Xzsuyv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iixu,ivsw,Xzsvuy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iixu,ivsw,Xzsvyu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iixu,ivsw,Xzsyuv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,Iixu,ivsw,Xzsyvu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixu,ivsy,Xzsvwu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Iixu,ivus,Xzsywv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += einsum('xyzw,Iixu,ivuw,Xzyv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,Iixu,ivuy,Xzvw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixu,ivws,Xzsyuv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixu,ivwu,Xzyv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixu,ivwy,Xzvu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iixu,ivys,Xzsuvw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,Iixu,ivys,Xzsuwv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iixu,ivys,Xzsvuw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iixu,ivys,Xzsvwu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iixu,ivys,Xzswuv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iixu,ivys,Xzswvu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixu,ivyu,Xzvw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixu,ivyw,Xzuv->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixu,iw,Xzyu->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixu,iy,Xzuw->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixu,izuv,Xvyw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iixu,izvs,Xsvuwy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iixu,izvs,Xsvuyw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iixu,izvs,Xsvwuy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iixu,izvs,Xsvwyu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iixu,izvs,Xsvyuw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iixu,izvs,Xsvywu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,Iixu,izvu,Xvyw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iixz,iXuv,ywvu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixz,iXuw,yu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xyzw,Iixz,iXuy,wu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xyzw,Iixz,iXwu,yu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixz,iXyu,wu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iixz,iu,Xuyw->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iixz,iuvs,Xvsuwy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iixz,iuvs,Xvsuyw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iixz,iuvs,Xvswuy->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iixz,iuvs,Xvswyu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iixz,iuvs,Xvsyuw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iixz,iuvs,Xvsywu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixz,iuvw,Xvyu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixz,iuvy,Xvuw->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,Iixz,iuwv,Xvyu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,Iixz,iuwy,Xu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixz,iuyv,Xvwu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixz,iuyw,Xu->IX', v_aaaa, t1_ccaa, t1_caaa, rdm_ca, optimize = einsum_type)
    V1 += einsum('xyzw,Iixz,iw,Xy->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iixz,iy,Xw->IX', v_aaaa, t1_ccaa, t1_ca, rdm_ca, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,Iuax,Xa,zuwy->IX', v_aaaa, t1_caea, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuax,Xvsa,zusvwy->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuax,Xvsa,zusvyw->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuax,Xvsa,zuswvy->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iuax,Xvsa,zuswyv->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuax,Xvsa,zusyvw->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuax,Xvsa,zusywv->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Iuax,Xvwa,zuvy->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Iuax,Xvya,zuwv->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iuax,Xzva,ywuv->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iuax,vXsa,zusvwy->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iuax,vXsa,zusvyw->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iuax,vXsa,zuswvy->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,Iuax,vXsa,zuswyv->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iuax,vXsa,zusyvw->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iuax,vXsa,zusywv->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= einsum('xyzw,Iuax,vXwa,zuvy->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('xyzw,Iuax,vXya,zuwv->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iuax,va,Xzuvwy->IX', v_aaaa, t1_caea, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuax,va,Xzuvyw->IX', v_aaaa, t1_caea, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuax,va,Xzuwvy->IX', v_aaaa, t1_caea, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuax,va,Xzuwyv->IX', v_aaaa, t1_caea, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuax,va,Xzuyvw->IX', v_aaaa, t1_caea, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuax,va,Xzuywv->IX', v_aaaa, t1_caea, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/96 * einsum('xyzw,Iuax,vsta,Xzutsvwy->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/96 * einsum('xyzw,Iuax,vsta,Xzutsvyw->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/32 * einsum('xyzw,Iuax,vsta,Xzutswvy->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuax,vsta,Xzutswyv->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 5/96 * einsum('xyzw,Iuax,vsta,Xzutsyvw->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuax,vsta,Xzutsywv->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/96 * einsum('xyzw,Iuax,vsta,Xzutvswy->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/96 * einsum('xyzw,Iuax,vsta,Xzutvsyw->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/32 * einsum('xyzw,Iuax,vsta,Xzutvwsy->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/24 * einsum('xyzw,Iuax,vsta,Xzutvwys->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 5/96 * einsum('xyzw,Iuax,vsta,Xzutvysw->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/24 * einsum('xyzw,Iuax,vsta,Xzutvyws->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/48 * einsum('xyzw,Iuax,vsta,Xzutwsvy->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 5/32 * einsum('xyzw,Iuax,vsta,Xzutwsyv->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/48 * einsum('xyzw,Iuax,vsta,Xzutwvsy->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/32 * einsum('xyzw,Iuax,vsta,Xzutwvys->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 11/96 * einsum('xyzw,Iuax,vsta,Xzutwysv->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/96 * einsum('xyzw,Iuax,vsta,Xzutwyvs->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 5/48 * einsum('xyzw,Iuax,vsta,Xzutysvw->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/32 * einsum('xyzw,Iuax,vsta,Xzutyswv->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 5/48 * einsum('xyzw,Iuax,vsta,Xzutyvsw->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 3/32 * einsum('xyzw,Iuax,vsta,Xzutyvws->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/96 * einsum('xyzw,Iuax,vsta,Xzutywsv->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 5/96 * einsum('xyzw,Iuax,vsta,Xzutywvs->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Iuax,vswa,Xzusvy->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iuax,vsya,Xzusvw->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,Iuax,vsya,Xzuswv->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iuax,vsya,Xzuvsw->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iuax,vsya,Xzuvws->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iuax,vsya,Xzuwsv->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iuax,vsya,Xzuwvs->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuax,vzsa,Xusvwy->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuax,vzsa,Xusvyw->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuax,vzsa,Xuswvy->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iuax,vzsa,Xuswyv->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuax,vzsa,Xusyvw->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuax,vzsa,Xusywv->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Iuax,zXva,ywuv->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iuax,za,Xuwy->IX', v_aaaa, t1_caea, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iuax,zvsa,Xusvyw->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,Iuxa,Xa,zuwy->IX', v_aaaa, t1_caae, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,Iuxa,Xvsa,zuswvy->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Iuxa,Xvwa,zuyv->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('xyzw,Iuxa,Xvya,zuwv->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iuxa,Xzva,ywvu->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuxa,vXsa,zusvwy->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuxa,vXsa,zusvyw->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuxa,vXsa,zuswvy->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Iuxa,vXsa,zuswyv->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuxa,vXsa,zusyvw->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Iuxa,vXsa,zusywv->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Iuxa,vXwa,zuvy->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Iuxa,vXya,zuwv->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,Iuxa,va,Xzuywv->IX', v_aaaa, t1_caae, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/120 * einsum('xyzw,Iuxa,vsta,Xzutsvwy->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/120 * einsum('xyzw,Iuxa,vsta,Xzutsvyw->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/160 * einsum('xyzw,Iuxa,vsta,Xzutswvy->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,Iuxa,vsta,Xzutswyv->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/160 * einsum('xyzw,Iuxa,vsta,Xzutsyvw->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,Iuxa,vsta,Xzutsywv->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/120 * einsum('xyzw,Iuxa,vsta,Xzutvswy->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/120 * einsum('xyzw,Iuxa,vsta,Xzutvsyw->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/160 * einsum('xyzw,Iuxa,vsta,Xzutvwsy->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,Iuxa,vsta,Xzutvwys->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/160 * einsum('xyzw,Iuxa,vsta,Xzutvysw->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,Iuxa,vsta,Xzutvyws->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/480 * einsum('xyzw,Iuxa,vsta,Xzutwsvy->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/160 * einsum('xyzw,Iuxa,vsta,Xzutwsyv->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/480 * einsum('xyzw,Iuxa,vsta,Xzutwvsy->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/160 * einsum('xyzw,Iuxa,vsta,Xzutwvys->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/240 * einsum('xyzw,Iuxa,vsta,Xzutwysv->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/240 * einsum('xyzw,Iuxa,vsta,Xzutwyvs->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/480 * einsum('xyzw,Iuxa,vsta,Xzutysvw->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/160 * einsum('xyzw,Iuxa,vsta,Xzutyswv->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/480 * einsum('xyzw,Iuxa,vsta,Xzutyvsw->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/160 * einsum('xyzw,Iuxa,vsta,Xzutyvws->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 59/240 * einsum('xyzw,Iuxa,vsta,Xzutywsv->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/240 * einsum('xyzw,Iuxa,vsta,Xzutywvs->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iuxa,vswa,Xzusvy->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iuxa,vswa,Xzusyv->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iuxa,vswa,Xzuvsy->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iuxa,vswa,Xzuvys->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iuxa,vswa,Xzuysv->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,Iuxa,vswa,Xzuyvs->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Iuxa,vsya,Xzuvws->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iuxa,vzsa,Xusywv->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iuxa,zXva,ywuv->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Iuxa,za,Xuyw->IX', v_aaaa, t1_caae, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuxa,zvsa,Xusvwy->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuxa,zvsa,Xusvyw->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuxa,zvsa,Xuswvy->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuxa,zvsa,Xuswyv->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Iuxa,zvsa,Xusyvw->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Iuxa,zvsa,Xusywv->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,IxXa,ua,zuwy->IX', v_aaaa, t1_caae, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,IxXa,uvsa,zvuswy->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,IxXa,uvsa,zvusyw->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,IxXa,uvsa,zvuwsy->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,IxXa,uvsa,zvuwys->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,IxXa,uvsa,zvuysw->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,IxXa,uvsa,zvuyws->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,IxXa,uvza,ywvu->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,IxaX,ua,zuwy->IX', v_aaaa, t1_caea, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,IxaX,uvsa,zvuswy->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,IxaX,uvsa,zvusyw->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,IxaX,uvsa,zvuwsy->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,IxaX,uvsa,zvuwys->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,IxaX,uvsa,zvuysw->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,IxaX,uvsa,zvuyws->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,IxaX,uvza,ywvu->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Ixau,Xa,zuwy->IX', v_aaaa, t1_caea, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixau,Xvsa,zuvswy->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixau,Xvsa,zuvsyw->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixau,Xvsa,zuvwsy->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Ixau,Xvsa,zuvwys->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixau,Xvsa,zuvysw->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixau,Xvsa,zuvyws->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Ixau,Xvua,zvwy->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Ixau,Xvza,ywuv->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Ixau,vXsa,zuvswy->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Ixau,vXsa,zuvsyw->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Ixau,vXsa,zuvwsy->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,Ixau,vXsa,zuvwys->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Ixau,vXsa,zuvysw->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Ixau,vXsa,zuvyws->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Ixau,vXua,zvwy->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Ixau,vXza,ywuv->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixau,va,Xywuvz->IX', v_aaaa, t1_caea, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixau,va,Xywuzv->IX', v_aaaa, t1_caea, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Ixau,va,Xywvuz->IX', v_aaaa, t1_caea, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixau,va,Xywvzu->IX', v_aaaa, t1_caea, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixau,va,Xywzuv->IX', v_aaaa, t1_caea, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixau,va,Xywzvu->IX', v_aaaa, t1_caea, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Ixau,vsta,Xywtsuzv->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/24 * einsum('xyzw,Ixau,vsta,Xywtsvzu->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixau,vsta,Xywtszuv->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/24 * einsum('xyzw,Ixau,vsta,Xywtszvu->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/48 * einsum('xyzw,Ixau,vsta,Xywtusvz->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/48 * einsum('xyzw,Ixau,vsta,Xywtuszv->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/48 * einsum('xyzw,Ixau,vsta,Xywtuvsz->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/48 * einsum('xyzw,Ixau,vsta,Xywtuvzs->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,Ixau,vsta,Xywtuzsv->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,Ixau,vsta,Xywtuzvs->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/24 * einsum('xyzw,Ixau,vsta,Xywtvszu->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/24 * einsum('xyzw,Ixau,vsta,Xywtvuzs->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/24 * einsum('xyzw,Ixau,vsta,Xywtvzsu->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/24 * einsum('xyzw,Ixau,vsta,Xywtvzus->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,Ixau,vsta,Xywtzsuv->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,Ixau,vsta,Xywtzsvu->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,Ixau,vsta,Xywtzusv->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,Ixau,vsta,Xywtzuvs->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,Ixau,vsta,Xywtzvsu->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,Ixau,vsta,Xywtzvus->IX', v_aaaa, t1_caea, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Ixau,vsua,Xywsvz->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Ixau,vsza,Xywsuv->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixau,vsza,Xywsvu->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixau,vsza,Xywusv->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixau,vsza,Xywuvs->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixau,vsza,Xywvsu->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixau,vsza,Xywvus->IX', v_aaaa, t1_caea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Ixua,Xa,zuwy->IX', v_aaaa, t1_caae, t1_ae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Ixua,Xvsa,zuvwsy->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Ixua,Xvua,zvwy->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Ixua,Xvza,ywvu->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixua,vXsa,zuvswy->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixua,vXsa,zuvsyw->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixua,vXsa,zuvwsy->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Ixua,vXsa,zuvwys->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixua,vXsa,zuvysw->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixua,vXsa,zuvyws->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Ixua,vXua,zvwy->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Ixua,vXza,ywuv->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Ixua,va,Xywuvz->IX', v_aaaa, t1_caae, t1_ae, rdm_cccaaa, optimize = einsum_type)
    V1 += 7/240 * einsum('xyzw,Ixua,vsta,Xywtsuzv->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/60 * einsum('xyzw,Ixua,vsta,Xywtsvzu->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/240 * einsum('xyzw,Ixua,vsta,Xywtszuv->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/60 * einsum('xyzw,Ixua,vsta,Xywtszvu->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/240 * einsum('xyzw,Ixua,vsta,Xywtusvz->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 13/60 * einsum('xyzw,Ixua,vsta,Xywtuszv->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/240 * einsum('xyzw,Ixua,vsta,Xywtuvsz->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/120 * einsum('xyzw,Ixua,vsta,Xywtuvzs->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/30 * einsum('xyzw,Ixua,vsta,Xywtuzsv->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/120 * einsum('xyzw,Ixua,vsta,Xywtuzvs->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/60 * einsum('xyzw,Ixua,vsta,Xywtvszu->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/80 * einsum('xyzw,Ixua,vsta,Xywtvuzs->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/60 * einsum('xyzw,Ixua,vsta,Xywtvzsu->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/80 * einsum('xyzw,Ixua,vsta,Xywtvzus->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/80 * einsum('xyzw,Ixua,vsta,Xywtzsuv->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/120 * einsum('xyzw,Ixua,vsta,Xywtzsvu->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/80 * einsum('xyzw,Ixua,vsta,Xywtzusv->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 13/240 * einsum('xyzw,Ixua,vsta,Xywtzuvs->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/120 * einsum('xyzw,Ixua,vsta,Xywtzvsu->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 13/240 * einsum('xyzw,Ixua,vsta,Xywtzvus->IX', v_aaaa, t1_caae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixua,vsua,Xywsvz->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixua,vsua,Xywszv->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Ixua,vsua,Xywvsz->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixua,vsua,Xywvzs->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixua,vsua,Xywzsv->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Ixua,vsua,Xywzvs->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Ixua,vsza,Xywusv->IX', v_aaaa, t1_caae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,Xuxa,Ia,zuwy->IX', v_aaaa, t1_aaae, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Xuxa,Ivas,zusvwy->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Xuxa,Ivas,zusvyw->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Xuxa,Ivas,zuswvy->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,Xuxa,Ivas,zuswyv->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Xuxa,Ivas,zusyvw->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,Xuxa,Ivas,zusywv->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,Xuxa,Ivsa,zuswvy->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Xxua,Ia,zuwy->IX', v_aaaa, t1_aaae, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Xxua,Ivas,zuvswy->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Xxua,Ivas,zuvsyw->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Xxua,Ivas,zuvwsy->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,Xxua,Ivas,zuvwys->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Xxua,Ivas,zuvysw->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,Xxua,Ivas,zuvyws->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Xxua,Ivau,zvwy->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,Xxua,Ivsa,zuvwsy->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,Xxua,Ivua,zvwy->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iIxa,iXau,zuwy->IX', v_aaaa, t1_ccae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,iIxa,iXaw,zy->IX', v_aaaa, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 += einsum('xyzw,iIxa,iXay,zw->IX', v_aaaa, t1_ccae, t1_caea, rdm_ca, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iIxa,iXua,zuwy->IX', v_aaaa, t1_ccae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,iIxa,iXwa,zy->IX', v_aaaa, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 -= 2 * einsum('xyzw,iIxa,iXya,zw->IX', v_aaaa, t1_ccae, t1_caae, rdm_ca, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iIxa,ia,Xzyw->IX', v_aaaa, t1_ccae, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iIxa,iuav,Xzvywu->IX', v_aaaa, t1_ccae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,iIxa,iuaw,Xzyu->IX', v_aaaa, t1_ccae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,iIxa,iuay,Xzuw->IX', v_aaaa, t1_ccae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iIxa,iuva,Xzvuwy->IX', v_aaaa, t1_ccae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iIxa,iuva,Xzvuyw->IX', v_aaaa, t1_ccae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iIxa,iuva,Xzvwuy->IX', v_aaaa, t1_ccae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iIxa,iuva,Xzvwyu->IX', v_aaaa, t1_ccae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iIxa,iuva,Xzvyuw->IX', v_aaaa, t1_ccae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iIxa,iuva,Xzvywu->IX', v_aaaa, t1_ccae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,iIxa,iuwa,Xzuy->IX', v_aaaa, t1_ccae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += einsum('xyzw,iIxa,iuya,Xzuw->IX', v_aaaa, t1_ccae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,iIxa,izau,Xuyw->IX', v_aaaa, t1_ccae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,iIxa,izua,Xuwy->IX', v_aaaa, t1_ccae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iXax,Iiua,zuwy->IX', v_aaaa, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iXax,iIua,zuwy->IX', v_aaaa, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iXux,Iiuv,zvwy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iXux,Iivs,zvsuwy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iXux,Iivs,zvsuyw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iXux,Iivs,zvswuy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iXux,Iivs,zvswyu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iXux,Iivs,zvsyuw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iXux,Iivs,zvsywu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iXux,Iivu,zvwy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iXxa,Iiua,zuwy->IX', v_aaaa, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iXxa,iIua,zuwy->IX', v_aaaa, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iXxu,Iiuv,zvwy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iXxu,Iivs,zvswuy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iXxu,Iivu,zvwy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iXzx,Iiuv,ywuv->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= einsum('xyzw,iuax,IiXa,zuwy->IX', v_aaaa, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuax,Iiva,Xywuvz->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuax,Iiva,Xywuzv->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,iuax,Iiva,Xywvuz->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuax,Iiva,Xywvzu->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuax,Iiva,Xywzuv->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuax,Iiva,Xywzvu->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iuax,iIXa,zuwy->IX', v_aaaa, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuax,iIva,Xywuvz->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuax,iIva,Xywuzv->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuax,iIva,Xywvuz->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuax,iIva,Xywvzu->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuax,iIva,Xywzuv->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuax,iIva,Xywzvu->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,IiXs,zusvwy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,IiXs,zusvyw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,IiXs,zuswvy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,iuvx,IiXs,zuswyv->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,IiXs,zusyvw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,IiXs,zusywv->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= einsum('xyzw,iuvx,IiXv,zuwy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuvx,IisX,zusvwy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuvx,IisX,zusvyw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuvx,IisX,zuswvy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,IisX,zuswyv->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuvx,IisX,zusyvw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuvx,IisX,zusywv->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/24 * einsum('xyzw,iuvx,Iist,Xywvstzu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,iuvx,Iist,Xywvsuzt->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/24 * einsum('xyzw,iuvx,Iist,Xywvsztu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuvx,Iist,Xywvszut->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/24 * einsum('xyzw,iuvx,Iist,Xywvtszu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/24 * einsum('xyzw,iuvx,Iist,Xywvtuzs->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/24 * einsum('xyzw,iuvx,Iist,Xywvtzsu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/24 * einsum('xyzw,iuvx,Iist,Xywvtzus->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/48 * einsum('xyzw,iuvx,Iist,Xywvustz->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/48 * einsum('xyzw,iuvx,Iist,Xywvuszt->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/48 * einsum('xyzw,iuvx,Iist,Xywvutsz->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/48 * einsum('xyzw,iuvx,Iist,Xywvutzs->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,iuvx,Iist,Xywvuzst->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,iuvx,Iist,Xywvuzts->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,iuvx,Iist,Xywvzstu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,iuvx,Iist,Xywvzsut->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,iuvx,Iist,Xywvztsu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,iuvx,Iist,Xywvztus->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,iuvx,Iist,Xywvzust->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/16 * einsum('xyzw,iuvx,Iist,Xywvzuts->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,iuvx,Iisv,Xywsuz->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,Iisv,Xywszu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,Iisv,Xywusz->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,Iisv,Xywuzs->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,Iisv,Xywzsu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,Iisv,Xywzus->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iuvx,IivX,zuwy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuvx,Iivs,Xywsuz->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuvx,Iivs,Xywszu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuvx,Iivs,Xywusz->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuvx,Iivs,Xywuzs->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuvx,Iivs,Xywzsu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuvx,Iivs,Xywzus->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iuxa,IiXa,zuwy->IX', v_aaaa, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxa,Iiva,Xywuvz->IX', v_aaaa, t1_caae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxa,Iiva,Xywuzv->IX', v_aaaa, t1_caae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuxa,Iiva,Xywvuz->IX', v_aaaa, t1_caae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxa,Iiva,Xywvzu->IX', v_aaaa, t1_caae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxa,Iiva,Xywzuv->IX', v_aaaa, t1_caae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxa,Iiva,Xywzvu->IX', v_aaaa, t1_caae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iuxa,iIXa,zuwy->IX', v_aaaa, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iuxa,iIva,Xywuvz->IX', v_aaaa, t1_caae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iuxv,IiXs,zuswvy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iuxv,IiXv,zuwy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iuxv,IisX,zuswvy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 3/16 * einsum('xyzw,iuxv,Iist,Xywvstzu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,iuxv,Iist,Xywvsztu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,iuxv,Iist,Xywvtszu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,iuxv,Iist,Xywvtzsu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,iuxv,Iist,Xywvzstu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/16 * einsum('xyzw,iuxv,Iist,Xywvztsu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuxv,Iisv,Xywsuz->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxv,Iisv,Xywszu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxv,Iisv,Xywusz->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxv,Iisv,Xywuzs->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxv,Iisv,Xywzsu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxv,Iisv,Xywzus->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iuxv,IivX,zuwy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iuxv,Iivs,Xywusz->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,iuxz,IiXv,ywvu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,iuxz,IivX,ywvu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxz,Iivs,Xywsuv->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxz,Iivs,Xywsvu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxz,Iivs,Xywusv->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxz,Iivs,Xywuvs->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,iuxz,Iivs,Xywvsu->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,iuxz,Iivs,Xywvus->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,ix,IiXu,zuwy->IX', v_aaaa, t1_ca, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ix,IiuX,zuwy->IX', v_aaaa, t1_ca, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,ix,Iiuv,Xywuvz->IX', v_aaaa, t1_ca, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += einsum('xyzw,ixau,IiXa,zuwy->IX', v_aaaa, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,ixau,Iiua,Xzyw->IX', v_aaaa, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,ixau,Iiva,Xzuvwy->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,ixau,Iiva,Xzuvyw->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,ixau,Iiva,Xzuwvy->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,ixau,Iiva,Xzuwyv->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,ixau,Iiva,Xzuyvw->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,ixau,Iiva,Xzuywv->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,ixau,iIXa,zuwy->IX', v_aaaa, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,ixau,iIua,Xzyw->IX', v_aaaa, t1_caea, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,ixau,iIva,Xzuvwy->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixau,iIva,Xzuvyw->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixau,iIva,Xzuwvy->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixau,iIva,Xzuwyv->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixau,iIva,Xzuyvw->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixau,iIva,Xzuywv->IX', v_aaaa, t1_caea, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,ixua,IiXa,zuwy->IX', v_aaaa, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,ixua,Iiua,Xzyw->IX', v_aaaa, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,ixua,Iiva,Xzuvwy->IX', v_aaaa, t1_caae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixua,Iiva,Xzuvyw->IX', v_aaaa, t1_caae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixua,Iiva,Xzuwvy->IX', v_aaaa, t1_caae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixua,Iiva,Xzuwyv->IX', v_aaaa, t1_caae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixua,Iiva,Xzuyvw->IX', v_aaaa, t1_caae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixua,Iiva,Xzuywv->IX', v_aaaa, t1_caae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,ixua,iIXa,zuwy->IX', v_aaaa, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,ixua,iIua,Xzyw->IX', v_aaaa, t1_caae, t1_ccae, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,ixua,iIva,Xzuywv->IX', v_aaaa, t1_caae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,ixuv,IiXs,zvuwys->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += einsum('xyzw,ixuv,IiXu,zvwy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,ixuv,IiXv,zuwy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,ixuv,IisX,zvuwys->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,ixuv,Iist,Xzvustwy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,ixuv,Iist,Xzvustyw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/40 * einsum('xyzw,ixuv,Iist,Xzvuswty->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 43/480 * einsum('xyzw,ixuv,Iist,Xzvuswyt->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 3/80 * einsum('xyzw,ixuv,Iist,Xzvusytw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 47/480 * einsum('xyzw,ixuv,Iist,Xzvusywt->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/160 * einsum('xyzw,ixuv,Iist,Xzvutswy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/160 * einsum('xyzw,ixuv,Iist,Xzvutsyw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/40 * einsum('xyzw,ixuv,Iist,Xzvutwsy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 17/480 * einsum('xyzw,ixuv,Iist,Xzvutwys->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 3/80 * einsum('xyzw,ixuv,Iist,Xzvutysw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 13/480 * einsum('xyzw,ixuv,Iist,Xzvutyws->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/160 * einsum('xyzw,ixuv,Iist,Xzvuwsty->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 11/120 * einsum('xyzw,ixuv,Iist,Xzvuwsyt->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 19/480 * einsum('xyzw,ixuv,Iist,Xzvuwtsy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/240 * einsum('xyzw,ixuv,Iist,Xzvuwtys->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 29/480 * einsum('xyzw,ixuv,Iist,Xzvuwyst->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 31/480 * einsum('xyzw,ixuv,Iist,Xzvuwyts->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/160 * einsum('xyzw,ixuv,Iist,Xzvuystw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 11/120 * einsum('xyzw,ixuv,Iist,Xzvuyswt->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 19/480 * einsum('xyzw,ixuv,Iist,Xzvuytsw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/240 * einsum('xyzw,ixuv,Iist,Xzvuytws->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 59/480 * einsum('xyzw,ixuv,Iist,Xzvuywst->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/480 * einsum('xyzw,ixuv,Iist,Xzvuywts->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,ixuv,Iisu,Xzvswy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,ixuv,Iisu,Xzvsyw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,ixuv,Iisu,Xzvwsy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,ixuv,Iisu,Xzvwys->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,ixuv,Iisu,Xzvysw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,ixuv,Iisu,Xzvyws->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,ixuv,Iisv,Xzuswy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixuv,Iisv,Xzusyw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixuv,Iisv,Xzuwsy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixuv,Iisv,Xzuwys->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixuv,Iisv,Xzuysw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixuv,Iisv,Xzuyws->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,ixuv,IiuX,zvwy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,ixuv,Iius,Xzvswy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixuv,Iius,Xzvsyw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixuv,Iius,Xzvwsy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixuv,Iius,Xzvwys->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixuv,Iius,Xzvysw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,ixuv,Iius,Xzvyws->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,ixuv,Iiuv,Xzyw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,ixuv,IivX,zuwy->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,ixuv,Iivs,Xzuyws->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,ixuv,Iivu,Xzyw->IX', v_aaaa, t1_caaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,uXxa,Ia,zuwy->IX', v_aaaa, t1_aaae, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uXxa,Ivas,zusvwy->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uXxa,Ivas,zusvyw->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uXxa,Ivas,zuswvy->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/3 * einsum('xyzw,uXxa,Ivas,zuswyv->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uXxa,Ivas,zusyvw->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uXxa,Ivas,zusywv->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uXxa,Ivsa,zusvwy->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uXxa,Ivsa,zusvyw->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uXxa,Ivsa,zuswvy->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,uXxa,Ivsa,zuswyv->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uXxa,Ivsa,zusyvw->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/12 * einsum('xyzw,uXxa,Ivsa,zusywv->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,uvxa,Ia,Xywvuz->IX', v_aaaa, t1_aaae, t1_ce, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/2 * einsum('xyzw,uvxa,IsXa,zuvwys->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,uvxa,IsaX,zuvwys->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 5/48 * einsum('xyzw,uvxa,Isat,Xywsuvzt->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 5/48 * einsum('xyzw,uvxa,Isat,Xywsuzvt->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 7/48 * einsum('xyzw,uvxa,Isat,Xywsvuzt->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 5/48 * einsum('xyzw,uvxa,Isat,Xywsvzut->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,uvxa,Isat,Xywsztuv->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,uvxa,Isat,Xywsztvu->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,uvxa,Isat,Xywszutv->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/48 * einsum('xyzw,uvxa,Isat,Xywszuvt->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,uvxa,Isat,Xywszvtu->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/48 * einsum('xyzw,uvxa,Isat,Xywszvut->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 19/480 * einsum('xyzw,uvxa,Ista,Xywstuzv->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 41/480 * einsum('xyzw,uvxa,Ista,Xywstvzu->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/160 * einsum('xyzw,uvxa,Ista,Xywstzuv->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 13/160 * einsum('xyzw,uvxa,Ista,Xywstzvu->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,uvxa,Ista,Xywsutvz->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 17/80 * einsum('xyzw,uvxa,Ista,Xywsutzv->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,uvxa,Ista,Xywsuvtz->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 13/160 * einsum('xyzw,uvxa,Ista,Xywsuvzt->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 11/240 * einsum('xyzw,uvxa,Ista,Xywsuztv->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 41/480 * einsum('xyzw,uvxa,Ista,Xywsuzvt->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,uvxa,Ista,Xywsvtuz->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 7/80 * einsum('xyzw,uvxa,Ista,Xywsvtzu->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,uvxa,Ista,Xywsvutz->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 13/160 * einsum('xyzw,uvxa,Ista,Xywsvuzt->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 19/240 * einsum('xyzw,uvxa,Ista,Xywsvztu->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 41/480 * einsum('xyzw,uvxa,Ista,Xywsvzut->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 61/480 * einsum('xyzw,uvxa,Ista,Xywsztuv->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,uvxa,Ista,Xywsztvu->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 61/480 * einsum('xyzw,uvxa,Ista,Xywszutv->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/240 * einsum('xyzw,uvxa,Ista,Xywszuvt->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/480 * einsum('xyzw,uvxa,Ista,Xywszvtu->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/240 * einsum('xyzw,uvxa,Ista,Xywszvut->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,uxva,Ia,Xzvywu->IX', v_aaaa, t1_aaae, t1_ce, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,uxva,IsXa,zvswuy->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,uxva,IsaX,zvswuy->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,uxva,Isat,Xzvsywut->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,uxva,Isav,Xzsywu->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,uxva,Ista,Xzvstwuy->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,uxva,Ista,Xzvstyuw->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,uxva,Ista,Xzvswtuy->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,uxva,Ista,Xzvswyut->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,uxva,Ista,Xzvsytuw->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,uxva,Ista,Xzvsywut->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,uxva,Isva,Xzsuwy->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,uxva,Isva,Xzsuyw->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,uxva,Isva,Xzswuy->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,uxva,Isva,Xzswyu->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,uxva,Isva,Xzsyuw->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,uxva,Isva,Xzsywu->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,xXua,Ia,zuwy->IX', v_aaaa, t1_aaae, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xXua,Ivas,zuvswy->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xXua,Ivas,zuvsyw->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xXua,Ivas,zuvwsy->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,xXua,Ivas,zuvwys->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xXua,Ivas,zuvysw->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xXua,Ivas,zuvyws->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,xXua,Ivau,zvwy->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xXua,Ivsa,zuvswy->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xXua,Ivsa,zuvsyw->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xXua,Ivsa,zuvwsy->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xXua,Ivsa,zuvwys->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xXua,Ivsa,zuvysw->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xXua,Ivsa,zuvyws->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,xXua,Ivua,zvwy->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,xa,Ia,Xzyw->IX', v_aaaa, t1_ae, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,xa,IuXa,zuwy->IX', v_aaaa, t1_ae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,xa,IuaX,zuwy->IX', v_aaaa, t1_ae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,xa,Iuav,Xzuywv->IX', v_aaaa, t1_ae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xa,Iuva,Xzuvwy->IX', v_aaaa, t1_ae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xa,Iuva,Xzuvyw->IX', v_aaaa, t1_ae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xa,Iuva,Xzuwvy->IX', v_aaaa, t1_ae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xa,Iuva,Xzuwyv->IX', v_aaaa, t1_ae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xa,Iuva,Xzuyvw->IX', v_aaaa, t1_ae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xa,Iuva,Xzuywv->IX', v_aaaa, t1_ae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xuva,Ia,Xzvuwy->IX', v_aaaa, t1_aaae, t1_ce, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuva,Ia,Xzvuyw->IX', v_aaaa, t1_aaae, t1_ce, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuva,Ia,Xzvwuy->IX', v_aaaa, t1_aaae, t1_ce, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuva,Ia,Xzvwyu->IX', v_aaaa, t1_aaae, t1_ce, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuva,Ia,Xzvyuw->IX', v_aaaa, t1_aaae, t1_ce, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuva,Ia,Xzvywu->IX', v_aaaa, t1_aaae, t1_ce, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xuva,IsXa,zvsuwy->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xuva,IsXa,zvsuyw->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xuva,IsXa,zvswuy->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/3 * einsum('xyzw,xuva,IsXa,zvswyu->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xuva,IsXa,zvsyuw->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xuva,IsXa,zvsywu->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuva,IsaX,zvsuwy->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuva,IsaX,zvsuyw->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuva,IsaX,zvswuy->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xuva,IsaX,zvswyu->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuva,IsaX,zvsyuw->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuva,IsaX,zvsywu->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,xuva,Isat,Xzvsuwyt->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,xuva,Isat,Xzvsuywt->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/24 * einsum('xyzw,xuva,Isat,Xzvswtuy->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/24 * einsum('xyzw,xuva,Isat,Xzvswtyu->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/24 * einsum('xyzw,xuva,Isat,Xzvswuty->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,xuva,Isat,Xzvswuyt->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/24 * einsum('xyzw,xuva,Isat,Xzvswytu->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/6 * einsum('xyzw,xuva,Isat,Xzvswyut->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,xuva,Isat,Xzvsytuw->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,xuva,Isat,Xzvsytwu->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,xuva,Isat,Xzvsyutw->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,xuva,Isat,Xzvsywtu->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,xuva,Isav,Xzsuwy->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuva,Isav,Xzsuyw->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuva,Isav,Xzswuy->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuva,Isav,Xzswyu->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuva,Isav,Xzsyuw->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,xuva,Isav,Xzsywu->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,xuva,Ista,Xzvstwuy->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,xuva,Ista,Xzvstyuw->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,xuva,Ista,Xzvsuwty->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,xuva,Ista,Xzvsuwyt->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,xuva,Ista,Xzvsuytw->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,xuva,Ista,Xzvsuywt->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,xuva,Ista,Xzvswtyu->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/8 * einsum('xyzw,xuva,Ista,Xzvswyut->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,xuva,Ista,Xzvsytwu->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/4 * einsum('xyzw,xuva,Ista,Xzvsywtu->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 += 1/8 * einsum('xyzw,xuva,Ista,Xzvsywut->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,xuva,Isva,Xzsywu->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,xzua,Ivua,Xvyw->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,zxua,Ia,Xuyw->IX', v_aaaa, t1_aaae, t1_ce, rdm_ccaa, optimize = einsum_type)
    V1 += 1/2 * einsum('xyzw,zxua,IvXa,ywvu->IX', v_aaaa, t1_aaae, t1_caae, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,zxua,IvaX,ywvu->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,zxua,Ivas,Xuvswy->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,zxua,Ivas,Xuvsyw->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,zxua,Ivas,Xuvwsy->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,zxua,Ivas,Xuvwys->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 += 1/12 * einsum('xyzw,zxua,Ivas,Xuvysw->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/6 * einsum('xyzw,zxua,Ivas,Xuvyws->IX', v_aaaa, t1_aaae, t1_caea, rdm_cccaaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,zxua,Ivau,Xvyw->IX', v_aaaa, t1_aaae, t1_caea, rdm_ccaa, optimize = einsum_type)
    V1 -= 1/4 * einsum('xyzw,zxua,Ivsa,Xuvswy->IX', v_aaaa, t1_aaae, t1_caae, rdm_cccaaa, optimize = einsum_type)

    chunks = tools.calculate_double_chunks(mr_adc, nextern, [ncore, ncore, nextern],
                                                                     [ncore, ncas, nextern], ntensors = 3)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.cece t1.caee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Amplitude
        t1_caee = mr_adc.t1.caee[:, :, s_chunk:f_chunk, :] 

        ## Two-electron integrals
        v_cece_ab = mr_adc.v2e.cece[:, s_chunk:f_chunk, :, :]
        v_cece_ba = mr_adc.v2e.cece[:, :, :, s_chunk:f_chunk]

        temp  = einsum('iXab,Iaib->IX', t1_caee, v_cece_ab, optimize = einsum_type)
        temp -= 1/2 * einsum('ixab,Iaib,Xx->IX', t1_caee, v_cece_ab, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('iXab,Ibia->IX', t1_caee, v_cece_ba, optimize = einsum_type)
        temp += einsum('ixab,Ibia,Xx->IX', t1_caee, v_cece_ba, rdm_ca, optimize = einsum_type)

        V1 += temp
        mr_adc.log.timer_debug("contracting v2e.cece t1.caee", *cput1)
    del(v_cece_ab, v_cece_ba, t1_caee)

    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.caea t1.ccee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Amplitude
        t1_ccee = mr_adc.t1.ccee[:, :, s_chunk:f_chunk, :] 

        ## Two-electron integrals
        v_ceae_ab = mr_adc.v2e.ceae[:, s_chunk:f_chunk, :, :]
        v_ceae_ba = mr_adc.v2e.ceae[:, :, :, s_chunk:f_chunk]

        temp  = einsum('Iiab,iaXb->IX', t1_ccee, v_ceae_ab, optimize = einsum_type)
        temp -= 1/2 * einsum('Iiab,iaxb,Xx->IX', t1_ccee, v_ceae_ab, rdm_ca, optimize = einsum_type)
        temp -= 2 * einsum('Iiab,ibXa->IX', t1_ccee, v_ceae_ba, optimize = einsum_type)
        temp += einsum('Iiab,ibxa,Xx->IX', t1_ccee, v_ceae_ba, rdm_ca, optimize = einsum_type)

        V1 += temp
        mr_adc.log.timer_debug("contracting v2e.ceae t1.ccee", *cput1)
    del(v_ceae_ab, v_ceae_ba, t1_ccee)

    chunks = tools.calculate_double_chunks(mr_adc, nextern, [ncore, ncore, nextern],
                                                                     [ncore, ncas, nextern], ntensors = 4)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("t1.ccee t1.caee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Molecular Orbitals Energies
        e_extern = mr_adc.mo_energy.e[s_chunk:f_chunk]

        ## Amplitude
        t1_ccee_ab = mr_adc.t1.ccee[:, :, s_chunk:f_chunk, :] 
        t1_caee_ab = mr_adc.t1.caee[:, :, s_chunk:f_chunk, :] 

        t1_ccee_ba = mr_adc.t1.ccee[:, :, :, s_chunk:f_chunk] 
        t1_caee_ba = mr_adc.t1.caee[:, :, :, s_chunk:f_chunk] 

        temp =- 1/2 * einsum('I,Iiab,iXab->IX', e_core, t1_ccee_ab, t1_caee_ab, optimize = einsum_type)
        temp += einsum('I,Iiab,iXba->IX', e_core, t1_ccee_ab, t1_caee_ba, optimize = einsum_type)
        temp += einsum('a,iXab,Iiab->IX', e_extern, t1_caee_ab, t1_ccee_ab, optimize = einsum_type)
        temp -= 2 * einsum('a,iXab,Iiba->IX', e_extern, t1_caee_ab, t1_ccee_ba, optimize = einsum_type)
        temp -= 2 * einsum('a,iXba,Iiab->IX', e_extern, t1_caee_ba, t1_ccee_ab, optimize = einsum_type)
        temp += einsum('a,iXba,Iiba->IX', e_extern, t1_caee_ba, t1_ccee_ba, optimize = einsum_type)
        temp -= 1/2 * einsum('i,Iiab,iXab->IX', e_core, t1_ccee_ab, t1_caee_ab, optimize = einsum_type)
        temp += einsum('i,Iiab,iXba->IX', e_core, t1_ccee_ab, t1_caee_ba, optimize = einsum_type)
        temp -= 1/2 * einsum('i,iXab,Iiab->IX', e_core, t1_caee_ab, t1_ccee_ab, optimize = einsum_type)
        temp += einsum('i,iXab,Iiba->IX', e_core, t1_caee_ab, t1_ccee_ba, optimize = einsum_type)
        temp -= 1/2 * einsum('Xx,ixab,Iiab->IX', h_aa, t1_caee_ab, t1_ccee_ab, optimize = einsum_type)
        temp += einsum('Xx,ixab,Iiba->IX', h_aa, t1_caee_ab, t1_ccee_ba, optimize = einsum_type)
        temp += 1/4 * einsum('I,Iiab,ixab,Xx->IX', e_core, t1_ccee_ab, t1_caee_ab, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('I,Iiab,ixba,Xx->IX', e_core, t1_ccee_ab, t1_caee_ba, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,ixab,Iiab,Xx->IX', e_extern, t1_caee_ab, t1_ccee_ab, rdm_ca, optimize = einsum_type)
        temp += einsum('a,ixab,Iiba,Xx->IX', e_extern, t1_caee_ab, t1_ccee_ba, rdm_ca, optimize = einsum_type)
        temp += einsum('a,ixba,Iiab,Xx->IX', e_extern, t1_caee_ba, t1_ccee_ab, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('a,ixba,Iiba,Xx->IX', e_extern, t1_caee_ba, t1_ccee_ba, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,Iiab,ixab,Xx->IX', e_core, t1_ccee_ab, t1_caee_ab, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,Iiab,ixba,Xx->IX', e_core, t1_ccee_ab, t1_caee_ba, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('i,ixab,Iiab,Xx->IX', e_core, t1_caee_ab, t1_ccee_ab, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('i,ixab,Iiba,Xx->IX', e_core, t1_caee_ab, t1_ccee_ba, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xy,ixab,Iiab,Xy->IX', h_aa, t1_caee_ab, t1_ccee_ab, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('xy,ixab,Iiba,Xy->IX', h_aa, t1_caee_ab, t1_ccee_ba, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,ixab,Iiab,yz->IX', v_aaaa, t1_caee_ab, t1_ccee_ab, rdm_ca, optimize = einsum_type)
        temp += einsum('Xxyz,ixab,Iiba,yz->IX', v_aaaa, t1_caee_ab, t1_ccee_ba, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('Xxyz,izab,Iiab,yx->IX', v_aaaa, t1_caee_ab, t1_ccee_ab, rdm_ca, optimize = einsum_type)
        temp -= 1/2 * einsum('Xxyz,izab,Iiba,yx->IX', v_aaaa, t1_caee_ab, t1_ccee_ba, rdm_ca, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,ixab,Iiab,Xzyw->IX', v_aaaa, t1_caee_ab, t1_ccee_ab, rdm_ccaa, optimize = einsum_type)
        temp -= 1/2 * einsum('xyzw,ixab,Iiba,Xzyw->IX', v_aaaa, t1_caee_ab, t1_ccee_ba, rdm_ccaa, optimize = einsum_type)

        V1 += temp
        mr_adc.log.timer_debug("contracting t1.ccee t1.caee", *cput1)
    del(e_extern, t1_ccee_ab, t1_ccee_ba, t1_caee_ab, t1_caee_ba)

    chunks = tools.calculate_double_chunks(mr_adc, nextern, [ncore, ncore, nextern],
                                                                     [ncas, ncas, nextern], ntensors = 3)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.cece t1.aaee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Amplitude
        t1_aaee = mr_adc.t1.aaee[:, :, s_chunk:f_chunk, :] 

        ## Two-electron integrals
        v_ceae_ab = mr_adc.v2e.ceae[:, s_chunk:f_chunk, :, :]
        v_ceae_ba = mr_adc.v2e.ceae[:, :, :, s_chunk:f_chunk]

        temp =- einsum('Xxab,Iayb,xy->IX', t1_aaee, v_ceae_ab, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Xxab,Ibya,xy->IX', t1_aaee, v_ceae_ba, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xyab,Iazb,Xzxy->IX', t1_aaee, v_ceae_ab, rdm_ccaa, optimize = einsum_type)

        V1 += temp
        mr_adc.log.timer_debug("contracting v2e.ceae t1.aaee", *cput1)
    del(v_ceae_ab, v_ceae_ba, t1_aaee)

    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("v2e.aeae t1.caee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Amplitude
        t1_caee = mr_adc.t1.caee[:, :, s_chunk:f_chunk, :] 

        ## Two-electron integrals
        v_aeae_ab = mr_adc.v2e.aeae[:, s_chunk:f_chunk, :, :]
        v_aeae_ba = mr_adc.v2e.aeae[:, :, :, s_chunk:f_chunk]

        temp =- einsum('Ixab,Xayb,xy->IX', t1_caee, v_aeae_ab, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ixab,Xbya,xy->IX', t1_caee, v_aeae_ba, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('Ixab,yazb,Xxyz->IX', t1_caee, v_aeae_ab, rdm_ccaa, optimize = einsum_type)

        V1 += temp
        mr_adc.log.timer_debug("contracting v2e.aeae t1.caee", *cput1)
    del(v_aeae_ab, v_aeae_ba, t1_caee)

    chunks = tools.calculate_double_chunks(mr_adc, nextern, [ncore, ncore, nextern],
                                                                     [ncas, ncas, nextern], ntensors = 4)
    for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
        cput1 = (logger.process_clock(), logger.perf_counter())
        mr_adc.log.debug("t1.aaee t1.caee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)

        ## Molecular Orbitals Energies
        e_extern = mr_adc.mo_energy.e[s_chunk:f_chunk]

        ## Amplitudes
        t1_caee_ab = mr_adc.t1.caee[:, :, s_chunk:f_chunk, :]
        t1_aaee_ab = mr_adc.t1.aaee[:, :, s_chunk:f_chunk, :]

        t1_caee_ba = mr_adc.t1.caee[:, :, :, s_chunk:f_chunk]
        t1_aaee_ba = mr_adc.t1.aaee[:, :, :, s_chunk:f_chunk]

        temp  = 1/2 * einsum('I,Ixab,Xyab,xy->IX', e_core, t1_caee_ab, t1_aaee_ab, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixab,Xyba,xy->IX', e_core, t1_caee_ab, t1_aaee_ba, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('I,Ixab,yzab,Xxyz->IX', e_core, t1_caee_ab, t1_aaee_ab, rdm_ccaa, optimize = einsum_type)
        temp -= einsum('a,Xxab,Iyab,xy->IX', e_extern, t1_aaee_ab, t1_caee_ab, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,Xxab,Iyba,xy->IX', e_extern, t1_aaee_ab, t1_caee_ba, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,Xxba,Iyab,xy->IX', e_extern, t1_aaee_ba, t1_caee_ab, rdm_ca, optimize = einsum_type)
        temp -= einsum('a,Xxba,Iyba,xy->IX', e_extern, t1_aaee_ba, t1_caee_ba, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('a,xyab,Izab,Xzxy->IX', e_extern, t1_aaee_ab, t1_caee_ab, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('a,xyab,Izba,Xzyx->IX', e_extern, t1_aaee_ab, t1_caee_ba, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xx,xyab,Izab,yz->IX', h_aa, t1_aaee_ab, t1_caee_ab, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xx,xyab,Izba,yz->IX', h_aa, t1_aaee_ab, t1_caee_ba, rdm_ca, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Ixab,Xzab,yz->IX', h_aa, t1_caee_ab, t1_aaee_ab, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixab,Xzba,yz->IX', h_aa, t1_caee_ab, t1_aaee_ba, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Ixab,zwab,Xyzw->IX', h_aa, t1_caee_ab, t1_aaee_ab, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xy,Xxab,Izab,yz->IX', h_aa, t1_aaee_ab, t1_caee_ab, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,Xxab,Izba,yz->IX', h_aa, t1_aaee_ab, t1_caee_ba, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,xzab,Iwab,Xwyz->IX', h_aa, t1_aaee_ab, t1_caee_ab, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xy,xzab,Iwba,Xwzy->IX', h_aa, t1_aaee_ab, t1_caee_ba, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,Iyab,wuab,xzwu->IX', v_aaaa, t1_caee_ab, t1_aaee_ab, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,xwab,Iuab,ywzu->IX', v_aaaa, t1_aaee_ab, t1_caee_ab, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,xwab,Iuba,ywzu->IX', v_aaaa, t1_aaee_ab, t1_caee_ba, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('Xxyz,xzab,Iwab,yw->IX', v_aaaa, t1_aaee_ab, t1_caee_ab, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,xzab,Iwba,yw->IX', v_aaaa, t1_aaee_ab, t1_caee_ba, rdm_ca, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,zwab,Iuab,ywxu->IX', v_aaaa, t1_aaee_ab, t1_caee_ab, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('Xxyz,zwab,Iuba,ywux->IX', v_aaaa, t1_aaee_ab, t1_caee_ba, rdm_ccaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Ixab,Xuab,zuwy->IX', v_aaaa, t1_caee_ab, t1_aaee_ab, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Ixab,Xuba,zuwy->IX', v_aaaa, t1_caee_ab, t1_aaee_ba, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Ixab,uvab,Xywuvz->IX', v_aaaa, t1_caee_ab, t1_aaee_ab, rdm_cccaaa, optimize = einsum_type)
        temp += 1/2 * einsum('xyzw,Xxab,Iuab,zuwy->IX', v_aaaa, t1_aaee_ab, t1_caee_ab, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,Xxab,Iuba,zuwy->IX', v_aaaa, t1_aaee_ab, t1_caee_ba, rdm_ccaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,xuab,Ivab,Xzvywu->IX', v_aaaa, t1_aaee_ab, t1_caee_ab, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/6 * einsum('xyzw,xuab,Ivba,Xzvuwy->IX', v_aaaa, t1_aaee_ab, t1_caee_ba, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,xuab,Ivba,Xzvuyw->IX', v_aaaa, t1_aaee_ab, t1_caee_ba, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,xuab,Ivba,Xzvwuy->IX', v_aaaa, t1_aaee_ab, t1_caee_ba, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,xuab,Ivba,Xzvwyu->IX', v_aaaa, t1_aaee_ab, t1_caee_ba, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,xuab,Ivba,Xzvyuw->IX', v_aaaa, t1_aaee_ab, t1_caee_ba, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,xuab,Ivba,Xzvywu->IX', v_aaaa, t1_aaee_ab, t1_caee_ba, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/4 * einsum('xyzw,xzab,Iuab,Xuyw->IX', v_aaaa, t1_aaee_ab, t1_caee_ab, rdm_ccaa, optimize = einsum_type)

        V1 += temp
        mr_adc.log.timer_debug("contracting t1.aaee t1.caee", *cput1)
    del(e_extern, t1_aaee_ab, t1_aaee_ba, t1_caee_ab, t1_caee_ba)

    # Compute denominators
    d_ip = (-e_core[:,None] + evals)
    d_ip = d_ip**(-1)

    # Compute T[+1']^(2) amplitudes
    S_12_V_p1p = einsum("iP,Pm->im", V1, S_p1p_12_inv_act, optimize = einsum_type)
    S_12_V_p1p = einsum("mp,im->ip", evecs, S_12_V_p1p, optimize = einsum_type)
    S_12_V_p1p *= d_ip ###S_12_V_p1p = einsum("ip,ip->ip", d_ip, S_12_V_p1p, optimize = einsum_type)
    S_12_V_p1p = einsum("mp,ip->im", evecs, S_12_V_p1p, optimize = einsum_type)
    del(V1, d_ip, evals, evecs)

    ## Compute T[+1']^(2) t2_ca tensor
    t2_ca = einsum("Pm,im->iP", S_p1p_12_inv_act, S_12_V_p1p, optimize = einsum_type)
    del(S_p1p_12_inv_act, S_12_V_p1p)
 
    mr_adc.log.extra("Norm of T[+1']^(2):                          %20.12f" % np.linalg.norm(t2_ca))
    mr_adc.log.timer("computing T[+1']^(2) amplitudes", *cput0)

    return t2_ca

def compute_t2_0pp_singles(mr_adc):

    cput0 = (logger.process_clock(), logger.perf_counter())
    mr_adc.log.extra("\nComputing T[0'']^(2) amplitudes...")

    # Import Prism interface
    interface = mr_adc.interface

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Variables from kernel
    ncore   = mr_adc.ncore
    ncas    = mr_adc.ncas
    nextern = mr_adc.nextern

    # Compute K_caca matrix
    K_caca = mr_adc_intermediates.compute_K_0pp(mr_adc)

    # Compute S^{-1/2} matrix: Orthogonalization and overlap truncation only in the active space
    S_0p_12_inv_act = mr_adc_overlap.compute_S12_0pp(mr_adc)

    # Compute K^{-1} matrix
    SKS = reduce(np.dot, (S_0p_12_inv_act.T, K_caca, S_0p_12_inv_act))
    evals, evecs = np.linalg.eigh(SKS)
    del(SKS)

    if np.any(evals) and (np.amin(np.absolute(evals)) < 1e-6):
        mr_adc.log.warn("Small denominator of %e is detected in the T[0'']^(2) amplitude equations...", np.amin(np.absolute(evals)))
 
    # Define functions to compute amplitude contributions to V1  
    ## t1_aaee
    def compute_V1__t1_m2(mr_adc, V1):
        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        ## One-electron integrals
        h_aa = mr_adc.h1eff.aa

        ## Two-electron integrals
        v_aaaa = mr_adc.v2e.aaaa

        ## Reduced density matrices
        rdm_ccaa = mr_adc.rdm.ccaa
        rdm_cccaaa = mr_adc.rdm.cccaaa
        rdm_ccccaaaa = mr_adc.rdm.ccccaaaa
        
        chunks = tools.calculate_chunks(mr_adc, nextern, [ncas, ncas, nextern], ntensors = 2)
        for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
            cput1 = (logger.process_clock(), logger.perf_counter())
            mr_adc.log.debug("v2e.aeae [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)
    
            ## Two-electron integrals
            v_aeae = mr_adc.v2e.aeae[:, s_chunk:f_chunk, :, :]
 
            ## Amplitudes
            t1_aaee = mr_adc.t1.aaee[:, :, s_chunk:f_chunk, :]

            temp =- 1/2 * einsum('Yxab,yazb,Xxyz->XY', t1_aaee, v_aeae, rdm_ccaa, optimize = einsum_type)
            temp -= 1/2 * einsum('xyab,Yazb,Xzxy->XY', t1_aaee, v_aeae, rdm_ccaa, optimize = einsum_type)
            temp -= 1/4 * einsum('xyab,zawb,XxyYzw->XY', t1_aaee, v_aeae, rdm_cccaaa, optimize = einsum_type)
            temp -= 1/4 * einsum('xyab,zawb,XzwYxy->XY', t1_aaee, v_aeae, rdm_cccaaa, optimize = einsum_type)
 
            V1 += temp
            mr_adc.log.timer_debug("contracting v2e.aeae", *cput1)
        del(t1_aaee, v_aeae)

        t1_aaee_INT = np.zeros((ncas, ncas, ncas, ncas))
        chunks = tools.calculate_chunks(mr_adc, nextern, [ncas, ncas, nextern], ntensors = 2)
        for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
            cput1 = (logger.process_clock(), logger.perf_counter())
            mr_adc.log.debug("t1.aaee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)
 
            ## Molecular Orbitals Energies
            e_extern = mr_adc.mo_energy.e[s_chunk:f_chunk]
 
            ## Amplitudes
            t1_aaee = mr_adc.t1.aaee[:, :, s_chunk:f_chunk, :]

            t1_aaee_INT += einsum('xuab,vsab->xuvs', t1_aaee, t1_aaee)

            temp =- 1/2 * einsum('a,Yxab,yzab,Xxyz->XY', e_extern, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
            temp -= 1/2 * einsum('a,xYab,yzab,Xxzy->XY', e_extern, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
            temp += 1/6 * einsum('a,xyab,zwab,XxyYwz->XY', e_extern, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
            temp -= 1/3 * einsum('a,xyab,zwab,XxyYzw->XY', e_extern, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
            temp += 1/6 * einsum('a,xyab,zwab,XxywYz->XY', e_extern, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
            temp += 1/6 * einsum('a,xyab,zwab,XxywzY->XY', e_extern, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
            temp += 1/6 * einsum('a,xyab,zwab,XxyzYw->XY', e_extern, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)
            temp += 1/6 * einsum('a,xyab,zwab,XxyzwY->XY', e_extern, t1_aaee, t1_aaee, rdm_cccaaa, optimize = einsum_type)

            V1 += temp
            mr_adc.log.timer_debug("contracting t1.aaee", *cput1)
        del(e_extern, t1_aaee)

        temp  = 1/4 * einsum('Yx,xyzw,Xyzw->XY', h_aa, t1_aaee_INT, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,Yxzw,Xyzw->XY', h_aa, t1_aaee_INT, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,xzYw,Xwyz->XY', h_aa, t1_aaee_INT, rdm_ccaa, optimize = einsum_type)
        temp += 1/4 * einsum('xy,xzwY,Xwzy->XY', h_aa, t1_aaee_INT, rdm_ccaa, optimize = einsum_type)
        temp += 5/24 * einsum('xy,xzwu,XwuYyz->XY', h_aa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xy,xzwu,XwuYzy->XY', h_aa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xy,xzwu,XwuyYz->XY', h_aa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xy,xzwu,XwuyzY->XY', h_aa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xy,xzwu,XwuzYy->XY', h_aa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xy,xzwu,XwuzyY->XY', h_aa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xy,xzwu,XyzYuw->XY', h_aa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp += 5/24 * einsum('xy,xzwu,XyzYwu->XY', h_aa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xy,xzwu,XyzuYw->XY', h_aa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xy,xzwu,XyzuwY->XY', h_aa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xy,xzwu,XyzwYu->XY', h_aa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xy,xzwu,XyzwuY->XY', h_aa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,xwuv,Xywuvz->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 * einsum('Yxyz,xwuv,Xywuzv->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,xwuv,Xywvuz->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,xwuv,Xywvzu->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,xwuv,Xywzuv->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('Yxyz,xwuv,Xywzvu->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('Yxyz,xzwu,Xywu->XY', v_aaaa, t1_aaee_INT, rdm_ccaa, optimize = einsum_type)
        temp -= 1/24 * einsum('Yxyz,ywuv,Xuvwxz->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('Yxyz,ywuv,Xuvwzx->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('Yxyz,ywuv,Xuvxwz->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp += 5/24 * einsum('Yxyz,ywuv,Xuvxzw->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('Yxyz,ywuv,Xuvzwx->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('Yxyz,ywuv,Xuvzxw->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('Yxyz,zwuv,Xywuvx->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('Yxyz,zwuv,Xywuxv->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('Yxyz,zwuv,Xywvux->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('Yxyz,zwuv,Xywvxu->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp += 5/24 * einsum('Yxyz,zwuv,Xywxuv->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('Yxyz,zwuv,Xywxvu->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,Yxuv,Xywuvz->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,xuYv,Xzvywu->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp += 1/6 *  einsum('xyzw,xuvY,Xzvuwy->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,xuvY,Xzvuyw->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,xuvY,Xzvwuy->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,xuvY,Xzvwyu->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,xuvY,Xzvyuw->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,xuvY,Xzvywu->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp += 1/4 * einsum('xyzw,xzYu,Xuyw->XY', v_aaaa, t1_aaee_INT, rdm_ccaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,xzuv,XuvYwy->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,xzuv,XuvYyw->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,xzuv,XuvwyY->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,xzuv,XuvywY->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp += 1/12 * einsum('xyzw,xzuv,XywYuv->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,xzuv,XywYvu->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,xzuv,XywuvY->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,xzuv,XywvuY->XY', v_aaaa, t1_aaee_INT, rdm_cccaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,xuvs,XywuYsvz->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,xuvs,XywuYszv->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,xuvs,XywuYvsz->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/24 * einsum('xyzw,xuvs,XywuYvzs->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,xuvs,XywuYzsv->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,xuvs,XywuYzvs->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,xuvs,XywusYvz->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,xuvs,XywusYzv->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,xuvs,XywusvYz->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,xuvs,XywuvYsz->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,xuvs,XywuvsYz->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,xuvs,XywuvzYs->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,xuvs,XywuzYsv->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,xuvs,XywuzvYs->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,xuvs,XzvsYuwy->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/16 * einsum('xyzw,xuvs,XzvsYuyw->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,xuvs,XzvsYwuy->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp += 5/24 * einsum('xyzw,xuvs,XzvsYwyu->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/12 * einsum('xyzw,xuvs,XzvsYyuw->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,xuvs,XzvsYywu->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,xuvs,XzvswYyu->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,xuvs,XzvswuYy->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/48 * einsum('xyzw,xuvs,XzvswuyY->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp += 1/24 * einsum('xyzw,xuvs,XzvswyYu->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,xuvs,XzvsyYuw->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,xuvs,XzvsyuYw->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/48 * einsum('xyzw,xuvs,XzvsyuwY->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        temp -= 1/24 * einsum('xyzw,xuvs,XzvsywuY->XY', v_aaaa, t1_aaee_INT, rdm_ccccaaaa, optimize = einsum_type)
        V1 += temp

    ## t1_caee
    def compute_V1__t1_m1(mr_adc, V1):
        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        ## Molecular Orbitals Energies
        e_core = mr_adc.mo_energy.c

        ## One-electron integrals
        h_aa = mr_adc.h1eff.aa

        ## Two-electron integrals
        v_aaaa = mr_adc.v2e.aaaa

        ## Reduced density matrices
        rdm_ca = mr_adc.rdm.ca 
        rdm_ccaa = mr_adc.rdm.ccaa
        rdm_cccaaa = mr_adc.rdm.cccaaa

        chunks = tools.calculate_chunks(mr_adc, nextern, [ncore, ncas, nextern], ntensors = 3)
        for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
            cput1 = (logger.process_clock(), logger.perf_counter())
            mr_adc.log.debug("v2e.ceae [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)
    
            ## Two-electron integrals
            v_ceae_ab = mr_adc.v2e.ceae[:, s_chunk:f_chunk, :, :]
            v_ceae_ba = mr_adc.v2e.ceae[:, :, :, s_chunk:f_chunk]
 
            ## Amplitudes
            t1_caee = mr_adc.t1.caee[:, :, s_chunk:f_chunk, :]

            temp =- einsum('iYab,iaxb,Xx->XY', t1_caee, v_ceae_ab, rdm_ca, optimize = einsum_type)
            temp -= einsum('ixab,iaYb,Xx->XY', t1_caee, v_ceae_ab, rdm_ca, optimize = einsum_type)
            temp -= einsum('ixab,iayb,XxYy->XY', t1_caee, v_ceae_ab, rdm_ccaa, optimize = einsum_type)
            temp -= einsum('ixab,iayb,XyYx->XY', t1_caee, v_ceae_ab, rdm_ccaa, optimize = einsum_type)

            temp += 1/2 * einsum('iYab,ibxa,Xx->XY', t1_caee, v_ceae_ba, rdm_ca, optimize = einsum_type)
            temp += 1/2 * einsum('ixab,ibYa,Xx->XY', t1_caee, v_ceae_ba, rdm_ca, optimize = einsum_type)
            temp += 1/2 * einsum('ixab,ibya,XxYy->XY', t1_caee, v_ceae_ba, rdm_ccaa, optimize = einsum_type)
            temp += 1/2 * einsum('ixab,ibya,XyYx->XY', t1_caee, v_ceae_ba, rdm_ccaa, optimize = einsum_type)

            V1 += temp
            mr_adc.log.timer_debug("contracting v2e.ceae", *cput1)
        del(t1_caee, v_ceae_ab, v_ceae_ba)

        chunks = tools.calculate_chunks(mr_adc, nextern, [ncore, ncas, nextern], ntensors = 2)
        for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
            cput1 = (logger.process_clock(), logger.perf_counter())
            mr_adc.log.debug("t1.caee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)
    
            ## Molecular Orbitals Energies
            e_extern = mr_adc.mo_energy.e[s_chunk:f_chunk]

            ## Amplitudes
            t1_caee_ab = mr_adc.t1.caee[:, :, s_chunk:f_chunk, :]
            t1_caee_ba = mr_adc.t1.caee[:, :, :, s_chunk:f_chunk]

            temp =- einsum('a,iYab,ixab,Xx->XY', e_extern, t1_caee_ab, t1_caee_ab, rdm_ca, optimize = einsum_type)
            temp += 1/2 * einsum('a,iYab,ixba,Xx->XY', e_extern, t1_caee_ab, t1_caee_ba, rdm_ca, optimize = einsum_type)
            temp += 1/2 * einsum('a,iYba,ixab,Xx->XY', e_extern, t1_caee_ba, t1_caee_ab, rdm_ca, optimize = einsum_type)
            temp -= einsum('a,iYba,ixba,Xx->XY', e_extern, t1_caee_ba, t1_caee_ba, rdm_ca, optimize = einsum_type)
            temp -= einsum('a,ixab,iyab,XxYy->XY', e_extern, t1_caee_ab, t1_caee_ab, rdm_ccaa, optimize = einsum_type)
            temp += 1/2 * einsum('a,ixab,iyba,XxYy->XY', e_extern, t1_caee_ab, t1_caee_ba, rdm_ccaa, optimize = einsum_type)
            temp += 1/2 * einsum('a,ixba,iyab,XxYy->XY', e_extern, t1_caee_ba, t1_caee_ab, rdm_ccaa, optimize = einsum_type)
            temp -= einsum('a,ixba,iyba,XxYy->XY', e_extern, t1_caee_ba, t1_caee_ba, rdm_ccaa, optimize = einsum_type)
            temp += 1/2 * einsum('i,iYab,ixab,Xx->XY', e_core, t1_caee_ab, t1_caee_ab, rdm_ca, optimize = einsum_type)
            temp -= 1/4 * einsum('i,iYab,ixba,Xx->XY', e_core, t1_caee_ab, t1_caee_ba, rdm_ca, optimize = einsum_type)
            temp += 1/2 * einsum('i,ixab,iYab,Xx->XY', e_core, t1_caee_ab, t1_caee_ab, rdm_ca, optimize = einsum_type)
            temp -= 1/4 * einsum('i,ixab,iYba,Xx->XY', e_core, t1_caee_ab, t1_caee_ba, rdm_ca, optimize = einsum_type)
            temp += 1/2 * einsum('i,ixab,iyab,XxYy->XY', e_core, t1_caee_ab, t1_caee_ab, rdm_ccaa, optimize = einsum_type)
            temp += 1/2 * einsum('i,ixab,iyab,XyYx->XY', e_core, t1_caee_ab, t1_caee_ab, rdm_ccaa, optimize = einsum_type)
            temp -= 1/4 * einsum('i,ixab,iyba,XxYy->XY', e_core, t1_caee_ab, t1_caee_ba, rdm_ccaa, optimize = einsum_type)
            temp -= 1/4 * einsum('i,ixab,iyba,XyYx->XY', e_core, t1_caee_ab, t1_caee_ba, rdm_ccaa, optimize = einsum_type)
            temp += 1/2 * einsum('Yx,ixab,iyab,Xy->XY', h_aa, t1_caee_ab, t1_caee_ab, rdm_ca, optimize = einsum_type)
            temp -= 1/4 * einsum('Yx,ixab,iyba,Xy->XY', h_aa, t1_caee_ab, t1_caee_ba, rdm_ca, optimize = einsum_type)
            temp += 1/2 * einsum('xy,ixab,iYab,Xy->XY', h_aa, t1_caee_ab, t1_caee_ab, rdm_ca, optimize = einsum_type)
            temp -= 1/4 * einsum('xy,ixab,iYba,Xy->XY', h_aa, t1_caee_ab, t1_caee_ba, rdm_ca, optimize = einsum_type)
            temp += 1/2 * einsum('xy,ixab,izab,XyYz->XY', h_aa, t1_caee_ab, t1_caee_ab, rdm_ccaa, optimize = einsum_type)
            temp += 1/2 * einsum('xy,ixab,izab,XzYy->XY', h_aa, t1_caee_ab, t1_caee_ab, rdm_ccaa, optimize = einsum_type)
            temp -= 1/4 * einsum('xy,ixab,izba,XyYz->XY', h_aa, t1_caee_ab, t1_caee_ba, rdm_ccaa, optimize = einsum_type)
            temp -= 1/4 * einsum('xy,ixab,izba,XzYy->XY', h_aa, t1_caee_ab, t1_caee_ba, rdm_ccaa, optimize = einsum_type)
            temp += 1/2 * einsum('Yxyz,ixab,iwab,Xywz->XY', v_aaaa, t1_caee_ab, t1_caee_ab, rdm_ccaa, optimize = einsum_type)
            temp -= 1/4 * einsum('Yxyz,ixab,iwba,Xywz->XY', v_aaaa, t1_caee_ab, t1_caee_ba, rdm_ccaa, optimize = einsum_type)
            temp += 1/2 * einsum('Yxyz,iyab,iwab,Xwxz->XY', v_aaaa, t1_caee_ab, t1_caee_ab, rdm_ccaa, optimize = einsum_type)
            temp -= 1/4 * einsum('Yxyz,iyab,iwba,Xwxz->XY', v_aaaa, t1_caee_ab, t1_caee_ba, rdm_ccaa, optimize = einsum_type)
            temp += 1/2 * einsum('Yxyz,izab,iwab,Xyxw->XY', v_aaaa, t1_caee_ab, t1_caee_ab, rdm_ccaa, optimize = einsum_type)
            temp -= 1/4 * einsum('Yxyz,izab,iwba,Xyxw->XY', v_aaaa, t1_caee_ab, t1_caee_ba, rdm_ccaa, optimize = einsum_type)
            temp += 1/2 * einsum('xyzw,ixab,iYab,Xzyw->XY', v_aaaa, t1_caee_ab, t1_caee_ab, rdm_ccaa, optimize = einsum_type)
            temp -= 1/4 * einsum('xyzw,ixab,iYba,Xzyw->XY', v_aaaa, t1_caee_ab, t1_caee_ba, rdm_ccaa, optimize = einsum_type)
            temp += 1/3 * einsum('xyzw,ixab,iuab,XywYuz->XY', v_aaaa, t1_caee_ab, t1_caee_ab, rdm_cccaaa, optimize = einsum_type)
            temp -= 1/6 * einsum('xyzw,ixab,iuab,XywYzu->XY', v_aaaa, t1_caee_ab, t1_caee_ab, rdm_cccaaa, optimize = einsum_type)
            temp -= 1/6 * einsum('xyzw,ixab,iuab,XywuYz->XY', v_aaaa, t1_caee_ab, t1_caee_ab, rdm_cccaaa, optimize = einsum_type)
            temp -= 1/6 * einsum('xyzw,ixab,iuab,XywuzY->XY', v_aaaa, t1_caee_ab, t1_caee_ab, rdm_cccaaa, optimize = einsum_type)
            temp -= 1/6 * einsum('xyzw,ixab,iuab,XywzYu->XY', v_aaaa, t1_caee_ab, t1_caee_ab, rdm_cccaaa, optimize = einsum_type)
            temp -= 1/6 * einsum('xyzw,ixab,iuab,XywzuY->XY', v_aaaa, t1_caee_ab, t1_caee_ab, rdm_cccaaa, optimize = einsum_type)
            temp += 1/3 * einsum('xyzw,ixab,iuab,XzuYwy->XY', v_aaaa, t1_caee_ab, t1_caee_ab, rdm_cccaaa, optimize = einsum_type)
            temp -= 1/6 * einsum('xyzw,ixab,iuab,XzuYyw->XY', v_aaaa, t1_caee_ab, t1_caee_ab, rdm_cccaaa, optimize = einsum_type)
            temp -= 1/6 * einsum('xyzw,ixab,iuab,XzuwYy->XY', v_aaaa, t1_caee_ab, t1_caee_ab, rdm_cccaaa, optimize = einsum_type)
            temp -= 1/6 * einsum('xyzw,ixab,iuab,XzuwyY->XY', v_aaaa, t1_caee_ab, t1_caee_ab, rdm_cccaaa, optimize = einsum_type)
            temp -= 1/6 * einsum('xyzw,ixab,iuab,XzuyYw->XY', v_aaaa, t1_caee_ab, t1_caee_ab, rdm_cccaaa, optimize = einsum_type)
            temp -= 1/6 * einsum('xyzw,ixab,iuab,XzuywY->XY', v_aaaa, t1_caee_ab, t1_caee_ab, rdm_cccaaa, optimize = einsum_type)
            temp -= 1/6 * einsum('xyzw,ixab,iuba,XywYuz->XY', v_aaaa, t1_caee_ab, t1_caee_ba, rdm_cccaaa, optimize = einsum_type)
            temp += 1/12 * einsum('xyzw,ixab,iuba,XywYzu->XY', v_aaaa, t1_caee_ab, t1_caee_ba, rdm_cccaaa, optimize = einsum_type)
            temp += 1/12 * einsum('xyzw,ixab,iuba,XywuYz->XY', v_aaaa, t1_caee_ab, t1_caee_ba, rdm_cccaaa, optimize = einsum_type)
            temp += 1/12 * einsum('xyzw,ixab,iuba,XywuzY->XY', v_aaaa, t1_caee_ab, t1_caee_ba, rdm_cccaaa, optimize = einsum_type)
            temp += 1/12 * einsum('xyzw,ixab,iuba,XywzYu->XY', v_aaaa, t1_caee_ab, t1_caee_ba, rdm_cccaaa, optimize = einsum_type)
            temp += 1/12 * einsum('xyzw,ixab,iuba,XywzuY->XY', v_aaaa, t1_caee_ab, t1_caee_ba, rdm_cccaaa, optimize = einsum_type)
            temp -= 1/6 * einsum('xyzw,ixab,iuba,XzuYwy->XY', v_aaaa, t1_caee_ab, t1_caee_ba, rdm_cccaaa, optimize = einsum_type)
            temp += 1/12 * einsum('xyzw,ixab,iuba,XzuYyw->XY', v_aaaa, t1_caee_ab, t1_caee_ba, rdm_cccaaa, optimize = einsum_type)
            temp += 1/12 * einsum('xyzw,ixab,iuba,XzuwYy->XY', v_aaaa, t1_caee_ab, t1_caee_ba, rdm_cccaaa, optimize = einsum_type)
            temp += 1/12 * einsum('xyzw,ixab,iuba,XzuwyY->XY', v_aaaa, t1_caee_ab, t1_caee_ba, rdm_cccaaa, optimize = einsum_type)
            temp += 1/12 * einsum('xyzw,ixab,iuba,XzuyYw->XY', v_aaaa, t1_caee_ab, t1_caee_ba, rdm_cccaaa, optimize = einsum_type)
            temp += 1/12 * einsum('xyzw,ixab,iuba,XzuywY->XY', v_aaaa, t1_caee_ab, t1_caee_ba, rdm_cccaaa, optimize = einsum_type)

            V1 += temp
            mr_adc.log.timer_debug("contracting t1.caee", *cput1)
        del(e_extern, t1_caee_ab, t1_caee_ba)

    ## t1_ccee 
    def compute_V1__t1_0(mr_adc, V1):
        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        ## Molecular Orbitals Energies
        e_core = mr_adc.mo_energy.c

        ## Reduced density matrices
        rdm_ca = mr_adc.rdm.ca 

        chunks = tools.calculate_chunks(mr_adc, nextern, [ncore, ncore, nextern], ntensors = 3)
        for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
            cput1 = (logger.process_clock(), logger.perf_counter())
            mr_adc.log.debug("v2e.cece [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)
  
            ## Two-electron integrals
            v_cece = mr_adc.v2e.cece[:, s_chunk:f_chunk, :, :]
 
            ## Amplitudes
            t1_ccee = mr_adc.t1.ccee[:, :, s_chunk:f_chunk, :]

            temp =- 2 * einsum('ijab,iajb,XY->XY', t1_ccee, v_cece, rdm_ca, optimize = einsum_type)
            temp += einsum('ijab,jaib,XY->XY', t1_ccee, v_cece, rdm_ca, optimize = einsum_type)

            V1 += temp
            mr_adc.log.timer_debug("contracting v2e.cece", *cput1)
        del(t1_ccee, v_cece)

        chunks = tools.calculate_chunks(mr_adc, nextern, [ncore, ncore, nextern], ntensors = 3)
        for i_chunk, (s_chunk, f_chunk) in enumerate(chunks):
            cput1 = (logger.process_clock(), logger.perf_counter())
            mr_adc.log.debug("t1.ccee [%i/%i], chunk [%i:%i]", i_chunk + 1, len(chunks), s_chunk, f_chunk)
 
            ## Molecular Orbitals Energies
            e_extern = mr_adc.mo_energy.e[s_chunk:f_chunk]
   
            ## Amplitudes
            t1_ccee_ab = mr_adc.t1.ccee[:, :, s_chunk:f_chunk, :]
            t1_ccee_ba = mr_adc.t1.ccee[:, :, :, s_chunk:f_chunk]
 
            temp =- 2 * einsum('a,ijab,ijab,XY->XY', e_extern, t1_ccee_ab, t1_ccee_ab, rdm_ca, optimize = einsum_type)
            temp += einsum('a,ijab,jiab,XY->XY', e_extern, t1_ccee_ab, t1_ccee_ab, rdm_ca, optimize = einsum_type)
            temp += 2 * einsum('i,ijab,ijab,XY->XY', e_core, t1_ccee_ab, t1_ccee_ab, rdm_ca, optimize = einsum_type)
            temp -= einsum('i,ijab,ijba,XY->XY', e_core, t1_ccee_ab, t1_ccee_ba, rdm_ca, optimize = einsum_type)
 
            V1 += temp
            mr_adc.log.timer_debug("contracting t1.ccee", *cput1)
        del(e_extern, t1_ccee_ab, t1_ccee_ba)

    ## t1_ccea 
    def compute_V1__t1_p1(mr_adc, V1):
        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        ## Molecular Orbitals Energies
        e_core = mr_adc.mo_energy.c
        e_extern = mr_adc.mo_energy.e

        ## One-electron integrals
        h_aa = mr_adc.h1eff.aa

        ## Two-electron integrals
        v_cace = mr_adc.v2e.cace
        v_aaaa = mr_adc.v2e.aaaa

        ## Amplitudes
        t1_ccae = mr_adc.t1.ccae

        ## Reduced density matrices
        rdm_ca = mr_adc.rdm.ca 
        rdm_ccaa = mr_adc.rdm.ccaa 
        rdm_cccaaa = mr_adc.rdm.cccaaa 

        V1_p1  = einsum('ijYa,ixja,Xx->XY', t1_ccae, v_cace, rdm_ca, optimize = einsum_type)
        V1_p1 -= 1/2 * einsum('ijYa,jxia,Xx->XY', t1_ccae, v_cace, rdm_ca, optimize = einsum_type)
        V1_p1 += einsum('ijxa,iYja,Xx->XY', t1_ccae, v_cace, rdm_ca, optimize = einsum_type)
        V1_p1 -= 4 * einsum('ijxa,ixja,XY->XY', t1_ccae, v_cace, rdm_ca, optimize = einsum_type)
        V1_p1 += einsum('ijxa,iyja,XxYy->XY', t1_ccae, v_cace, rdm_ccaa, optimize = einsum_type)
        V1_p1 += einsum('ijxa,iyja,XyYx->XY', t1_ccae, v_cace, rdm_ccaa, optimize = einsum_type)
        V1_p1 -= 1/2 * einsum('ijxa,jYia,Xx->XY', t1_ccae, v_cace, rdm_ca, optimize = einsum_type)
        V1_p1 += 2 * einsum('ijxa,jxia,XY->XY', t1_ccae, v_cace, rdm_ca, optimize = einsum_type)
        V1_p1 -= 1/2 * einsum('ijxa,jyia,XxYy->XY', t1_ccae, v_cace, rdm_ccaa, optimize = einsum_type)
        V1_p1 -= 1/2 * einsum('ijxa,jyia,XyYx->XY', t1_ccae, v_cace, rdm_ccaa, optimize = einsum_type)
        V1_p1 += einsum('a,ijxa,ijYa,Xx->XY', e_extern, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 -= 2 * einsum('a,ijxa,ijxa,XY->XY', e_extern, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 += einsum('a,ijxa,ijya,XyYx->XY', e_extern, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 -= 1/2 * einsum('a,ijxa,jiYa,Xx->XY', e_extern, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 += einsum('a,ijxa,jixa,XY->XY', e_extern, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 -= 1/2 * einsum('a,ijxa,jiya,XyYx->XY', e_extern, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 -= 1/2 * einsum('i,ijYa,ijxa,Xx->XY', e_core, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 += 1/4 * einsum('i,ijYa,jixa,Xx->XY', e_core, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 -= 1/2 * einsum('i,ijxa,ijYa,Xx->XY', e_core, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 += 2 * einsum('i,ijxa,ijxa,XY->XY', e_core, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 -= 1/2 * einsum('i,ijxa,ijya,XxYy->XY', e_core, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 -= 1/2 * einsum('i,ijxa,ijya,XyYx->XY', e_core, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 += 1/4 * einsum('i,ijxa,jiYa,Xx->XY', e_core, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 -= einsum('i,ijxa,jixa,XY->XY', e_core, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 += 1/4 * einsum('i,ijxa,jiya,XxYy->XY', e_core, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 += 1/4 * einsum('i,ijxa,jiya,XyYx->XY', e_core, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 += 1/4 * einsum('i,jiYa,ijxa,Xx->XY', e_core, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 -= 1/2 * einsum('i,jiYa,jixa,Xx->XY', e_core, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 += 1/4 * einsum('i,jixa,ijYa,Xx->XY', e_core, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 -= einsum('i,jixa,ijxa,XY->XY', e_core, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 += 1/4 * einsum('i,jixa,ijya,XxYy->XY', e_core, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 += 1/4 * einsum('i,jixa,ijya,XyYx->XY', e_core, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 -= 1/2 * einsum('i,jixa,jiYa,Xx->XY', e_core, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 += 2 * einsum('i,jixa,jixa,XY->XY', e_core, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 -= 1/2 * einsum('i,jixa,jiya,XxYy->XY', e_core, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 -= 1/2 * einsum('i,jixa,jiya,XyYx->XY', e_core, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 += 1/2 * einsum('Yx,ijxa,ijya,Xy->XY', h_aa, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 -= 1/4 * einsum('Yx,ijxa,jiya,Xy->XY', h_aa, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 += 1/2 * einsum('xy,ijxa,ijYa,Xy->XY', h_aa, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 -= 2 * einsum('xy,ijxa,ijya,XY->XY', h_aa, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 += 1/2 * einsum('xy,ijxa,ijza,XyYz->XY', h_aa, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 += 1/2 * einsum('xy,ijxa,ijza,XzYy->XY', h_aa, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 -= 1/4 * einsum('xy,ijxa,jiYa,Xy->XY', h_aa, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 += einsum('xy,ijxa,jiya,XY->XY', h_aa, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 -= 1/4 * einsum('xy,ijxa,jiza,XyYz->XY', h_aa, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 -= 1/4 * einsum('xy,ijxa,jiza,XzYy->XY', h_aa, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 += 1/2 * einsum('Yxyz,ijxa,ijwa,Xywz->XY', v_aaaa, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 -= 1/4 * einsum('Yxyz,ijxa,jiwa,Xywz->XY', v_aaaa, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 += 1/2 * einsum('Yxyz,ijya,ijwa,Xwxz->XY', v_aaaa, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 += einsum('Yxyz,ijya,ijxa,Xz->XY', v_aaaa, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 -= 2 * einsum('Yxyz,ijya,ijza,Xx->XY', v_aaaa, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 -= 1/4 * einsum('Yxyz,ijya,jiwa,Xwxz->XY', v_aaaa, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 -= 1/2 * einsum('Yxyz,ijya,jixa,Xz->XY', v_aaaa, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 += einsum('Yxyz,ijya,jiza,Xx->XY', v_aaaa, t1_ccae, t1_ccae, rdm_ca, optimize = einsum_type)
        V1_p1 += 1/2 * einsum('Yxyz,ijza,ijwa,Xyxw->XY', v_aaaa, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 -= 1/4 * einsum('Yxyz,ijza,jiwa,Xyxw->XY', v_aaaa, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 += 1/2 * einsum('xyzw,ijxa,ijYa,Xzyw->XY', v_aaaa, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 += 1/3 * einsum('xyzw,ijxa,ijua,XywYuz->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 -= 1/6 * einsum('xyzw,ijxa,ijua,XywYzu->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 -= 1/6 * einsum('xyzw,ijxa,ijua,XywuYz->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 -= 1/6 * einsum('xyzw,ijxa,ijua,XywuzY->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 -= 1/6 * einsum('xyzw,ijxa,ijua,XywzYu->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 -= 1/6 * einsum('xyzw,ijxa,ijua,XywzuY->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 += 1/3 * einsum('xyzw,ijxa,ijua,XzuYwy->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 -= 1/6 * einsum('xyzw,ijxa,ijua,XzuYyw->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 -= 1/6 * einsum('xyzw,ijxa,ijua,XzuwYy->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 -= 1/6 * einsum('xyzw,ijxa,ijua,XzuwyY->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 -= 1/6 * einsum('xyzw,ijxa,ijua,XzuyYw->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 -= 1/6 * einsum('xyzw,ijxa,ijua,XzuywY->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 += einsum('xyzw,ijxa,ijwa,XzYy->XY', v_aaaa, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 -= 2 * einsum('xyzw,ijxa,ijya,XzYw->XY', v_aaaa, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 -= 1/4 * einsum('xyzw,ijxa,jiYa,Xzyw->XY', v_aaaa, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 -= 1/6 * einsum('xyzw,ijxa,jiua,XywYuz->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 += 1/12 * einsum('xyzw,ijxa,jiua,XywYzu->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 += 1/12 * einsum('xyzw,ijxa,jiua,XywuYz->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 += 1/12 * einsum('xyzw,ijxa,jiua,XywuzY->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 += 1/12 * einsum('xyzw,ijxa,jiua,XywzYu->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 += 1/12 * einsum('xyzw,ijxa,jiua,XywzuY->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 -= 1/6 * einsum('xyzw,ijxa,jiua,XzuYwy->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 += 1/12 * einsum('xyzw,ijxa,jiua,XzuYyw->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 += 1/12 * einsum('xyzw,ijxa,jiua,XzuwYy->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 += 1/12 * einsum('xyzw,ijxa,jiua,XzuwyY->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 += 1/12 * einsum('xyzw,ijxa,jiua,XzuyYw->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 += 1/12 * einsum('xyzw,ijxa,jiua,XzuywY->XY', v_aaaa, t1_ccae, t1_ccae, rdm_cccaaa, optimize = einsum_type)
        V1_p1 -= 1/2 * einsum('xyzw,ijxa,jiwa,XzYy->XY', v_aaaa, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1_p1 += einsum('xyzw,ijxa,jiya,XzYw->XY', v_aaaa, t1_ccae, t1_ccae, rdm_ccaa, optimize = einsum_type)
        V1 += V1_p1
        #print (">> Norm of t1_p1 contribution:                     %20.12f\n" % (np.linalg.norm(V1_p1)))


    ## t1_ccaa 
    def compute_V1__t1_p2(mr_adc, V1):
        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        ## Molecular Orbitals Energies
        e_core = mr_adc.mo_energy.c
        e_extern = mr_adc.mo_energy.e

        ## One-electron integrals
        h_aa = mr_adc.h1eff.aa

        ## Two-electron integrals
        v_caca = mr_adc.v2e.caca
        v_aaaa = mr_adc.v2e.aaaa

        ## Amplitudes
        t1_ccaa = mr_adc.t1.ccaa

        ## Reduced density matrices
        rdm_ca = mr_adc.rdm.ca 
        rdm_ccaa = mr_adc.rdm.ccaa 
        rdm_cccaaa = mr_adc.rdm.cccaaa 
        rdm_ccccaaaa = mr_adc.rdm.ccccaaaa 
        #rdm_ccccaaaa = np.zeros((ncas, ncas, ncas, ncas, ncas, ncas, ncas, ncas))

        V1_p2 =- 1/2 * einsum('ijYx,ixjy,Xy->XY', t1_ccaa, v_caca, rdm_ca, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('ijYx,iyjz,Xxyz->XY', t1_ccaa, v_caca, rdm_ccaa, optimize = einsum_type)
        V1_p2 += einsum('ijYx,jxiy,Xy->XY', t1_ccaa, v_caca, rdm_ca, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('ijxy,iYjx,Xy->XY', t1_ccaa, v_caca, rdm_ca, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('ijxy,iYjz,Xzxy->XY', t1_ccaa, v_caca, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 2 * einsum('ijxy,ixjy,XY->XY', t1_ccaa, v_caca, rdm_ca, optimize = einsum_type)
        V1_p2 += einsum('ijxy,ixjz,XyYz->XY', t1_ccaa, v_caca, rdm_ccaa, optimize = einsum_type)
        V1_p2 += einsum('ijxy,ixjz,XzYy->XY', t1_ccaa, v_caca, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('ijxy,iyjz,XxYz->XY', t1_ccaa, v_caca, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('ijxy,iyjz,XzYx->XY', t1_ccaa, v_caca, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/4 * einsum('ijxy,izjw,XxyYzw->XY', t1_ccaa, v_caca, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/4 * einsum('ijxy,izjw,XzwYxy->XY', t1_ccaa, v_caca, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += einsum('ijxy,jYix,Xy->XY', t1_ccaa, v_caca, rdm_ca, optimize = einsum_type)
        V1_p2 += einsum('ijxy,jxiy,XY->XY', t1_ccaa, v_caca, rdm_ca, optimize = einsum_type)
        V1_p2 += 1/4 * einsum('i,ijYx,ijxy,Xy->XY', e_core, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('i,ijYx,ijyx,Xy->XY', e_core, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 += 1/4 * einsum('i,ijYx,ijyz,Xxyz->XY', e_core, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += 1/4 * einsum('i,ijxy,ijYx,Xy->XY', e_core, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('i,ijxy,ijYy,Xx->XY', e_core, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 += 1/4 * einsum('i,ijxy,ijYz,Xzxy->XY', e_core, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += 2 * einsum('i,ijxy,ijxy,XY->XY', e_core, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('i,ijxy,ijxz,XyYz->XY', e_core, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('i,ijxy,ijxz,XzYy->XY', e_core, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= einsum('i,ijxy,ijyx,XY->XY', e_core, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 += 1/4 * einsum('i,ijxy,ijyz,XxYz->XY', e_core, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += 1/4 * einsum('i,ijxy,ijyz,XzYx->XY', e_core, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += 1/4 * einsum('i,ijxy,ijzw,XxyYzw->XY', e_core, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/4 * einsum('i,ijxy,ijzw,XzwYxy->XY', e_core, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/4 * einsum('i,ijxy,ijzx,XyYz->XY', e_core, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += 1/4 * einsum('i,ijxy,ijzx,XzYy->XY', e_core, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('i,ijxy,ijzy,XxYz->XY', e_core, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('i,ijxy,ijzy,XzYx->XY', e_core, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('i,ijxy,jiYx,Xy->XY', e_core, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 += 1/4 * einsum('i,ijxy,jiYy,Xx->XY', e_core, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 += 1/4 * einsum('i,ijxy,jiYz,Xzyx->XY', e_core, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('i,jiYx,ijxy,Xy->XY', e_core, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 += 1/4 * einsum('i,jiYx,ijyx,Xy->XY', e_core, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 += 1/4 * einsum('i,jiYx,ijyz,Xxzy->XY', e_core, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/4 * einsum('Yx,ijxy,ijyz,Xz->XY', h_aa, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 -= 1/4 * einsum('Yx,ijxy,ijzw,Xyzw->XY', h_aa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += 1/2 * einsum('Yx,ijxy,jiyz,Xz->XY', h_aa, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('xy,ijYx,ijyz,Xz->XY', h_aa, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 -= 1/4 * einsum('xy,ijYx,ijzw,Xyzw->XY', h_aa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += einsum('xy,ijYx,jiyz,Xz->XY', h_aa, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 -= 1/4 * einsum('xy,ijxz,ijYw,Xwyz->XY', h_aa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += 1/2 * einsum('xy,ijxz,ijYz,Xy->XY', h_aa, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 -= 5/24 * einsum('xy,ijxz,ijwu,XwuYyz->XY', h_aa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('xy,ijxz,ijwu,XwuYzy->XY', h_aa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('xy,ijxz,ijwu,XwuyYz->XY', h_aa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('xy,ijxz,ijwu,XwuyzY->XY', h_aa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('xy,ijxz,ijwu,XwuzYy->XY', h_aa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('xy,ijxz,ijwu,XwuzyY->XY', h_aa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('xy,ijxz,ijwu,XyzYuw->XY', h_aa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 5/24 * einsum('xy,ijxz,ijwu,XyzYwu->XY', h_aa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('xy,ijxz,ijwu,XyzuYw->XY', h_aa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('xy,ijxz,ijwu,XyzuwY->XY', h_aa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('xy,ijxz,ijwu,XyzwYu->XY', h_aa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('xy,ijxz,ijwu,XyzwuY->XY', h_aa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += einsum('xy,ijxz,ijyw,XzYw->XY', h_aa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 2 * einsum('xy,ijxz,ijyz,XY->XY', h_aa, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 -= 1/4 * einsum('xy,ijxz,ijzw,XwYy->XY', h_aa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/4 * einsum('xy,ijxz,ijzw,XyYw->XY', h_aa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/4 * einsum('xy,ijxz,jiYw,Xwzy->XY', h_aa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/4 * einsum('xy,ijxz,jiYz,Xy->XY', h_aa, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('xy,ijxz,jiyw,XzYw->XY', h_aa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += einsum('xy,ijxz,jiyz,XY->XY', h_aa, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 += 1/2 * einsum('xy,ijxz,jizw,XwYy->XY', h_aa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += 1/2 * einsum('xy,ijxz,jizw,XyYw->XY', h_aa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('Yxyz,ijxw,ijuv,Xywuvz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/6 * einsum('Yxyz,ijxw,ijuv,Xywuzv->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('Yxyz,ijxw,ijuv,Xywvuz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('Yxyz,ijxw,ijuv,Xywvzu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('Yxyz,ijxw,ijuv,Xywzuv->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('Yxyz,ijxw,ijuv,Xywzvu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/4 * einsum('Yxyz,ijxw,ijwu,Xyuz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += 1/2 * einsum('Yxyz,ijxw,jiwu,Xyuz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/4 * einsum('Yxyz,ijxz,ijwu,Xywu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('Yxyz,ijyw,ijuv,Xuvwxz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('Yxyz,ijyw,ijuv,Xuvwzx->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('Yxyz,ijyw,ijuv,Xuvxwz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 5/24 * einsum('Yxyz,ijyw,ijuv,Xuvxzw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('Yxyz,ijyw,ijuv,Xuvzwx->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('Yxyz,ijyw,ijuv,Xuvzxw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/4 * einsum('Yxyz,ijyw,ijwu,Xuxz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('Yxyz,ijyw,ijxu,Xuzw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += einsum('Yxyz,ijyw,ijxw,Xz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('Yxyz,ijyw,ijxz,Xw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 += einsum('Yxyz,ijyw,ijzu,Xuxw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 2 * einsum('Yxyz,ijyw,ijzw,Xx->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 += 1/2 * einsum('Yxyz,ijyw,jiwu,Xuxz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('Yxyz,ijyw,jixu,Xuwz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('Yxyz,ijyw,jixw,Xz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 += einsum('Yxyz,ijyw,jixz,Xw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('Yxyz,ijyw,jizu,Xuxw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += einsum('Yxyz,ijyw,jizw,Xx->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('Yxyz,ijzw,ijuv,Xywuvx->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('Yxyz,ijzw,ijuv,Xywuxv->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('Yxyz,ijzw,ijuv,Xywvux->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('Yxyz,ijzw,ijuv,Xywvxu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 5/24 * einsum('Yxyz,ijzw,ijuv,Xywxuv->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('Yxyz,ijzw,ijuv,Xywxvu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/4 * einsum('Yxyz,ijzw,ijwu,Xyxu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += 1/2 * einsum('Yxyz,ijzw,jiwu,Xyxu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/4 * einsum('xyzw,ijYx,ijuv,Xywuvz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('xyzw,ijYx,ijwu,Xyzu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('xyzw,ijYx,ijyu,Xwuz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('xyzw,ijYx,ijyw,Xz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('xyzw,ijYx,jiwu,Xyuz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += einsum('xyzw,ijYx,jiyu,Xwuz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += einsum('xyzw,ijYx,jiyw,Xz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 += 1/2 * einsum('xyzw,ijxu,ijYu,Xzyw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/4 * einsum('xyzw,ijxu,ijYv,Xzvywu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/6 * einsum('xyzw,ijxu,ijuv,XywYvz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxu,ijuv,XywYzv->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxu,ijuv,XywvYz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxu,ijuv,XywvzY->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxu,ijuv,XywzYv->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxu,ijuv,XywzvY->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/6 * einsum('xyzw,ijxu,ijuv,XzvYwy->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxu,ijuv,XzvYyw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxu,ijuv,XzvwYy->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxu,ijuv,XzvwyY->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxu,ijuv,XzvyYw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxu,ijuv,XzvywY->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/16 * einsum('xyzw,ijxu,ijvs,XywuYsvz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxu,ijvs,XywuYszv->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 += 1/16 * einsum('xyzw,ijxu,ijvs,XywuYvsz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 -= 5/24 * einsum('xyzw,ijxu,ijvs,XywuYvzs->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxu,ijvs,XywuYzsv->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('xyzw,ijxu,ijvs,XywuYzvs->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 += 1/48 * einsum('xyzw,ijxu,ijvs,XywusYvz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('xyzw,ijxu,ijvs,XywusYzv->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 -= 1/48 * einsum('xyzw,ijxu,ijvs,XywusvYz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 += 1/48 * einsum('xyzw,ijxu,ijvs,XywuvYsz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 -= 1/48 * einsum('xyzw,ijxu,ijvs,XywuvsYz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 -= 1/24 * einsum('xyzw,ijxu,ijvs,XywuvzYs->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('xyzw,ijxu,ijvs,XywuzYsv->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 -= 1/24 * einsum('xyzw,ijxu,ijvs,XywuzvYs->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 += 1/16 * einsum('xyzw,ijxu,ijvs,XzvsYuwy->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 += 1/16 * einsum('xyzw,ijxu,ijvs,XzvsYuyw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxu,ijvs,XzvsYwuy->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 -= 5/24 * einsum('xyzw,ijxu,ijvs,XzvsYwyu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxu,ijvs,XzvsYyuw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('xyzw,ijxu,ijvs,XzvsYywu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 -= 1/24 * einsum('xyzw,ijxu,ijvs,XzvswYyu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 -= 1/48 * einsum('xyzw,ijxu,ijvs,XzvswuYy->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 -= 1/48 * einsum('xyzw,ijxu,ijvs,XzvswuyY->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 -= 1/24 * einsum('xyzw,ijxu,ijvs,XzvswyYu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('xyzw,ijxu,ijvs,XzvsyYuw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 += 1/48 * einsum('xyzw,ijxu,ijvs,XzvsyuYw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 += 1/48 * einsum('xyzw,ijxu,ijvs,XzvsyuwY->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('xyzw,ijxu,ijvs,XzvsywuY->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p2 += einsum('xyzw,ijxu,ijwu,XzYy->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('xyzw,ijxu,ijwv,XzvYyu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 2 * einsum('xyzw,ijxu,ijyu,XzYw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += einsum('xyzw,ijxu,ijyv,XzvYwu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/4 * einsum('xyzw,ijxu,jiYu,Xzyw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/6 * einsum('xyzw,ijxu,jiYv,Xzvuwy->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxu,jiYv,Xzvuyw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxu,jiYv,Xzvwuy->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxu,jiYv,Xzvwyu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxu,jiYv,Xzvyuw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxu,jiYv,Xzvywu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/3 * einsum('xyzw,ijxu,jiuv,XywYvz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/6 * einsum('xyzw,ijxu,jiuv,XywYzv->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/6 * einsum('xyzw,ijxu,jiuv,XywvYz->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/6 * einsum('xyzw,ijxu,jiuv,XywvzY->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/6 * einsum('xyzw,ijxu,jiuv,XywzYv->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/6 * einsum('xyzw,ijxu,jiuv,XywzvY->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/3 * einsum('xyzw,ijxu,jiuv,XzvYwy->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/6 * einsum('xyzw,ijxu,jiuv,XzvYyw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/6 * einsum('xyzw,ijxu,jiuv,XzvwYy->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/6 * einsum('xyzw,ijxu,jiuv,XzvwyY->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/6 * einsum('xyzw,ijxu,jiuv,XzvyYw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/6 * einsum('xyzw,ijxu,jiuv,XzvywY->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('xyzw,ijxu,jiwu,XzYy->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/3 * einsum('xyzw,ijxu,jiwv,XzvYuy->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/6 * einsum('xyzw,ijxu,jiwv,XzvYyu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/6 * einsum('xyzw,ijxu,jiwv,XzvuYy->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/6 * einsum('xyzw,ijxu,jiwv,XzvuyY->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/6 * einsum('xyzw,ijxu,jiwv,XzvyYu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/6 * einsum('xyzw,ijxu,jiwv,XzvyuY->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += einsum('xyzw,ijxu,jiyu,XzYw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('xyzw,ijxu,jiyv,XzvYwu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/4 * einsum('xyzw,ijxz,ijYu,Xuyw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('xyzw,ijxz,ijuv,XuvYwy->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/12 * einsum('xyzw,ijxz,ijuv,XuvYyw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxz,ijuv,XuvwyY->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxz,ijuv,XuvywY->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 -= 1/12 * einsum('xyzw,ijxz,ijuv,XywYuv->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/24 * einsum('xyzw,ijxz,ijuv,XywYvu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxz,ijuv,XywuvY->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += 1/12 * einsum('xyzw,ijxz,ijuv,XywvuY->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_cccaaa, optimize = einsum_type)
        V1_p2 += einsum('xyzw,ijxz,ijyu,XuYw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += einsum('xyzw,ijxz,ijyu,XwYu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= einsum('xyzw,ijxz,ijyw,XY->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('xyzw,ijxz,jiyu,XuYw->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 -= 1/2 * einsum('xyzw,ijxz,jiyu,XwYu->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ccaa, optimize = einsum_type)
        V1_p2 += 1/2 * einsum('xyzw,ijxz,jiyw,XY->XY', v_aaaa, t1_ccaa, t1_ccaa, rdm_ca, optimize = einsum_type)
        V1 += V1_p2
        #print (">> Norm of t1_p2 contribution:                     %20.12f\n" % (np.linalg.norm(V1_p2)))

    ## t1_ce, t1_caea 
    def compute_V1__t1_0p(mr_adc, V1):
        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        ## Molecular Orbitals Energies
        e_core = mr_adc.mo_energy.c
        e_extern = mr_adc.mo_energy.e

        ## One-electron integrals
        h_ce = mr_adc.h1eff.ce
        h_aa = mr_adc.h1eff.aa

        ## Two-electron integrals
        v_aaaa = mr_adc.v2e.aaaa
        v_ceaa = mr_adc.v2e.ceaa
        v_caae = mr_adc.v2e.caae

        ## Amplitudes
        t1_ce = mr_adc.t1.ce
        t1_caae = mr_adc.t1.caae
        t1_caea = mr_adc.t1.caea

        ## Reduced density matrices
        rdm_ca = mr_adc.rdm.ca 
        rdm_ccaa = mr_adc.rdm.ccaa
        rdm_cccaaa = mr_adc.rdm.cccaaa
        rdm_ccccaaaa = mr_adc.rdm.ccccaaaa
        #rdm_ccccaaaa = np.zeros((ncas, ncas, ncas, ncas, ncas, ncas, ncas, ncas))

        V1_0p =- einsum('ia,iYax,Xx->XY', h_ce, t1_caea, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ia,iYxa,Xx->XY', h_ce, t1_caae, rdm_ca, optimize = einsum_type)
        V1_0p -= 2 * einsum('ia,ia,XY->XY', h_ce, t1_ce, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ia,ixYa,Xx->XY', h_ce, t1_caae, rdm_ca, optimize = einsum_type)
        V1_0p -= einsum('ia,ixaY,Xx->XY', h_ce, t1_caea, rdm_ca, optimize = einsum_type)
        V1_0p -= einsum('ia,ixay,XxYy->XY', h_ce, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('ia,ixay,XyYx->XY', h_ce, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ia,ixya,XxYy->XY', h_ce, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ia,ixya,XyYx->XY', h_ce, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('iYax,iayx,Xy->XY', t1_caea, v_ceaa, rdm_ca, optimize = einsum_type)
        V1_0p -= einsum('iYax,iayz,Xzxy->XY', t1_caea, v_ceaa, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('iYax,ixya,Xy->XY', t1_caea, v_caae, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('iYax,iyza,Xyxz->XY', t1_caea, v_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('iYxa,iayx,Xy->XY', t1_caae, v_ceaa, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('iYxa,iayz,Xzxy->XY', t1_caae, v_ceaa, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('iYxa,ixya,Xy->XY', t1_caae, v_caae, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('iYxa,iyza,Xyzx->XY', t1_caae, v_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ia,iYxa,Xx->XY', t1_ce, v_caae, rdm_ca, optimize = einsum_type)
        V1_0p -= einsum('ia,iaYx,Xx->XY', t1_ce, v_ceaa, rdm_ca, optimize = einsum_type)
        V1_0p -= einsum('ia,iaxY,Xx->XY', t1_ce, v_ceaa, rdm_ca, optimize = einsum_type)
        V1_0p -= einsum('ia,iaxy,XxYy->XY', t1_ce, v_ceaa, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('ia,iaxy,XyYx->XY', t1_ce, v_ceaa, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ia,ixYa,Xx->XY', t1_ce, v_caae, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ia,ixya,XxYy->XY', t1_ce, v_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ia,ixya,XyYx->XY', t1_ce, v_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ixYa,iayz,Xyxz->XY', t1_caae, v_ceaa, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ixYa,iyza,Xzyx->XY', t1_caae, v_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('ixaY,iayz,Xyxz->XY', t1_caea, v_ceaa, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ixaY,iyza,Xzxy->XY', t1_caea, v_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ixay,iYza,Xxzy->XY', t1_caea, v_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('ixay,iaYy,Xx->XY', t1_caea, v_ceaa, rdm_ca, optimize = einsum_type)
        V1_0p -= einsum('ixay,iaYz,Xyzx->XY', t1_caea, v_ceaa, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('ixay,iazY,Xxzy->XY', t1_caea, v_ceaa, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('ixay,iazw,XxwYyz->XY', t1_caea, v_ceaa, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= einsum('ixay,iazw,XyzYxw->XY', t1_caea, v_ceaa, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= einsum('ixay,iazy,XxYz->XY', t1_caea, v_ceaa, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('ixay,iazy,XzYx->XY', t1_caea, v_ceaa, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ixay,iyYa,Xx->XY', t1_caea, v_caae, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ixay,iyza,XxYz->XY', t1_caea, v_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ixay,iyza,XzYx->XY', t1_caea, v_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ixay,izYa,Xyzx->XY', t1_caea, v_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ixay,izwa,XxzYyw->XY', t1_caea, v_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ixay,izwa,XywYxz->XY', t1_caea, v_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ixya,iYza,Xxyz->XY', t1_caae, v_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ixya,iaYy,Xx->XY', t1_caae, v_ceaa, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ixya,iaYz,Xyzx->XY', t1_caae, v_ceaa, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ixya,iazY,Xxzy->XY', t1_caae, v_ceaa, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ixya,iazw,XxwYyz->XY', t1_caae, v_ceaa, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ixya,iazw,XyzYxw->XY', t1_caae, v_ceaa, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ixya,iazy,XxYz->XY', t1_caae, v_ceaa, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ixya,iazy,XzYx->XY', t1_caae, v_ceaa, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('ixya,iyYa,Xx->XY', t1_caae, v_caae, rdm_ca, optimize = einsum_type)
        V1_0p -= einsum('ixya,iyza,XxYz->XY', t1_caae, v_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('ixya,iyza,XzYx->XY', t1_caae, v_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('ixya,izYa,Xyxz->XY', t1_caae, v_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/3 * einsum('ixya,izwa,XxzYwy->XY', t1_caae, v_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('ixya,izwa,XxzYyw->XY', t1_caae, v_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('ixya,izwa,XxzwYy->XY', t1_caae, v_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('ixya,izwa,XxzwyY->XY', t1_caae, v_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('ixya,izwa,XxzyYw->XY', t1_caae, v_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('ixya,izwa,XxzywY->XY', t1_caae, v_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('ixya,izwa,XywYxz->XY', t1_caae, v_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/3 * einsum('ixya,izwa,XywYzx->XY', t1_caae, v_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('ixya,izwa,XywxYz->XY', t1_caae, v_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('ixya,izwa,XywxzY->XY', t1_caae, v_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('ixya,izwa,XywzYx->XY', t1_caae, v_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('ixya,izwa,XywzxY->XY', t1_caae, v_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= einsum('a,iYax,ia,Xx->XY', e_extern, t1_caea, t1_ce, rdm_ca, optimize = einsum_type)
        V1_0p -= einsum('a,iYax,iyax,Xy->XY', e_extern, t1_caea, t1_caea, rdm_ca, optimize = einsum_type)
        V1_0p -= einsum('a,iYax,iyaz,Xzxy->XY', e_extern, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('a,iYax,iyxa,Xy->XY', e_extern, t1_caea, t1_caae, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('a,iYax,iyza,Xzxy->XY', e_extern, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('a,iYxa,ia,Xx->XY', e_extern, t1_caae, t1_ce, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('a,iYxa,iyax,Xy->XY', e_extern, t1_caae, t1_caea, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('a,iYxa,iyaz,Xzxy->XY', e_extern, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('a,iYxa,iyxa,Xy->XY', e_extern, t1_caae, t1_caae, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('a,iYxa,iyza,Xzyx->XY', e_extern, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('a,ia,ia,XY->XY', e_extern, t1_ce, t1_ce, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('a,ia,ixYa,Xx->XY', e_extern, t1_ce, t1_caae, rdm_ca, optimize = einsum_type)
        V1_0p -= einsum('a,ia,ixaY,Xx->XY', e_extern, t1_ce, t1_caea, rdm_ca, optimize = einsum_type)
        V1_0p -= einsum('a,ia,ixay,XyYx->XY', e_extern, t1_ce, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('a,ia,ixya,XyYx->XY', e_extern, t1_ce, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('a,ixay,ia,XxYy->XY', e_extern, t1_caea, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('a,ixay,izYa,Xxzy->XY', e_extern, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('a,ixay,izaY,Xxzy->XY', e_extern, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('a,ixay,izaw,XxwYyz->XY', e_extern, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= einsum('a,ixay,izay,XxYz->XY', e_extern, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('a,ixay,izwa,XxwYyz->XY', e_extern, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('a,ixay,izya,XxYz->XY', e_extern, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('a,ixya,ia,XxYy->XY', e_extern, t1_caae, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('a,ixya,izYa,Xxyz->XY', e_extern, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('a,ixya,izaY,Xxzy->XY', e_extern, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('a,ixya,izaw,XxwYyz->XY', e_extern, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('a,ixya,izay,XxYz->XY', e_extern, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('a,ixya,izwa,XxwYyz->XY', e_extern, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/3 * einsum('a,ixya,izwa,XxwYzy->XY', e_extern, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('a,ixya,izwa,XxwyYz->XY', e_extern, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('a,ixya,izwa,XxwyzY->XY', e_extern, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('a,ixya,izwa,XxwzYy->XY', e_extern, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('a,ixya,izwa,XxwzyY->XY', e_extern, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= einsum('a,ixya,izya,XxYz->XY', e_extern, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,iYax,ia,Xx->XY', e_core, t1_caea, t1_ce, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,iYax,iyax,Xy->XY', e_core, t1_caea, t1_caea, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,iYax,iyaz,Xzxy->XY', e_core, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,iYax,iyxa,Xy->XY', e_core, t1_caea, t1_caae, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,iYax,iyza,Xzxy->XY', e_core, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,iYxa,ia,Xx->XY', e_core, t1_caae, t1_ce, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,iYxa,iyax,Xy->XY', e_core, t1_caae, t1_caea, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,iYxa,iyaz,Xzxy->XY', e_core, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,iYxa,iyxa,Xy->XY', e_core, t1_caae, t1_caae, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,iYxa,iyza,Xzyx->XY', e_core, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,ia,iYax,Xx->XY', e_core, t1_ce, t1_caea, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ia,iYxa,Xx->XY', e_core, t1_ce, t1_caae, rdm_ca, optimize = einsum_type)
        V1_0p += einsum('i,ia,ia,XY->XY', e_core, t1_ce, t1_ce, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ia,ixYa,Xx->XY', e_core, t1_ce, t1_caae, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,ia,ixaY,Xx->XY', e_core, t1_ce, t1_caea, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,ia,ixay,XxYy->XY', e_core, t1_ce, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,ia,ixay,XyYx->XY', e_core, t1_ce, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ia,ixya,XxYy->XY', e_core, t1_ce, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ia,ixya,XyYx->XY', e_core, t1_ce, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixYa,ia,Xx->XY', e_core, t1_caae, t1_ce, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixYa,iyaz,Xyxz->XY', e_core, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixYa,iyza,Xyzx->XY', e_core, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,ixaY,ia,Xx->XY', e_core, t1_caea, t1_ce, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,ixaY,iyaz,Xyxz->XY', e_core, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixaY,iyza,Xyxz->XY', e_core, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,ixay,iYay,Xx->XY', e_core, t1_caea, t1_caea, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,ixay,iYaz,Xyzx->XY', e_core, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixay,iYya,Xx->XY', e_core, t1_caea, t1_caae, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixay,iYza,Xyzx->XY', e_core, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,ixay,ia,XxYy->XY', e_core, t1_caea, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,ixay,ia,XyYx->XY', e_core, t1_caea, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixay,izYa,Xxzy->XY', e_core, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,ixay,izaY,Xxzy->XY', e_core, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,ixay,izaw,XxwYyz->XY', e_core, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,ixay,izaw,XyzYxw->XY', e_core, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,ixay,izay,XxYz->XY', e_core, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,ixay,izay,XzYx->XY', e_core, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixay,izwa,XxwYyz->XY', e_core, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixay,izwa,XyzYxw->XY', e_core, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixay,izya,XxYz->XY', e_core, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixay,izya,XzYx->XY', e_core, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixya,iYay,Xx->XY', e_core, t1_caae, t1_caea, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixya,iYaz,Xyzx->XY', e_core, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,ixya,iYya,Xx->XY', e_core, t1_caae, t1_caae, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixya,iYza,Xyxz->XY', e_core, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixya,ia,XxYy->XY', e_core, t1_caae, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixya,ia,XyYx->XY', e_core, t1_caae, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixya,izYa,Xxyz->XY', e_core, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixya,izaY,Xxzy->XY', e_core, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixya,izaw,XxwYyz->XY', e_core, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixya,izaw,XyzYxw->XY', e_core, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixya,izay,XxYz->XY', e_core, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('i,ixya,izay,XzYx->XY', e_core, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('i,ixya,izwa,XxwYyz->XY', e_core, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('i,ixya,izwa,XxwYzy->XY', e_core, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('i,ixya,izwa,XxwyYz->XY', e_core, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('i,ixya,izwa,XxwyzY->XY', e_core, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('i,ixya,izwa,XxwzYy->XY', e_core, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('i,ixya,izwa,XxwzyY->XY', e_core, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('i,ixya,izwa,XyzYwx->XY', e_core, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('i,ixya,izwa,XyzYxw->XY', e_core, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('i,ixya,izwa,XyzwYx->XY', e_core, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('i,ixya,izwa,XyzwxY->XY', e_core, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('i,ixya,izwa,XyzxYw->XY', e_core, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('i,ixya,izwa,XyzxwY->XY', e_core, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,ixya,izya,XxYz->XY', e_core, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('i,ixya,izya,XzYx->XY', e_core, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yx,ixay,ia,Xy->XY', h_aa, t1_caea, t1_ce, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yx,ixay,izaw,Xwyz->XY', h_aa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yx,ixay,izay,Xz->XY', h_aa, t1_caea, t1_caea, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yx,ixay,izwa,Xwyz->XY', h_aa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yx,ixay,izya,Xz->XY', h_aa, t1_caea, t1_caae, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yx,ixya,ia,Xy->XY', h_aa, t1_caae, t1_ce, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yx,ixya,izaw,Xwyz->XY', h_aa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yx,ixya,izay,Xz->XY', h_aa, t1_caae, t1_caea, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yx,ixya,izwa,Xwzy->XY', h_aa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yx,ixya,izya,Xz->XY', h_aa, t1_caae, t1_caae, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/2 * einsum('Yx,iyax,ia,Xy->XY', h_aa, t1_caea, t1_ce, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/2 * einsum('Yx,iyax,izaw,Xzyw->XY', h_aa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('Yx,iyax,izwa,Xzyw->XY', h_aa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('Yx,iyxa,ia,Xy->XY', h_aa, t1_caae, t1_ce, rdm_ca, optimize = einsum_type)
        V1_0p += 1/4 * einsum('Yx,iyxa,izaw,Xzyw->XY', h_aa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('Yx,iyxa,izwa,Xzwy->XY', h_aa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/2 * einsum('xy,iYax,ia,Xy->XY', h_aa, t1_caea, t1_ce, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/2 * einsum('xy,iYax,izaw,Xwyz->XY', h_aa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('xy,iYax,izay,Xz->XY', h_aa, t1_caea, t1_caea, rdm_ca, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xy,iYax,izwa,Xwyz->XY', h_aa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xy,iYax,izya,Xz->XY', h_aa, t1_caea, t1_caae, rdm_ca, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xy,iYxa,ia,Xy->XY', h_aa, t1_caae, t1_ce, rdm_ca, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xy,iYxa,izaw,Xwyz->XY', h_aa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xy,iYxa,izay,Xz->XY', h_aa, t1_caae, t1_caea, rdm_ca, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xy,iYxa,izwa,Xwzy->XY', h_aa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('xy,iYxa,izya,Xz->XY', h_aa, t1_caae, t1_caae, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixYa,ia,Xy->XY', h_aa, t1_caae, t1_ce, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixYa,izaw,Xzyw->XY', h_aa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixYa,izwa,Xzwy->XY', h_aa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xy,ixaY,ia,Xy->XY', h_aa, t1_caea, t1_ce, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xy,ixaY,izaw,Xzyw->XY', h_aa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixaY,izwa,Xzyw->XY', h_aa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xy,ixaz,iYaw,Xzwy->XY', h_aa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xy,ixaz,iYaz,Xy->XY', h_aa, t1_caea, t1_caea, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixaz,iYwa,Xzwy->XY', h_aa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixaz,iYza,Xy->XY', h_aa, t1_caea, t1_caae, rdm_ca, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xy,ixaz,ia,XyYz->XY', h_aa, t1_caea, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xy,ixaz,ia,XzYy->XY', h_aa, t1_caea, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixaz,iwYa,Xywz->XY', h_aa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xy,ixaz,iwaY,Xywz->XY', h_aa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xy,ixaz,iwau,XyuYzw->XY', h_aa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xy,ixaz,iwau,XzwYyu->XY', h_aa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xy,ixaz,iwaz,XwYy->XY', h_aa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xy,ixaz,iwaz,XyYw->XY', h_aa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixaz,iwua,XyuYzw->XY', h_aa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixaz,iwua,XzwYyu->XY', h_aa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixaz,iwza,XwYy->XY', h_aa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixaz,iwza,XyYw->XY', h_aa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixza,iYaw,Xzwy->XY', h_aa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixza,iYaz,Xy->XY', h_aa, t1_caae, t1_caea, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixza,iYwa,Xzyw->XY', h_aa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xy,ixza,iYza,Xy->XY', h_aa, t1_caae, t1_caae, rdm_ca, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixza,ia,XyYz->XY', h_aa, t1_caae, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixza,ia,XzYy->XY', h_aa, t1_caae, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixza,iwYa,Xyzw->XY', h_aa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixza,iwaY,Xywz->XY', h_aa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixza,iwau,XyuYzw->XY', h_aa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixza,iwau,XzwYyu->XY', h_aa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixza,iwaz,XwYy->XY', h_aa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xy,ixza,iwaz,XyYw->XY', h_aa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xy,ixza,iwua,XyuYwz->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xy,ixza,iwua,XyuYzw->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xy,ixza,iwua,XyuwYz->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xy,ixza,iwua,XyuwzY->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xy,ixza,iwua,XyuzYw->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xy,ixza,iwua,XyuzwY->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xy,ixza,iwua,XzwYuy->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xy,ixza,iwua,XzwYyu->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xy,ixza,iwua,XzwuYy->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xy,ixza,iwua,XzwuyY->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xy,ixza,iwua,XzwyYu->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xy,ixza,iwua,XzwyuY->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xy,ixza,iwza,XwYy->XY', h_aa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xy,ixza,iwza,XyYw->XY', h_aa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/2 * einsum('xy,izax,iYaw,Xywz->XY', h_aa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xy,izax,iYwa,Xywz->XY', h_aa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/2 * einsum('xy,izax,ia,XyYz->XY', h_aa, t1_caea, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/2 * einsum('xy,izax,ia,XzYy->XY', h_aa, t1_caea, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xy,izax,iwYa,Xzwy->XY', h_aa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/2 * einsum('xy,izax,iwaY,Xzwy->XY', h_aa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/2 * einsum('xy,izax,iwau,XywYzu->XY', h_aa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/2 * einsum('xy,izax,iwau,XzuYyw->XY', h_aa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= einsum('xy,izax,iway,XzYw->XY', h_aa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xy,izax,iwua,XywYzu->XY', h_aa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xy,izax,iwua,XzuYyw->XY', h_aa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xy,izax,iwya,XwYz->XY', h_aa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xy,izax,iwya,XzYw->XY', h_aa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xy,izxa,iYaw,Xywz->XY', h_aa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xy,izxa,iYwa,Xyzw->XY', h_aa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xy,izxa,ia,XyYz->XY', h_aa, t1_caae, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xy,izxa,ia,XzYy->XY', h_aa, t1_caae, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xy,izxa,iwYa,Xzyw->XY', h_aa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xy,izxa,iwaY,Xzwy->XY', h_aa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xy,izxa,iwau,XywYzu->XY', h_aa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xy,izxa,iwau,XzuYyw->XY', h_aa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xy,izxa,iwua,XywYuz->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xy,izxa,iwua,XywYzu->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xy,izxa,iwua,XywuYz->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xy,izxa,iwua,XywuzY->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xy,izxa,iwua,XywzYu->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xy,izxa,iwua,XywzuY->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xy,izxa,iwua,XzuYwy->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xy,izxa,iwua,XzuYyw->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xy,izxa,iwua,XzuwYy->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xy,izxa,iwua,XzuwyY->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xy,izxa,iwua,XzuyYw->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xy,izxa,iwua,XzuywY->XY', h_aa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= einsum('xy,izxa,iwya,XzYw->XY', h_aa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/2 * einsum('Yxyz,iwax,ia,Xywz->XY', v_aaaa, t1_caea, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('Yxyz,iwax,iuav,Xyuvwz->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('Yxyz,iwax,iuav,Xyuvzw->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('Yxyz,iwax,iuav,Xyuwvz->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/3 * einsum('Yxyz,iwax,iuav,Xyuwzv->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('Yxyz,iwax,iuav,Xyuzvw->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('Yxyz,iwax,iuav,Xyuzwv->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwax,iuva,Xyuvwz->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwax,iuva,Xyuvzw->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwax,iuva,Xyuwvz->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('Yxyz,iwax,iuva,Xyuwzv->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwax,iuva,Xyuzvw->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwax,iuva,Xyuzwv->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yxyz,iwax,izau,Xywu->XY', v_aaaa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,iwax,izua,Xywu->XY', v_aaaa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/2 * einsum('Yxyz,iway,ia,Xwxz->XY', v_aaaa, t1_caea, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/2 * einsum('Yxyz,iway,iuav,Xwvxzu->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= einsum('Yxyz,iway,iuax,Xwuz->XY', v_aaaa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('Yxyz,iway,iuaz,Xwxu->XY', v_aaaa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('Yxyz,iway,iuva,Xwvxzu->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yxyz,iway,iuxa,Xwuz->XY', v_aaaa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yxyz,iway,iuza,Xwxu->XY', v_aaaa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/2 * einsum('Yxyz,iwaz,ia,Xyxw->XY', v_aaaa, t1_caea, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/2 * einsum('Yxyz,iwaz,iuav,Xyuxwv->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('Yxyz,iwaz,iuva,Xyuxwv->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('Yxyz,iwxa,ia,Xywz->XY', v_aaaa, t1_caae, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwxa,iuav,Xyuvwz->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwxa,iuav,Xyuvzw->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwxa,iuav,Xyuwvz->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('Yxyz,iwxa,iuav,Xyuwzv->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwxa,iuav,Xyuzvw->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwxa,iuav,Xyuzwv->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('Yxyz,iwxa,iuva,Xyuvzw->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,iwxa,izau,Xywu->XY', v_aaaa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,iwxa,izua,Xyuw->XY', v_aaaa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('Yxyz,iwya,ia,Xwxz->XY', v_aaaa, t1_caae, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('Yxyz,iwya,iuav,Xwvxzu->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yxyz,iwya,iuax,Xwuz->XY', v_aaaa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yxyz,iwya,iuaz,Xwxu->XY', v_aaaa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwya,iuva,Xwvuxz->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwya,iuva,Xwvuzx->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('Yxyz,iwya,iuva,Xwvxuz->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwya,iuva,Xwvxzu->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwya,iuva,Xwvzux->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwya,iuva,Xwvzxu->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yxyz,iwya,iuxa,Xwzu->XY', v_aaaa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('Yxyz,iwya,iuza,Xwxu->XY', v_aaaa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('Yxyz,iwza,ia,Xyxw->XY', v_aaaa, t1_caae, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('Yxyz,iwza,iuav,Xyuxwv->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwza,iuva,Xyuvwx->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwza,iuva,Xyuvxw->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwza,iuva,Xyuwvx->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwza,iuva,Xyuwxv->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('Yxyz,iwza,iuva,Xyuxvw->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('Yxyz,iwza,iuva,Xyuxwv->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yxyz,ixaw,ia,Xywz->XY', v_aaaa, t1_caea, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('Yxyz,ixaw,iuav,Xyvuwz->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('Yxyz,ixaw,iuav,Xyvuzw->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('Yxyz,ixaw,iuav,Xyvwuz->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/3 * einsum('Yxyz,ixaw,iuav,Xyvwzu->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('Yxyz,ixaw,iuav,Xyvzuw->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('Yxyz,ixaw,iuav,Xyvzwu->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yxyz,ixaw,iuaw,Xyuz->XY', v_aaaa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yxyz,ixaw,iuaz,Xywu->XY', v_aaaa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,ixaw,iuva,Xyvuwz->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,ixaw,iuva,Xyvuzw->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,ixaw,iuva,Xyvwuz->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('Yxyz,ixaw,iuva,Xyvwzu->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,ixaw,iuva,Xyvzuw->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,ixaw,iuva,Xyvzwu->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,ixaw,iuwa,Xyuz->XY', v_aaaa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,ixaw,iuza,Xywu->XY', v_aaaa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,ixwa,ia,Xywz->XY', v_aaaa, t1_caae, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,ixwa,iuav,Xyvuwz->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,ixwa,iuav,Xyvuzw->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,ixwa,iuav,Xyvwuz->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('Yxyz,ixwa,iuav,Xyvwzu->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,ixwa,iuav,Xyvzuw->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,ixwa,iuav,Xyvzwu->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,ixwa,iuaw,Xyuz->XY', v_aaaa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,ixwa,iuaz,Xywu->XY', v_aaaa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,ixwa,iuva,Xyvuzw->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yxyz,ixwa,iuwa,Xyuz->XY', v_aaaa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,ixwa,iuza,Xyuw->XY', v_aaaa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yxyz,iyaw,ia,Xwxz->XY', v_aaaa, t1_caea, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yxyz,iyaw,iuav,Xwuxzv->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yxyz,iyaw,iuaw,Xuxz->XY', v_aaaa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,iyaw,iuva,Xwuxzv->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,iyaw,iuwa,Xuxz->XY', v_aaaa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,iywa,ia,Xwxz->XY', v_aaaa, t1_caae, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,iywa,iuav,Xwuxzv->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,iywa,iuaw,Xuxz->XY', v_aaaa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,iywa,iuva,Xwuvxz->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,iywa,iuva,Xwuvzx->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('Yxyz,iywa,iuva,Xwuxvz->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,iywa,iuva,Xwuxzv->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,iywa,iuva,Xwuzvx->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,iywa,iuva,Xwuzxv->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yxyz,iywa,iuwa,Xuxz->XY', v_aaaa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yxyz,izaw,ia,Xyxw->XY', v_aaaa, t1_caea, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yxyz,izaw,iuav,Xyvxwu->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yxyz,izaw,iuaw,Xyxu->XY', v_aaaa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,izaw,iuva,Xyvxwu->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,izaw,iuwa,Xyxu->XY', v_aaaa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,izwa,ia,Xyxw->XY', v_aaaa, t1_caae, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,izwa,iuav,Xyvxwu->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('Yxyz,izwa,iuaw,Xyxu->XY', v_aaaa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,izwa,iuva,Xyvuwx->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,izwa,iuva,Xyvuxw->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,izwa,iuva,Xyvwux->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,izwa,iuva,Xyvwxu->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('Yxyz,izwa,iuva,Xyvxuw->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('Yxyz,izwa,iuva,Xyvxwu->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('Yxyz,izwa,iuwa,Xyxu->XY', v_aaaa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/2 * einsum('xyzw,iYax,ia,Xzyw->XY', v_aaaa, t1_caea, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/2 * einsum('xyzw,iYax,iuav,Xzvywu->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= einsum('xyzw,iYax,iuaw,Xzyu->XY', v_aaaa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('xyzw,iYax,iuay,Xzuw->XY', v_aaaa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xyzw,iYax,iuva,Xzvywu->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xyzw,iYax,iuwa,Xzyu->XY', v_aaaa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xyzw,iYax,iuya,Xzuw->XY', v_aaaa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xyzw,iYax,izau,Xuyw->XY', v_aaaa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,iYax,izua,Xuyw->XY', v_aaaa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xyzw,iYxa,ia,Xzyw->XY', v_aaaa, t1_caae, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xyzw,iYxa,iuav,Xzvywu->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xyzw,iYxa,iuaw,Xzyu->XY', v_aaaa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xyzw,iYxa,iuay,Xzuw->XY', v_aaaa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iYxa,iuva,Xzvuwy->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iYxa,iuva,Xzvuyw->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iYxa,iuva,Xzvwuy->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iYxa,iuva,Xzvwyu->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iYxa,iuva,Xzvyuw->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iYxa,iuva,Xzvywu->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xyzw,iYxa,iuwa,Xzuy->XY', v_aaaa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= einsum('xyzw,iYxa,iuya,Xzuw->XY', v_aaaa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,iYxa,izau,Xuyw->XY', v_aaaa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,iYxa,izua,Xuwy->XY', v_aaaa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,iYav,Xywuvz->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,iYav,Xywuzv->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/3 * einsum('xyzw,iuax,iYav,Xywvuz->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,iYav,Xywvzu->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,iYav,Xywzuv->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,iYav,Xywzvu->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuax,iYva,Xywuvz->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuax,iYva,Xywuzv->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,iYva,Xywvuz->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuax,iYva,Xywvzu->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuax,iYva,Xywzuv->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuax,iYva,Xywzvu->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/3 * einsum('xyzw,iuax,ia,XywYuz->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ia,XywYzu->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ia,XywuYz->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ia,XywuzY->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ia,XywzYu->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ia,XywzuY->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/3 * einsum('xyzw,iuax,ia,XzuYwy->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ia,XzuYyw->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ia,XzuwYy->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ia,XzuwyY->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ia,XzuyYw->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ia,XzuywY->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ivYa,Xzuvwy->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuax,ivYa,Xzuvyw->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuax,ivYa,Xzuwvy->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuax,ivYa,Xzuwyv->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuax,ivYa,Xzuyvw->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuax,ivYa,Xzuywv->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/3 * einsum('xyzw,iuax,ivaY,Xzuvwy->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ivaY,Xzuvyw->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ivaY,Xzuwvy->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ivaY,Xzuwyv->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ivaY,Xzuyvw->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ivaY,Xzuywv->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ivas,XywvYsuz->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ivas,XywvYszu->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ivas,XywvYusz->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,iuax,ivas,XywvYuzs->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ivas,XywvYzsu->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xyzw,iuax,ivas,XywvYzus->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,iuax,ivas,XywvuYzs->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,iuax,ivas,XywvuzYs->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,iuax,ivas,XywvzYus->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,iuax,ivas,XywvzuYs->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ivas,XzusYvwy->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ivas,XzusYvyw->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ivas,XzusYwvy->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,iuax,ivas,XzusYwyv->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuax,ivas,XzusYyvw->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xyzw,iuax,ivas,XzusYywv->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,iuax,ivas,XzuswYyv->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,iuax,ivas,XzuswyYv->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,iuax,ivas,XzusyYwv->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,iuax,ivas,XzusywYv->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 2/3 * einsum('xyzw,iuax,ivaw,XzuYvy->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/3 * einsum('xyzw,iuax,ivaw,XzuYyv->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/3 * einsum('xyzw,iuax,ivaw,XzuvYy->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/3 * einsum('xyzw,iuax,ivaw,XzuvyY->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/3 * einsum('xyzw,iuax,ivaw,XzuyYv->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/3 * einsum('xyzw,iuax,ivaw,XzuyvY->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= einsum('xyzw,iuax,ivay,XzuYwv->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuax,ivsa,XywvYsuz->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuax,ivsa,XywvYszu->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuax,ivsa,XywvYusz->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/8 * einsum('xyzw,iuax,ivsa,XywvYuzs->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuax,ivsa,XywvYzsu->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/8 * einsum('xyzw,iuax,ivsa,XywvYzus->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,iuax,ivsa,XywvuYzs->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,iuax,ivsa,XywvuzYs->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,iuax,ivsa,XywvzYus->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,iuax,ivsa,XywvzuYs->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuax,ivsa,XzusYvwy->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuax,ivsa,XzusYvyw->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuax,ivsa,XzusYwvy->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/8 * einsum('xyzw,iuax,ivsa,XzusYwyv->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuax,ivsa,XzusYyvw->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/8 * einsum('xyzw,iuax,ivsa,XzusYywv->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,iuax,ivsa,XzuswYyv->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,iuax,ivsa,XzuswyYv->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,iuax,ivsa,XzusyYwv->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,iuax,ivsa,XzusywYv->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/3 * einsum('xyzw,iuax,ivwa,XyvYuz->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,iuax,ivwa,XyvYzu->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,iuax,ivwa,XyvuYz->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,iuax,ivwa,XyvuzY->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,iuax,ivwa,XyvzYu->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,iuax,ivwa,XyvzuY->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/3 * einsum('xyzw,iuax,ivwa,XzuYvy->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,iuax,ivwa,XzuYyv->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,iuax,ivwa,XzuvYy->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,iuax,ivwa,XzuvyY->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,iuax,ivwa,XzuyYv->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,iuax,ivwa,XzuyvY->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xyzw,iuax,ivya,XwvYzu->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xyzw,iuax,ivya,XzuYwv->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xyzw,iuax,izav,XuvYyw->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xyzw,iuax,izav,XywYuv->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,iYav,Xywuvz->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,iYav,Xywuzv->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuxa,iYav,Xywvuz->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,iYav,Xywvzu->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,iYav,Xywzuv->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,iYav,Xywzvu->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xyzw,iuxa,iYva,Xywuvz->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuxa,ia,XywYuz->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ia,XywYzu->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ia,XywuYz->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ia,XywuzY->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ia,XywzYu->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ia,XywzuY->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuxa,ia,XzuYwy->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ia,XzuYyw->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ia,XzuwYy->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ia,XzuwyY->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ia,XzuyYw->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ia,XzuywY->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xyzw,iuxa,ivYa,Xzuywv->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/6 * einsum('xyzw,iuxa,ivaY,Xzuvwy->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ivaY,Xzuvyw->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ivaY,Xzuwvy->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ivaY,Xzuwyv->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ivaY,Xzuyvw->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ivaY,Xzuywv->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ivas,XywvYsuz->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ivas,XywvYszu->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ivas,XywvYusz->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/8 * einsum('xyzw,iuxa,ivas,XywvYuzs->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ivas,XywvYzsu->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/8 * einsum('xyzw,iuxa,ivas,XywvYzus->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,iuxa,ivas,XywvuYzs->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,iuxa,ivas,XywvuzYs->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,iuxa,ivas,XywvzYus->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,iuxa,ivas,XywvzuYs->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ivas,XzusYvwy->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ivas,XzusYvyw->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ivas,XzusYwvy->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/8 * einsum('xyzw,iuxa,ivas,XzusYwyv->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,iuxa,ivas,XzusYyvw->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/8 * einsum('xyzw,iuxa,ivas,XzusYywv->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,iuxa,ivas,XzuswYyv->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,iuxa,ivas,XzuswyYv->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,iuxa,ivas,XzusyYwv->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,iuxa,ivas,XzusywYv->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 5/24 * einsum('xyzw,iuxa,ivsa,XywvYszu->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,iuxa,ivsa,XywvYzsu->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,iuxa,ivsa,XywvsYuz->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,iuxa,ivsa,XywvsuYz->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,iuxa,ivsa,XywvuYsz->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,iuxa,ivsa,XywvuYzs->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,iuxa,ivsa,XywvusYz->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,iuxa,ivsa,XywvuzYs->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,iuxa,ivsa,XywvzYus->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,iuxa,ivsa,XywvzuYs->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 5/24 * einsum('xyzw,iuxa,ivsa,XzusYwvy->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,iuxa,ivsa,XzusYyvw->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,iuxa,ivsa,XzuswYyv->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,iuxa,ivsa,XzuswvYy->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,iuxa,ivsa,XzuswvyY->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,iuxa,ivsa,XzuswyYv->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,iuxa,ivsa,XzusyYwv->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,iuxa,ivsa,XzusyvYw->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,iuxa,ivsa,XzusyvwY->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,iuxa,ivsa,XzusywYv->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xyzw,iuxa,ivwa,XzuYyv->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= einsum('xyzw,iuxa,ivya,XzuYwv->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,iuxa,izav,XuvYyw->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,iuxa,izav,XywYuv->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,iuxa,izva,XuvYwy->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,iuxa,izva,XuvYyw->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,iuxa,izva,XuvwyY->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,iuxa,izva,XuvywY->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,iuxa,izva,XywYuv->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,iuxa,izva,XywYvu->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,iuxa,izva,XywuvY->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,iuxa,izva,XywvuY->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,ixYa,ia,Xzyw->XY', v_aaaa, t1_caae, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,ixYa,iuav,Xzuywv->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,ixYa,iuaz,Xuyw->XY', v_aaaa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixYa,iuva,Xzuvwy->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixYa,iuva,Xzuvyw->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixYa,iuva,Xzuwvy->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixYa,iuva,Xzuwyv->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixYa,iuva,Xzuyvw->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixYa,iuva,Xzuywv->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,ixYa,iuza,Xuwy->XY', v_aaaa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xyzw,ixaY,ia,Xzyw->XY', v_aaaa, t1_caea, t1_ce, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xyzw,ixaY,iuav,Xzuywv->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xyzw,ixaY,iuaz,Xuyw->XY', v_aaaa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,ixaY,iuva,Xzuywv->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,ixaY,iuza,Xuyw->XY', v_aaaa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xyzw,ixau,iYau,Xzyw->XY', v_aaaa, t1_caea, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p += 1/3 * einsum('xyzw,ixau,iYav,Xzuvwy->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,iYav,Xzuvyw->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,iYav,Xzuwvy->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,iYav,Xzuwyv->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,iYav,Xzuyvw->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,iYav,Xzuywv->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,ixau,iYua,Xzyw->XY', v_aaaa, t1_caea, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,iYva,Xzuvwy->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,iYva,Xzuvyw->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,iYva,Xzuwvy->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,iYva,Xzuwyv->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,iYva,Xzuyvw->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,iYva,Xzuywv->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/3 * einsum('xyzw,ixau,ia,XywYuz->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ia,XywYzu->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ia,XywuYz->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ia,XywuzY->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ia,XywzYu->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ia,XywzuY->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/3 * einsum('xyzw,ixau,ia,XzuYwy->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ia,XzuYyw->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ia,XzuwYy->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ia,XzuwyY->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ia,XzuyYw->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ia,XzuywY->XY', v_aaaa, t1_caea, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivYa,Xywuvz->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivYa,Xywuzv->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivYa,Xywvuz->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivYa,Xywvzu->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivYa,Xywzuv->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivYa,Xywzvu->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivaY,Xywuvz->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivaY,Xywuzv->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/3 * einsum('xyzw,ixau,ivaY,Xywvuz->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivaY,Xywvzu->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivaY,Xywzuv->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivaY,Xywzvu->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivas,XywsYuvz->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xyzw,ixau,ivas,XywsYuzv->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivas,XywsYvuz->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivas,XywsYvzu->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,ixau,ivas,XywsYzuv->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivas,XywsYzvu->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,ixau,ivas,XywsuYzv->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,ixau,ivas,XywsuzYv->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,ixau,ivas,XywszYuv->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,ixau,ivas,XywszuYv->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivas,XzuvYswy->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivas,XzuvYsyw->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivas,XzuvYwsy->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/4 * einsum('xyzw,ixau,ivas,XzuvYwys->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivas,XzuvYysw->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,ixau,ivas,XzuvYyws->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,ixau,ivas,XzuvwYys->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,ixau,ivas,XzuvwyYs->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,ixau,ivas,XzuvyYws->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/12 * einsum('xyzw,ixau,ivas,XzuvywYs->XY', v_aaaa, t1_caea, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/3 * einsum('xyzw,ixau,ivau,XywYvz->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivau,XywYzv->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivau,XywvYz->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivau,XywvzY->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivau,XywzYv->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivau,XywzvY->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/3 * einsum('xyzw,ixau,ivau,XzvYwy->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivau,XzvYyw->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivau,XzvwYy->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivau,XzvwyY->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivau,XzvyYw->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivau,XzvywY->XY', v_aaaa, t1_caea, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivsa,XywsYuvz->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/8 * einsum('xyzw,ixau,ivsa,XywsYuzv->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivsa,XywsYvuz->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivsa,XywsYvzu->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/8 * einsum('xyzw,ixau,ivsa,XywsYzuv->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivsa,XywsYzvu->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,ixau,ivsa,XywsuYzv->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,ixau,ivsa,XywsuzYv->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,ixau,ivsa,XywszYuv->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,ixau,ivsa,XywszuYv->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivsa,XzuvYswy->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivsa,XzuvYsyw->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivsa,XzuvYwsy->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/8 * einsum('xyzw,ixau,ivsa,XzuvYwys->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivsa,XzuvYysw->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/8 * einsum('xyzw,ixau,ivsa,XzuvYyws->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,ixau,ivsa,XzuvwYys->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,ixau,ivsa,XzuvwyYs->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,ixau,ivsa,XzuvyYws->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,ixau,ivsa,XzuvywYs->XY', v_aaaa, t1_caea, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivua,XywYvz->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivua,XywYzv->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivua,XywvYz->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivua,XywvzY->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivua,XywzYv->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivua,XywzvY->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixau,ivua,XzvYwy->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivua,XzvYyw->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivua,XzvwYy->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivua,XzvwyY->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivua,XzvyYw->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixau,ivua,XzvywY->XY', v_aaaa, t1_caea, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,ixua,iYau,Xzyw->XY', v_aaaa, t1_caae, t1_caea, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixua,iYav,Xzuvwy->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,iYav,Xzuvyw->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,iYav,Xzuwvy->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,iYav,Xzuwyv->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,iYav,Xzuyvw->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,iYav,Xzuywv->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/2 * einsum('xyzw,ixua,iYua,Xzyw->XY', v_aaaa, t1_caae, t1_caae, rdm_ccaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,ixua,iYva,Xzuywv->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixua,ia,XywYuz->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ia,XywYzu->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ia,XywuYz->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ia,XywuzY->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ia,XywzYu->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ia,XywzuY->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixua,ia,XzuYwy->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ia,XzuYyw->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ia,XzuwYy->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ia,XzuwyY->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ia,XzuyYw->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ia,XzuywY->XY', v_aaaa, t1_caae, t1_ce, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,ixua,ivYa,Xywuvz->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivaY,Xywuvz->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivaY,Xywuzv->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixua,ivaY,Xywvuz->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivaY,Xywvzu->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivaY,Xywzuv->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivaY,Xywzvu->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivas,XywsYuvz->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/8 * einsum('xyzw,ixua,ivas,XywsYuzv->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivas,XywsYvuz->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivas,XywsYvzu->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/8 * einsum('xyzw,ixua,ivas,XywsYzuv->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivas,XywsYzvu->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,ixua,ivas,XywsuYzv->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,ixua,ivas,XywsuzYv->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,ixua,ivas,XywszYuv->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,ixua,ivas,XywszuYv->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivas,XzuvYswy->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivas,XzuvYsyw->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivas,XzuvYwsy->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/8 * einsum('xyzw,ixua,ivas,XzuvYwys->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivas,XzuvYysw->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/8 * einsum('xyzw,ixua,ivas,XzuvYyws->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,ixua,ivas,XzuvwYys->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,ixua,ivas,XzuvwyYs->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,ixua,ivas,XzuvyYws->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,ixua,ivas,XzuvywYs->XY', v_aaaa, t1_caae, t1_caea, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixua,ivau,XywYvz->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivau,XywYzv->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivau,XywvYz->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivau,XywvzY->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivau,XywzYv->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivau,XywzvY->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixua,ivau,XzvYwy->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivau,XzvYyw->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivau,XzvwYy->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivau,XzvwyY->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivau,XzvyYw->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivau,XzvywY->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,ixua,ivaz,XuvYyw->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/4 * einsum('xyzw,ixua,ivaz,XywYuv->XY', v_aaaa, t1_caae, t1_caea, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 5/24 * einsum('xyzw,ixua,ivsa,XywsYvzu->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,ixua,ivsa,XywsYzvu->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,ixua,ivsa,XywsuYvz->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,ixua,ivsa,XywsuYzv->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,ixua,ivsa,XywsuvYz->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,ixua,ivsa,XywsuzYv->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,ixua,ivsa,XywsvYuz->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,ixua,ivsa,XywsvuYz->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,ixua,ivsa,XywszYuv->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,ixua,ivsa,XywszuYv->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 5/24 * einsum('xyzw,ixua,ivsa,XzuvYwsy->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/24 * einsum('xyzw,ixua,ivsa,XzuvYysw->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,ixua,ivsa,XzuvwYys->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,ixua,ivsa,XzuvwsYy->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,ixua,ivsa,XzuvwsyY->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,ixua,ivsa,XzuvwyYs->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,ixua,ivsa,XzuvyYws->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,ixua,ivsa,XzuvysYw->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,ixua,ivsa,XzuvyswY->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p -= 1/24 * einsum('xyzw,ixua,ivsa,XzuvywYs->XY', v_aaaa, t1_caae, t1_caae, rdm_ccccaaaa, optimize = einsum_type)
        V1_0p += 1/3 * einsum('xyzw,ixua,ivua,XywYvz->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixua,ivua,XywYzv->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixua,ivua,XywvYz->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixua,ivua,XywvzY->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixua,ivua,XywzYv->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixua,ivua,XywzvY->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/3 * einsum('xyzw,ixua,ivua,XzvYwy->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixua,ivua,XzvYyw->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixua,ivua,XzvwYy->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixua,ivua,XzvwyY->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixua,ivua,XzvyYw->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p -= 1/6 * einsum('xyzw,ixua,ivua,XzvywY->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivza,XuvwyY->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivza,XuvywY->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivza,XywuvY->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1_0p += 1/12 * einsum('xyzw,ixua,ivza,XywvuY->XY', v_aaaa, t1_caae, t1_caae, rdm_cccaaa, optimize = einsum_type)
        V1 += V1_0p
        #print (">> Norm of t1_0p contribution:                     %20.12f\n" % (np.linalg.norm(V1_0p)))

    ## t1_ae, t1_aaea 
    def compute_V1__t1_m1p(mr_adc, V1):
        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        ## Molecular Orbitals Energies
        e_extern = mr_adc.mo_energy.e

        ## One-electron integrals
        h_ae = mr_adc.h1eff.ae
        h_aa = mr_adc.h1eff.aa

        ## Two-electron integrals
        v_aaaa = mr_adc.v2e.aaaa
        v_aaae = mr_adc.v2e.aaae

        ## Amplitudes
        t1_ae = mr_adc.t1.ae
        t1_aaae = mr_adc.t1.aaae

        ## Reduced density matrices
        rdm_ca = mr_adc.rdm.ca 
        rdm_ccaa = mr_adc.rdm.ccaa
        rdm_cccaaa = mr_adc.rdm.cccaaa
        rdm_ccccaaaa = mr_adc.rdm.ccccaaaa
        #rdm_ccccaaaa = np.zeros((ncas, ncas, ncas, ncas, ncas, ncas, ncas, ncas))

        V1_m1p =- 1/2 * einsum('Ya,xa,Xx->XY', h_ae, t1_ae, rdm_ca, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('Ya,xyza,Xzyx->XY', h_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xa,Ya,Xx->XY', h_ae, t1_ae, rdm_ca, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xa,Yyza,Xyzx->XY', h_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xa,yYza,Xyxz->XY', h_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xa,ya,XxYy->XY', h_ae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xa,ya,XyYx->XY', h_ae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xa,yzYa,Xxyz->XY', h_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xa,yzwa,XxwYzy->XY', h_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xa,yzwa,XzyYxw->XY', h_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('Ya,xyza,Xyzx->XY', t1_ae, v_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('Yxya,zwua,Xxwyuz->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('Yxya,zywa,Xxzw->XY', t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/3 * einsum('xYya,zwua,Xxwuyz->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xYya,zwua,Xxwuzy->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xYya,zwua,Xxwyuz->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xYya,zwua,Xxwyzu->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xYya,zwua,Xxwzuy->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xYya,zwua,Xxwzyu->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xYya,zywa,Xxwz->XY', t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xa,Yyza,Xzyx->XY', t1_ae, v_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xa,yYza,Xxyz->XY', t1_ae, v_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xa,yzYa,Xyxz->XY', t1_ae, v_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xa,yzwa,XwyYxz->XY', t1_ae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xa,yzwa,XxzYwy->XY', t1_ae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyYa,zwua,Xuzwxy->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyYa,zwua,Xuzwyx->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyYa,zwua,Xuzxwy->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/3 * einsum('xyYa,zwua,Xuzxyw->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyYa,zwua,Xuzywx->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyYa,zwua,Xuzyxw->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/3 * einsum('xyza,Ywua,Xzuwxy->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyza,Ywua,Xzuwyx->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyza,Ywua,Xzuxwy->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyza,Ywua,Xzuxyw->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyza,Ywua,Xzuywx->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyza,Ywua,Xzuyxw->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xyza,Yzwa,Xwxy->XY', t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyza,wYua,Xyxuwz->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyza,wYua,Xyxuzw->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/3 * einsum('xyza,wYua,Xyxwuz->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyza,wYua,Xyxwzu->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyza,wYua,Xyxzuw->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyza,wYua,Xyxzwu->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xyza,wuYa,Xzwyxu->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 29/120 * einsum('xyza,wuva,XyxuYvwz->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 37/120 * einsum('xyza,wuva,XyxuYvzw->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 29/120 * einsum('xyza,wuva,XyxuYwvz->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 23/120 * einsum('xyza,wuva,XyxuYwzv->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 23/120 * einsum('xyza,wuva,XyxuYzvw->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 23/120 * einsum('xyza,wuva,XyxuYzwv->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/120 * einsum('xyza,wuva,XyxuvYwz->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/120 * einsum('xyza,wuva,XyxuvYzw->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 3/40 * einsum('xyza,wuva,XyxuvwYz->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyza,wuva,XyxuvzYw->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/120 * einsum('xyza,wuva,XyxuwYvz->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/120 * einsum('xyza,wuva,XyxuwYzv->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 3/40 * einsum('xyza,wuva,XyxuwvYz->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyza,wuva,XyxuwzYv->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/40 * einsum('xyza,wuva,XyxuzYvw->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/40 * einsum('xyza,wuva,XyxuzYwv->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/120 * einsum('xyza,wuva,XyxuzvYw->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/30 * einsum('xyza,wuva,XyxuzvwY->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/120 * einsum('xyza,wuva,XyxuzwYv->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/30 * einsum('xyza,wuva,XyxuzwvY->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 29/120 * einsum('xyza,wuva,XzvwYuxy->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 29/120 * einsum('xyza,wuva,XzvwYuyx->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 23/120 * einsum('xyza,wuva,XzvwYxuy->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 37/120 * einsum('xyza,wuva,XzvwYxyu->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 23/120 * einsum('xyza,wuva,XzvwYyux->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 23/120 * einsum('xyza,wuva,XzvwYyxu->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/30 * einsum('xyza,wuva,XzvwuYxy->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/30 * einsum('xyza,wuva,XzvwuYyx->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/120 * einsum('xyza,wuva,XzvwxYuy->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/120 * einsum('xyza,wuva,XzvwxYyu->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 3/40 * einsum('xyza,wuva,XzvwxuYy->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 3/40 * einsum('xyza,wuva,XzvwxuyY->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyza,wuva,XzvwxyYu->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyza,wuva,XzvwxyuY->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/40 * einsum('xyza,wuva,XzvwyYux->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/40 * einsum('xyza,wuva,XzvwyYxu->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/120 * einsum('xyza,wuva,XzvwyuYx->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/120 * einsum('xyza,wuva,XzvwyuxY->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/120 * einsum('xyza,wuva,XzvwyxYu->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/120 * einsum('xyza,wuva,XzvwyxuY->XY', t1_aaae, v_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xyza,wzYa,Xwyx->XY', t1_aaae, v_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xyza,wzua,XwuYxy->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xyza,wzua,XxyYwu->XY', t1_aaae, v_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('a,Ya,xa,Xx->XY', e_extern, t1_ae, t1_ae, rdm_ca, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('a,Ya,xyza,Xzyx->XY', e_extern, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('a,Yxya,za,Xxyz->XY', e_extern, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('a,Yxya,zwua,Xxuywz->XY', e_extern, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('a,Yxya,zwya,Xxzw->XY', e_extern, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('a,xYya,za,Xxzy->XY', e_extern, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/3 * einsum('a,xYya,zwua,Xxuwyz->XY', e_extern, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('a,xYya,zwua,Xxuwzy->XY', e_extern, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('a,xYya,zwua,Xxuywz->XY', e_extern, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('a,xYya,zwua,Xxuyzw->XY', e_extern, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('a,xYya,zwua,Xxuzwy->XY', e_extern, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('a,xYya,zwua,Xxuzyw->XY', e_extern, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('a,xYya,zwya,Xxwz->XY', e_extern, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('a,xa,ya,XxYy->XY', e_extern, t1_ae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('a,xa,yzYa,Xxyz->XY', e_extern, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('a,xa,yzwa,XxwYzy->XY', e_extern, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/3 * einsum('a,xyza,wa,XyxYwz->XY', e_extern, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('a,xyza,wa,XyxYzw->XY', e_extern, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('a,xyza,wa,XyxwYz->XY', e_extern, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('a,xyza,wa,XyxwzY->XY', e_extern, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('a,xyza,wa,XyxzYw->XY', e_extern, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('a,xyza,wa,XyxzwY->XY', e_extern, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('a,xyza,wuYa,Xyxuwz->XY', e_extern, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('a,xyza,wuYa,Xyxuzw->XY', e_extern, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/3 * einsum('a,xyza,wuYa,Xyxwuz->XY', e_extern, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('a,xyza,wuYa,Xyxwzu->XY', e_extern, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('a,xyza,wuYa,Xyxzuw->XY', e_extern, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('a,xyza,wuYa,Xyxzwu->XY', e_extern, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('a,xyza,wuva,XyxvYuwz->XY', e_extern, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/8 * einsum('a,xyza,wuva,XyxvYuzw->XY', e_extern, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('a,xyza,wuva,XyxvYwuz->XY', e_extern, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('a,xyza,wuva,XyxvYwzu->XY', e_extern, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('a,xyza,wuva,XyxvYzuw->XY', e_extern, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('a,xyza,wuva,XyxvYzwu->XY', e_extern, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('a,xyza,wuza,XyxYuw->XY', e_extern, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yx,xa,ya,Xy->XY', h_aa, t1_ae, t1_ae, rdm_ca, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yx,xa,yzwa,Xwzy->XY', h_aa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yx,xyza,wa,Xyzw->XY', h_aa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yx,xyza,wuva,Xyvzuw->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yx,xyza,wuza,Xywu->XY', h_aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yx,yxza,wa,Xywz->XY', h_aa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yx,yxza,wuva,Xyvuwz->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('Yx,yxza,wuva,Xyvuzw->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yx,yxza,wuva,Xyvwuz->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yx,yxza,wuva,Xyvwzu->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yx,yxza,wuva,Xyvzuw->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yx,yxza,wuva,Xyvzwu->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yx,yxza,wuza,Xyuw->XY', h_aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/4 * einsum('Yx,yzxa,wa,Xwyz->XY', h_aa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('Yx,yzxa,wuva,Xuwvyz->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('Yx,yzxa,wuva,Xuwvzy->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('Yx,yzxa,wuva,Xuwyvz->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('Yx,yzxa,wuva,Xuwyzv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('Yx,yzxa,wuva,Xuwzvy->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('Yx,yzxa,wuva,Xuwzyv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,Yxza,wa,Xyzw->XY', h_aa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,Yxza,wuva,Xyvzuw->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,Yxza,wuza,Xywu->XY', h_aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/4 * einsum('xy,Yzxa,wa,Xzyw->XY', h_aa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/4 * einsum('xy,Yzxa,wuva,Xzvyuw->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xy,Yzxa,wuya,Xzwu->XY', h_aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xYza,wa,Xywz->XY', h_aa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xYza,wuva,Xyvuwz->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xy,xYza,wuva,Xyvuzw->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xYza,wuva,Xyvwuz->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xYza,wuva,Xyvwzu->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xYza,wuva,Xyvzuw->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xYza,wuva,Xyvzwu->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xYza,wuza,Xyuw->XY', h_aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xa,Ya,Xy->XY', h_aa, t1_ae, t1_ae, rdm_ca, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xa,Yzwa,Xzwy->XY', h_aa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xa,zYwa,Xzyw->XY', h_aa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xa,za,XyYz->XY', h_aa, t1_ae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xa,za,XzYy->XY', h_aa, t1_ae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xa,zwYa,Xyzw->XY', h_aa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xa,zwua,XwzYyu->XY', h_aa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xa,zwua,XyuYwz->XY', h_aa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xzYa,wa,Xwyz->XY', h_aa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xzYa,wuva,Xuwyzv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xzwa,Ya,Xwzy->XY', h_aa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xzwa,Yuva,Xwuvyz->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xzwa,Yuwa,Xuyz->XY', h_aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xzwa,uYva,Xwuvyz->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xzwa,uYva,Xwuvzy->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xzwa,uYva,Xwuyvz->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xzwa,uYva,Xwuyzv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xzwa,uYva,Xwuzvy->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xy,xzwa,uYva,Xwuzyv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xzwa,uYwa,Xuzy->XY', h_aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xzwa,ua,XwuYyz->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xzwa,ua,XyzYwu->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xzwa,uvYa,Xyzuwv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xzwa,uvsa,XwvuYyzs->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,xzwa,uvsa,XyzsYwvu->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xy,xzwa,uvwa,XuvYyz->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xzwa,uvwa,XuvYzy->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xzwa,uvwa,XuvyYz->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xzwa,uvwa,XuvyzY->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xzwa,uvwa,XuvzYy->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xzwa,uvwa,XuvzyY->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xy,xzwa,uvwa,XyzYuv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xzwa,uvwa,XyzYvu->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xzwa,uvwa,XyzuYv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xzwa,uvwa,XyzuvY->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xzwa,uvwa,XyzvYu->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,xzwa,uvwa,XyzvuY->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/4 * einsum('xy,zYxa,wa,Xzwy->XY', h_aa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zYxa,wuva,Xzvuwy->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('xy,zYxa,wuva,Xzvuyw->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zYxa,wuva,Xzvwuy->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zYxa,wuva,Xzvwyu->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zYxa,wuva,Xzvyuw->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zYxa,wuva,Xzvywu->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xy,zYxa,wuya,Xzuw->XY', h_aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/4 * einsum('xy,zwxa,Ya,Xywz->XY', h_aa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,Yuva,Xyuvwz->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('xy,zwxa,Yuva,Xyuvzw->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,Yuva,Xyuwvz->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,Yuva,Xyuwzv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,Yuva,Xyuzvw->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,Yuva,Xyuzwv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/4 * einsum('xy,zwxa,uYva,Xyuwzv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,ua,XyuYwz->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('xy,zwxa,ua,XyuYzw->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,ua,XyuwYz->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,ua,XyuwzY->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,ua,XyuzYw->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,ua,XyuzwY->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,ua,XzwYuy->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('xy,zwxa,ua,XzwYyu->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,ua,XzwuYy->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,ua,XzwuyY->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,ua,XzwyYu->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,ua,XzwyuY->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,uvYa,Xzwuvy->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('xy,zwxa,uvYa,Xzwuyv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,uvYa,Xzwvuy->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,uvYa,Xzwvyu->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,uvYa,Xzwyuv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zwxa,uvYa,Xzwyvu->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('xy,zwxa,uvsa,XyvuYswz->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('xy,zwxa,uvsa,XyvuYszw->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('xy,zwxa,uvsa,XyvuYwsz->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('xy,zwxa,uvsa,XyvuYwzs->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('xy,zwxa,uvsa,XyvuYzsw->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/16 * einsum('xy,zwxa,uvsa,XyvuYzws->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('xy,zwxa,uvsa,XzwsYuvy->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('xy,zwxa,uvsa,XzwsYuyv->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('xy,zwxa,uvsa,XzwsYvuy->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('xy,zwxa,uvsa,XzwsYvyu->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('xy,zwxa,uvsa,XzwsYyuv->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/16 * einsum('xy,zwxa,uvsa,XzwsYyvu->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xy,zwxa,uvya,XzwYuv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,zxYa,wa,Xwzy->XY', h_aa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxYa,wuva,Xuwvyz->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxYa,wuva,Xuwvzy->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxYa,wuva,Xuwyvz->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxYa,wuva,Xuwyzv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxYa,wuva,Xuwzvy->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xy,zxYa,wuva,Xuwzyv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,zxwa,Ya,Xwyz->XY', h_aa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,Yuva,Xwuvyz->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xy,zxwa,Yuva,Xwuvzy->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,Yuva,Xwuyvz->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,Yuva,Xwuyzv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,Yuva,Xwuzvy->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,Yuva,Xwuzyv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,zxwa,Yuwa,Xuzy->XY', h_aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,zxwa,uYva,Xwuyzv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,zxwa,uYwa,Xuyz->XY', h_aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,ua,XwuYyz->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xy,zxwa,ua,XwuYzy->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,ua,XwuyYz->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,ua,XwuyzY->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,ua,XwuzYy->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,ua,XwuzyY->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xy,zxwa,ua,XyzYuw->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,ua,XyzYwu->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,ua,XyzuYw->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,ua,XyzuwY->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,ua,XyzwYu->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,ua,XyzwuY->XY', h_aa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xy,zxwa,uvYa,Xyzuvw->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,uvYa,Xyzuwv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,uvYa,Xyzvuw->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,uvYa,Xyzvwu->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,uvYa,Xyzwuv->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xy,zxwa,uvYa,Xyzwvu->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('xy,zxwa,uvsa,XwvuYsyz->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('xy,zxwa,uvsa,XwvuYszy->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('xy,zxwa,uvsa,XwvuYysz->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('xy,zxwa,uvsa,XwvuYyzs->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('xy,zxwa,uvsa,XwvuYzsy->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zxwa,uvsa,XwvuYzys->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('xy,zxwa,uvsa,XyzsYuvw->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('xy,zxwa,uvsa,XyzsYuwv->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('xy,zxwa,uvsa,XyzsYvuw->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xy,zxwa,uvsa,XyzsYvwu->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('xy,zxwa,uvsa,XyzsYwuv->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('xy,zxwa,uvsa,XyzsYwvu->XY', h_aa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,zxwa,uvwa,XvuYyz->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xy,zxwa,uvwa,XyzYvu->XY', h_aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/4 * einsum('Yxyz,wuxa,va,Xyvwzu->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/48 * einsum('Yxyz,wuxa,vsta,Xysvtzuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/48 * einsum('Yxyz,wuxa,vsta,Xysvtzwu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/48 * einsum('Yxyz,wuxa,vsta,Xysvuztw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/48 * einsum('Yxyz,wuxa,vsta,Xysvuzwt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/48 * einsum('Yxyz,wuxa,vsta,Xysvwztu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 11/48 * einsum('Yxyz,wuxa,vsta,Xysvwzut->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wuxa,vzsa,Xyvsuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wuxa,vzsa,Xyvswu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wuxa,vzsa,Xyvusw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wuxa,vzsa,Xyvuws->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wuxa,vzsa,Xyvwsu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('Yxyz,wuxa,vzsa,Xyvwus->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,wuxa,za,Xywu->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,wuxa,zvsa,Xyvwsu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('Yxyz,wuya,va,Xwuvxz->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('Yxyz,wuya,va,Xwuvzx->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('Yxyz,wuya,va,Xwuxvz->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('Yxyz,wuya,va,Xwuxzv->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('Yxyz,wuya,va,Xwuzvx->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('Yxyz,wuya,va,Xwuzxv->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/480 * einsum('Yxyz,wuya,vsta,Xwutsvxz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/480 * einsum('Yxyz,wuya,vsta,Xwutsvzx->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/480 * einsum('Yxyz,wuya,vsta,Xwutsxzv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/480 * einsum('Yxyz,wuya,vsta,Xwutszxv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/480 * einsum('Yxyz,wuya,vsta,Xwutvsxz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/480 * einsum('Yxyz,wuya,vsta,Xwutvszx->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/160 * einsum('Yxyz,wuya,vsta,Xwutvxzs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/160 * einsum('Yxyz,wuya,vsta,Xwutvzxs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 29/480 * einsum('Yxyz,wuya,vsta,Xwutxsvz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 11/240 * einsum('Yxyz,wuya,vsta,Xwutxszv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 29/480 * einsum('Yxyz,wuya,vsta,Xwutxvsz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/15 * einsum('Yxyz,wuya,vsta,Xwutxvzs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 97/480 * einsum('Yxyz,wuya,vsta,Xwutxzsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 11/160 * einsum('Yxyz,wuya,vsta,Xwutxzvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/480 * einsum('Yxyz,wuya,vsta,Xwutzsvx->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('Yxyz,wuya,vsta,Xwutzsxv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/480 * einsum('Yxyz,wuya,vsta,Xwutzvsx->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/240 * einsum('Yxyz,wuya,vsta,Xwutzvxs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/480 * einsum('Yxyz,wuya,vsta,Xwutzxsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/160 * einsum('Yxyz,wuya,vsta,Xwutzxvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('Yxyz,wuya,vsxa,Xwusvz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('Yxyz,wuya,vsxa,Xwuszv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('Yxyz,wuya,vsxa,Xwuvsz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/3 * einsum('Yxyz,wuya,vsxa,Xwuvzs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('Yxyz,wuya,vsxa,Xwuzsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('Yxyz,wuya,vsxa,Xwuzvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('Yxyz,wuya,vsza,Xwuxvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('Yxyz,wuza,va,Xyvuwx->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('Yxyz,wuza,va,Xyvuxw->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('Yxyz,wuza,va,Xyvwux->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('Yxyz,wuza,va,Xyvwxu->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('Yxyz,wuza,va,Xyvxuw->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('Yxyz,wuza,va,Xyvxwu->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('Yxyz,wuza,vsta,Xysvxtuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('Yxyz,wuza,vsta,Xysvxtwu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('Yxyz,wuza,vsta,Xysvxutw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('Yxyz,wuza,vsta,Xysvxuwt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('Yxyz,wuza,vsta,Xysvxwtu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/16 * einsum('Yxyz,wuza,vsta,Xysvxwut->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,wxua,va,Xywvzu->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('Yxyz,wxua,vsta,Xywtszuv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wxua,vsta,Xywtszvu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wxua,vsta,Xywtuzsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wxua,vsta,Xywtuzvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wxua,vsta,Xywtvzsu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wxua,vsta,Xywtvzus->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wxua,vsua,Xywsvz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('Yxyz,wxua,vsua,Xywszv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wxua,vsua,Xywvsz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wxua,vsua,Xywvzs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wxua,vsua,Xywzsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wxua,vsua,Xywzvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,wxua,vsza,Xywsvu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wyua,va,Xuvwxz->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wyua,va,Xuvwzx->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('Yxyz,wyua,va,Xuvxwz->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wyua,va,Xuvxzw->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wyua,va,Xuvzwx->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wyua,va,Xuvzxw->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/96 * einsum('Yxyz,wyua,vsta,Xusvtxwz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/96 * einsum('Yxyz,wyua,vsta,Xusvtxzw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/96 * einsum('Yxyz,wyua,vsta,Xusvtzwx->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/96 * einsum('Yxyz,wyua,vsta,Xusvtzxw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/48 * einsum('Yxyz,wyua,vsta,Xusvwtxz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/48 * einsum('Yxyz,wyua,vsta,Xusvwtzx->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/96 * einsum('Yxyz,wyua,vsta,Xusvwxtz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/96 * einsum('Yxyz,wyua,vsta,Xusvwxzt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/96 * einsum('Yxyz,wyua,vsta,Xusvwztx->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/96 * einsum('Yxyz,wyua,vsta,Xusvwzxt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 17/96 * einsum('Yxyz,wyua,vsta,Xusvxtwz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 17/96 * einsum('Yxyz,wyua,vsta,Xusvxtzw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 5/32 * einsum('Yxyz,wyua,vsta,Xusvxwtz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 3/32 * einsum('Yxyz,wyua,vsta,Xusvxwzt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('Yxyz,wyua,vsta,Xusvxztw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('Yxyz,wyua,vsta,Xusvxzwt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/96 * einsum('Yxyz,wyua,vsta,Xusvztwx->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/96 * einsum('Yxyz,wyua,vsta,Xusvztxw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/96 * einsum('Yxyz,wyua,vsta,Xusvzwtx->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/96 * einsum('Yxyz,wyua,vsta,Xusvzwxt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,wyua,vsua,Xsvxzw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wzua,va,Xywuvx->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wzua,va,Xywuxv->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wzua,va,Xywvux->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wzua,va,Xywvxu->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,wzua,va,Xywxuv->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('Yxyz,wzua,va,Xywxvu->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('Yxyz,wzua,vsta,Xywtxsuv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('Yxyz,wzua,vsta,Xywtxsvu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('Yxyz,wzua,vsta,Xywtxusv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('Yxyz,wzua,vsta,Xywtxuvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('Yxyz,wzua,vsta,Xywtxvsu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('Yxyz,wzua,vsta,Xywtxvus->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,wzua,vsua,Xywxsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,xa,wa,Xywz->XY', v_aaaa, t1_ae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,xa,wuva,Xyvuwz->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('Yxyz,xa,wuva,Xyvuzw->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,xa,wuva,Xyvwuz->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,xa,wuva,Xyvwzu->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,xa,wuva,Xyvzuw->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,xa,wuva,Xyvzwu->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,xa,wuza,Xyuw->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,xwua,va,Xywuvz->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('Yxyz,xwua,va,Xywuzv->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,xwua,va,Xywvuz->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,xwua,va,Xywvzu->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,xwua,va,Xywzuv->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,xwua,va,Xywzvu->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,xwua,vsta,Xywtuzsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,xwua,vsua,Xywvzs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,xwua,vsza,Xywsuv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,xwua,vsza,Xywsvu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,xwua,vsza,Xywusv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('Yxyz,xwua,vsza,Xywuvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,xwua,vsza,Xywvsu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,xwua,vsza,Xywvus->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,xzwa,ua,Xywu->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,xzwa,uvsa,Xyswvu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,xzwa,uvwa,Xyuv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,ya,wa,Xwxz->XY', v_aaaa, t1_ae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,ya,wuva,Xuwxzv->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,ywua,va,Xuvxzw->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('Yxyz,ywua,vsta,Xusvtxwz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('Yxyz,ywua,vsta,Xusvtxzw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('Yxyz,ywua,vsta,Xusvtzwx->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('Yxyz,ywua,vsta,Xusvtzxw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('Yxyz,ywua,vsta,Xusvwtxz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('Yxyz,ywua,vsta,Xusvwtzx->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('Yxyz,ywua,vsta,Xusvwxtz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('Yxyz,ywua,vsta,Xusvwxzt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('Yxyz,ywua,vsta,Xusvwztx->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('Yxyz,ywua,vsta,Xusvwzxt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 3/160 * einsum('Yxyz,ywua,vsta,Xusvxtwz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 3/160 * einsum('Yxyz,ywua,vsta,Xusvxtzw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('Yxyz,ywua,vsta,Xusvxwtz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('Yxyz,ywua,vsta,Xusvxwzt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/240 * einsum('Yxyz,ywua,vsta,Xusvxztw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 61/240 * einsum('Yxyz,ywua,vsta,Xusvxzwt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 3/160 * einsum('Yxyz,ywua,vsta,Xusvztwx->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 3/160 * einsum('Yxyz,ywua,vsta,Xusvztxw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('Yxyz,ywua,vsta,Xusvzwtx->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('Yxyz,ywua,vsta,Xusvzwxt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/240 * einsum('Yxyz,ywua,vsta,Xusvzxtw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/240 * einsum('Yxyz,ywua,vsta,Xusvzxwt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,ywua,vsua,Xvswxz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,ywua,vsua,Xvswzx->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,ywua,vsua,Xvsxwz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('Yxyz,ywua,vsua,Xvsxzw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,ywua,vsua,Xvszwx->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,ywua,vsua,Xvszxw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,za,wa,Xyxw->XY', v_aaaa, t1_ae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,za,wuva,Xyvxuw->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,zwua,va,Xywxuv->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,zwua,vsta,Xywtxusv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,zwua,vsua,Xywsvx->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,zwua,vsua,Xywsxv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,zwua,vsua,Xywvsx->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,zwua,vsua,Xywvxs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,zwua,vsua,Xywxsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('Yxyz,zwua,vsua,Xywxvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,zxwa,ua,Xyuw->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,zxwa,uvsa,Xysuvw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,zxwa,uvsa,Xysuwv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,zxwa,uvsa,Xysvuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('Yxyz,zxwa,uvsa,Xysvwu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,zxwa,uvsa,Xyswuv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('Yxyz,zxwa,uvsa,Xyswvu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('Yxyz,zxwa,uvwa,Xyvu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/4 * einsum('xyzw,Yuxa,va,Xzuywv->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/120 * einsum('xyzw,Yuxa,vsta,Xzutsvwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/120 * einsum('xyzw,Yuxa,vsta,Xzutsvyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/160 * einsum('xyzw,Yuxa,vsta,Xzutswvy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('xyzw,Yuxa,vsta,Xzutswyv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/160 * einsum('xyzw,Yuxa,vsta,Xzutsyvw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('xyzw,Yuxa,vsta,Xzutsywv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/120 * einsum('xyzw,Yuxa,vsta,Xzutvswy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/120 * einsum('xyzw,Yuxa,vsta,Xzutvsyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/160 * einsum('xyzw,Yuxa,vsta,Xzutvwsy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('xyzw,Yuxa,vsta,Xzutvwys->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/160 * einsum('xyzw,Yuxa,vsta,Xzutvysw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('xyzw,Yuxa,vsta,Xzutvyws->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/480 * einsum('xyzw,Yuxa,vsta,Xzutwsvy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/160 * einsum('xyzw,Yuxa,vsta,Xzutwsyv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/480 * einsum('xyzw,Yuxa,vsta,Xzutwvsy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/160 * einsum('xyzw,Yuxa,vsta,Xzutwvys->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/240 * einsum('xyzw,Yuxa,vsta,Xzutwysv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/240 * einsum('xyzw,Yuxa,vsta,Xzutwyvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/480 * einsum('xyzw,Yuxa,vsta,Xzutysvw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/160 * einsum('xyzw,Yuxa,vsta,Xzutyswv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/480 * einsum('xyzw,Yuxa,vsta,Xzutyvsw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/160 * einsum('xyzw,Yuxa,vsta,Xzutyvws->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 61/240 * einsum('xyzw,Yuxa,vsta,Xzutywsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/240 * einsum('xyzw,Yuxa,vsta,Xzutywvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,Yuxa,vswa,Xzusvy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,Yuxa,vswa,Xzusyv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,Yuxa,vswa,Xzuvsy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,Yuxa,vswa,Xzuvys->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,Yuxa,vswa,Xzuysv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/3 * einsum('xyzw,Yuxa,vswa,Xzuyvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xyzw,Yuxa,vsya,Xzuvws->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,Yuxa,vzsa,Xusywv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,Yuxa,za,Xuyw->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,Yuxa,zvsa,Xusvwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,Yuxa,zvsa,Xusvyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,Yuxa,zvsa,Xuswvy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,Yuxa,zvsa,Xuswyv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,Yuxa,zvsa,Xusyvw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,Yuxa,zvsa,Xusywv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,Yxua,va,Xywuvz->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,Yxua,vsta,Xywtsuzv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,Yxua,vsta,Xywtsvzu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,Yxua,vsta,Xywtszuv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,Yxua,vsta,Xywtszvu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/240 * einsum('xyzw,Yxua,vsta,Xywtusvz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 17/60 * einsum('xyzw,Yxua,vsta,Xywtuszv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/240 * einsum('xyzw,Yxua,vsta,Xywtuvsz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/120 * einsum('xyzw,Yxua,vsta,Xywtuvzs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/30 * einsum('xyzw,Yxua,vsta,Xywtuzsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/120 * einsum('xyzw,Yxua,vsta,Xywtuzvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,Yxua,vsta,Xywtvszu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,Yxua,vsta,Xywtvuzs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,Yxua,vsta,Xywtvzsu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,Yxua,vsta,Xywtvzus->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,Yxua,vsta,Xywtzsuv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/120 * einsum('xyzw,Yxua,vsta,Xywtzsvu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,Yxua,vsta,Xywtzusv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 13/240 * einsum('xyzw,Yxua,vsta,Xywtzuvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/120 * einsum('xyzw,Yxua,vsta,Xywtzvsu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 13/240 * einsum('xyzw,Yxua,vsta,Xywtzvus->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,Yxua,vsua,Xywsvz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,Yxua,vsua,Xywszv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,Yxua,vsua,Xywvsz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,Yxua,vsua,Xywvzs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,Yxua,vsua,Xywzsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,Yxua,vsua,Xywzvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,Yxua,vsza,Xywusv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/6 * einsum('xyzw,uYxa,va,Xzuvwy->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xyzw,uYxa,va,Xzuvyw->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xyzw,uYxa,va,Xzuwvy->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xyzw,uYxa,va,Xzuwyv->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xyzw,uYxa,va,Xzuyvw->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xyzw,uYxa,va,Xzuywv->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/96 * einsum('xyzw,uYxa,vsta,Xzutsvwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/96 * einsum('xyzw,uYxa,vsta,Xzutsvyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 5/96 * einsum('xyzw,uYxa,vsta,Xzutswvy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uYxa,vsta,Xzutswyv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/32 * einsum('xyzw,uYxa,vsta,Xzutsyvw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xyzw,uYxa,vsta,Xzutsywv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/96 * einsum('xyzw,uYxa,vsta,Xzutvswy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/96 * einsum('xyzw,uYxa,vsta,Xzutvsyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 5/96 * einsum('xyzw,uYxa,vsta,Xzutvwsy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,uYxa,vsta,Xzutvwys->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/32 * einsum('xyzw,uYxa,vsta,Xzutvysw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,uYxa,vsta,Xzutvyws->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/48 * einsum('xyzw,uYxa,vsta,Xzutwsvy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 3/32 * einsum('xyzw,uYxa,vsta,Xzutwsyv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/48 * einsum('xyzw,uYxa,vsta,Xzutwvsy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/32 * einsum('xyzw,uYxa,vsta,Xzutwvys->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 5/96 * einsum('xyzw,uYxa,vsta,Xzutwysv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/96 * einsum('xyzw,uYxa,vsta,Xzutwyvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/16 * einsum('xyzw,uYxa,vsta,Xzutysvw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 5/96 * einsum('xyzw,uYxa,vsta,Xzutyswv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/16 * einsum('xyzw,uYxa,vsta,Xzutyvsw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/96 * einsum('xyzw,uYxa,vsta,Xzutyvws->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 3/32 * einsum('xyzw,uYxa,vsta,Xzutywsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/32 * einsum('xyzw,uYxa,vsta,Xzutywvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xyzw,uYxa,vswa,Xzusvy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,uYxa,vsya,Xzusvw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/3 * einsum('xyzw,uYxa,vsya,Xzuswv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,uYxa,vsya,Xzuvsw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,uYxa,vsya,Xzuvws->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,uYxa,vsya,Xzuwsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,uYxa,vsya,Xzuwvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uYxa,vzsa,Xusvwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uYxa,vzsa,Xusvyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uYxa,vzsa,Xuswvy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,uYxa,vzsa,Xuswyv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uYxa,vzsa,Xusyvw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uYxa,vzsa,Xusywv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,uYxa,za,Xuwy->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,uYxa,zvsa,Xusvyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/4 * einsum('xyzw,uvxa,Ya,Xywvuz->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 7/160 * einsum('xyzw,uvxa,Ysta,Xywstuzv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 13/160 * einsum('xyzw,uvxa,Ysta,Xywstvzu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 19/480 * einsum('xyzw,uvxa,Ysta,Xywstzuv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 41/480 * einsum('xyzw,uvxa,Ysta,Xywstzvu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/480 * einsum('xyzw,uvxa,Ysta,Xywsutvz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 49/240 * einsum('xyzw,uvxa,Ysta,Xywsutzv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/480 * einsum('xyzw,uvxa,Ysta,Xywsuvtz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 41/480 * einsum('xyzw,uvxa,Ysta,Xywsuvzt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 3/80 * einsum('xyzw,uvxa,Ysta,Xywsuztv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 13/160 * einsum('xyzw,uvxa,Ysta,Xywsuzvt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/480 * einsum('xyzw,uvxa,Ysta,Xywsvtuz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 19/240 * einsum('xyzw,uvxa,Ysta,Xywsvtzu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/480 * einsum('xyzw,uvxa,Ysta,Xywsvutz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 41/480 * einsum('xyzw,uvxa,Ysta,Xywsvuzt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/80 * einsum('xyzw,uvxa,Ysta,Xywsvztu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 13/160 * einsum('xyzw,uvxa,Ysta,Xywsvzut->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 59/480 * einsum('xyzw,uvxa,Ysta,Xywsztuv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/480 * einsum('xyzw,uvxa,Ysta,Xywsztvu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 59/480 * einsum('xyzw,uvxa,Ysta,Xywszutv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/240 * einsum('xyzw,uvxa,Ysta,Xywszuvt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/480 * einsum('xyzw,uvxa,Ysta,Xywszvtu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/240 * einsum('xyzw,uvxa,Ysta,Xywszvut->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('xyzw,uvxa,sYta,Xywsuvzt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('xyzw,uvxa,sYta,Xywsuzvt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/16 * einsum('xyzw,uvxa,sYta,Xywsvuzt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('xyzw,uvxa,sYta,Xywsvzut->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uvxa,sYta,Xywsztuv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uvxa,sYta,Xywsztvu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uvxa,sYta,Xywszutv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/48 * einsum('xyzw,uvxa,sYta,Xywszuvt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uvxa,sYta,Xywszvtu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/48 * einsum('xyzw,uvxa,sYta,Xywszvut->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 11/240 * einsum('xyzw,uvxa,sa,XywsYuvz->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 19/120 * einsum('xyzw,uvxa,sa,XywsYuzv->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 11/240 * einsum('xyzw,uvxa,sa,XywsYvuz->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/20 * einsum('xyzw,uvxa,sa,XywsYvzu->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 11/120 * einsum('xyzw,uvxa,sa,XywsYzuv->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/20 * einsum('xyzw,uvxa,sa,XywsYzvu->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,uvxa,sa,XywsuYvz->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,uvxa,sa,XywsuYzv->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,uvxa,sa,XywsuvYz->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,uvxa,sa,XywsuzYv->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,uvxa,sa,XywsvYuz->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,uvxa,sa,XywsvYzu->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,uvxa,sa,XywsvuYz->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,uvxa,sa,XywsvzYu->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,uvxa,sa,XywszYuv->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,uvxa,sa,XywszYvu->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,uvxa,sa,XywszuYv->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,uvxa,sa,XywszuvY->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,uvxa,sa,XywszvYu->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,uvxa,sa,XywszvuY->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 11/240 * einsum('xyzw,uvxa,sa,XzuvYswy->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 11/240 * einsum('xyzw,uvxa,sa,XzuvYsyw->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/20 * einsum('xyzw,uvxa,sa,XzuvYwsy->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 19/120 * einsum('xyzw,uvxa,sa,XzuvYwys->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/20 * einsum('xyzw,uvxa,sa,XzuvYysw->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 11/120 * einsum('xyzw,uvxa,sa,XzuvYyws->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,uvxa,sa,XzuvsYwy->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,uvxa,sa,XzuvsYyw->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,uvxa,sa,XzuvwYsy->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,uvxa,sa,XzuvwYys->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,uvxa,sa,XzuvwsYy->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,uvxa,sa,XzuvwsyY->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,uvxa,sa,XzuvwyYs->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,uvxa,sa,XzuvwysY->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,uvxa,sa,XzuvyYsw->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,uvxa,sa,XzuvyYws->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,uvxa,sa,XzuvysYw->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,uvxa,sa,XzuvyswY->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,uvxa,sa,XzuvywYs->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,uvxa,sa,XzuvywsY->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/160 * einsum('xyzw,uvxa,stYa,Xzuvstwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/160 * einsum('xyzw,uvxa,stYa,Xzuvstyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 17/480 * einsum('xyzw,uvxa,stYa,Xzuvswty->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 19/240 * einsum('xyzw,uvxa,stYa,Xzuvswyt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 11/160 * einsum('xyzw,uvxa,stYa,Xzuvsytw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/15 * einsum('xyzw,uvxa,stYa,Xzuvsywt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/480 * einsum('xyzw,uvxa,stYa,Xzuvtswy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/480 * einsum('xyzw,uvxa,stYa,Xzuvtsyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 17/480 * einsum('xyzw,uvxa,stYa,Xzuvtwsy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 11/240 * einsum('xyzw,uvxa,stYa,Xzuvtwys->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 11/160 * einsum('xyzw,uvxa,stYa,Xzuvtysw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/120 * einsum('xyzw,uvxa,stYa,Xzuvtyws->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/120 * einsum('xyzw,uvxa,stYa,Xzuvwsty->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 61/480 * einsum('xyzw,uvxa,stYa,Xzuvwsyt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,uvxa,stYa,Xzuvwtsy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/480 * einsum('xyzw,uvxa,stYa,Xzuvwtys->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 29/480 * einsum('xyzw,uvxa,stYa,Xzuvwyst->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 31/480 * einsum('xyzw,uvxa,stYa,Xzuvwyts->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/20 * einsum('xyzw,uvxa,stYa,Xzuvystw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 41/480 * einsum('xyzw,uvxa,stYa,Xzuvyswt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 13/240 * einsum('xyzw,uvxa,stYa,Xzuvytsw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/160 * einsum('xyzw,uvxa,stYa,Xzuvytws->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 59/480 * einsum('xyzw,uvxa,stYa,Xzuvywst->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/480 * einsum('xyzw,uvxa,stYa,Xzuvywts->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('xyzw,uvxa,stwa,XzuvYsty->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/8 * einsum('xyzw,uvxa,stwa,XzuvYsyt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('xyzw,uvxa,stwa,XzuvYtsy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('xyzw,uvxa,stwa,XzuvYtys->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('xyzw,uvxa,stwa,XzuvYyst->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('xyzw,uvxa,stwa,XzuvYyts->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/2 * einsum('xyzw,uvxa,stya,XzuvYwst->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,uxYa,va,Xzvuwy->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uxYa,va,Xzvuyw->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uxYa,va,Xzvwuy->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uxYa,va,Xzvwyu->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uxYa,va,Xzvyuw->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uxYa,va,Xzvywu->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/120 * einsum('xyzw,uxYa,vsta,Xzsvtwuy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/120 * einsum('xyzw,uxYa,vsta,Xzsvtwyu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/120 * einsum('xyzw,uxYa,vsta,Xzsvtyuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/120 * einsum('xyzw,uxYa,vsta,Xzsvtywu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/240 * einsum('xyzw,uxYa,vsta,Xzsvutwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/240 * einsum('xyzw,uxYa,vsta,Xzsvutyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/120 * einsum('xyzw,uxYa,vsta,Xzsvuwty->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 2/15 * einsum('xyzw,uxYa,vsta,Xzsvuwyt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/120 * einsum('xyzw,uxYa,vsta,Xzsvuytw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/60 * einsum('xyzw,uxYa,vsta,Xzsvuywt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 13/240 * einsum('xyzw,uxYa,vsta,Xzsvwtuy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 13/240 * einsum('xyzw,uxYa,vsta,Xzsvwtyu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/20 * einsum('xyzw,uxYa,vsta,Xzsvwuty->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/40 * einsum('xyzw,uxYa,vsta,Xzsvwuyt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/120 * einsum('xyzw,uxYa,vsta,Xzsvwytu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/15 * einsum('xyzw,uxYa,vsta,Xzsvwyut->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 23/240 * einsum('xyzw,uxYa,vsta,Xzsvytuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 23/240 * einsum('xyzw,uxYa,vsta,Xzsvytwu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 11/120 * einsum('xyzw,uxYa,vsta,Xzsvyutw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/30 * einsum('xyzw,uxYa,vsta,Xzsvyuwt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/10 * einsum('xyzw,uxYa,vsta,Xzsvywtu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/40 * einsum('xyzw,uxYa,vsta,Xzsvywut->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,uxYa,vsza,Xvsuwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,uxva,Ya,Xzvywu->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('xyzw,uxva,Ysta,Xzvstwuy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/8 * einsum('xyzw,uxva,Ysta,Xzvstyuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/8 * einsum('xyzw,uxva,Ysta,Xzvswtuy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/8 * einsum('xyzw,uxva,Ysta,Xzvswyut->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/8 * einsum('xyzw,uxva,Ysta,Xzvsytuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/8 * einsum('xyzw,uxva,Ysta,Xzvsywut->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,uxva,Ysva,Xzsuwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uxva,Ysva,Xzsuyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uxva,Ysva,Xzswuy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uxva,Ysva,Xzswyu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uxva,Ysva,Xzsyuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,uxva,Ysva,Xzsywu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,uxva,sYta,Xzvsywut->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,uxva,sYva,Xzsywu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 5/24 * einsum('xyzw,uxva,sa,XywuYszv->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,uxva,sa,XywuYzsv->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,uxva,sa,XywusYvz->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,uxva,sa,XywusvYz->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,uxva,sa,XywuvYsz->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,uxva,sa,XywuvYzs->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,uxva,sa,XywuvsYz->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,uxva,sa,XywuvzYs->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,uxva,sa,XywuzYvs->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,uxva,sa,XywuzvYs->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 5/24 * einsum('xyzw,uxva,sa,XzvsYwuy->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,uxva,sa,XzvsYyuw->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,uxva,sa,XzvswYyu->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,uxva,sa,XzvswuYy->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,uxva,sa,XzvswuyY->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,uxva,sa,XzvswyYu->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,uxva,sa,XzvsyYwu->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,uxva,sa,XzvsyuYw->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,uxva,sa,XzvsyuwY->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,uxva,sa,XzvsywYu->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 3/16 * einsum('xyzw,uxva,stYa,Xywustzv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/16 * einsum('xyzw,uxva,stYa,Xywusztv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/16 * einsum('xyzw,uxva,stYa,Xywutszv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/16 * einsum('xyzw,uxva,stYa,Xywutzsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/16 * einsum('xyzw,uxva,stYa,Xywuzstv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/16 * einsum('xyzw,uxva,stYa,Xywuztsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 11/240 * einsum('xyzw,uxva,stva,XywuYstz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/20 * einsum('xyzw,uxva,stva,XywuYszt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 11/240 * einsum('xyzw,uxva,stva,XywuYtsz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 19/120 * einsum('xyzw,uxva,stva,XywuYtzs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/20 * einsum('xyzw,uxva,stva,XywuYzst->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 11/120 * einsum('xyzw,uxva,stva,XywuYzts->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,uxva,stva,XywusYtz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,uxva,stva,XywusYzt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,uxva,stva,XywustYz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,uxva,stva,XywuszYt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,uxva,stva,XywutYsz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,uxva,stva,XywutYzs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,uxva,stva,XywutsYz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,uxva,stva,XywutzYs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,uxva,stva,XywuzYst->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,uxva,stva,XywuzYts->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,uxva,stva,XywuzsYt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,uxva,stva,XywuzstY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,uxva,stva,XywuztYs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,uxva,stva,XywuztsY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 11/240 * einsum('xyzw,uxva,stva,XztsYuwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 11/240 * einsum('xyzw,uxva,stva,XztsYuyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/20 * einsum('xyzw,uxva,stva,XztsYwuy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 19/120 * einsum('xyzw,uxva,stva,XztsYwyu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/20 * einsum('xyzw,uxva,stva,XztsYyuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 11/120 * einsum('xyzw,uxva,stva,XztsYywu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,uxva,stva,XztsuYwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,uxva,stva,XztsuYyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,uxva,stva,XztswYuy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,uxva,stva,XztswYyu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,uxva,stva,XztswuYy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,uxva,stva,XztswuyY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,uxva,stva,XztswyYu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,uxva,stva,XztswyuY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,uxva,stva,XztsyYuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,uxva,stva,XztsyYwu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,uxva,stva,XztsyuYw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,uxva,stva,XztsyuwY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,uxva,stva,XztsywYu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,uxva,stva,XztsywuY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 5/24 * einsum('xyzw,uxva,stza,XvstYuwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,uxva,stza,XvstYuyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,uxva,stza,XvstwuYy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,uxva,stza,XvstwuyY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,uxva,stza,XvstyuYw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,uxva,stza,XvstyuwY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,uxva,stza,XywuYstv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 5/24 * einsum('xyzw,uxva,stza,XywuYtsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,uxva,stza,XywusYtv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,uxva,stza,XywustYv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,uxva,stza,XywutYsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,uxva,stza,XywutsYv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xYua,va,Xywuvz->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xYua,va,Xywuzv->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,xYua,va,Xywvuz->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xYua,va,Xywvzu->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xYua,va,Xywzuv->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xYua,va,Xywzvu->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xyzw,xYua,vsta,Xywtsuzv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,xYua,vsta,Xywtsvzu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xYua,vsta,Xywtszuv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,xYua,vsta,Xywtszvu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/48 * einsum('xyzw,xYua,vsta,Xywtusvz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/16 * einsum('xyzw,xYua,vsta,Xywtuszv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/48 * einsum('xyzw,xYua,vsta,Xywtuvsz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/16 * einsum('xyzw,xYua,vsta,Xywtuvzs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 5/48 * einsum('xyzw,xYua,vsta,Xywtuzsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/48 * einsum('xyzw,xYua,vsta,Xywtuzvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,xYua,vsta,Xywtvszu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,xYua,vsta,Xywtvuzs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,xYua,vsta,Xywtvzsu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,xYua,vsta,Xywtvzus->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/48 * einsum('xyzw,xYua,vsta,Xywtzsuv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 5/48 * einsum('xyzw,xYua,vsta,Xywtzsvu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/48 * einsum('xyzw,xYua,vsta,Xywtzusv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 5/48 * einsum('xyzw,xYua,vsta,Xywtzuvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 5/48 * einsum('xyzw,xYua,vsta,Xywtzvsu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 5/48 * einsum('xyzw,xYua,vsta,Xywtzvus->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,xYua,vsua,Xywsvz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,xYua,vsza,Xywsuv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xYua,vsza,Xywsvu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xYua,vsza,Xywusv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xYua,vsza,Xywuvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xYua,vsza,Xywvsu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xYua,vsza,Xywvus->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,xa,Ya,Xzyw->XY', v_aaaa, t1_ae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,xa,Yuva,Xzuvwy->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,Yuva,Xzuvyw->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,Yuva,Xzuwvy->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,Yuva,Xzuwyv->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,Yuva,Xzuyvw->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,Yuva,Xzuywv->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,xa,uYva,Xzuywv->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,xa,ua,XywYuz->XY', v_aaaa, t1_ae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,ua,XywYzu->XY', v_aaaa, t1_ae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,ua,XywuYz->XY', v_aaaa, t1_ae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,ua,XywuzY->XY', v_aaaa, t1_ae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,ua,XywzYu->XY', v_aaaa, t1_ae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,ua,XywzuY->XY', v_aaaa, t1_ae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,xa,ua,XzuYwy->XY', v_aaaa, t1_ae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,ua,XzuYyw->XY', v_aaaa, t1_ae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,ua,XzuwYy->XY', v_aaaa, t1_ae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,ua,XzuwyY->XY', v_aaaa, t1_ae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,ua,XzuyYw->XY', v_aaaa, t1_ae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,ua,XzuywY->XY', v_aaaa, t1_ae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,xa,uvYa,Xywuvz->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,uvYa,Xywuzv->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,uvYa,Xywvuz->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,uvYa,Xywvzu->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,uvYa,Xywzuv->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xa,uvYa,Xywzvu->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 11/240 * einsum('xyzw,xa,uvsa,XywsYuvz->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/20 * einsum('xyzw,xa,uvsa,XywsYuzv->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 11/240 * einsum('xyzw,xa,uvsa,XywsYvuz->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 19/120 * einsum('xyzw,xa,uvsa,XywsYvzu->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/20 * einsum('xyzw,xa,uvsa,XywsYzuv->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 11/120 * einsum('xyzw,xa,uvsa,XywsYzvu->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,xa,uvsa,XywsuYvz->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,xa,uvsa,XywsuYzv->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,xa,uvsa,XywsuvYz->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,xa,uvsa,XywsuzYv->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,xa,uvsa,XywsvYuz->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,xa,uvsa,XywsvYzu->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,xa,uvsa,XywsvuYz->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,xa,uvsa,XywsvzYu->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,xa,uvsa,XywszYuv->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,xa,uvsa,XywszYvu->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,xa,uvsa,XywszuYv->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,xa,uvsa,XywszuvY->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,xa,uvsa,XywszvYu->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,xa,uvsa,XywszvuY->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 11/240 * einsum('xyzw,xa,uvsa,XzvuYswy->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 11/240 * einsum('xyzw,xa,uvsa,XzvuYsyw->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/20 * einsum('xyzw,xa,uvsa,XzvuYwsy->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 19/120 * einsum('xyzw,xa,uvsa,XzvuYwys->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/20 * einsum('xyzw,xa,uvsa,XzvuYysw->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 11/120 * einsum('xyzw,xa,uvsa,XzvuYyws->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,xa,uvsa,XzvusYwy->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,xa,uvsa,XzvusYyw->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,xa,uvsa,XzvuwYsy->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,xa,uvsa,XzvuwYys->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,xa,uvsa,XzvuwsYy->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,xa,uvsa,XzvuwsyY->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,xa,uvsa,XzvuwyYs->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,xa,uvsa,XzvuwysY->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,xa,uvsa,XzvuyYsw->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,xa,uvsa,XzvuyYws->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,xa,uvsa,XzvuysYw->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,xa,uvsa,XzvuyswY->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,xa,uvsa,XzvuywYs->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,xa,uvsa,XzvuywsY->XY', v_aaaa, t1_ae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,xa,uvza,XuvYwy->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,xa,uvza,XywYvu->XY', v_aaaa, t1_ae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,xuYa,va,Xzvywu->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('xyzw,xuYa,vsta,Xzsvtwuy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('xyzw,xuYa,vsta,Xzsvtwyu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('xyzw,xuYa,vsta,Xzsvtyuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('xyzw,xuYa,vsta,Xzsvtywu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,xuYa,vsta,Xzsvutwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,xuYa,vsta,Xzsvutyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('xyzw,xuYa,vsta,Xzsvuwty->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('xyzw,xuYa,vsta,Xzsvuwyt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('xyzw,xuYa,vsta,Xzsvuytw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('xyzw,xuYa,vsta,Xzsvuywt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 3/160 * einsum('xyzw,xuYa,vsta,Xzsvwtuy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 3/160 * einsum('xyzw,xuYa,vsta,Xzsvwtyu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('xyzw,xuYa,vsta,Xzsvwuty->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('xyzw,xuYa,vsta,Xzsvwuyt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/240 * einsum('xyzw,xuYa,vsta,Xzsvwytu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/240 * einsum('xyzw,xuYa,vsta,Xzsvwyut->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 3/160 * einsum('xyzw,xuYa,vsta,Xzsvytuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 3/160 * einsum('xyzw,xuYa,vsta,Xzsvytwu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('xyzw,xuYa,vsta,Xzsvyutw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/480 * einsum('xyzw,xuYa,vsta,Xzsvyuwt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/240 * einsum('xyzw,xuYa,vsta,Xzsvywtu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 61/240 * einsum('xyzw,xuYa,vsta,Xzsvywut->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuYa,vsza,Xvsuwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuYa,vsza,Xvsuyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuYa,vsza,Xvswuy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuYa,vsza,Xvswyu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuYa,vsza,Xvsyuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,xuYa,vsza,Xvsywu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,xuva,Ya,Xzvuwy->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,Ya,Xzvuyw->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,Ya,Xzvwuy->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,Ya,Xzvwyu->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,Ya,Xzvyuw->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,Ya,Xzvywu->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/8 * einsum('xyzw,xuva,Ysta,Xzvstwuy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('xyzw,xuva,Ysta,Xzvstyuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/8 * einsum('xyzw,xuva,Ysta,Xzvsuwty->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/8 * einsum('xyzw,xuva,Ysta,Xzvsuwyt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('xyzw,xuva,Ysta,Xzvsuytw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('xyzw,xuva,Ysta,Xzvsuywt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/8 * einsum('xyzw,xuva,Ysta,Xzvswtyu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('xyzw,xuva,Ysta,Xzvswyut->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/8 * einsum('xyzw,xuva,Ysta,Xzvsytwu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/4 * einsum('xyzw,xuva,Ysta,Xzvsywtu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/8 * einsum('xyzw,xuva,Ysta,Xzvsywut->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,xuva,Ysva,Xzsywu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('xyzw,xuva,sYta,Xzvsuwyt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/8 * einsum('xyzw,xuva,sYta,Xzvsuywt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,xuva,sYta,Xzvswtuy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,xuva,sYta,Xzvswtyu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,xuva,sYta,Xzvswuty->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,sYta,Xzvswuyt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,xuva,sYta,Xzvswytu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,sYta,Xzvswyut->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('xyzw,xuva,sYta,Xzvsytuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('xyzw,xuva,sYta,Xzvsytwu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('xyzw,xuva,sYta,Xzvsyutw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('xyzw,xuva,sYta,Xzvsywtu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,xuva,sYva,Xzsuwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,sYva,Xzsuyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,sYva,Xzswuy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,sYva,Xzswyu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,sYva,Xzsyuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,sYva,Xzsywu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,sa,XywuYsvz->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,sa,XywuYszv->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,sa,XywuYvsz->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('xyzw,xuva,sa,XywuYvzs->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,sa,XywuYzsv->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/8 * einsum('xyzw,xuva,sa,XywuYzvs->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,xuva,sa,XywuvYzs->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,xuva,sa,XywuvzYs->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,xuva,sa,XywuzYvs->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,xuva,sa,XywuzvYs->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,sa,XzvsYuwy->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,sa,XzvsYuyw->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,sa,XzvsYwuy->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('xyzw,xuva,sa,XzvsYwyu->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,sa,XzvsYyuw->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/8 * einsum('xyzw,xuva,sa,XzvsYywu->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,xuva,sa,XzvswYyu->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,xuva,sa,XzvswyYu->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,xuva,sa,XzvsyYwu->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,xuva,sa,XzvsywYu->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,stYa,Xywustzv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,xuva,stYa,Xywusvzt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xyzw,xuva,stYa,Xywusztv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,xuva,stYa,Xywuszvt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,stYa,Xywutszv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xuva,stYa,Xywutvzs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xyzw,xuva,stYa,Xywutzsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/12 * einsum('xyzw,xuva,stYa,Xywutzvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/48 * einsum('xyzw,xuva,stYa,Xywuvstz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/16 * einsum('xyzw,xuva,stYa,Xywuvszt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/48 * einsum('xyzw,xuva,stYa,Xywuvtsz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/16 * einsum('xyzw,xuva,stYa,Xywuvtzs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/48 * einsum('xyzw,xuva,stYa,Xywuvzst->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 5/48 * einsum('xyzw,xuva,stYa,Xywuvzts->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('xyzw,xuva,stYa,Xywuzstv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/16 * einsum('xyzw,xuva,stYa,Xywuzsvt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('xyzw,xuva,stYa,Xywuztsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('xyzw,xuva,stYa,Xywuztvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/16 * einsum('xyzw,xuva,stYa,Xywuzvst->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/16 * einsum('xyzw,xuva,stYa,Xywuzvts->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/80 * einsum('xyzw,xuva,stva,XywuYstz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/40 * einsum('xyzw,xuva,stva,XywuYszt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/80 * einsum('xyzw,xuva,stva,XywuYtsz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/30 * einsum('xyzw,xuva,stva,XywuYtzs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/40 * einsum('xyzw,xuva,stva,XywuYzst->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/30 * einsum('xyzw,xuva,stva,XywuYzts->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyzw,xuva,stva,XywusYtz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,xuva,stva,XywusYzt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyzw,xuva,stva,XywustYz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,xuva,stva,XywuszYt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyzw,xuva,stva,XywutYsz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,xuva,stva,XywutYzs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyzw,xuva,stva,XywutsYz->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,xuva,stva,XywutzYs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,xuva,stva,XywuzYst->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,xuva,stva,XywuzYts->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,xuva,stva,XywuzsYt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,xuva,stva,XywuzstY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,xuva,stva,XywuztYs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,xuva,stva,XywuztsY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/80 * einsum('xyzw,xuva,stva,XzstYuwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/80 * einsum('xyzw,xuva,stva,XzstYuyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/30 * einsum('xyzw,xuva,stva,XzstYwuy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/40 * einsum('xyzw,xuva,stva,XzstYwyu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/30 * einsum('xyzw,xuva,stva,XzstYyuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/40 * einsum('xyzw,xuva,stva,XzstYywu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,xuva,stva,XzstuYwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,xuva,stva,XzstuYyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,xuva,stva,XzstwYuy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,xuva,stva,XzstwYyu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyzw,xuva,stva,XzstwuYy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyzw,xuva,stva,XzstwuyY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,xuva,stva,XzstwyYu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,xuva,stva,XzstwyuY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,xuva,stva,XzstyYuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,xuva,stva,XzstyYwu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyzw,xuva,stva,XzstyuYw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyzw,xuva,stva,XzstyuwY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,xuva,stva,XzstywYu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,xuva,stva,XzstywuY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/80 * einsum('xyzw,xuva,stza,XvstYuwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/80 * einsum('xyzw,xuva,stza,XvstYuyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/30 * einsum('xyzw,xuva,stza,XvstYwuy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/40 * einsum('xyzw,xuva,stza,XvstYwyu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/30 * einsum('xyzw,xuva,stza,XvstYyuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/40 * einsum('xyzw,xuva,stza,XvstYywu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,xuva,stza,XvstuYwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,xuva,stza,XvstuYyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,xuva,stza,XvstwYuy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,xuva,stza,XvstwYyu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyzw,xuva,stza,XvstwuYy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyzw,xuva,stza,XvstwuyY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,xuva,stza,XvstwyYu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,xuva,stza,XvstwyuY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,xuva,stza,XvstyYuw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,xuva,stza,XvstyYwu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyzw,xuva,stza,XvstyuYw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyzw,xuva,stza,XvstyuwY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,xuva,stza,XvstywYu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,xuva,stza,XvstywuY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/80 * einsum('xyzw,xuva,stza,XywuYstv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/40 * einsum('xyzw,xuva,stza,XywuYsvt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 3/80 * einsum('xyzw,xuva,stza,XywuYtsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/30 * einsum('xyzw,xuva,stza,XywuYtvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/40 * einsum('xyzw,xuva,stza,XywuYvst->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/30 * einsum('xyzw,xuva,stza,XywuYvts->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyzw,xuva,stza,XywusYtv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,xuva,stza,XywusYvt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyzw,xuva,stza,XywustYv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,xuva,stza,XywusvYt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyzw,xuva,stza,XywutYsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,xuva,stza,XywutYvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/40 * einsum('xyzw,xuva,stza,XywutsYv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,xuva,stza,XywutvYs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,xuva,stza,XywuvYst->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,xuva,stza,XywuvYts->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,xuva,stza,XywuvsYt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,xuva,stza,XywuvstY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,xuva,stza,XywuvtYs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/60 * einsum('xyzw,xuva,stza,XywuvtsY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,xzYa,ua,Xuyw->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,xzYa,uvsa,Xvuyws->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,xzua,Yvua,Xvyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,xzua,vsua,XvsYwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,xzua,vsua,XvsYyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xzua,vsua,XvswyY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xzua,vsua,XvsywY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,xzua,vsua,XywYsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/24 * einsum('xyzw,xzua,vsua,XywYvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xzua,vsua,XywsvY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,xzua,vsua,XywvsY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,zxua,Ya,Xuyw->XY', v_aaaa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,zxua,Yvsa,Xuvswy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,zxua,vYsa,Xuvswy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,zxua,vYsa,Xuvsyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,zxua,vYsa,Xuvwsy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,zxua,vYsa,Xuvwys->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,zxua,vYsa,Xuvysw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/6 * einsum('xyzw,zxua,vYsa,Xuvyws->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,zxua,vYua,Xvyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,zxua,va,XuvYwy->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,zxua,va,XywYvu->XY', v_aaaa, t1_aaae, t1_ae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/4 * einsum('xyzw,zxua,vsYa,Xywvsu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 11/240 * einsum('xyzw,zxua,vsta,XusvYtwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 11/240 * einsum('xyzw,zxua,vsta,XusvYtyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/20 * einsum('xyzw,zxua,vsta,XusvYwty->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 19/120 * einsum('xyzw,zxua,vsta,XusvYwyt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/20 * einsum('xyzw,zxua,vsta,XusvYytw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 11/120 * einsum('xyzw,zxua,vsta,XusvYywt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,zxua,vsta,XusvtYwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,zxua,vsta,XusvtYyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,zxua,vsta,XusvwYty->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,zxua,vsta,XusvwYyt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,zxua,vsta,XusvwtYy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,zxua,vsta,XusvwtyY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,zxua,vsta,XusvwyYt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,zxua,vsta,XusvwytY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,zxua,vsta,XusvyYtw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,zxua,vsta,XusvyYwt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,zxua,vsta,XusvytYw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,zxua,vsta,XusvytwY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,zxua,vsta,XusvywYt->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,zxua,vsta,XusvywtY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 19/120 * einsum('xyzw,zxua,vsta,XywtYsuv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 11/240 * einsum('xyzw,zxua,vsta,XywtYsvu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 11/120 * einsum('xyzw,zxua,vsta,XywtYusv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/20 * einsum('xyzw,zxua,vsta,XywtYuvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 11/240 * einsum('xyzw,zxua,vsta,XywtYvsu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/20 * einsum('xyzw,zxua,vsta,XywtYvus->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,zxua,vsta,XywtsYuv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,zxua,vsta,XywtsYvu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 7/240 * einsum('xyzw,zxua,vsta,XywtsuYv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,zxua,vsta,XywtsvYu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,zxua,vsta,XywtuYsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,zxua,vsta,XywtuYvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/80 * einsum('xyzw,zxua,vsta,XywtusYv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,zxua,vsta,XywtusvY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 7/240 * einsum('xyzw,zxua,vsta,XywtuvYs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,zxua,vsta,XywtuvsY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,zxua,vsta,XywtvYsu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,zxua,vsta,XywtvYus->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/60 * einsum('xyzw,zxua,vsta,XywtvsYu->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p += 1/80 * einsum('xyzw,zxua,vsta,XywtvuYs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_ccccaaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,zxua,vsua,XsvYwy->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('xyzw,zxua,vsua,XsvYyw->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,zxua,vsua,XsvwyY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,zxua,vsua,XsvywY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p += 1/8 * einsum('xyzw,zxua,vsua,XywYsv->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/24 * einsum('xyzw,zxua,vsua,XywYvs->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,zxua,vsua,XywsvY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1_m1p -= 1/12 * einsum('xyzw,zxua,vsua,XywvsY->XY', v_aaaa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
        V1 += V1_m1p
        #print (">> Norm of t1_m1p contribution:                    %20.12f\n" % (np.linalg.norm(V1_m1p)))

    ## t1_ca, t1_caaa 
    def compute_V1__t1_p1p(mr_adc, V1):
        # Einsum definition from kernel
        einsum = mr_adc.interface.einsum
        einsum_type = mr_adc.interface.einsum_type

        ## Molecular Orbitals Energies
        e_core = mr_adc.mo_energy.c

        ## One-electron integrals
        h_ca = mr_adc.h1eff.ca
        h_aa = mr_adc.h1eff.aa

        ## Two-electron integrals
        v_aaaa = mr_adc.v2e.aaaa
        v_caaa = mr_adc.v2e.caaa

        ## Amplitudes
        t1_ca = mr_adc.t1.ca
        t1_caaa = mr_adc.t1.caaa

        ## Reduced density matrices
        rdm_ca = mr_adc.rdm.ca 
        rdm_ccaa = mr_adc.rdm.ccaa
        rdm_cccaaa = mr_adc.rdm.cccaaa
        rdm_ccccaaaa = mr_adc.rdm.ccccaaaa
        #rdm_ccccaaaa = np.zeros((ncas, ncas, ncas, ncas, ncas, ncas, ncas, ncas))

        V1_p1p  = 1/2 * einsum('iY,ix,Xx->XY', h_ca, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('iY,ixyz,Xxyz->XY', h_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iY,Xx->XY', h_ca, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p -= einsum('ix,iYxy,Xy->XY', h_ca, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iYyx,Xy->XY', h_ca, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iYyz,Xxzy->XY', h_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 2 * einsum('ix,ix,XY->XY', h_ca, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iy,XxYy->XY', h_ca, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iy,XyYx->XY', h_ca, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iyYx,Xy->XY', h_ca, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iyYz,Xzxy->XY', h_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('ix,iyxY,Xy->XY', h_ca, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p -= einsum('ix,iyxz,XyYz->XY', h_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('ix,iyxz,XzYy->XY', h_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iyzY,Xzyx->XY', h_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iyzw,XxyYzw->XY', h_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iyzw,XzwYxy->XY', h_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iyzx,XyYz->XY', h_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iyzx,XzYy->XY', h_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('iY,ixyz,Xyxz->XY', t1_ca, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('iYxy,ixzw,Xwyz->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('iYxy,ixzy,Xz->XY', t1_caaa, v_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('iYxy,iyzw,Xwxz->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('iYxy,iyzx,Xz->XY', t1_caaa, v_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('iYxy,izwu,Xzuwxy->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('iYxy,izwu,Xzuwyx->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('iYxy,izwu,Xzuxwy->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('iYxy,izwu,Xzuxyw->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('iYxy,izwu,Xzuywx->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('iYxy,izwu,Xzuyxw->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('iYxy,izwx,Xzyw->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('iYxy,izwy,Xzwx->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iYyx,Xy->XY', t1_ca, v_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iYyz,Xzxy->XY', t1_ca, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('ix,ixYy,Xy->XY', t1_ca, v_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p -= einsum('ix,ixyY,Xy->XY', t1_ca, v_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p -= einsum('ix,ixyz,XyYz->XY', t1_ca, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('ix,ixyz,XzYy->XY', t1_ca, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iyYx,Xy->XY', t1_ca, v_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iyYz,Xxzy->XY', t1_ca, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iyzY,Xyzx->XY', t1_ca, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iyzw,XxzYyw->XY', t1_ca, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iyzw,XywYxz->XY', t1_ca, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iyzx,XyYz->XY', t1_ca, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ix,iyzx,XzYy->XY', t1_ca, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ixYy,iyzw,Xzxw->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixYy,izwu,Xywuxz->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixYy,izwu,Xywuzx->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixYy,izwu,Xywxuz->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixYy,izwu,Xywxzu->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixYy,izwu,Xywzux->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('ixYy,izwu,Xywzxu->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ixYy,izwy,Xwzx->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('ixyY,iyzw,Xzxw->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ixyY,izwu,Xywxzu->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ixyY,izwy,Xwxz->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ixyz,iYwu,Xxuyzw->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ixyz,iYwy,Xxwz->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ixyz,iYwz,Xxyw->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('ixyz,iwYu,Xyzuwx->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwYu,Xyzuxw->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwYu,Xyzwux->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwYu,Xyzwxu->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwYu,Xyzxuw->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwYu,Xyzxwu->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ixyz,iwYy,Xzwx->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ixyz,iwYz,Xyxw->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwuY,Xxwuyz->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('ixyz,iwuY,Xxwuzy->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwuY,Xxwyuz->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwuY,Xxwyzu->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwuY,Xxwzuy->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwuY,Xxwzyu->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 29/120 * einsum('ixyz,iwuv,XxwvYuyz->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 29/120 * einsum('ixyz,iwuv,XxwvYuzy->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 23/120 * einsum('ixyz,iwuv,XxwvYyuz->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 23/120 * einsum('ixyz,iwuv,XxwvYyzu->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 23/120 * einsum('ixyz,iwuv,XxwvYzuy->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 37/120 * einsum('ixyz,iwuv,XxwvYzyu->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/30 * einsum('ixyz,iwuv,XxwvuYyz->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/30 * einsum('ixyz,iwuv,XxwvuYzy->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/40 * einsum('ixyz,iwuv,XxwvyYuz->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/40 * einsum('ixyz,iwuv,XxwvyYzu->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/120 * einsum('ixyz,iwuv,XxwvyuYz->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/120 * einsum('ixyz,iwuv,XxwvyuzY->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 7/120 * einsum('ixyz,iwuv,XxwvyzYu->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 7/120 * einsum('ixyz,iwuv,XxwvyzuY->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/120 * einsum('ixyz,iwuv,XxwvzYuy->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/120 * einsum('ixyz,iwuv,XxwvzYyu->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 3/40 * einsum('ixyz,iwuv,XxwvzuYy->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 3/40 * einsum('ixyz,iwuv,XxwvzuyY->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/40 * einsum('ixyz,iwuv,XxwvzyYu->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/40 * einsum('ixyz,iwuv,XxwvzyuY->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 29/120 * einsum('ixyz,iwuv,XyzuYvwx->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 23/120 * einsum('ixyz,iwuv,XyzuYvxw->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 29/120 * einsum('ixyz,iwuv,XyzuYwvx->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 37/120 * einsum('ixyz,iwuv,XyzuYwxv->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 23/120 * einsum('ixyz,iwuv,XyzuYxvw->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 23/120 * einsum('ixyz,iwuv,XyzuYxwv->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/120 * einsum('ixyz,iwuv,XyzuvYwx->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 7/120 * einsum('ixyz,iwuv,XyzuvYxw->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 3/40 * einsum('ixyz,iwuv,XyzuvwYx->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/40 * einsum('ixyz,iwuv,XyzuvxYw->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/120 * einsum('ixyz,iwuv,XyzuwYvx->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 7/120 * einsum('ixyz,iwuv,XyzuwYxv->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 3/40 * einsum('ixyz,iwuv,XyzuwvYx->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/40 * einsum('ixyz,iwuv,XyzuwxYv->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/40 * einsum('ixyz,iwuv,XyzuxYvw->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/40 * einsum('ixyz,iwuv,XyzuxYwv->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/120 * einsum('ixyz,iwuv,XyzuxvYw->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/30 * einsum('ixyz,iwuv,XyzuxvwY->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/120 * einsum('ixyz,iwuv,XyzuxwYv->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/30 * einsum('ixyz,iwuv,XyzuxwvY->XY', t1_caaa, v_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ixyz,iwuy,XxwYzu->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ixyz,iwuy,XzuYxw->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('ixyz,iwuz,XxwYuy->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwuz,XxwYyu->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwuz,XxwuYy->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwuz,XxwuyY->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwuz,XxwyYu->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwuz,XxwyuY->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('ixyz,iwuz,XyuYwx->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwuz,XyuYxw->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwuz,XyuwYx->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwuz,XyuwxY->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwuz,XyuxYw->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('ixyz,iwuz,XyuxwY->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= einsum('ixyz,iyYw,Xzwx->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('ixyz,iyYz,Xx->XY', t1_caaa, v_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p -= einsum('ixyz,iywY,Xxwz->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('ixyz,iywu,XxuYzw->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= einsum('ixyz,iywu,XzwYxu->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= einsum('ixyz,iywz,XwYx->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('ixyz,iywz,XxYw->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ixyz,izYw,Xywx->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ixyz,izYy,Xx->XY', t1_caaa, v_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ixyz,izwY,Xxwy->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ixyz,izwu,XxuYyw->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ixyz,izwu,XywYxu->XY', t1_caaa, v_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ixyz,izwy,XwYx->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('ixyz,izwy,XxYw->XY', t1_caaa, v_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('i,iY,ix,Xx->XY', e_core, t1_ca, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('i,iY,ixyz,Xxyz->XY', e_core, t1_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('i,iYxy,ix,Xy->XY', e_core, t1_caaa, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,iYxy,iy,Xx->XY', e_core, t1_caaa, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,iYxy,izwx,Xwyz->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,iYxy,izwy,Xwzx->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('i,iYxy,izxw,Xwyz->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('i,iYxy,izxy,Xz->XY', e_core, t1_caaa, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,iYxy,izyw,Xwxz->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,iYxy,izyx,Xz->XY', e_core, t1_caaa, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('i,ix,iYxy,Xy->XY', e_core, t1_ca, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ix,iYyx,Xy->XY', e_core, t1_ca, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('i,ix,iYyz,Xxzy->XY', e_core, t1_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += einsum('i,ix,ix,XY->XY', e_core, t1_ca, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('i,ix,iy,XxYy->XY', e_core, t1_ca, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ix,iyYx,Xy->XY', e_core, t1_ca, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('i,ix,iyxY,Xy->XY', e_core, t1_ca, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('i,ix,iyxz,XyYz->XY', e_core, t1_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('i,ix,iyxz,XzYy->XY', e_core, t1_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('i,ix,iyzw,XxyYzw->XY', e_core, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ix,iyzx,XyYz->XY', e_core, t1_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ix,iyzx,XzYy->XY', e_core, t1_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixYy,ixzw,Xyzw->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixYy,iy,Xx->XY', e_core, t1_caaa, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('i,ixYy,iz,Xyzx->XY', e_core, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('i,ixYy,izwu,Xyzuwx->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('i,ixYy,izwu,Xyzuxw->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('i,ixYy,izwu,Xyzwux->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/3 * einsum('i,ixYy,izwu,Xyzwxu->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('i,ixYy,izwu,Xyzxuw->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('i,ixYy,izwu,Xyzxwu->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixYy,izwy,Xzwx->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixYy,izyw,Xzxw->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixyY,ixzw,Xywz->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('i,ixyY,iy,Xx->XY', e_core, t1_caaa, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('i,ixyY,iz,Xyxz->XY', e_core, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('i,ixyY,izwu,Xyzxwu->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixyY,izwy,Xzxw->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('i,ixyY,izyw,Xzxw->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/3 * einsum('i,ixyz,iYwu,Xyzuwx->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('i,ixyz,iYwu,Xyzuxw->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('i,ixyz,iYwu,Xyzwux->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('i,ixyz,iYwu,Xyzwxu->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('i,ixyz,iYwu,Xyzxuw->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('i,ixyz,iYwu,Xyzxwu->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixyz,iYwy,Xzwx->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixyz,iYwz,Xyxw->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('i,ixyz,iYyw,Xzwx->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('i,ixyz,iYyz,Xx->XY', e_core, t1_caaa, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixyz,iYzw,Xywx->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixyz,iYzy,Xx->XY', e_core, t1_caaa, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/3 * einsum('i,ixyz,iw,XyzYwx->XY', e_core, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('i,ixyz,iw,XyzYxw->XY', e_core, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('i,ixyz,iw,XyzwYx->XY', e_core, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('i,ixyz,iw,XyzwxY->XY', e_core, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('i,ixyz,iw,XyzxYw->XY', e_core, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('i,ixyz,iw,XyzxwY->XY', e_core, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixyz,iwYy,Xxwz->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixyz,iwYz,Xxyw->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('i,ixyz,iwuv,XyzwYuvx->XY', e_core, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 3/8 * einsum('i,ixyz,iwuv,XyzwYuxv->XY', e_core, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('i,ixyz,iwuv,XyzwYvux->XY', e_core, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('i,ixyz,iwuv,XyzwYvxu->XY', e_core, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('i,ixyz,iwuv,XyzwYxuv->XY', e_core, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('i,ixyz,iwuv,XyzwYxvu->XY', e_core, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixyz,iwuy,XxuYzw->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixyz,iwuy,XzwYxu->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('i,ixyz,iwuz,XxuYwy->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('i,ixyz,iwuz,XxuYyw->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('i,ixyz,iwuz,XxuwYy->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('i,ixyz,iwuz,XxuwyY->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('i,ixyz,iwuz,XxuyYw->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('i,ixyz,iwuz,XxuywY->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('i,ixyz,iwuz,XywYux->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('i,ixyz,iwuz,XywYxu->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('i,ixyz,iwuz,XywuYx->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('i,ixyz,iwuz,XywuxY->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('i,ixyz,iwuz,XywxYu->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('i,ixyz,iwuz,XywxuY->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('i,ixyz,iwyY,Xxwz->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('i,ixyz,iwyu,XxuYzw->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('i,ixyz,iwyu,XzwYxu->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('i,ixyz,iwyz,XwYx->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('i,ixyz,iwyz,XxYw->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixyz,iwzY,Xxwy->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixyz,iwzu,XxuYyw->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixyz,iwzu,XywYxu->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixyz,iwzy,XwYx->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixyz,iwzy,XxYw->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('i,ixyz,ixYw,Xwyz->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('i,ixyz,ixwY,Xwzy->XY', e_core, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('i,ixyz,ixwu,XwuYyz->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixyz,ixwu,XyzYwu->XY', e_core, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('i,ixyz,iy,XxYz->XY', e_core, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('i,ixyz,iy,XzYx->XY', e_core, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixyz,iz,XxYy->XY', e_core, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('i,ixyz,iz,XyYx->XY', e_core, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yx,ix,iy,Xy->XY', h_aa, t1_ca, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yx,ix,iyzw,Xyzw->XY', h_aa, t1_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yx,ixyz,iw,Xwzy->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yx,ixyz,iwuv,Xuvwyz->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yx,ixyz,iwuv,Xuvwzy->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yx,ixyz,iwuv,Xuvywz->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yx,ixyz,iwuv,Xuvyzw->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yx,ixyz,iwuv,Xuvzwy->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yx,ixyz,iwuv,Xuvzyw->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yx,ixyz,iwuy,Xuzw->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yx,ixyz,iwuz,Xuwy->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yx,ixyz,iwyu,Xuzw->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yx,ixyz,iwyz,Xw->XY', h_aa, t1_caaa, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yx,ixyz,iwzu,Xuyw->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yx,ixyz,iwzy,Xw->XY', h_aa, t1_caaa, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yx,ixyz,iy,Xz->XY', h_aa, t1_caaa, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yx,ixyz,iz,Xy->XY', h_aa, t1_caaa, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yx,iyxz,iw,Xzwy->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yx,iyxz,iwuv,Xzwuvy->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('Yx,iyxz,iwuv,Xzwuyv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yx,iyxz,iwuv,Xzwvuy->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yx,iyxz,iwuv,Xzwvyu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yx,iyxz,iwuv,Xzwyuv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yx,iyxz,iwuv,Xzwyvu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yx,iyxz,iwuz,Xwuy->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yx,iyxz,iwzu,Xwyu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yx,iyxz,iz,Xy->XY', h_aa, t1_caaa, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yx,iyzx,iw,Xzyw->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yx,iyzx,iwuv,Xzwyuv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yx,iyzx,iwuz,Xwyu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('Yx,iyzx,iwzu,Xwyu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('Yx,iyzx,iz,Xy->XY', h_aa, t1_caaa, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,iYxz,iw,Xwzy->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,iYxz,iwuv,Xuvwyz->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,iYxz,iwuv,Xuvwzy->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,iYxz,iwuv,Xuvywz->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,iYxz,iwuv,Xuvyzw->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,iYxz,iwuv,Xuvzwy->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xy,iYxz,iwuv,Xuvzyw->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,iYxz,iwuy,Xuzw->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,iYxz,iwuz,Xuwy->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('xy,iYxz,iwyu,Xuzw->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('xy,iYxz,iwyz,Xw->XY', h_aa, t1_caaa, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,iYxz,iwzu,Xuyw->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,iYxz,iwzy,Xw->XY', h_aa, t1_caaa, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p -= einsum('xy,iYxz,iy,Xz->XY', h_aa, t1_caaa, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,iYxz,iz,Xy->XY', h_aa, t1_caaa, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,iYzx,iw,Xwyz->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,iYzx,iwuv,Xuvyzw->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,iYzx,iwuy,Xuwz->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,iYzx,iwuz,Xuyw->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,iYzx,iwyu,Xuzw->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,iYzx,iwyz,Xw->XY', h_aa, t1_caaa, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('xy,iYzx,iwzu,Xuyw->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('xy,iYzx,iwzy,Xw->XY', h_aa, t1_caaa, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,iYzx,iy,Xz->XY', h_aa, t1_caaa, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('xy,iYzx,iz,Xy->XY', h_aa, t1_caaa, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,ix,iY,Xy->XY', h_aa, t1_ca, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,ix,iYzw,Xywz->XY', h_aa, t1_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('xy,ix,iy,XY->XY', h_aa, t1_ca, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,ix,iz,XyYz->XY', h_aa, t1_ca, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,ix,iz,XzYy->XY', h_aa, t1_ca, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,ix,izYw,Xwyz->XY', h_aa, t1_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,ix,izwY,Xwzy->XY', h_aa, t1_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,ix,izwu,XwuYyz->XY', h_aa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,ix,izwu,XyzYwu->XY', h_aa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,ix,izwy,XwYz->XY', h_aa, t1_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,ix,izwy,XzYw->XY', h_aa, t1_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('xy,ix,izyw,XwYz->XY', h_aa, t1_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('xy,ix,izyw,XzYw->XY', h_aa, t1_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixYz,iw,Xzwy->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixYz,iwuv,Xzwuvy->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,ixYz,iwuv,Xzwuyv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixYz,iwuv,Xzwvuy->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixYz,iwuv,Xzwvyu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixYz,iwuv,Xzwyuv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixYz,iwuv,Xzwyvu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixYz,iwuz,Xwuy->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixYz,iwzu,Xwyu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixYz,iz,Xy->XY', h_aa, t1_caaa, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzY,iw,Xzyw->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzY,iwuv,Xzwyuv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzY,iwuz,Xwyu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,ixzY,iwzu,Xwyu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,ixzY,iz,Xy->XY', h_aa, t1_caaa, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzw,iY,Xyzw->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iYuv,Xwzuvy->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iYuv,Xwzuyv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iYuv,Xwzvuy->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,ixzw,iYuv,Xwzvyu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iYuv,Xwzyuv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iYuv,Xwzyvu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzw,iYuw,Xzyu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzw,iYuz,Xwuy->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzw,iYwu,Xzuy->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzw,iYwz,Xy->XY', h_aa, t1_caaa, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,ixzw,iYzu,Xwuy->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,ixzw,iYzw,Xy->XY', h_aa, t1_caaa, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iu,XwzYuy->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,ixzw,iu,XwzYyu->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iu,XwzuYy->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iu,XwzuyY->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iu,XwzyYu->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iu,XwzyuY->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,ixzw,iu,XyuYwz->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iu,XyuYzw->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iu,XyuwYz->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iu,XyuwzY->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iu,XyuzYw->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iu,XyuzwY->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzw,iuYv,Xyvzwu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzw,iuYw,Xyzu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzw,iuYz,Xyuw->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,ixzw,iuvY,Xyvuwz->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iuvY,Xyvuzw->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iuvY,Xyvwuz->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iuvY,Xyvwzu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iuvY,Xyvzuw->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iuvY,Xyvzwu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('xy,ixzw,iuvs,XwzuYsvy->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('xy,ixzw,iuvs,XwzuYsyv->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('xy,ixzw,iuvs,XwzuYvsy->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('xy,ixzw,iuvs,XwzuYvys->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('xy,ixzw,iuvs,XwzuYysv->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 3/16 * einsum('xy,ixzw,iuvs,XwzuYyvs->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('xy,ixzw,iuvs,XyvsYuwz->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('xy,ixzw,iuvs,XyvsYuzw->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('xy,ixzw,iuvs,XyvsYwuz->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 3/16 * einsum('xy,ixzw,iuvs,XyvsYwzu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('xy,ixzw,iuvs,XyvsYzuw->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('xy,ixzw,iuvs,XyvsYzwu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,ixzw,iuvw,XyvYuz->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iuvw,XyvYzu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iuvw,XyvuYz->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iuvw,XyvuzY->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iuvw,XyvzYu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iuvw,XyvzuY->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,ixzw,iuvw,XzuYvy->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iuvw,XzuYyv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iuvw,XzuvYy->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iuvw,XzuvyY->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iuvw,XzuyYv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,ixzw,iuvw,XzuyvY->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzw,iuvz,XwuYyv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzw,iuvz,XyvYwu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzw,iuwY,Xyuz->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzw,iuwv,XyvYzu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzw,iuwv,XzuYyv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzw,iuwz,XuYy->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzw,iuwz,XyYu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,ixzw,iuzY,Xyuw->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,ixzw,iuzv,XwuYyv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,ixzw,iuzv,XyvYwu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,ixzw,iuzw,XuYy->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,ixzw,iuzw,XyYu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzw,iw,XyYz->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xy,ixzw,iw,XzYy->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,ixzw,iz,XwYy->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,ixzw,iz,XyYw->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izYx,iw,Xywz->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izYx,iwuv,Xywuvz->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xy,izYx,iwuv,Xywuzv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izYx,iwuv,Xywvuz->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izYx,iwuv,Xywvzu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izYx,iwuv,Xywzuv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izYx,iwuv,Xywzvu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,izYx,iwuy,Xwuz->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,izYx,iwyu,Xwzu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,izYx,iy,Xz->XY', h_aa, t1_caaa, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izwx,iY,Xzwy->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izwx,iYuv,Xywvzu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izwx,iYuw,Xyuz->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('xy,izwx,iYwu,Xyuz->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izwx,iu,XywYzu->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izwx,iu,XzuYyw->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izwx,iuYv,Xzvuwy->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izwx,iuYv,Xzvuyw->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izwx,iuYv,Xzvwuy->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xy,izwx,iuYv,Xzvwyu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izwx,iuYv,Xzvyuw->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izwx,iuYv,Xzvywu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izwx,iuYw,Xzuy->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izwx,iuvY,Xzvuyw->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izwx,iuvs,XywuYzvs->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izwx,iuvs,XzvsYywu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izwx,iuvw,XyuYzv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izwx,iuvw,XzvYyu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xy,izwx,iuvy,XwuYvz->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,izwx,iuvy,XwuYzv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,izwx,iuvy,XwuvYz->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,izwx,iuvy,XwuvzY->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,izwx,iuvy,XwuzYv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,izwx,iuvy,XwuzvY->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('xy,izwx,iuwY,Xzuy->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('xy,izwx,iuwv,XyuYzv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('xy,izwx,iuwv,XzvYyu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= einsum('xy,izwx,iuwy,XzYu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,izwx,iuyv,XwuYzv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,izwx,iuyv,XzvYwu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,izwx,iuyw,XuYz->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,izwx,iuyw,XzYu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('xy,izwx,iw,XyYz->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('xy,izwx,iw,XzYy->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izxY,iw,Xyzw->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izxY,iwuv,Xywzuv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xy,izxY,iwuy,Xwzu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('xy,izxY,iwyu,Xwzu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('xy,izxY,iy,Xz->XY', h_aa, t1_caaa, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izxw,iY,Xzyw->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iYuv,Xywuvz->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iYuv,Xywuzv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xy,izxw,iYuv,Xywvuz->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iYuv,Xywvzu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iYuv,Xywzuv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iYuv,Xywzvu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izxw,iYuw,Xyzu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izxw,iYwu,Xyuz->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xy,izxw,iu,XywYuz->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iu,XywYzu->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iu,XywuYz->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iu,XywuzY->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iu,XywzYu->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iu,XywzuY->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xy,izxw,iu,XzuYwy->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iu,XzuYyw->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iu,XzuwYy->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iu,XzuwyY->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iu,XzuyYw->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iu,XzuywY->XY', h_aa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izxw,iuYv,Xzvywu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izxw,iuYw,Xzyu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xy,izxw,iuvY,Xzvuwy->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iuvY,Xzvuyw->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iuvY,Xzvwuy->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iuvY,Xzvwyu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iuvY,Xzvyuw->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iuvY,Xzvywu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,izxw,iuvs,XywuYsvz->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,izxw,iuvs,XywuYszv->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,izxw,iuvs,XywuYvsz->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,izxw,iuvs,XywuYvzs->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,izxw,iuvs,XywuYzsv->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,izxw,iuvs,XywuYzvs->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,izxw,iuvs,XzvsYuwy->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,izxw,iuvs,XzvsYuyw->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,izxw,iuvs,XzvsYwuy->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xy,izxw,iuvs,XzvsYwyu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,izxw,iuvs,XzvsYyuw->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xy,izxw,iuvs,XzvsYywu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xy,izxw,iuvw,XyuYvz->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iuvw,XyuYzv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iuvw,XyuvYz->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iuvw,XyuvzY->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iuvw,XyuzYv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iuvw,XyuzvY->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xy,izxw,iuvw,XzvYuy->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iuvw,XzvYyu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iuvw,XzvuYy->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iuvw,XzvuyY->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iuvw,XzvyYu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xy,izxw,iuvw,XzvyuY->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izxw,iuwY,Xzuy->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izxw,iuwv,XyuYzv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izxw,iuwv,XzvYyu->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= einsum('xy,izxw,iuyv,XwuYzv->XY', h_aa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= einsum('xy,izxw,iuyw,XzYu->XY', h_aa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izxw,iw,XyYz->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xy,izxw,iw,XzYy->XY', h_aa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('Yxyz,iwux,iu,Xywz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwux,iv,Xyuvwz->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwux,iv,Xyuvzw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwux,iv,Xyuwvz->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('Yxyz,iwux,iv,Xyuwzv->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwux,iv,Xyuzvw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwux,iv,Xyuzwv->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iwux,ivst,Xyuvwzst->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwux,ivsu,Xyvswz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwux,ivsu,Xyvszw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwux,ivsu,Xyvwsz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('Yxyz,iwux,ivsu,Xyvwzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwux,ivsu,Xyvzsw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwux,ivsu,Xyvzws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('Yxyz,iwux,ivus,Xyvswz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('Yxyz,iwux,ivus,Xyvszw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('Yxyz,iwux,ivus,Xyvwsz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/3 * einsum('Yxyz,iwux,ivus,Xyvwzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('Yxyz,iwux,ivus,Xyvzsw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('Yxyz,iwux,ivus,Xyvzws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iwux,izuv,Xywv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,iwux,izvs,Xyusvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,iwux,izvs,Xyuswv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,iwux,izvs,Xyuvsw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,iwux,izvs,Xyuvws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwux,izvs,Xyuwsv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,iwux,izvs,Xyuwvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,iwux,izvu,Xywv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('Yxyz,iwuy,iu,Xwxz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iwuy,iv,Xwvxzu->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('Yxyz,iwuy,ivst,Xwstuvxz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('Yxyz,iwuy,ivst,Xwstuvzx->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('Yxyz,iwuy,ivst,Xwstuxvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('Yxyz,iwuy,ivst,Xwstuxzv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('Yxyz,iwuy,ivst,Xwstuzvx->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('Yxyz,iwuy,ivst,Xwstuzxv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('Yxyz,iwuy,ivst,Xwstvxuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('Yxyz,iwuy,ivst,Xwstvxzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('Yxyz,iwuy,ivst,Xwstvzux->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('Yxyz,iwuy,ivst,Xwstvzxu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('Yxyz,iwuy,ivst,Xwstxuvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('Yxyz,iwuy,ivst,Xwstxuzv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 3/160 * einsum('Yxyz,iwuy,ivst,Xwstxvuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 3/160 * einsum('Yxyz,iwuy,ivst,Xwstxvzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 61/240 * einsum('Yxyz,iwuy,ivst,Xwstxzuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/240 * einsum('Yxyz,iwuy,ivst,Xwstxzvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('Yxyz,iwuy,ivst,Xwstzuvx->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('Yxyz,iwuy,ivst,Xwstzuxv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 3/160 * einsum('Yxyz,iwuy,ivst,Xwstzvux->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 3/160 * einsum('Yxyz,iwuy,ivst,Xwstzvxu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/240 * einsum('Yxyz,iwuy,ivst,Xwstzxuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/240 * einsum('Yxyz,iwuy,ivst,Xwstzxvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iwuy,ivsu,Xwsxzv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iwuy,ivsx,Xwsvzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwuy,ivsz,Xwsuvx->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwuy,ivsz,Xwsuxv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwuy,ivsz,Xwsvux->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwuy,ivsz,Xwsvxu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwuy,ivsz,Xwsxuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('Yxyz,iwuy,ivsz,Xwsxvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('Yxyz,iwuy,ivus,Xwsxzv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= einsum('Yxyz,iwuy,ivux,Xwvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('Yxyz,iwuy,ivuz,Xwxv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwuy,ivxs,Xwsuvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('Yxyz,iwuy,ivxs,Xwsuzv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwuy,ivxs,Xwsvuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwuy,ivxs,Xwsvzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwuy,ivxs,Xwszuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwuy,ivxs,Xwszvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iwuy,ivxu,Xwvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iwuy,ivxz,Xwuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iwuy,ivzs,Xwsxuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iwuy,ivzu,Xwxv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iwuy,ivzx,Xwvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iwuy,ix,Xwuz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iwuy,iz,Xwxu->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('Yxyz,iwuz,iu,Xyxw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iwuz,iv,Xyuxwv->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iwuz,ivst,Xyuvxwst->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iwuz,ivsu,Xyvxws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('Yxyz,iwuz,ivus,Xyvxws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iwxu,iu,Xywz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iwxu,iv,Xyuvzw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwxu,ivst,Xyuvsztw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('Yxyz,iwxu,ivst,Xyuvszwt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwxu,ivst,Xyuvtzsw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwxu,ivst,Xyuvtzws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwxu,ivst,Xyuvwzst->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwxu,ivst,Xyuvwzts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iwxu,ivsu,Xyvszw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwxu,ivus,Xyvswz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwxu,ivus,Xyvszw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwxu,ivus,Xyvwsz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('Yxyz,iwxu,ivus,Xyvwzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwxu,ivus,Xyvzsw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwxu,ivus,Xyvzws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,iwxu,izuv,Xywv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,iwxu,izvs,Xyuvsw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,iwxu,izvu,Xyvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iwxz,iu,Xyuw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwxz,iuvs,Xyusvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwxz,iuvs,Xyuswv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwxz,iuvs,Xyuvsw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('Yxyz,iwxz,iuvs,Xyuvws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwxz,iuvs,Xyuwsv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwxz,iuvs,Xyuwvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iwyu,iu,Xwxz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwyu,iv,Xwvuxz->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwyu,iv,Xwvuzx->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('Yxyz,iwyu,iv,Xwvxuz->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwyu,iv,Xwvxzu->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwyu,iv,Xwvzux->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwyu,iv,Xwvzxu->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/48 * einsum('Yxyz,iwyu,ivst,Xwstuvxz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/48 * einsum('Yxyz,iwyu,ivst,Xwstuvzx->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/96 * einsum('Yxyz,iwyu,ivst,Xwstuxvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/96 * einsum('Yxyz,iwyu,ivst,Xwstuxzv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/96 * einsum('Yxyz,iwyu,ivst,Xwstuzvx->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/96 * einsum('Yxyz,iwyu,ivst,Xwstuzxv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/96 * einsum('Yxyz,iwyu,ivst,Xwstvxuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/96 * einsum('Yxyz,iwyu,ivst,Xwstvxzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/96 * einsum('Yxyz,iwyu,ivst,Xwstvzux->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/96 * einsum('Yxyz,iwyu,ivst,Xwstvzxu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 5/32 * einsum('Yxyz,iwyu,ivst,Xwstxuvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 3/32 * einsum('Yxyz,iwyu,ivst,Xwstxuzv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 17/96 * einsum('Yxyz,iwyu,ivst,Xwstxvuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 17/96 * einsum('Yxyz,iwyu,ivst,Xwstxvzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwyu,ivst,Xwstxzuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwyu,ivst,Xwstxzvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/96 * einsum('Yxyz,iwyu,ivst,Xwstzuvx->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/96 * einsum('Yxyz,iwyu,ivst,Xwstzuxv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/96 * einsum('Yxyz,iwyu,ivst,Xwstzvux->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/96 * einsum('Yxyz,iwyu,ivst,Xwstzvxu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwyu,ivsu,Xwsvxz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwyu,ivsu,Xwsvzx->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('Yxyz,iwyu,ivsu,Xwsxvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwyu,ivsu,Xwsxzv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwyu,ivsu,Xwszvx->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwyu,ivsu,Xwszxv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwyu,ivsx,Xwsuvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwyu,ivsx,Xwsuzv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('Yxyz,iwyu,ivsx,Xwsvuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwyu,ivsx,Xwsvzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwyu,ivsx,Xwszuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwyu,ivsx,Xwszvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iwyu,ivsz,Xwsxuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iwyu,ivus,Xwsxzv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iwyu,ivux,Xwvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iwyu,ivuz,Xwxv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iwyu,ivxs,Xwszuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iwyu,ivxu,Xwzv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iwyu,ivxz,Xwvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('Yxyz,iwyu,ivzs,Xwsxuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= einsum('Yxyz,iwyu,ivzu,Xwxv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('Yxyz,iwyu,ivzx,Xwvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iwyu,ix,Xwzu->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('Yxyz,iwyu,iz,Xwxu->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iwzu,iu,Xyxw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwzu,iv,Xyuvwx->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwzu,iv,Xyuvxw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwzu,iv,Xyuwvx->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwzu,iv,Xyuwxv->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('Yxyz,iwzu,iv,Xyuxvw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwzu,iv,Xyuxwv->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwzu,ivst,Xyuvxstw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,iwzu,ivst,Xyuvxswt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwzu,ivst,Xyuvxtsw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwzu,ivst,Xyuvxtws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwzu,ivst,Xyuvxwst->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iwzu,ivst,Xyuvxwts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwzu,ivsu,Xyvswx->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwzu,ivsu,Xyvsxw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwzu,ivsu,Xyvwsx->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwzu,ivsu,Xyvwxs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('Yxyz,iwzu,ivsu,Xyvxsw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,iwzu,ivsu,Xyvxws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iwzu,ivus,Xyvxws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iwzx,iu,Xywu->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iwzx,iuvs,Xyuwvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,ix,iw,Xywz->XY', v_aaaa, t1_ca, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,ix,iwuv,Xywuvz->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('Yxyz,ix,iwuv,Xywuzv->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,ix,iwuv,Xywvuz->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,ix,iwuv,Xywvzu->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,ix,iwuv,Xywzuv->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('Yxyz,ix,iwuv,Xywzvu->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,ix,izwu,Xywu->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,ixwu,iu,Xywz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,ixwu,iv,Xyvuzw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/48 * einsum('Yxyz,ixwu,ivst,Xystuzvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 11/48 * einsum('Yxyz,ixwu,ivst,Xystuzwv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/48 * einsum('Yxyz,ixwu,ivst,Xystvzuw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/48 * einsum('Yxyz,ixwu,ivst,Xystvzwu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/48 * einsum('Yxyz,ixwu,ivst,Xystwzuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/48 * einsum('Yxyz,ixwu,ivst,Xystwzvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,ixwu,ivsu,Xysvzw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,ixwu,ivsw,Xysuvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,ixwu,ivsw,Xysuzv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,ixwu,ivsw,Xysvuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,ixwu,ivsw,Xysvzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,ixwu,ivsw,Xyszuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,ixwu,ivsw,Xyszvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,ixwu,ivsz,Xysuvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,ixwu,ivus,Xysvwz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,ixwu,ivus,Xysvzw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,ixwu,ivus,Xyswvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,ixwu,ivus,Xyswzv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,ixwu,ivus,Xyszvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,ixwu,ivus,Xyszwv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,ixwu,ivuw,Xyvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,ixwu,ivuz,Xywv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,ixwu,ivws,Xysuvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('Yxyz,ixwu,ivws,Xysuzv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,ixwu,ivws,Xysvuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,ixwu,ivws,Xysvzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,ixwu,ivws,Xyszuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,ixwu,ivws,Xyszvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,ixwu,ivwu,Xyvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,ixwu,ivwz,Xyuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,ixwu,ivzs,Xysuvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,ixwu,ivzs,Xysuwv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,ixwu,ivzs,Xysvuw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,ixwu,ivzs,Xysvwu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,ixwu,ivzs,Xyswuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,ixwu,ivzs,Xyswvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,ixwu,ivzu,Xyvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,ixwu,ivzw,Xyuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,ixwu,iw,Xyuz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,ixwu,iz,Xyuw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iy,iw,Xwxz->XY', v_aaaa, t1_ca, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iy,iwuv,Xuvxzw->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iy,iwux,Xuwz->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iy,iwuz,Xuxw->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iy,iwxu,Xuzw->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iy,iwxz,Xw->XY', v_aaaa, t1_ca, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p -= einsum('Yxyz,iy,iwzu,Xuxw->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('Yxyz,iy,iwzx,Xw->XY', v_aaaa, t1_ca, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iy,ix,Xz->XY', v_aaaa, t1_ca, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p -= einsum('Yxyz,iy,iz,Xx->XY', v_aaaa, t1_ca, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,iywu,iu,Xwxz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,iywu,iv,Xuwvxz->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,iywu,iv,Xuwvzx->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,iywu,iv,Xuwxvz->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iywu,iv,Xuwxzv->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,iywu,iv,Xuwzvx->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,iywu,iv,Xuwzxv->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/480 * einsum('Yxyz,iywu,ivst,Xuwvstxz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/480 * einsum('Yxyz,iywu,ivst,Xuwvstzx->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/480 * einsum('Yxyz,iywu,ivst,Xuwvsxzt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/480 * einsum('Yxyz,iywu,ivst,Xuwvszxt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/480 * einsum('Yxyz,iywu,ivst,Xuwvtsxz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/480 * einsum('Yxyz,iywu,ivst,Xuwvtszx->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/160 * einsum('Yxyz,iywu,ivst,Xuwvtxzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/160 * einsum('Yxyz,iywu,ivst,Xuwvtzxs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 29/480 * einsum('Yxyz,iywu,ivst,Xuwvxstz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 11/240 * einsum('Yxyz,iywu,ivst,Xuwvxszt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 29/480 * einsum('Yxyz,iywu,ivst,Xuwvxtsz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/15 * einsum('Yxyz,iywu,ivst,Xuwvxtzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 97/480 * einsum('Yxyz,iywu,ivst,Xuwvxzst->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 11/160 * einsum('Yxyz,iywu,ivst,Xuwvxzts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/480 * einsum('Yxyz,iywu,ivst,Xuwvzstx->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/60 * einsum('Yxyz,iywu,ivst,Xuwvzsxt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/480 * einsum('Yxyz,iywu,ivst,Xuwvztsx->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/240 * einsum('Yxyz,iywu,ivst,Xuwvztxs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/480 * einsum('Yxyz,iywu,ivst,Xuwvzxst->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/160 * einsum('Yxyz,iywu,ivst,Xuwvzxts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,iywu,ivsu,Xwvsxz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,iywu,ivsu,Xwvszx->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,iywu,ivsu,Xwvxsz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,iywu,ivsu,Xwvxzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,iywu,ivsu,Xwvzsx->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,iywu,ivsu,Xwvzxs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,iywu,ivsw,Xuvxzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,iywu,ivus,Xwvxzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,iywu,ivuw,Xvxz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iywu,ivws,Xuvxzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iywu,ivwu,Xvxz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,iywu,iw,Xuxz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iz,iw,Xyxw->XY', v_aaaa, t1_ca, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('Yxyz,iz,iwuv,Xywxuv->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,izwu,iu,Xyxw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,izwu,iv,Xyvuwx->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,izwu,iv,Xyvuxw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,izwu,iv,Xyvwux->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,izwu,iv,Xyvwxu->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,izwu,iv,Xyvxuw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,izwu,iv,Xyvxwu->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('Yxyz,izwu,ivst,Xystxuvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 3/16 * einsum('Yxyz,izwu,ivst,Xystxuwv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('Yxyz,izwu,ivst,Xystxvuw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('Yxyz,izwu,ivst,Xystxvwu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('Yxyz,izwu,ivst,Xystxwuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('Yxyz,izwu,ivst,Xystxwvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,izwu,ivsu,Xysvwx->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,izwu,ivsu,Xysvxw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,izwu,ivsu,Xyswvx->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,izwu,ivsu,Xyswxv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('Yxyz,izwu,ivsu,Xysxvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('Yxyz,izwu,ivsu,Xysxwv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,izwu,ivsw,Xysxuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,izwu,ivus,Xysxwv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('Yxyz,izwu,ivuw,Xyxv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,izwu,ivws,Xysxuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,izwu,ivwu,Xyxv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('Yxyz,izwu,iw,Xyxu->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('xyzw,iYux,iu,Xzyw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,iYux,iv,Xzvywu->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,iYux,ivst,Xzstuvwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,iYux,ivst,Xzstuvyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('xyzw,iYux,ivst,Xzstuwvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('xyzw,iYux,ivst,Xzstuwyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('xyzw,iYux,ivst,Xzstuyvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('xyzw,iYux,ivst,Xzstuywv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('xyzw,iYux,ivst,Xzstvwuy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('xyzw,iYux,ivst,Xzstvwyu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('xyzw,iYux,ivst,Xzstvyuw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('xyzw,iYux,ivst,Xzstvywu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('xyzw,iYux,ivst,Xzstwuvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('xyzw,iYux,ivst,Xzstwuyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 3/160 * einsum('xyzw,iYux,ivst,Xzstwvuy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 3/160 * einsum('xyzw,iYux,ivst,Xzstwvyu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/240 * einsum('xyzw,iYux,ivst,Xzstwyuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/240 * einsum('xyzw,iYux,ivst,Xzstwyvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('xyzw,iYux,ivst,Xzstyuvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('xyzw,iYux,ivst,Xzstyuwv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 3/160 * einsum('xyzw,iYux,ivst,Xzstyvuw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 3/160 * einsum('xyzw,iYux,ivst,Xzstyvwu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 61/240 * einsum('xyzw,iYux,ivst,Xzstywuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/240 * einsum('xyzw,iYux,ivst,Xzstywvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,iYux,ivsu,Xzsywv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYux,ivsw,Xzsuvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYux,ivsw,Xzsuyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYux,ivsw,Xzsvuy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYux,ivsw,Xzsvyu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYux,ivsw,Xzsyuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iYux,ivsw,Xzsyvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYux,ivsy,Xzsvwu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('xyzw,iYux,ivus,Xzsywv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,iYux,ivuw,Xzyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,iYux,ivuy,Xzvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYux,ivws,Xzsyuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYux,ivwu,Xzyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYux,ivwy,Xzvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYux,ivys,Xzsuvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iYux,ivys,Xzsuwv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYux,ivys,Xzsvuw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYux,ivys,Xzsvwu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYux,ivys,Xzswuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYux,ivys,Xzswvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYux,ivyu,Xzvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYux,ivyw,Xzuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYux,iw,Xzyu->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYux,iy,Xzuw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYux,izuv,Xvyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iYux,izvs,Xsvuwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iYux,izvs,Xsvuyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iYux,izvs,Xsvwuy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iYux,izvs,Xsvwyu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iYux,izvs,Xsvyuw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYux,izvs,Xsvywu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,iYux,izvu,Xvyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,iYxu,iu,Xzyw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iYxu,iv,Xzvuwy->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iYxu,iv,Xzvuyw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iYxu,iv,Xzvwuy->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iYxu,iv,Xzvwyu->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iYxu,iv,Xzvyuw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iYxu,iv,Xzvywu->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/240 * einsum('xyzw,iYxu,ivst,Xzstuvwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/240 * einsum('xyzw,iYxu,ivst,Xzstuvyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/120 * einsum('xyzw,iYxu,ivst,Xzstuwvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 2/15 * einsum('xyzw,iYxu,ivst,Xzstuwyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/120 * einsum('xyzw,iYxu,ivst,Xzstuyvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/60 * einsum('xyzw,iYxu,ivst,Xzstuywv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/120 * einsum('xyzw,iYxu,ivst,Xzstvwuy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/120 * einsum('xyzw,iYxu,ivst,Xzstvwyu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/120 * einsum('xyzw,iYxu,ivst,Xzstvyuw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/120 * einsum('xyzw,iYxu,ivst,Xzstvywu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/20 * einsum('xyzw,iYxu,ivst,Xzstwuvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 3/40 * einsum('xyzw,iYxu,ivst,Xzstwuyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 13/240 * einsum('xyzw,iYxu,ivst,Xzstwvuy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 13/240 * einsum('xyzw,iYxu,ivst,Xzstwvyu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/15 * einsum('xyzw,iYxu,ivst,Xzstwyuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 7/120 * einsum('xyzw,iYxu,ivst,Xzstwyvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 11/120 * einsum('xyzw,iYxu,ivst,Xzstyuvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/30 * einsum('xyzw,iYxu,ivst,Xzstyuwv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 23/240 * einsum('xyzw,iYxu,ivst,Xzstyvuw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 23/240 * einsum('xyzw,iYxu,ivst,Xzstyvwu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/40 * einsum('xyzw,iYxu,ivst,Xzstywuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/10 * einsum('xyzw,iYxu,ivst,Xzstywvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iYxu,ivsu,Xzsvwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iYxu,ivsu,Xzsvyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iYxu,ivsu,Xzswvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iYxu,ivsu,Xzswyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iYxu,ivsu,Xzsyvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iYxu,ivsu,Xzsywv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYxu,ivsw,Xzsuvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYxu,ivsy,Xzsuvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iYxu,ivsy,Xzsuwv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYxu,ivsy,Xzsvuw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYxu,ivsy,Xzsvwu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYxu,ivsy,Xzswuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYxu,ivsy,Xzswvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,iYxu,ivus,Xzsywv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYxu,ivuw,Xzyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYxu,ivuy,Xzvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYxu,ivws,Xzsuvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iYxu,ivws,Xzsuyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYxu,ivws,Xzsvuy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYxu,ivws,Xzsvyu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYxu,ivws,Xzsyuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iYxu,ivws,Xzsyvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYxu,ivwu,Xzvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYxu,ivwy,Xzuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iYxu,ivys,Xzsuvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 2/3 * einsum('xyzw,iYxu,ivys,Xzsuwv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iYxu,ivys,Xzsvuw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iYxu,ivys,Xzsvwu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iYxu,ivys,Xzswuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iYxu,ivys,Xzswvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,iYxu,ivyu,Xzvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,iYxu,ivyw,Xzuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYxu,iw,Xzuy->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,iYxu,iy,Xzuw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,iYxu,izuv,Xvyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,iYxu,izvs,Xsvuwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,iYxu,izvu,Xvwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,iYzx,iu,Xuyw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,iYzx,iuvs,Xvsywu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYzx,iuvw,Xvyu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYzx,iuvy,Xvuw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,iYzx,iuwv,Xvyu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,iYzx,iuwy,Xu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYzx,iuyv,Xvwu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYzx,iuyw,Xu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ca, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,iYzx,iw,Xy->XY', v_aaaa, t1_caaa, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iYzx,iy,Xw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ca, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuYx,iv,Xywuvz->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuYx,iv,Xywuzv->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuYx,iv,Xywvuz->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuYx,iv,Xywvzu->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuYx,iv,Xywzuv->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuYx,iv,Xywzvu->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuYx,ivst,Xywvstzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuYx,ivst,Xywvsuzt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuYx,ivst,Xywvsztu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuYx,ivst,Xywvszut->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuYx,ivst,Xywvtszu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuYx,ivst,Xywvtuzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuYx,ivst,Xywvtzsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuYx,ivst,Xywvtzus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/48 * einsum('xyzw,iuYx,ivst,Xywvustz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 3/16 * einsum('xyzw,iuYx,ivst,Xywvuszt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/48 * einsum('xyzw,iuYx,ivst,Xywvutsz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/16 * einsum('xyzw,iuYx,ivst,Xywvutzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 5/48 * einsum('xyzw,iuYx,ivst,Xywvuzst->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/48 * einsum('xyzw,iuYx,ivst,Xywvuzts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 5/48 * einsum('xyzw,iuYx,ivst,Xywvzstu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/48 * einsum('xyzw,iuYx,ivst,Xywvzsut->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 5/48 * einsum('xyzw,iuYx,ivst,Xywvztsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 5/48 * einsum('xyzw,iuYx,ivst,Xywvztus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/48 * einsum('xyzw,iuYx,ivst,Xywvzust->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 5/48 * einsum('xyzw,iuYx,ivst,Xywvzuts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iuYx,ivsw,Xyvsuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuYx,ivsw,Xyvszu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuYx,ivsw,Xyvusz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuYx,ivsw,Xyvuzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuYx,ivsw,Xyvzsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuYx,ivsw,Xyvzus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuYx,ivsy,Xwvszu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuYx,ivws,Xyvzus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuYx,ivwy,Xvzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuYx,ivys,Xwvsuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuYx,ivys,Xwvszu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuYx,ivys,Xwvusz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iuYx,ivys,Xwvuzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuYx,ivys,Xwvzsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuYx,ivys,Xwvzus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuYx,ivyw,Xvuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuYx,iw,Xyzu->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuYx,iy,Xwuz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,iuYx,izvs,Xywvus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,iY,Xzuvwy->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,iY,Xzuvyw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,iY,Xzuwvy->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,iY,Xzuwyv->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,iY,Xzuyvw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,iY,Xzuywv->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,iYst,Xywvstzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,iYst,Xywvsuzt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuvx,iYst,Xywvsztu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuvx,iYst,Xywvszut->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,iYst,Xywvtszu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuvx,iYst,Xywvtuzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuvx,iYst,Xywvtzsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuvx,iYst,Xywvtzus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/48 * einsum('xyzw,iuvx,iYst,Xywvustz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/16 * einsum('xyzw,iuvx,iYst,Xywvuszt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/48 * einsum('xyzw,iuvx,iYst,Xywvutsz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 3/16 * einsum('xyzw,iuvx,iYst,Xywvutzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 5/48 * einsum('xyzw,iuvx,iYst,Xywvuzst->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/48 * einsum('xyzw,iuvx,iYst,Xywvuzts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('xyzw,iuvx,iYst,Xywvzstu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('xyzw,iuvx,iYst,Xywvzsut->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('xyzw,iuvx,iYst,Xywvztsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/16 * einsum('xyzw,iuvx,iYst,Xywvztus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('xyzw,iuvx,iYst,Xywvzust->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/16 * einsum('xyzw,iuvx,iYst,Xywvzuts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,iYsv,Xywsuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,iYsv,Xywszu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,iYsv,Xywusz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,iYsv,Xywuzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,iYsv,Xywzsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,iYsv,Xywzus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/3 * einsum('xyzw,iuvx,iYvs,Xywsuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,iYvs,Xywszu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,iYvs,Xywusz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,iYvs,Xywuzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,iYvs,Xywzsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,iYvs,Xywzus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,is,XywvYsuz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,is,XywvYszu->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,is,XywvYusz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,iuvx,is,XywvYuzs->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,is,XywvYzsu->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuvx,is,XywvYzus->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuvx,is,XywvuYzs->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuvx,is,XywvuzYs->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuvx,is,XywvzYus->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuvx,is,XywvzuYs->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,is,XzusYvwy->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,is,XzusYvyw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,is,XzusYwvy->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,iuvx,is,XzusYwyv->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,is,XzusYyvw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuvx,is,XzusYywv->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuvx,is,XzuswYyv->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuvx,is,XzuswyYv->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuvx,is,XzusyYwv->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuvx,is,XzusywYv->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,iuvx,isYt,Xzutvwys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuvx,isYt,Xzutvyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuvx,isYt,Xzutwsvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuvx,isYt,Xzutwsyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuvx,isYt,Xzutwvsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,isYt,Xzutwvys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuvx,isYt,Xzutwysv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,isYt,Xzutwyvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,iuvx,isYt,Xzutysvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,iuvx,isYt,Xzutyswv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,iuvx,isYt,Xzutyvsw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,iuvx,isYt,Xzutywsv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,isYv,Xzuswy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,isYv,Xzusyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,isYv,Xzuwsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,isYv,Xzuwys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,isYv,Xzuysw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,isYv,Xzuyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuvx,istY,Xzutswvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,iuvx,istY,Xzutsyvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuvx,istY,Xzutvwsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuvx,istY,Xzutvwys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,iuvx,istY,Xzutvysw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,iuvx,istY,Xzutvyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuvx,istY,Xzutwsyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,iuvx,istY,Xzutwyvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuvx,istY,Xzutyswv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,iuvx,istY,Xzutywsv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuvx,istY,Xzutywvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,istv,XywsYtuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,istv,XywsYtzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,istv,XywsYutz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,iuvx,istv,XywsYuzt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,istv,XywsYztu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuvx,istv,XywsYzut->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuvx,istv,XywsuYzt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuvx,istv,XywsuzYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuvx,istv,XywszYut->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuvx,istv,XywszuYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,istv,XzutYswy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,istv,XzutYsyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,istv,XzutYwsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,iuvx,istv,XzutYwys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuvx,istv,XzutYysw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuvx,istv,XzutYyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuvx,istv,XzutwYys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuvx,istv,XzutwyYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuvx,istv,XzutyYws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuvx,istv,XzutywYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuvx,istw,XzutYsyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuvx,isty,XzutYwsv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/3 * einsum('xyzw,iuvx,isvY,Xzuswy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,isvY,Xzusyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,isvY,Xzuwsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,isvY,Xzuwys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,isvY,Xzuysw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,isvY,Xzuyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,isvt,XywsYtuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,isvt,XywsYtzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,isvt,XywsYutz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,iuvx,isvt,XywsYuzt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,isvt,XywsYztu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,iuvx,isvt,XywsYzut->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuvx,isvt,XywsuYzt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuvx,isvt,XywsuzYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuvx,isvt,XywszYut->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuvx,isvt,XywszuYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,isvt,XzutYswy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,isvt,XzutYsyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,isvt,XzutYwsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,iuvx,isvt,XzutYwys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,isvt,XzutYysw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,iuvx,isvt,XzutYyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuvx,isvt,XzutwYys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuvx,isvt,XzutwyYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuvx,isvt,XzutyYws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuvx,isvt,XzutywYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 2/3 * einsum('xyzw,iuvx,isvw,XzuYsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iuvx,isvw,XzuYys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iuvx,isvw,XzusYy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iuvx,isvw,XzusyY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iuvx,isvw,XzuyYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iuvx,isvw,XzuysY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,iuvx,isvy,XzuYws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuvx,iswt,XyvsYuzt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('xyzw,iuvx,iswt,XzutYsvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('xyzw,iuvx,iswt,XzutYsyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('xyzw,iuvx,iswt,XzutYvsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('xyzw,iuvx,iswt,XzutYysv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/2 * einsum('xyzw,iuvx,iswt,XzutYyvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iuvx,iswv,XysYuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuvx,iswv,XysYzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuvx,iswv,XysuYz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuvx,iswv,XysuzY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuvx,iswv,XyszYu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuvx,iswv,XyszuY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iuvx,iswv,XzuYsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuvx,iswv,XzuYys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuvx,iswv,XzusYy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuvx,iswv,XzusyY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuvx,iswv,XzuyYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuvx,iswv,XzuysY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuvx,isyt,XwvsYzut->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuvx,isyt,XzutYwvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuvx,isyv,XwsYzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuvx,isyv,XzuYws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/3 * einsum('xyzw,iuvx,iv,XywYuz->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,iv,XywYzu->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,iv,XywuYz->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,iv,XywuzY->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,iv,XywzYu->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,iv,XywzuY->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/3 * einsum('xyzw,iuvx,iv,XzuYwy->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,iv,XzuYyw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,iv,XzuwYy->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,iv,XzuwyY->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,iv,XzuyYw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuvx,iv,XzuywY->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/240 * einsum('xyzw,iuvx,izst,XutsYvwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/240 * einsum('xyzw,iuvx,izst,XutsYvyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/120 * einsum('xyzw,iuvx,izst,XutsYwvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/30 * einsum('xyzw,iuvx,izst,XutsYwyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/120 * einsum('xyzw,iuvx,izst,XutsYyvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 13/60 * einsum('xyzw,iuvx,izst,XutsYywv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/120 * einsum('xyzw,iuvx,izst,XutsvwYy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/120 * einsum('xyzw,iuvx,izst,XutsvwyY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/120 * einsum('xyzw,iuvx,izst,XutsvyYw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/120 * einsum('xyzw,iuvx,izst,XutsvywY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/240 * einsum('xyzw,iuvx,izst,XutswYvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/80 * einsum('xyzw,iuvx,izst,XutswYyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/30 * einsum('xyzw,iuvx,izst,XutswvYy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/30 * einsum('xyzw,iuvx,izst,XutswvyY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/240 * einsum('xyzw,iuvx,izst,XutswyYv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 3/80 * einsum('xyzw,iuvx,izst,XutswyvY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/240 * einsum('xyzw,iuvx,izst,XutsyYvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/80 * einsum('xyzw,iuvx,izst,XutsyYwv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/30 * einsum('xyzw,iuvx,izst,XutsyvYw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/30 * einsum('xyzw,iuvx,izst,XutsyvwY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/240 * einsum('xyzw,iuvx,izst,XutsywYv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 3/80 * einsum('xyzw,iuvx,izst,XutsywvY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/240 * einsum('xyzw,iuvx,izst,XywvYstu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/120 * einsum('xyzw,iuvx,izst,XywvYsut->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/240 * einsum('xyzw,iuvx,izst,XywvYtsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/30 * einsum('xyzw,iuvx,izst,XywvYtus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/120 * einsum('xyzw,iuvx,izst,XywvYust->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 13/60 * einsum('xyzw,iuvx,izst,XywvYuts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/30 * einsum('xyzw,iuvx,izst,XywvsYtu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 3/80 * einsum('xyzw,iuvx,izst,XywvsYut->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/30 * einsum('xyzw,iuvx,izst,XywvstYu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/120 * einsum('xyzw,iuvx,izst,XywvstuY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 3/80 * einsum('xyzw,iuvx,izst,XywvsuYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/120 * einsum('xyzw,iuvx,izst,XywvsutY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/30 * einsum('xyzw,iuvx,izst,XywvtYsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/240 * einsum('xyzw,iuvx,izst,XywvtYus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/30 * einsum('xyzw,iuvx,izst,XywvtsYu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/120 * einsum('xyzw,iuvx,izst,XywvtsuY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/240 * einsum('xyzw,iuvx,izst,XywvtuYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/120 * einsum('xyzw,iuvx,izst,XywvtusY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/240 * einsum('xyzw,iuvx,izst,XywvuYst->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/80 * einsum('xyzw,iuvx,izst,XywvuYts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/240 * einsum('xyzw,iuvx,izst,XywvusYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/80 * einsum('xyzw,iuvx,izst,XywvutYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuvx,izvs,XusYyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuvx,izvs,XywYus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,iuxY,iv,Xywuvz->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/60 * einsum('xyzw,iuxY,ivst,Xywvstzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 7/240 * einsum('xyzw,iuxY,ivst,Xywvsuzt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/60 * einsum('xyzw,iuxY,ivst,Xywvsztu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 7/240 * einsum('xyzw,iuxY,ivst,Xywvszut->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/60 * einsum('xyzw,iuxY,ivst,Xywvtszu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/80 * einsum('xyzw,iuxY,ivst,Xywvtuzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/60 * einsum('xyzw,iuxY,ivst,Xywvtzsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/80 * einsum('xyzw,iuxY,ivst,Xywvtzus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/240 * einsum('xyzw,iuxY,ivst,Xywvustz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 17/60 * einsum('xyzw,iuxY,ivst,Xywvuszt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/240 * einsum('xyzw,iuxY,ivst,Xywvutsz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/120 * einsum('xyzw,iuxY,ivst,Xywvutzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/30 * einsum('xyzw,iuxY,ivst,Xywvuzst->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/120 * einsum('xyzw,iuxY,ivst,Xywvuzts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/120 * einsum('xyzw,iuxY,ivst,Xywvzstu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/80 * einsum('xyzw,iuxY,ivst,Xywvzsut->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/120 * einsum('xyzw,iuxY,ivst,Xywvztsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 13/240 * einsum('xyzw,iuxY,ivst,Xywvztus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/80 * einsum('xyzw,iuxY,ivst,Xywvzust->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 13/240 * einsum('xyzw,iuxY,ivst,Xywvzuts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuxY,ivsw,Xyvusz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuxY,ivsy,Xwvsuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuxY,ivsy,Xwvszu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuxY,ivsy,Xwvusz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iuxY,ivsy,Xwvuzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuxY,ivsy,Xwvzsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuxY,ivsy,Xwvzus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuxY,ivws,Xyvsuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuxY,ivws,Xyvszu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuxY,ivws,Xyvusz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iuxY,ivws,Xyvuzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuxY,ivws,Xyvzsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuxY,ivws,Xyvzus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuxY,ivwy,Xvuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iuxY,ivys,Xwvsuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iuxY,ivys,Xwvszu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iuxY,ivys,Xwvusz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 2/3 * einsum('xyzw,iuxY,ivys,Xwvuzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iuxY,ivys,Xwvzsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iuxY,ivys,Xwvzus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,iuxY,ivyw,Xvuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuxY,iw,Xyuz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,iuxY,iy,Xwuz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuxY,izvs,Xywsuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuxY,izvs,Xywsvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuxY,izvs,Xywusv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuxY,izvs,Xywuvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuxY,izvs,Xywvsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuxY,izvs,Xywvus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,iuxv,iY,Xzuywv->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/16 * einsum('xyzw,iuxv,iYst,Xywvstzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/16 * einsum('xyzw,iuxv,iYst,Xywvsztu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 3/16 * einsum('xyzw,iuxv,iYst,Xywvtszu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/16 * einsum('xyzw,iuxv,iYst,Xywvtzsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/16 * einsum('xyzw,iuxv,iYst,Xywvzstu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/16 * einsum('xyzw,iuxv,iYst,Xywvztsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,iuxv,iYsv,Xywusz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuxv,iYvs,Xywsuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,iYvs,Xywszu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,iYvs,Xywusz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,iYvs,Xywuzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,iYvs,Xywzsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,iYvs,Xywzus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 5/24 * einsum('xyzw,iuxv,is,XywvYszu->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuxv,is,XywvYzsu->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,is,XywvsYuz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,is,XywvsuYz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,is,XywvuYsz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,is,XywvuYzs->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,is,XywvusYz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,is,XywvuzYs->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,is,XywvzYus->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,is,XywvzuYs->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 5/24 * einsum('xyzw,iuxv,is,XzusYwvy->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuxv,is,XzusYyvw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,is,XzuswYyv->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,is,XzuswvYy->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,is,XzuswvyY->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,is,XzuswyYv->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,is,XzusyYwv->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,is,XzusyvYw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,is,XzusyvwY->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,is,XzusywYv->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,iuxv,isYt,Xzutywvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,iuxv,isYv,Xzuyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,iuxv,istY,Xzutswvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuxv,istY,Xzutsyvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuxv,istY,Xzutwsvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuxv,istY,Xzutwyvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuxv,istY,Xzutysvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuxv,istY,Xzutywvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 5/24 * einsum('xyzw,iuxv,istv,XywsYtzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuxv,istv,XywsYztu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,istv,XywstYuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,istv,XywstuYz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,istv,XywsuYtz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,istv,XywsuYzt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,istv,XywsutYz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,istv,XywsuzYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,istv,XywszYut->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,istv,XywszuYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 5/24 * einsum('xyzw,iuxv,istv,XzutYwsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuxv,istv,XzutYysw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,istv,XzutwYys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,istv,XzutwsYy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,istv,XzutwsyY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,istv,XzutwyYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,istv,XzutyYws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,istv,XzutysYw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,istv,XzutyswY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,istv,XzutywYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuxv,isvY,Xzuswy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,isvY,Xzusyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,isvY,Xzuwsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,isvY,Xzuwys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,isvY,Xzuysw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,isvY,Xzuyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,isvt,XywsYtuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,isvt,XywsYtzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,isvt,XywsYutz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,iuxv,isvt,XywsYuzt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,isvt,XywsYztu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuxv,isvt,XywsYzut->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuxv,isvt,XywsuYzt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuxv,isvt,XywsuzYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuxv,isvt,XywszYut->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuxv,isvt,XywszuYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,isvt,XzutYswy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,isvt,XzutYsyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,isvt,XzutYwsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,iuxv,isvt,XzutYwys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,isvt,XzutYysw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuxv,isvt,XzutYyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuxv,isvt,XzutwYys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuxv,isvt,XzutwyYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuxv,isvt,XzutyYws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,iuxv,isvt,XzutywYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuxv,iswt,XzutYyvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuxv,iswv,XzuYys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,iuxv,isyt,XzutYwvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,iuxv,isyv,XzuYws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuxv,iv,XywYuz->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,iv,XywYzu->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,iv,XywuYz->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,iv,XywuzY->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,iv,XywzYu->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,iv,XywzuY->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuxv,iv,XzuYwy->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,iv,XzuYyw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,iv,XzuwYy->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,iv,XzuwyY->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,iv,XzuyYw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxv,iv,XzuywY->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuxv,izst,XutsYvwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,iuxv,izst,XutsYvyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuxv,izst,XutsYwvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuxv,izst,XutsYwyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuxv,izst,XutsYyvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuxv,izst,XutsYywv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,izst,XutswvYy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,izst,XutswvyY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,izst,XutsyvYw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,izst,XutsyvwY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,iuxv,izst,XywvYstu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuxv,izst,XywvYsut->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,iuxv,izst,XywvYtsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuxv,izst,XywvYtus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuxv,izst,XywvYust->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuxv,izst,XywvYuts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,izst,XywvsYtu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,izst,XywvstYu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,izst,XywvtYsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,iuxv,izst,XywvtsYu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuxv,izsv,XusYwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuxv,izsv,XusYyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuxv,izsv,XuswyY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuxv,izsv,XusywY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuxv,izsv,XywYsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuxv,izsv,XywYus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuxv,izsv,XywsuY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,iuxv,izsv,XywusY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,iuxv,izvs,XusYyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,iuxv,izvs,XywYus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,iuxz,iY,Xuyw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,iuxz,iYvs,Xywsvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,iuxz,iv,XuvYwy->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,iuxz,iv,XywYvu->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxz,ivYs,Xusvwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxz,ivYs,Xusvyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxz,ivYs,Xuswvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxz,ivYs,Xuswyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,iuxz,ivYs,Xusyvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,iuxz,ivYs,Xusywv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,iuxz,ivsY,Xusvwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 11/240 * einsum('xyzw,iuxz,ivst,XustYvwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 11/240 * einsum('xyzw,iuxz,ivst,XustYvyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/20 * einsum('xyzw,iuxz,ivst,XustYwvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 19/120 * einsum('xyzw,iuxz,ivst,XustYwyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/20 * einsum('xyzw,iuxz,ivst,XustYyvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 11/120 * einsum('xyzw,iuxz,ivst,XustYywv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,iuxz,ivst,XustvYwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,iuxz,ivst,XustvYyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 7/240 * einsum('xyzw,iuxz,ivst,XustwYvy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/80 * einsum('xyzw,iuxz,ivst,XustwYyv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,iuxz,ivst,XustwvYy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,iuxz,ivst,XustwvyY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/240 * einsum('xyzw,iuxz,ivst,XustwyYv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/80 * einsum('xyzw,iuxz,ivst,XustwyvY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 7/240 * einsum('xyzw,iuxz,ivst,XustyYvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/80 * einsum('xyzw,iuxz,ivst,XustyYwv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,iuxz,ivst,XustyvYw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,iuxz,ivst,XustyvwY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/240 * einsum('xyzw,iuxz,ivst,XustywYv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/80 * einsum('xyzw,iuxz,ivst,XustywvY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 11/240 * einsum('xyzw,iuxz,ivst,XywvYstu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 19/120 * einsum('xyzw,iuxz,ivst,XywvYsut->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 11/240 * einsum('xyzw,iuxz,ivst,XywvYtsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/20 * einsum('xyzw,iuxz,ivst,XywvYtus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 11/120 * einsum('xyzw,iuxz,ivst,XywvYust->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/20 * einsum('xyzw,iuxz,ivst,XywvYuts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,iuxz,ivst,XywvsYtu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/240 * einsum('xyzw,iuxz,ivst,XywvsYut->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,iuxz,ivst,XywvstYu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/240 * einsum('xyzw,iuxz,ivst,XywvsuYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,iuxz,ivst,XywvtYsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/80 * einsum('xyzw,iuxz,ivst,XywvtYus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,iuxz,ivst,XywvtsYu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/80 * einsum('xyzw,iuxz,ivst,XywvtuYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/80 * einsum('xyzw,iuxz,ivst,XywvuYst->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 7/240 * einsum('xyzw,iuxz,ivst,XywvuYts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/80 * einsum('xyzw,iuxz,ivst,XywvusYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,iuxz,ivst,XywvustY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 7/240 * einsum('xyzw,iuxz,ivst,XywvutYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,iuxz,ivst,XywvutsY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuxz,ivsy,XusYwv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuxz,ivsy,XwvYus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,iuxz,ivys,XusYwv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,iuxz,ivys,XwvYus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,iuxz,ivyw,XuYv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,iuxz,iy,XuYw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,iuxz,iy,XwYu->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iuzx,ivsy,XusYvw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuzx,ivsy,XusYwv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuzx,ivsy,XusvYw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuzx,ivsy,XusvwY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuzx,ivsy,XuswYv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuzx,ivsy,XuswvY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,iuzx,ivsy,XwvYsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuzx,ivsy,XwvYus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuzx,ivsy,XwvsYu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuzx,ivsy,XwvsuY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuzx,ivsy,XwvuYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,iuzx,ivsy,XwvusY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuzx,ivys,XusYwv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuzx,ivys,XwvYus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuzx,ivyw,XuYv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuzx,iy,XuYw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,iuzx,iy,XwYu->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,ix,iY,Xzyw->XY', v_aaaa, t1_ca, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iYuv,Xywuvz->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iYuv,Xywuzv->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,ix,iYuv,Xywvuz->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iYuv,Xywvzu->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iYuv,Xywzuv->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iYuv,Xywzvu->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,ix,iu,XywYuz->XY', v_aaaa, t1_ca, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iu,XywYzu->XY', v_aaaa, t1_ca, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iu,XywuYz->XY', v_aaaa, t1_ca, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iu,XywuzY->XY', v_aaaa, t1_ca, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iu,XywzYu->XY', v_aaaa, t1_ca, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iu,XywzuY->XY', v_aaaa, t1_ca, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,ix,iu,XzuYwy->XY', v_aaaa, t1_ca, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iu,XzuYyw->XY', v_aaaa, t1_ca, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iu,XzuwYy->XY', v_aaaa, t1_ca, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iu,XzuwyY->XY', v_aaaa, t1_ca, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iu,XzuyYw->XY', v_aaaa, t1_ca, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iu,XzuywY->XY', v_aaaa, t1_ca, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,ix,iuYv,Xzvywu->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/6 * einsum('xyzw,ix,iuvY,Xzvuwy->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iuvY,Xzvuyw->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iuvY,Xzvwuy->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iuvY,Xzvwyu->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iuvY,Xzvyuw->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ix,iuvY,Xzvywu->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 11/240 * einsum('xyzw,ix,iuvs,XywuYsvz->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/20 * einsum('xyzw,ix,iuvs,XywuYszv->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 11/240 * einsum('xyzw,ix,iuvs,XywuYvsz->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 19/120 * einsum('xyzw,ix,iuvs,XywuYvzs->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/20 * einsum('xyzw,ix,iuvs,XywuYzsv->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 11/120 * einsum('xyzw,ix,iuvs,XywuYzvs->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,ix,iuvs,XywusYvz->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/80 * einsum('xyzw,ix,iuvs,XywusYzv->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,ix,iuvs,XywusvYz->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/80 * einsum('xyzw,ix,iuvs,XywuszYv->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,ix,iuvs,XywuvYsz->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/240 * einsum('xyzw,ix,iuvs,XywuvYzs->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,ix,iuvs,XywuvsYz->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/240 * einsum('xyzw,ix,iuvs,XywuvzYs->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 7/240 * einsum('xyzw,ix,iuvs,XywuzYsv->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/80 * einsum('xyzw,ix,iuvs,XywuzYvs->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 7/240 * einsum('xyzw,ix,iuvs,XywuzsYv->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,ix,iuvs,XywuzsvY->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/80 * einsum('xyzw,ix,iuvs,XywuzvYs->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,ix,iuvs,XywuzvsY->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 11/240 * einsum('xyzw,ix,iuvs,XzvsYuwy->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 11/240 * einsum('xyzw,ix,iuvs,XzvsYuyw->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/20 * einsum('xyzw,ix,iuvs,XzvsYwuy->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 19/120 * einsum('xyzw,ix,iuvs,XzvsYwyu->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/20 * einsum('xyzw,ix,iuvs,XzvsYyuw->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 11/120 * einsum('xyzw,ix,iuvs,XzvsYywu->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,ix,iuvs,XzvsuYwy->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,ix,iuvs,XzvsuYyw->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 7/240 * einsum('xyzw,ix,iuvs,XzvswYuy->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/80 * einsum('xyzw,ix,iuvs,XzvswYyu->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,ix,iuvs,XzvswuYy->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,ix,iuvs,XzvswuyY->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/240 * einsum('xyzw,ix,iuvs,XzvswyYu->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/80 * einsum('xyzw,ix,iuvs,XzvswyuY->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 7/240 * einsum('xyzw,ix,iuvs,XzvsyYuw->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/80 * einsum('xyzw,ix,iuvs,XzvsyYwu->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,ix,iuvs,XzvsyuYw->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/60 * einsum('xyzw,ix,iuvs,XzvsyuwY->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/240 * einsum('xyzw,ix,iuvs,XzvsywYu->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/80 * einsum('xyzw,ix,iuvs,XzvsywuY->XY', v_aaaa, t1_ca, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,ix,iuvw,XyuYvz->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ix,iuvw,XyuYzv->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ix,iuvw,XyuvYz->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ix,iuvw,XyuvzY->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ix,iuvw,XyuzYv->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ix,iuvw,XyuzvY->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,ix,iuvw,XzvYuy->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ix,iuvw,XzvYyu->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ix,iuvw,XzvuYy->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ix,iuvw,XzvuyY->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ix,iuvw,XzvyYu->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ix,iuvw,XzvyuY->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,ix,iuvy,XwuYzv->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,ix,iuvy,XzvYwu->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,ix,iuwv,XyuYzv->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,ix,iuwv,XzvYyu->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,ix,iuyv,XwuYzv->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,ix,iuyv,XzvYwu->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,ix,iw,XzYy->XY', v_aaaa, t1_ca, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= einsum('xyzw,ix,iy,XzYw->XY', v_aaaa, t1_ca, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ix,izuv,XvuYwy->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ix,izuv,XvuYyw->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ix,izuv,XvuwYy->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ix,izuv,XvuwyY->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ix,izuv,XvuyYw->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ix,izuv,XvuywY->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ix,izuv,XywYuv->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ix,izuv,XywYvu->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ix,izuv,XywuYv->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ix,izuv,XywuvY->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ix,izuv,XywvYu->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ix,izuv,XywvuY->XY', v_aaaa, t1_ca, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,ixYu,iu,Xzyw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixYu,iv,Xzuvwy->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixYu,iv,Xzuvyw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixYu,iv,Xzuwvy->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixYu,iv,Xzuwyv->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixYu,iv,Xzuyvw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixYu,iv,Xzuywv->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/96 * einsum('xyzw,ixYu,ivst,Xzuvstwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/96 * einsum('xyzw,ixYu,ivst,Xzuvstyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 5/96 * einsum('xyzw,ixYu,ivst,Xzuvswty->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ixYu,ivst,Xzuvswyt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/32 * einsum('xyzw,ixYu,ivst,Xzuvsytw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixYu,ivst,Xzuvsywt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/96 * einsum('xyzw,ixYu,ivst,Xzuvtswy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/96 * einsum('xyzw,ixYu,ivst,Xzuvtsyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 5/96 * einsum('xyzw,ixYu,ivst,Xzuvtwsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,ixYu,ivst,Xzuvtwys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/32 * einsum('xyzw,ixYu,ivst,Xzuvtysw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,ixYu,ivst,Xzuvtyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/48 * einsum('xyzw,ixYu,ivst,Xzuvwsty->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 3/32 * einsum('xyzw,ixYu,ivst,Xzuvwsyt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/48 * einsum('xyzw,ixYu,ivst,Xzuvwtsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/32 * einsum('xyzw,ixYu,ivst,Xzuvwtys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 5/96 * einsum('xyzw,ixYu,ivst,Xzuvwyst->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/96 * einsum('xyzw,ixYu,ivst,Xzuvwyts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/16 * einsum('xyzw,ixYu,ivst,Xzuvystw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 5/96 * einsum('xyzw,ixYu,ivst,Xzuvyswt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/16 * einsum('xyzw,ixYu,ivst,Xzuvytsw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/96 * einsum('xyzw,ixYu,ivst,Xzuvytws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 3/32 * einsum('xyzw,ixYu,ivst,Xzuvywst->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/32 * einsum('xyzw,ixYu,ivst,Xzuvywts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixYu,ivsu,Xzvswy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixYu,ivsu,Xzvsyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixYu,ivsu,Xzvwsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixYu,ivsu,Xzvwys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixYu,ivsu,Xzvysw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixYu,ivsu,Xzvyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,ixYu,ivsz,Xuvsyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,ixYu,ivus,Xzvyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,ixYu,ivuz,Xvyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixYu,ivzs,Xuvswy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixYu,ivzs,Xuvsyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixYu,ivzs,Xuvwsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixYu,ivzs,Xuvwys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixYu,ivzs,Xuvysw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixYu,ivzs,Xuvyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,ixYu,ivzu,Xvwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,ixYu,iz,Xuwy->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,ixuY,iu,Xzyw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,ixuY,iv,Xzuywv->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/120 * einsum('xyzw,ixuY,ivst,Xzuvstwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/120 * einsum('xyzw,ixuY,ivst,Xzuvstyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/160 * einsum('xyzw,ixuY,ivst,Xzuvswty->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('xyzw,ixuY,ivst,Xzuvswyt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/160 * einsum('xyzw,ixuY,ivst,Xzuvsytw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('xyzw,ixuY,ivst,Xzuvsywt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/120 * einsum('xyzw,ixuY,ivst,Xzuvtswy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/120 * einsum('xyzw,ixuY,ivst,Xzuvtsyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/160 * einsum('xyzw,ixuY,ivst,Xzuvtwsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('xyzw,ixuY,ivst,Xzuvtwys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/160 * einsum('xyzw,ixuY,ivst,Xzuvtysw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/480 * einsum('xyzw,ixuY,ivst,Xzuvtyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/480 * einsum('xyzw,ixuY,ivst,Xzuvwsty->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/160 * einsum('xyzw,ixuY,ivst,Xzuvwsyt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/480 * einsum('xyzw,ixuY,ivst,Xzuvwtsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/160 * einsum('xyzw,ixuY,ivst,Xzuvwtys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/240 * einsum('xyzw,ixuY,ivst,Xzuvwyst->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/240 * einsum('xyzw,ixuY,ivst,Xzuvwyts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/480 * einsum('xyzw,ixuY,ivst,Xzuvystw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/160 * einsum('xyzw,ixuY,ivst,Xzuvyswt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/480 * einsum('xyzw,ixuY,ivst,Xzuvytsw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/160 * einsum('xyzw,ixuY,ivst,Xzuvytws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 61/240 * einsum('xyzw,ixuY,ivst,Xzuvywst->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/240 * einsum('xyzw,ixuY,ivst,Xzuvywts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,ixuY,ivsu,Xzvyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuY,ivsz,Xuvswy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuY,ivsz,Xuvsyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuY,ivsz,Xuvwsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuY,ivsz,Xuvwys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuY,ivsz,Xuvysw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuY,ivsz,Xuvyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,ixuY,ivus,Xzvyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,ixuY,ivuz,Xvyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,ixuY,ivzs,Xuvyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,ixuY,ivzu,Xvyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,ixuY,iz,Xuyw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,ixuv,iY,Xywuvz->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/480 * einsum('xyzw,ixuv,iYst,Xzvustwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/480 * einsum('xyzw,ixuv,iYst,Xzvustyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 17/480 * einsum('xyzw,ixuv,iYst,Xzvuswty->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 11/240 * einsum('xyzw,ixuv,iYst,Xzvuswyt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 11/160 * einsum('xyzw,ixuv,iYst,Xzvusytw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/120 * einsum('xyzw,ixuv,iYst,Xzvusywt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/160 * einsum('xyzw,ixuv,iYst,Xzvutswy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/160 * einsum('xyzw,ixuv,iYst,Xzvutsyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 17/480 * einsum('xyzw,ixuv,iYst,Xzvutwsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 19/240 * einsum('xyzw,ixuv,iYst,Xzvutwys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 11/160 * einsum('xyzw,ixuv,iYst,Xzvutysw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/15 * einsum('xyzw,ixuv,iYst,Xzvutyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/80 * einsum('xyzw,ixuv,iYst,Xzvuwsty->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/480 * einsum('xyzw,ixuv,iYst,Xzvuwsyt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/120 * einsum('xyzw,ixuv,iYst,Xzvuwtsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 61/480 * einsum('xyzw,ixuv,iYst,Xzvuwtys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 31/480 * einsum('xyzw,ixuv,iYst,Xzvuwyst->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 29/480 * einsum('xyzw,ixuv,iYst,Xzvuwyts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 13/240 * einsum('xyzw,ixuv,iYst,Xzvuystw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/160 * einsum('xyzw,ixuv,iYst,Xzvuyswt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/20 * einsum('xyzw,ixuv,iYst,Xzvuytsw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 41/480 * einsum('xyzw,ixuv,iYst,Xzvuytws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/480 * einsum('xyzw,ixuv,iYst,Xzvuywst->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 59/480 * einsum('xyzw,ixuv,iYst,Xzvuywts->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,iYsu,Xzvswy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iYsu,Xzvsyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iYsu,Xzvwsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iYsu,Xzvwys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iYsu,Xzvysw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iYsu,Xzvyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,ixuv,iYsv,Xzuyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,ixuv,iYus,Xzvswy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,iYus,Xzvsyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,iYus,Xzvwsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,iYus,Xzvwys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,iYus,Xzvysw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,iYus,Xzvyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/2 * einsum('xyzw,ixuv,iYuv,Xzyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,iYvs,Xzuswy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iYvs,Xzusyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iYvs,Xzuwsy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iYvs,Xzuwys->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iYvs,Xzuysw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iYvs,Xzuyws->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,ixuv,iYvu,Xzyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccaa, optimize = einsum_type)
        V1_p1p += 11/240 * einsum('xyzw,ixuv,is,XywsYuvz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/20 * einsum('xyzw,ixuv,is,XywsYuzv->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 11/240 * einsum('xyzw,ixuv,is,XywsYvuz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 19/120 * einsum('xyzw,ixuv,is,XywsYvzu->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/20 * einsum('xyzw,ixuv,is,XywsYzuv->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 11/120 * einsum('xyzw,ixuv,is,XywsYzvu->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/60 * einsum('xyzw,ixuv,is,XywsuYvz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/80 * einsum('xyzw,ixuv,is,XywsuYzv->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/60 * einsum('xyzw,ixuv,is,XywsuvYz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/80 * einsum('xyzw,ixuv,is,XywsuzYv->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/60 * einsum('xyzw,ixuv,is,XywsvYuz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 7/240 * einsum('xyzw,ixuv,is,XywsvYzu->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/60 * einsum('xyzw,ixuv,is,XywsvuYz->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 7/240 * einsum('xyzw,ixuv,is,XywsvzYu->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/240 * einsum('xyzw,ixuv,is,XywszYuv->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/80 * einsum('xyzw,ixuv,is,XywszYvu->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/240 * einsum('xyzw,ixuv,is,XywszuYv->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/60 * einsum('xyzw,ixuv,is,XywszuvY->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/80 * einsum('xyzw,ixuv,is,XywszvYu->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/60 * einsum('xyzw,ixuv,is,XywszvuY->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 11/240 * einsum('xyzw,ixuv,is,XzvuYswy->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 11/240 * einsum('xyzw,ixuv,is,XzvuYsyw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/20 * einsum('xyzw,ixuv,is,XzvuYwsy->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 19/120 * einsum('xyzw,ixuv,is,XzvuYwys->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/20 * einsum('xyzw,ixuv,is,XzvuYysw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 11/120 * einsum('xyzw,ixuv,is,XzvuYyws->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/60 * einsum('xyzw,ixuv,is,XzvusYwy->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/60 * einsum('xyzw,ixuv,is,XzvusYyw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/240 * einsum('xyzw,ixuv,is,XzvuwYsy->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/80 * einsum('xyzw,ixuv,is,XzvuwYys->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/60 * einsum('xyzw,ixuv,is,XzvuwsYy->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/60 * einsum('xyzw,ixuv,is,XzvuwsyY->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 7/240 * einsum('xyzw,ixuv,is,XzvuwyYs->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/80 * einsum('xyzw,ixuv,is,XzvuwysY->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/240 * einsum('xyzw,ixuv,is,XzvuyYsw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/80 * einsum('xyzw,ixuv,is,XzvuyYws->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/60 * einsum('xyzw,ixuv,is,XzvuysYw->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/60 * einsum('xyzw,ixuv,is,XzvuyswY->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 7/240 * einsum('xyzw,ixuv,is,XzvuywYs->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/80 * einsum('xyzw,ixuv,is,XzvuywsY->XY', v_aaaa, t1_caaa, t1_ca, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 3/16 * einsum('xyzw,ixuv,isYt,Xywtuvzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('xyzw,ixuv,isYt,Xywtuzvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('xyzw,ixuv,isYt,Xywtvuzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/16 * einsum('xyzw,ixuv,isYt,Xywtvzus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ixuv,isYt,Xywtzsuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ixuv,isYt,Xywtzsvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ixuv,isYt,Xywtzusv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/48 * einsum('xyzw,ixuv,isYt,Xywtzuvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ixuv,isYt,Xywtzvsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/48 * einsum('xyzw,ixuv,isYt,Xywtzvus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isYu,Xywsvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isYu,Xywszv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isYu,Xywvsz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isYu,Xywvzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isYu,Xywzsv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isYu,Xywzvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,ixuv,isYv,Xywusz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 13/160 * einsum('xyzw,ixuv,istY,Xywtsuzv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/160 * einsum('xyzw,ixuv,istY,Xywtsvzu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 41/480 * einsum('xyzw,ixuv,istY,Xywtszuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 19/480 * einsum('xyzw,ixuv,istY,Xywtszvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/480 * einsum('xyzw,ixuv,istY,Xywtusvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 19/240 * einsum('xyzw,ixuv,istY,Xywtuszv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/480 * einsum('xyzw,ixuv,istY,Xywtuvsz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 41/480 * einsum('xyzw,ixuv,istY,Xywtuvzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 7/80 * einsum('xyzw,ixuv,istY,Xywtuzsv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 13/160 * einsum('xyzw,ixuv,istY,Xywtuzvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/480 * einsum('xyzw,ixuv,istY,Xywtvsuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 49/240 * einsum('xyzw,ixuv,istY,Xywtvszu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/480 * einsum('xyzw,ixuv,istY,Xywtvusz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 41/480 * einsum('xyzw,ixuv,istY,Xywtvuzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 3/80 * einsum('xyzw,ixuv,istY,Xywtvzsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 13/160 * einsum('xyzw,ixuv,istY,Xywtvzus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/480 * einsum('xyzw,ixuv,istY,Xywtzsuv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 59/480 * einsum('xyzw,ixuv,istY,Xywtzsvu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/480 * einsum('xyzw,ixuv,istY,Xywtzusv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/240 * einsum('xyzw,ixuv,istY,Xywtzuvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 59/480 * einsum('xyzw,ixuv,istY,Xywtzvsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/240 * einsum('xyzw,ixuv,istY,Xywtzvus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,istu,XywtYsvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,istu,XywtYszv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,istu,XywtYvsz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,ixuv,istu,XywtYvzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,istu,XywtYzsv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,ixuv,istu,XywtYzvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,ixuv,istu,XywtvYzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,ixuv,istu,XywtvzYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,ixuv,istu,XywtzYvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,ixuv,istu,XywtzvYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,istu,XzvsYtwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,istu,XzvsYtyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,istu,XzvsYwty->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,ixuv,istu,XzvsYwyt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,istu,XzvsYytw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,ixuv,istu,XzvsYywt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,ixuv,istu,XzvswYyt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,ixuv,istu,XzvswyYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,ixuv,istu,XzvsyYwt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,ixuv,istu,XzvsywYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 5/24 * einsum('xyzw,ixuv,istv,XywtYszu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,ixuv,istv,XywtYzsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,ixuv,istv,XywtsYuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,ixuv,istv,XywtsuYz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,ixuv,istv,XywtuYsz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,ixuv,istv,XywtuYzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,ixuv,istv,XywtusYz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,ixuv,istv,XywtuzYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,ixuv,istv,XywtzYus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,ixuv,istv,XywtzuYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 5/24 * einsum('xyzw,ixuv,istv,XzusYwty->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,ixuv,istv,XzusYytw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,ixuv,istv,XzuswYyt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,ixuv,istv,XzuswtYy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,ixuv,istv,XzuswtyY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,ixuv,istv,XzuswyYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,ixuv,istv,XzusyYwt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,ixuv,istv,XzusytYw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,ixuv,istv,XzusytwY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/24 * einsum('xyzw,ixuv,istv,XzusywYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,ixuv,isuY,Xywsvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isuY,Xywszv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isuY,Xywvsz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isuY,Xywvzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isuY,Xywzsv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isuY,Xywzvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isut,XywtYsvz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isut,XywtYszv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isut,XywtYvsz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,ixuv,isut,XywtYvzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isut,XywtYzsv->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,ixuv,isut,XywtYzvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ixuv,isut,XywtvYzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ixuv,isut,XywtvzYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ixuv,isut,XywtzYvs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ixuv,isut,XywtzvYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isut,XzvsYtwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isut,XzvsYtyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isut,XzvsYwty->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/4 * einsum('xyzw,ixuv,isut,XzvsYwyt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isut,XzvsYytw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,ixuv,isut,XzvsYywt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ixuv,isut,XzvswYyt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ixuv,isut,XzvswyYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ixuv,isut,XzvsyYwt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/12 * einsum('xyzw,ixuv,isut,XzvsywYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,ixuv,isuv,XywYsz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isuv,XywYzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isuv,XywsYz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isuv,XywszY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isuv,XywzYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isuv,XywzsY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,ixuv,isuv,XzsYwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isuv,XzsYyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isuv,XzswYy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isuv,XzswyY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isuv,XzsyYw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isuv,XzsywY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isvY,Xywsuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvY,Xywszu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvY,Xywusz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvY,Xywuzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvY,Xywzsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvY,Xywzus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvt,XywtYsuz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvt,XywtYszu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvt,XywtYusz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,ixuv,isvt,XywtYuzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvt,XywtYzsu->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,ixuv,isvt,XywtYzus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,ixuv,isvt,XywtuYzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,ixuv,isvt,XywtuzYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,ixuv,isvt,XywtzYus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,ixuv,isvt,XywtzuYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvt,XzusYtwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvt,XzusYtyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvt,XzusYwty->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/8 * einsum('xyzw,ixuv,isvt,XzusYwyt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvt,XzusYytw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/8 * einsum('xyzw,ixuv,isvt,XzusYywt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,ixuv,isvt,XzuswYyt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,ixuv,isvt,XzuswyYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,ixuv,isvt,XzusyYwt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p += 1/24 * einsum('xyzw,ixuv,isvt,XzusywYt->XY', v_aaaa, t1_caaa, t1_caaa, rdm_ccccaaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isvu,XywYsz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvu,XywYzs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvu,XywsYz->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvu,XywszY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvu,XywzYs->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvu,XywzsY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,isvu,XzsYwy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvu,XzsYyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvu,XzswYy->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvu,XzswyY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvu,XzsyYw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,isvu,XzsywY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,ixuv,isvz,XusYyw->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/4 * einsum('xyzw,ixuv,isvz,XywYus->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iszv,XuswyY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iszv,XusywY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iszv,XywsuY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iszv,XywusY->XY', v_aaaa, t1_caaa, t1_caaa, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,ixuv,iu,XywYvz->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,iu,XywYzv->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,iu,XywvYz->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,iu,XywvzY->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,iu,XywzYv->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,iu,XywzvY->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/3 * einsum('xyzw,ixuv,iu,XzvYwy->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,iu,XzvYyw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,iu,XzvwYy->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,iu,XzvwyY->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,iu,XzvyYw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,iu,XzvywY->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,iv,XywYuz->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iv,XywYzu->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iv,XywuYz->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iv,XywuzY->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iv,XywzYu->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iv,XywzuY->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p -= 1/6 * einsum('xyzw,ixuv,iv,XzuYwy->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iv,XzuYyw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iv,XzuwYy->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iv,XzuwyY->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iv,XzuyYw->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1_p1p += 1/12 * einsum('xyzw,ixuv,iv,XzuywY->XY', v_aaaa, t1_caaa, t1_ca, rdm_cccaaa, optimize = einsum_type)
        V1 += V1_p1p
        #print (">> Norm of t1_p1p contribution:                    %20.12f\n" % (np.linalg.norm(V1_p1p)))

########################################################################################################################

    # V1 block: - 1/2 < Psi_0 | a^{\dag}_X a_Y [V + H^{(1)}, T - T^\dag] | Psi_0 >
    V1 = np.zeros((ncas, ncas))
    ## T - T^{\dag}: AAEE
    compute_V1__t1_m2(mr_adc, V1) 
    ## T - T^{\dag}: CAEE
    compute_V1__t1_m1(mr_adc, V1)
    ## T - T^{\dag}: CCEE
    compute_V1__t1_0(mr_adc, V1)
    ## T - T^{\dag}: CCEA
    compute_V1__t1_p1(mr_adc, V1)
    ## T - T^{\dag}: CCAA
    compute_V1__t1_p2(mr_adc, V1) 
    ## T - T^{\dag}: CE-CAEA
    compute_V1__t1_0p(mr_adc, V1)
    ## T - T^{\dag}: AE-AAEA
    compute_V1__t1_m1p(mr_adc, V1)
    ## T - T^{\dag}: CA-CAAA
    compute_V1__t1_p1p(mr_adc, V1)
 
    # V1 block: - 1/2 < Psi_0 | (a^{\dag}_X a_Y - a^{\dag}_Y a_X) [V + H^{(1)}, T - T^\dag] | Psi_0 > 
    V1 -= V1.T

    tril_ind = np.tril_indices(ncas, k=-1)

    V1_sym = V1[tril_ind[0], tril_ind[1]]
    V1_sym = np.stack((V1_sym, V1_sym))
    V1 = V1_sym.reshape(-1) 
    del(V1_sym)

    # Compute denominators
    evals = evals**(-1)
 
    # Compute T[0'']^(2) amplitudes 
    S_12_V_0pp = np.einsum("P,Pm->m", V1, S_0p_12_inv_act)
    S_12_V_0pp = np.einsum("mp,m->p", evecs, S_12_V_0pp)
    S_12_V_0pp *= evals
    S_12_V_0pp = np.einsum("mp,p->m", evecs, S_12_V_0pp)
    del(V1, evals, evecs)

    ## Compute T[0'']^(2) t2_aa tensor
    t_0p = np.einsum("m,Pm->P", S_12_V_0pp, S_0p_12_inv_act)
    t_0p = np.split(t_0p, 2)[0]

    t2_aa = np.zeros((ncas, ncas)) 
    t2_aa[tril_ind[0], tril_ind[1]] += t_0p
    t2_aa[tril_ind[1], tril_ind[0]] -= t_0p
 
    mr_adc.log.extra("Norm of T[0'']^(2):                          %20.12f" % np.linalg.norm(t2_aa))
    mr_adc.log.timer("computing T[0'']^(2) amplitudes", *cput0)

    return t2_aa

