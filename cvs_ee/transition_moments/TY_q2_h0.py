##Q2 TRANSITION MOMENTS
from . import logger

def compute_TY__q2_h0__CA(mr_adc, Y_KW__aa, Y_KW__bb, TY):

    cput1 = (logger.process_clock(), logger.perf_counter())

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type
    
    # Dimensions
    s_c = 0
    f_c = s_c + mr_adc.ncvs
    s_v = f_c
    f_v = s_v + mr_adc.nval
    s_a = f_v
    f_a = s_a + mr_adc.ncas
    s_e = f_a
    f_e = s_e + mr_adc.nextern
 
    ## Amplitudes
    t1_xa = mr_adc.t1.xa
    t1_xe = mr_adc.t1.xe
    t1_va = mr_adc.t1.va
    t1_ve = mr_adc.t1.ve
    t1_ae = mr_adc.t1.ae

    t2_xa = mr_adc.t2.xa
    t2_xe = mr_adc.t2.xe
    t2_va = mr_adc.t2.va
    t2_aa = mr_adc.t2.aa
    t2_ae = mr_adc.t2.ae

    t1_xxaa = mr_adc.t1.xxaa
    t1_xxae = mr_adc.t1.xxae
    t1_xxee = mr_adc.t1.xxee

    t1_xvaa = mr_adc.t1.xvaa
    t1_xvae = mr_adc.t1.xvae
    t1_xvee = mr_adc.t1.xvee

    t1_xaaa = mr_adc.t1.xaaa
    t1_xaae = mr_adc.t1.xaae
    t1_xaea = mr_adc.t1.xaea
    t1_xaee = mr_adc.t1.xaee

    t1_vxaa = mr_adc.t1.vxaa
    t1_vxae = mr_adc.t1.vxae
    t1_vxee = mr_adc.t1.vxee

    t1_vvaa = mr_adc.t1.vvaa
    t1_vvae = mr_adc.t1.vvae
    t1_vvee = mr_adc.t1.vvee

    t1_vaaa = mr_adc.t1.vaaa
    t1_vaae = mr_adc.t1.vaae
    t1_vaea = mr_adc.t1.vaea
    t1_vaee = mr_adc.t1.vaee

    t1_aaae = mr_adc.t1.aaae
    t1_aaee = mr_adc.t1.aaee
    
    # Reduced Density Matrices
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa
    rdm_cccaaa = mr_adc.rdm.cccaaa
    
    temp =- einsum('RPx,Qx->RPQ', Y_KW__aa, t2_xa, optimize = einsum_type)
    temp -= einsum('RPx,Qx->RPQ', Y_KW__bb, t2_xa, optimize = einsum_type)
    temp -= einsum('RPx,Qixa,ia->RPQ', Y_KW__aa, t1_xxae, t1_xe, optimize = einsum_type)
    temp -= einsum('RPx,Qixy,iy->RPQ', Y_KW__aa, t1_xxaa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyx,iy->RPQ', Y_KW__aa, t1_xxaa, t1_xa, optimize = einsum_type)
    temp -= einsum('RPx,Qixa,ia->RPQ', Y_KW__aa, t1_xvae, t1_ve, optimize = einsum_type)
    temp -= einsum('RPx,Qixy,iy->RPQ', Y_KW__aa, t1_xvaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyx,iy->RPQ', Y_KW__aa, t1_xvaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,ia->RPQ', Y_KW__aa, t1_xxae, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixab,Qiab->RPQ', Y_KW__aa, t1_xaee, t1_xxee, optimize = einsum_type)
    temp -= einsum('RPx,ixab,Qiba->RPQ', Y_KW__aa, t1_xaee, t1_xxee, optimize = einsum_type)
    temp -= einsum('RPx,ixay,Qiya->RPQ', Y_KW__aa, t1_xaea, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,iQya->RPQ', Y_KW__aa, t1_xaea, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,Qiya->RPQ', Y_KW__aa, t1_xaae, t1_xxae, optimize = einsum_type)
    temp -= einsum('RPx,ixya,iQya->RPQ', Y_KW__aa, t1_xaae, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qiyz->RPQ', Y_KW__aa, t1_xaaa, t1_xxaa, optimize = einsum_type)
    temp -= einsum('RPx,ixyz,Qizy->RPQ', Y_KW__aa, t1_xaaa, t1_xxaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,ia->RPQ', Y_KW__aa, t1_vxae, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixab,Qiab->RPQ', Y_KW__aa, t1_vaee, t1_xvee, optimize = einsum_type)
    temp -= einsum('RPx,ixab,Qiba->RPQ', Y_KW__aa, t1_vaee, t1_xvee, optimize = einsum_type)
    temp -= einsum('RPx,ixay,Qiya->RPQ', Y_KW__aa, t1_vaea, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,iQya->RPQ', Y_KW__aa, t1_vaea, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,Qiya->RPQ', Y_KW__aa, t1_vaae, t1_xvae, optimize = einsum_type)
    temp -= einsum('RPx,ixya,iQya->RPQ', Y_KW__aa, t1_vaae, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qiyz->RPQ', Y_KW__aa, t1_vaaa, t1_xvaa, optimize = einsum_type)
    temp -= einsum('RPx,ixyz,Qizy->RPQ', Y_KW__aa, t1_vaaa, t1_xvaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xa,Qa->RPQ', Y_KW__aa, t1_ae, t1_xe, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiab,Pxab->RPQ', Y_KW__aa, t1_xxee, t1_xaee, optimize = einsum_type)
    temp += einsum('Rix,Qiab,Pxba->RPQ', Y_KW__aa, t1_xxee, t1_xaee, optimize = einsum_type)
    temp += einsum('Rix,Qixa,Pa->RPQ', Y_KW__aa, t1_xxae, t1_xe, optimize = einsum_type)
    temp += einsum('Rix,Qixy,Py->RPQ', Y_KW__aa, t1_xxaa, t1_xa, optimize = einsum_type)
    temp += einsum('Rix,Qiya,Pxay->RPQ', Y_KW__aa, t1_xxae, t1_xaea, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiya,Pxya->RPQ', Y_KW__aa, t1_xxae, t1_xaae, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiyx,Py->RPQ', Y_KW__aa, t1_xxaa, t1_xa, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiyz,Pxyz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pxzy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iQxa,Pa->RPQ', Y_KW__aa, t1_xxae, t1_xe, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iQya,Pxay->RPQ', Y_KW__aa, t1_xxae, t1_xaea, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pxya->RPQ', Y_KW__aa, t1_xxae, t1_xaae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qy,xy->RPQ', Y_KW__aa, t2_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,Qixa,ia->RPQ', Y_KW__bb, t1_xxae, t1_xe, optimize = einsum_type)
    temp -= einsum('RPx,Qixy,iy->RPQ', Y_KW__bb, t1_xxaa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyx,iy->RPQ', Y_KW__bb, t1_xxaa, t1_xa, optimize = einsum_type)
    temp -= einsum('RPx,Qixa,ia->RPQ', Y_KW__bb, t1_xvae, t1_ve, optimize = einsum_type)
    temp -= einsum('RPx,Qixy,iy->RPQ', Y_KW__bb, t1_xvaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyx,iy->RPQ', Y_KW__bb, t1_xvaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,ia->RPQ', Y_KW__bb, t1_xxae, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixab,Qiab->RPQ', Y_KW__bb, t1_xaee, t1_xxee, optimize = einsum_type)
    temp -= einsum('RPx,ixab,Qiba->RPQ', Y_KW__bb, t1_xaee, t1_xxee, optimize = einsum_type)
    temp -= einsum('RPx,ixay,Qiya->RPQ', Y_KW__bb, t1_xaea, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,iQya->RPQ', Y_KW__bb, t1_xaea, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,Qiya->RPQ', Y_KW__bb, t1_xaae, t1_xxae, optimize = einsum_type)
    temp -= einsum('RPx,ixya,iQya->RPQ', Y_KW__bb, t1_xaae, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qiyz->RPQ', Y_KW__bb, t1_xaaa, t1_xxaa, optimize = einsum_type)
    temp -= einsum('RPx,ixyz,Qizy->RPQ', Y_KW__bb, t1_xaaa, t1_xxaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,ia->RPQ', Y_KW__bb, t1_vxae, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixab,Qiab->RPQ', Y_KW__bb, t1_vaee, t1_xvee, optimize = einsum_type)
    temp -= einsum('RPx,ixab,Qiba->RPQ', Y_KW__bb, t1_vaee, t1_xvee, optimize = einsum_type)
    temp -= einsum('RPx,ixay,Qiya->RPQ', Y_KW__bb, t1_vaea, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,iQya->RPQ', Y_KW__bb, t1_vaea, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,Qiya->RPQ', Y_KW__bb, t1_vaae, t1_xvae, optimize = einsum_type)
    temp -= einsum('RPx,ixya,iQya->RPQ', Y_KW__bb, t1_vaae, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qiyz->RPQ', Y_KW__bb, t1_vaaa, t1_xvaa, optimize = einsum_type)
    temp -= einsum('RPx,ixyz,Qizy->RPQ', Y_KW__bb, t1_vaaa, t1_xvaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xa,Qa->RPQ', Y_KW__bb, t1_ae, t1_xe, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiab,Pxab->RPQ', Y_KW__bb, t1_xxee, t1_xaee, optimize = einsum_type)
    temp += einsum('Rix,Qiab,Pxba->RPQ', Y_KW__bb, t1_xxee, t1_xaee, optimize = einsum_type)
    temp += einsum('Rix,Qixa,Pa->RPQ', Y_KW__bb, t1_xxae, t1_xe, optimize = einsum_type)
    temp += einsum('Rix,Qixy,Py->RPQ', Y_KW__bb, t1_xxaa, t1_xa, optimize = einsum_type)
    temp += einsum('Rix,Qiya,Pxay->RPQ', Y_KW__bb, t1_xxae, t1_xaea, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiya,Pxya->RPQ', Y_KW__bb, t1_xxae, t1_xaae, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiyx,Py->RPQ', Y_KW__bb, t1_xxaa, t1_xa, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiyz,Pxyz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pxzy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iQxa,Pa->RPQ', Y_KW__bb, t1_xxae, t1_xe, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iQya,Pxay->RPQ', Y_KW__bb, t1_xxae, t1_xaea, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pxya->RPQ', Y_KW__bb, t1_xxae, t1_xaae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qy,xy->RPQ', Y_KW__bb, t2_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qa,ya,xy->RPQ', Y_KW__aa, t1_xe, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qa,yzwa,xwzy->RPQ', Y_KW__aa, t1_xe, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiab,iyab,xy->RPQ', Y_KW__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiab,iyba,xy->RPQ', Y_KW__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,Qixa,iyaz,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixa,iyza,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,iz,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,izwu,yzwu->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,izwy,zw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,Qixy,izyw,zw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,ia,xy->RPQ', Y_KW__aa, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,izaw,xwyz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,izay,xz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiya,izwa,xwyz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiya,izya,xz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,iz,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,izwu,yzwu->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,izwy,zw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyx,izyw,zw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iw,xwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuv,xuvyzw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuy,xuwz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuz,xuyw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwyu,xuzw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwyz,xw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iwzu,xuyw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iwzy,xw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iy,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iz,xy->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiab,iyab,xy->RPQ', Y_KW__aa, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiab,iyba,xy->RPQ', Y_KW__aa, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,Qixa,iyaz,yz->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixa,iyza,yz->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,iz,yz->RPQ', Y_KW__aa, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,izwu,yzwu->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,izwy,zw->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,Qixy,izyw,zw->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,ia,xy->RPQ', Y_KW__aa, t1_xvae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,izaw,xwyz->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,izay,xz->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiya,izwa,xwyz->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiya,izya,xz->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,iz,yz->RPQ', Y_KW__aa, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,izwu,yzwu->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,izwy,zw->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyx,izyw,zw->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iw,xwyz->RPQ', Y_KW__aa, t1_xvaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuv,xuvyzw->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuy,xuwz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuz,xuyw->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwyu,xuzw->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwyz,xw->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iwzu,xuyw->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iwzy,xw->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iy,xz->RPQ', Y_KW__aa, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iz,xy->RPQ', Y_KW__aa, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyab,zwab,xyzw->RPQ', Y_KW__aa, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyax,za,yz->RPQ', Y_KW__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyax,zwua,yuwz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyaz,wa,xywz->RPQ', Y_KW__aa, t1_xaea, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyaz,wuva,xyvuwz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPx,Qyaz,wuva,xyvuzw->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyaz,wuva,xyvwuz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyaz,wuva,xyvwzu->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyaz,wuva,xyvzuw->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyaz,wuva,xyvzwu->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyaz,wuza,xyuw->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,Qyxa,za,yz->RPQ', Y_KW__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,Qyxa,zwua,yuwz->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyza,wa,xyzw->RPQ', Y_KW__aa, t1_xaae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyza,wuva,xyvzuw->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyza,wuza,xywu->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,iyaz,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxa,iyza,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,ia,xy->RPQ', Y_KW__aa, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izaw,xwyz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izay,xz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izwa,xwzy->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQya,izya,xz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,Qiza,yz->RPQ', Y_KW__aa, t1_xaea, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixay,iQza,yz->RPQ', Y_KW__aa, t1_xaea, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixya,Qiza,yz->RPQ', Y_KW__aa, t1_xaae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,iQza,yz->RPQ', Y_KW__aa, t1_xaae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiwu,zywu->RPQ', Y_KW__aa, t1_xaaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qiwy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiwz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiyw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qizw,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,iyaz,yz->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxa,iyza,yz->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,ia,xy->RPQ', Y_KW__aa, t1_vxae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izaw,xwyz->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izay,xz->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izwa,xwzy->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQya,izya,xz->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,Qiza,yz->RPQ', Y_KW__aa, t1_vaea, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixay,iQza,yz->RPQ', Y_KW__aa, t1_vaea, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixya,Qiza,yz->RPQ', Y_KW__aa, t1_vaae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,iQza,yz->RPQ', Y_KW__aa, t1_vaae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiwu,zywu->RPQ', Y_KW__aa, t1_vaaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qiwy,zw->RPQ', Y_KW__aa, t1_vaaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiwz,yw->RPQ', Y_KW__aa, t1_vaaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiyw,zw->RPQ', Y_KW__aa, t1_vaaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qizw,yw->RPQ', Y_KW__aa, t1_vaaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xa,Qyaz,yz->RPQ', Y_KW__aa, t1_ae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xa,Qyza,yz->RPQ', Y_KW__aa, t1_ae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xyab,Qzab,yz->RPQ', Y_KW__aa, t1_aaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyab,Qzba,yz->RPQ', Y_KW__aa, t1_aaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qa,yz->RPQ', Y_KW__aa, t1_aaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qwau,yuzw->RPQ', Y_KW__aa, t1_aaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qwaz,yw->RPQ', Y_KW__aa, t1_aaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qwua,yuwz->RPQ', Y_KW__aa, t1_aaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xyza,Qwza,yw->RPQ', Y_KW__aa, t1_aaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yxza,Qa,yz->RPQ', Y_KW__aa, t1_aaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yxza,Qwau,yuzw->RPQ', Y_KW__aa, t1_aaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yxza,Qwaz,yw->RPQ', Y_KW__aa, t1_aaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yxza,Qwua,yuzw->RPQ', Y_KW__aa, t1_aaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yxza,Qwza,yw->RPQ', Y_KW__aa, t1_aaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiab,Pyab,xy->RPQ', Y_KW__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiab,Pyba,xy->RPQ', Y_KW__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qixa,Pyaz,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixa,Pyza,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixy,Pz,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixy,Pzwu,yzwu->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixy,Pzwy,zw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qixy,Pzyw,zw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pa,xy->RPQ', Y_KW__aa, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pxaz,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiya,Pxza,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pzaw,xwyz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pzay,xz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pzwa,xwzy->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiya,Pzya,xz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyx,Pz,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyx,Pzwu,yzwu->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyx,Pzwy,zw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiyx,Pzyw,zw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pw,xwzy->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvwzy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvywz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvyzw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvzwy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/3 * einsum('Rix,Qiyz,Pwuv,xuvzyw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwuy,xuzw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwuz,xuwy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pwyu,xuzw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pwyz,xw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwzu,xuyw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwzy,xw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pxwu,yzwu->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pxwy,zw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pxwz,yw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pxyw,zw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pxzw,yw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Py,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pz,xy->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iQxa,Pyaz,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQxa,Pyza,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pa,xy->RPQ', Y_KW__aa, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pxaz,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,Pxza,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pzaw,xwyz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pzay,xz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,Pzwa,xwyz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,Pzya,xz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qa,ya,xy->RPQ', Y_KW__bb, t1_xe, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qa,yzwa,xwzy->RPQ', Y_KW__bb, t1_xe, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiab,iyab,xy->RPQ', Y_KW__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiab,iyba,xy->RPQ', Y_KW__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,Qixa,iyaz,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixa,iyza,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,iz,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,izwu,yzwu->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,izwy,zw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,Qixy,izyw,zw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,ia,xy->RPQ', Y_KW__bb, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,izaw,xwyz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,izay,xz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiya,izwa,xwyz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiya,izya,xz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,iz,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,izwu,yzwu->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,izwy,zw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyx,izyw,zw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iw,xwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuv,xuvyzw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuy,xuwz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuz,xuyw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwyu,xuzw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwyz,xw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iwzu,xuyw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iwzy,xw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iy,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iz,xy->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiab,iyab,xy->RPQ', Y_KW__bb, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiab,iyba,xy->RPQ', Y_KW__bb, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,Qixa,iyaz,yz->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixa,iyza,yz->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,iz,yz->RPQ', Y_KW__bb, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,izwu,yzwu->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,izwy,zw->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,Qixy,izyw,zw->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,ia,xy->RPQ', Y_KW__bb, t1_xvae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,izaw,xwyz->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,izay,xz->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiya,izwa,xwyz->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiya,izya,xz->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,iz,yz->RPQ', Y_KW__bb, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,izwu,yzwu->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,izwy,zw->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyx,izyw,zw->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iw,xwyz->RPQ', Y_KW__bb, t1_xvaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuv,xuvyzw->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuy,xuwz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuz,xuyw->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwyu,xuzw->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwyz,xw->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iwzu,xuyw->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iwzy,xw->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iy,xz->RPQ', Y_KW__bb, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iz,xy->RPQ', Y_KW__bb, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyab,zwab,xyzw->RPQ', Y_KW__bb, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyax,za,yz->RPQ', Y_KW__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyax,zwua,yuwz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyaz,wa,xywz->RPQ', Y_KW__bb, t1_xaea, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyaz,wuva,xyvuwz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPx,Qyaz,wuva,xyvuzw->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyaz,wuva,xyvwuz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyaz,wuva,xyvwzu->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyaz,wuva,xyvzuw->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyaz,wuva,xyvzwu->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyaz,wuza,xyuw->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,Qyxa,za,yz->RPQ', Y_KW__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,Qyxa,zwua,yuwz->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyza,wa,xyzw->RPQ', Y_KW__bb, t1_xaae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyza,wuva,xyvzuw->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyza,wuza,xywu->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,iyaz,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxa,iyza,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,ia,xy->RPQ', Y_KW__bb, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izaw,xwyz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izay,xz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izwa,xwzy->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQya,izya,xz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,Qiza,yz->RPQ', Y_KW__bb, t1_xaea, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixay,iQza,yz->RPQ', Y_KW__bb, t1_xaea, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixya,Qiza,yz->RPQ', Y_KW__bb, t1_xaae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,iQza,yz->RPQ', Y_KW__bb, t1_xaae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiwu,zywu->RPQ', Y_KW__bb, t1_xaaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qiwy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiwz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiyw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qizw,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,iyaz,yz->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxa,iyza,yz->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,ia,xy->RPQ', Y_KW__bb, t1_vxae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izaw,xwyz->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izay,xz->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izwa,xwzy->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQya,izya,xz->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,Qiza,yz->RPQ', Y_KW__bb, t1_vaea, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixay,iQza,yz->RPQ', Y_KW__bb, t1_vaea, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixya,Qiza,yz->RPQ', Y_KW__bb, t1_vaae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,iQza,yz->RPQ', Y_KW__bb, t1_vaae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiwu,zywu->RPQ', Y_KW__bb, t1_vaaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qiwy,zw->RPQ', Y_KW__bb, t1_vaaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiwz,yw->RPQ', Y_KW__bb, t1_vaaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiyw,zw->RPQ', Y_KW__bb, t1_vaaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qizw,yw->RPQ', Y_KW__bb, t1_vaaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xa,Qyaz,yz->RPQ', Y_KW__bb, t1_ae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xa,Qyza,yz->RPQ', Y_KW__bb, t1_ae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xyab,Qzab,yz->RPQ', Y_KW__bb, t1_aaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyab,Qzba,yz->RPQ', Y_KW__bb, t1_aaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qa,yz->RPQ', Y_KW__bb, t1_aaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qwau,yuzw->RPQ', Y_KW__bb, t1_aaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qwaz,yw->RPQ', Y_KW__bb, t1_aaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qwua,yuwz->RPQ', Y_KW__bb, t1_aaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xyza,Qwza,yw->RPQ', Y_KW__bb, t1_aaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yxza,Qa,yz->RPQ', Y_KW__bb, t1_aaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yxza,Qwau,yuzw->RPQ', Y_KW__bb, t1_aaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yxza,Qwaz,yw->RPQ', Y_KW__bb, t1_aaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yxza,Qwua,yuzw->RPQ', Y_KW__bb, t1_aaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yxza,Qwza,yw->RPQ', Y_KW__bb, t1_aaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiab,Pyab,xy->RPQ', Y_KW__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiab,Pyba,xy->RPQ', Y_KW__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qixa,Pyaz,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixa,Pyza,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixy,Pz,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixy,Pzwu,yzwu->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixy,Pzwy,zw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qixy,Pzyw,zw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pa,xy->RPQ', Y_KW__bb, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pxaz,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiya,Pxza,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pzaw,xwyz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pzay,xz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pzwa,xwzy->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiya,Pzya,xz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyx,Pz,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyx,Pzwu,yzwu->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyx,Pzwy,zw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiyx,Pzyw,zw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pw,xwzy->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvwzy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvywz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvyzw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvzwy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/3 * einsum('Rix,Qiyz,Pwuv,xuvzyw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwuy,xuzw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwuz,xuwy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pwyu,xuzw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pwyz,xw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwzu,xuyw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwzy,xw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pxwu,yzwu->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pxwy,zw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pxwz,yw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pxyw,zw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pxzw,yw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Py,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pz,xy->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iQxa,Pyaz,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQxa,Pyza,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pa,xy->RPQ', Y_KW__bb, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pxaz,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,Pxza,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pzaw,xwyz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pzay,xz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,Pzwa,xwyz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,Pzya,xz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    TY[:, s_c:f_c, s_c:f_c] += temp   
 
    temp =- 2 * einsum('Rix,Qiab,Pxab->RPQ', Y_KW__aa, t1_vxee, t1_vaee, optimize = einsum_type)
    temp += einsum('Rix,Qiab,Pxba->RPQ', Y_KW__aa, t1_vxee, t1_vaee, optimize = einsum_type)
    temp += einsum('Rix,Qixa,Pa->RPQ', Y_KW__aa, t1_vxae, t1_ve, optimize = einsum_type)
    temp += einsum('Rix,Qixy,Py->RPQ', Y_KW__aa, t1_vxaa, t1_va, optimize = einsum_type)
    temp += einsum('Rix,Qiya,Pxay->RPQ', Y_KW__aa, t1_vxae, t1_vaea, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiya,Pxya->RPQ', Y_KW__aa, t1_vxae, t1_vaae, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiyx,Py->RPQ', Y_KW__aa, t1_vxaa, t1_va, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiyz,Pxyz->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pxzy->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iQxa,Pa->RPQ', Y_KW__aa, t1_xvae, t1_ve, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iQya,Pxay->RPQ', Y_KW__aa, t1_xvae, t1_vaea, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pxya->RPQ', Y_KW__aa, t1_xvae, t1_vaae, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiab,Pxab->RPQ', Y_KW__bb, t1_vxee, t1_vaee, optimize = einsum_type)
    temp += einsum('Rix,Qiab,Pxba->RPQ', Y_KW__bb, t1_vxee, t1_vaee, optimize = einsum_type)
    temp += einsum('Rix,Qixa,Pa->RPQ', Y_KW__bb, t1_vxae, t1_ve, optimize = einsum_type)
    temp += einsum('Rix,Qixy,Py->RPQ', Y_KW__bb, t1_vxaa, t1_va, optimize = einsum_type)
    temp += einsum('Rix,Qiya,Pxay->RPQ', Y_KW__bb, t1_vxae, t1_vaea, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiya,Pxya->RPQ', Y_KW__bb, t1_vxae, t1_vaae, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiyx,Py->RPQ', Y_KW__bb, t1_vxaa, t1_va, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiyz,Pxyz->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pxzy->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iQxa,Pa->RPQ', Y_KW__bb, t1_xvae, t1_ve, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iQya,Pxay->RPQ', Y_KW__bb, t1_xvae, t1_vaea, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pxya->RPQ', Y_KW__bb, t1_xvae, t1_vaae, optimize = einsum_type)
    temp += einsum('Rix,Qiab,Pyab,xy->RPQ', Y_KW__aa, t1_vxee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiab,Pyba,xy->RPQ', Y_KW__aa, t1_vxee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qixa,Pyaz,yz->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixa,Pyza,yz->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixy,Pz,yz->RPQ', Y_KW__aa, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixy,Pzwu,yzwu->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixy,Pzwy,zw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qixy,Pzyw,zw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pa,xy->RPQ', Y_KW__aa, t1_vxae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pxaz,yz->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiya,Pxza,yz->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pzaw,xwyz->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pzay,xz->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pzwa,xwzy->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiya,Pzya,xz->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyx,Pz,yz->RPQ', Y_KW__aa, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyx,Pzwu,yzwu->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyx,Pzwy,zw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiyx,Pzyw,zw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pw,xwzy->RPQ', Y_KW__aa, t1_vxaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvwyz->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvwzy->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvywz->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvyzw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvzwy->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/3 * einsum('Rix,Qiyz,Pwuv,xuvzyw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwuy,xuzw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwuz,xuwy->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pwyu,xuzw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pwyz,xw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwzu,xuyw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwzy,xw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pxwu,yzwu->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pxwy,zw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pxwz,yw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pxyw,zw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pxzw,yw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Py,xz->RPQ', Y_KW__aa, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pz,xy->RPQ', Y_KW__aa, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iQxa,Pyaz,yz->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQxa,Pyza,yz->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pa,xy->RPQ', Y_KW__aa, t1_xvae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pxaz,yz->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,Pxza,yz->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pzaw,xwyz->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pzay,xz->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,Pzwa,xwyz->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,Pzya,xz->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiab,Pyab,xy->RPQ', Y_KW__bb, t1_vxee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiab,Pyba,xy->RPQ', Y_KW__bb, t1_vxee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qixa,Pyaz,yz->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixa,Pyza,yz->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixy,Pz,yz->RPQ', Y_KW__bb, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixy,Pzwu,yzwu->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixy,Pzwy,zw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qixy,Pzyw,zw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pa,xy->RPQ', Y_KW__bb, t1_vxae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pxaz,yz->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiya,Pxza,yz->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pzaw,xwyz->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pzay,xz->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pzwa,xwzy->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiya,Pzya,xz->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyx,Pz,yz->RPQ', Y_KW__bb, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyx,Pzwu,yzwu->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyx,Pzwy,zw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiyx,Pzyw,zw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pw,xwzy->RPQ', Y_KW__bb, t1_vxaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvwyz->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvwzy->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvywz->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvyzw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvzwy->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/3 * einsum('Rix,Qiyz,Pwuv,xuvzyw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwuy,xuzw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwuz,xuwy->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pwyu,xuzw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pwyz,xw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwzu,xuyw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwzy,xw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pxwu,yzwu->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pxwy,zw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pxwz,yw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pxyw,zw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pxzw,yw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Py,xz->RPQ', Y_KW__bb, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pz,xy->RPQ', Y_KW__bb, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iQxa,Pyaz,yz->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQxa,Pyza,yz->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pa,xy->RPQ', Y_KW__bb, t1_xvae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pxaz,yz->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,Pxza,yz->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pzaw,xwyz->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pzay,xz->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,Pzwa,xwyz->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,Pzya,xz->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    TY[:, s_v:f_v, s_v:f_v] += temp   
 
    temp  = einsum('RiQ,iP->RPQ', Y_KW__aa, t2_xa, optimize = einsum_type)
    temp += einsum('RiQ,iP->RPQ', Y_KW__bb, t2_xa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,Pa->RPQ', Y_KW__aa, t1_xe, t1_ae, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,ja->RPQ', Y_KW__aa, t1_xxae, t1_xe, optimize = einsum_type)
    temp += einsum('RiQ,ijPx,jx->RPQ', Y_KW__aa, t1_xxaa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,jPab->RPQ', Y_KW__aa, t1_xxee, t1_xaee, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,jPba->RPQ', Y_KW__aa, t1_xxee, t1_xaee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,jPax->RPQ', Y_KW__aa, t1_xxae, t1_xaea, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KW__aa, t1_xxae, t1_xaae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPxy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,jPyx->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,ja->RPQ', Y_KW__aa, t1_xvae, t1_ve, optimize = einsum_type)
    temp += einsum('RiQ,ijPx,jx->RPQ', Y_KW__aa, t1_xvaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,jPab->RPQ', Y_KW__aa, t1_xvee, t1_vaee, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,jPba->RPQ', Y_KW__aa, t1_xvee, t1_vaee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,jPax->RPQ', Y_KW__aa, t1_xvae, t1_vaea, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KW__aa, t1_xvae, t1_vaae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPxy->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,jPyx->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KW__aa, t1_xxae, t1_xe, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPx,jx->RPQ', Y_KW__aa, t1_xxaa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPax->RPQ', Y_KW__aa, t1_xxae, t1_xaea, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KW__aa, t1_xxae, t1_xaae, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KW__aa, t1_vxae, t1_ve, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPx,jx->RPQ', Y_KW__aa, t1_vxaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPax->RPQ', Y_KW__aa, t1_vxae, t1_vaea, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KW__aa, t1_vxae, t1_vaae, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jxQa->RPQ', Y_KW__aa, t1_xxae, t1_xaae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPa,jxaQ->RPQ', Y_KW__aa, t1_xxae, t1_xaea, optimize = einsum_type)
    temp -= einsum('Rix,ijPx,jQ->RPQ', Y_KW__aa, t1_xxaa, t1_xa, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jxQy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPy,jxyQ->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jxQa->RPQ', Y_KW__aa, t1_xvae, t1_vaae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPa,jxaQ->RPQ', Y_KW__aa, t1_xvae, t1_vaea, optimize = einsum_type)
    temp -= einsum('Rix,ijPx,jQ->RPQ', Y_KW__aa, t1_xvaa, t1_va, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jxQy->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPy,jxyQ->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPa,jxQa->RPQ', Y_KW__aa, t1_xxae, t1_xaae, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jxaQ->RPQ', Y_KW__aa, t1_xxae, t1_xaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPx,jQ->RPQ', Y_KW__aa, t1_xxaa, t1_xa, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPy,jxQy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jxyQ->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPa,jxQa->RPQ', Y_KW__aa, t1_vxae, t1_vaae, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jxaQ->RPQ', Y_KW__aa, t1_vxae, t1_vaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPx,jQ->RPQ', Y_KW__aa, t1_vxaa, t1_va, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPy,jxQy->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jxyQ->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iP,Qx->RPQ', Y_KW__aa, t2_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,Pa->RPQ', Y_KW__bb, t1_xe, t1_ae, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,ja->RPQ', Y_KW__bb, t1_xxae, t1_xe, optimize = einsum_type)
    temp += einsum('RiQ,ijPx,jx->RPQ', Y_KW__bb, t1_xxaa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,jPab->RPQ', Y_KW__bb, t1_xxee, t1_xaee, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,jPba->RPQ', Y_KW__bb, t1_xxee, t1_xaee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,jPax->RPQ', Y_KW__bb, t1_xxae, t1_xaea, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KW__bb, t1_xxae, t1_xaae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPxy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,jPyx->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,ja->RPQ', Y_KW__bb, t1_xvae, t1_ve, optimize = einsum_type)
    temp += einsum('RiQ,ijPx,jx->RPQ', Y_KW__bb, t1_xvaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,jPab->RPQ', Y_KW__bb, t1_xvee, t1_vaee, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,jPba->RPQ', Y_KW__bb, t1_xvee, t1_vaee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,jPax->RPQ', Y_KW__bb, t1_xvae, t1_vaea, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KW__bb, t1_xvae, t1_vaae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPxy->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,jPyx->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KW__bb, t1_xxae, t1_xe, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPx,jx->RPQ', Y_KW__bb, t1_xxaa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPax->RPQ', Y_KW__bb, t1_xxae, t1_xaea, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KW__bb, t1_xxae, t1_xaae, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KW__bb, t1_vxae, t1_ve, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPx,jx->RPQ', Y_KW__bb, t1_vxaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPax->RPQ', Y_KW__bb, t1_vxae, t1_vaea, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KW__bb, t1_vxae, t1_vaae, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jxQa->RPQ', Y_KW__bb, t1_xxae, t1_xaae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPa,jxaQ->RPQ', Y_KW__bb, t1_xxae, t1_xaea, optimize = einsum_type)
    temp -= einsum('Rix,ijPx,jQ->RPQ', Y_KW__bb, t1_xxaa, t1_xa, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jxQy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPy,jxyQ->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jxQa->RPQ', Y_KW__bb, t1_xvae, t1_vaae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPa,jxaQ->RPQ', Y_KW__bb, t1_xvae, t1_vaea, optimize = einsum_type)
    temp -= einsum('Rix,ijPx,jQ->RPQ', Y_KW__bb, t1_xvaa, t1_va, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jxQy->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPy,jxyQ->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPa,jxQa->RPQ', Y_KW__bb, t1_xxae, t1_xaae, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jxaQ->RPQ', Y_KW__bb, t1_xxae, t1_xaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPx,jQ->RPQ', Y_KW__bb, t1_xxaa, t1_xa, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPy,jxQy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jxyQ->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPa,jxQa->RPQ', Y_KW__bb, t1_vxae, t1_vaae, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jxaQ->RPQ', Y_KW__bb, t1_vxae, t1_vaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPx,jQ->RPQ', Y_KW__bb, t1_vxaa, t1_va, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPy,jxQy->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jxyQ->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iP,Qx->RPQ', Y_KW__bb, t2_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ia,Pxya,xy->RPQ', Y_KW__aa, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,xPya,xy->RPQ', Y_KW__aa, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jy,xy->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,ijPx,jyxz,zy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jyzw,xyzw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jyzx,zy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPay,xy->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPxz,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPyz,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPzw,xywz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPzx,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPzy,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jy,xy->RPQ', Y_KW__aa, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,ijPx,jyxz,zy->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jyzw,xyzw->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jyzx,zy->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPay,xy->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPxz,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPyz,xz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPzw,xywz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPzx,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPzy,xz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ixPa,ya,xy->RPQ', Y_KW__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ixPa,yzwa,xwzy->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixaP,ya,xy->RPQ', Y_KW__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixaP,yzwa,xwzy->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixab,Pyab,xy->RPQ', Y_KW__aa, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixab,Pyba,xy->RPQ', Y_KW__aa, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pa,xy->RPQ', Y_KW__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzwa,xwyz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzya,xz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,zPwa,xwyz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,zPya,xz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pa,xy->RPQ', Y_KW__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzwa,xwzy->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixya,Pzya,xz->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,zPwa,xwyz->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,zPya,xz->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jy,xy->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPx,jyxz,zy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jyzw,xyzw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jyzx,zy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,jPay,xy->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jy,xy->RPQ', Y_KW__aa, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPx,jyxz,zy->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jyzw,xyzw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jyzx,zy->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,jPay,xy->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQab,xyab,Py->RPQ', Y_KW__aa, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQab,xyba,Py->RPQ', Y_KW__aa, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQab,yzba,Pxyz->RPQ', Y_KW__aa, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQax,ya,Py->RPQ', Y_KW__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQax,yzwa,Pwzy->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQay,xa,Py->RPQ', Y_KW__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQay,xzwa,Pwyz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQay,xzya,Pz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQay,za,Pxyz->RPQ', Y_KW__aa, t1_xaea, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iQay,zwua,Pxuwyz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iQay,zwua,Pxuwzy->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iQay,zwua,Pxuywz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iQay,zwua,Pxuyzw->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iQay,zwua,Pxuzwy->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iQay,zwua,Pxuzyw->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQay,zwya,Pxzw->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQay,zxwa,Pwyz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQay,zxya,Pz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQxa,ya,Py->RPQ', Y_KW__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQxa,yzwa,Pwzy->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQya,xa,Py->RPQ', Y_KW__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQya,xzwa,Pwzy->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,xzya,Pz->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQya,za,Pxzy->RPQ', Y_KW__aa, t1_xaae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQya,zwua,Pxuwyz->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQya,zwya,Pxwz->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQya,zxwa,Pwyz->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQya,zxya,Pz->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pa,Qx->RPQ', Y_KW__aa, t1_xe, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,Pxya,Qy->RPQ', Y_KW__aa, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pyza,Qyzx->RPQ', Y_KW__aa, t1_xe, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,xPya,Qy->RPQ', Y_KW__aa, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ia,xyQa,Py->RPQ', Y_KW__aa, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,yPza,Qyxz->RPQ', Y_KW__aa, t1_xe, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ia,yxQa,Py->RPQ', Y_KW__aa, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ia,yzQa,Pxyz->RPQ', Y_KW__aa, t1_xe, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPa,ja,Qx->RPQ', Y_KW__aa, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPa,jxay,Qy->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPa,jxya,Qy->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPa,jyQa,xy->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jyaQ,xy->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPa,jyaz,Qyxz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPa,jyza,Qyxz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPx,jy,Qy->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPx,jyQz,zy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPx,jyzQ,zy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPx,jyzw,Qyzw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jQ,xy->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jxQz,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPy,jxyz,Qz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jxzQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jxzw,Qywz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jxzy,Qz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPy,jy,Qx->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jz,Qyxz->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzQw,xwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzQy,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzwQ,xwzy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jzwu,Qyzxwu->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jzwy,Qzxw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jzyQ,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPy,jzyw,Qzxw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijab,jPab,Qx->RPQ', Y_KW__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijab,jPba,Qx->RPQ', Y_KW__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,jPay,Qy->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxa,jPya,Qy->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxa,jyQa,Py->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,ijxa,jyaQ,Py->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,jPyz,Qz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,jPzw,Qywz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,jPzy,Qz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jQ,Py->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzQw,Pwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzQy,Pz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzwQ,Pwzy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,ijxy,jzyQ,Pz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,jPay,Qx->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,jPaz,Qyzx->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPya,Qx->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPza,Qyzx->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijya,jxQa,Py->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijya,jxaQ,Py->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijya,jzQa,Pxzy->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijya,jzaQ,Pxzy->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,jPyz,Qz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,jPzw,Qywz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,jPzy,Qz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jQ,Py->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzQw,Pwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzQy,Pz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzwQ,Pwzy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyx,jzyQ,Pz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPwu,Qyzuxw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPwy,Qzxw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPwz,Qywx->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPyw,Qzwx->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPyz,Qx->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPzw,Qywx->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPzy,Qx->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jQ,Pxzy->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuwzy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuywz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuyzw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuzwy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,ijyz,jwQu,Pxuzyw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwQy,Pxzw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwQz,Pxwy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwuQ,Pxuwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwyQ,Pxwz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jwzQ,Pxwy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxQw,Pwzy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jxQy,Pz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxQz,Py->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxwQ,Pwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxyQ,Pz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jxzQ,Py->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPa,ja,Qx->RPQ', Y_KW__aa, t1_xvae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPa,jxay,Qy->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPa,jxya,Qy->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPa,jyQa,xy->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jyaQ,xy->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPa,jyaz,Qyxz->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPa,jyza,Qyxz->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPx,jy,Qy->RPQ', Y_KW__aa, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPx,jyQz,zy->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPx,jyzQ,zy->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPx,jyzw,Qyzw->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jQ,xy->RPQ', Y_KW__aa, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jxQz,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPy,jxyz,Qz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jxzQ,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jxzw,Qywz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jxzy,Qz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPy,jy,Qx->RPQ', Y_KW__aa, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jz,Qyxz->RPQ', Y_KW__aa, t1_xvaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzQw,xwyz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzQy,xz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzwQ,xwzy->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jzwu,Qyzxwu->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jzwy,Qzxw->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jzyQ,xz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPy,jzyw,Qzxw->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijab,jPab,Qx->RPQ', Y_KW__aa, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijab,jPba,Qx->RPQ', Y_KW__aa, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,jPay,Qy->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxa,jPya,Qy->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxa,jyQa,Py->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,ijxa,jyaQ,Py->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,jPyz,Qz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,jPzw,Qywz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,jPzy,Qz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jQ,Py->RPQ', Y_KW__aa, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzQw,Pwyz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzQy,Pz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzwQ,Pwzy->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,ijxy,jzyQ,Pz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,jPay,Qx->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,jPaz,Qyzx->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPya,Qx->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPza,Qyzx->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijya,jxQa,Py->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijya,jxaQ,Py->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijya,jzQa,Pxzy->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijya,jzaQ,Pxzy->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,jPyz,Qz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,jPzw,Qywz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,jPzy,Qz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jQ,Py->RPQ', Y_KW__aa, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzQw,Pwyz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzQy,Pz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzwQ,Pwzy->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyx,jzyQ,Pz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPwu,Qyzuxw->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPwy,Qzxw->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPwz,Qywx->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPyw,Qzwx->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPyz,Qx->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPzw,Qywx->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPzy,Qx->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jQ,Pxzy->RPQ', Y_KW__aa, t1_xvaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuwyz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuwzy->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuywz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuyzw->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuzwy->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,ijyz,jwQu,Pxuzyw->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwQy,Pxzw->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwQz,Pxwy->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwuQ,Pxuwyz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwyQ,Pxwz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jwzQ,Pxwy->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxQw,Pwzy->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jxQy,Pz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxQz,Py->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxwQ,Pwyz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxyQ,Pz->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jxzQ,Py->RPQ', Y_KW__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyPa,xa,Qy->RPQ', Y_KW__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyPa,xzQa,yz->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyPa,xzwa,Qzwy->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyPa,za,Qzxy->RPQ', Y_KW__aa, t1_xaae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPa,zwQa,xyzw->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyPa,zwua,Qwzuxy->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyPa,zwua,Qwzuyx->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyPa,zwua,Qwzxuy->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyPa,zwua,Qwzxyu->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyPa,zwua,Qwzyux->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyPa,zwua,Qwzyxu->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPa,zxQa,yz->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyPa,zxwa,Qzyw->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyaP,xa,Qy->RPQ', Y_KW__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaP,xzQa,yz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyaP,xzwa,Qzyw->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyaP,za,Qzyx->RPQ', Y_KW__aa, t1_xaea, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaP,zwQa,xywz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyaP,zwua,Qwzyxu->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += einsum('Rix,iyaP,zxQa,yz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyaP,zxwa,Qzyw->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyab,Pxab,Qy->RPQ', Y_KW__aa, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyab,Pxba,Qy->RPQ', Y_KW__aa, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyab,Pzab,Qzxy->RPQ', Y_KW__aa, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyab,Pzba,Qzyx->RPQ', Y_KW__aa, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,Pa,Qy->RPQ', Y_KW__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,Pzwa,Qzwy->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,zPwa,Qzyw->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyax,zwQa,Pyzw->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pa,Qzxy->RPQ', Y_KW__aa, t1_xaea, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwuxy->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyaz,Pwua,Qzwuyx->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwxuy->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwxyu->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwyux->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwyxu->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pwza,Qwyx->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,Pxwa,Qzwy->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,Pxza,Qy->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,wPua,Qzwxyu->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,wPza,Qwxy->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyaz,wuQa,Pxywuz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyaz,wxQa,Pywz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,xPwa,Qzwy->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,xPza,Qy->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyaz,xwQa,Pywz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,Pa,Qy->RPQ', Y_KW__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,Pzwa,Qzwy->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,zPwa,Qzyw->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxa,zwQa,Pyzw->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pa,Qzyx->RPQ', Y_KW__aa, t1_xaae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pwua,Qzwuxy->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pwza,Qwxy->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pxwa,Qzwy->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pxza,Qy->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,wPua,Qzwuxy->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,wPua,Qzwuyx->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,wPua,Qzwxuy->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,wPua,Qzwxyu->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,wPua,Qzwyux->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyza,wPua,Qzwyxu->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,wPza,Qwyx->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyza,wuQa,Pxyuwz->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyza,wuQa,Pxyuzw->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyza,wuQa,Pxywuz->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyza,wuQa,Pxywzu->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyza,wuQa,Pxyzuw->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyza,wuQa,Pxyzwu->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyza,wxQa,Pywz->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,xPwa,Qzyw->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,xPza,Qy->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyza,xwQa,Pyzw->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPa,ja,Qx->RPQ', Y_KW__aa, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPa,jxay,Qy->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiPa,jxya,Qy->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jyQa,xy->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPa,jyaQ,xy->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPa,jyaz,Qyxz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPa,jyza,Qyzx->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiPx,jy,Qy->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPx,jyQz,zy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPx,jyzQ,zy->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiPx,jyzw,Qyzw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jQ,xy->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jxQz,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jxyz,Qz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jxzQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jxzw,Qyzw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiPy,jxzy,Qz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jy,Qx->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jz,Qyzx->RPQ', Y_KW__aa, t1_xxaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jzQw,xwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jzQy,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jzwQ,xwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzuwx->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzuxw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzwux->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,jiPy,jzwu,Qyzwxu->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzxuw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzxwu->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jzwy,Qzwx->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jzyQ,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jzyw,Qzxw->RPQ', Y_KW__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,jPay,Qy->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jixa,jPya,Qy->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jixa,jyQa,Py->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jixa,jyaQ,Py->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPay,Qx->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPaz,Qyzx->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,jPya,Qx->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPza,Qyxz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiya,jxQa,Py->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jxaQ,Py->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jzQa,Pxyz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jzaQ,Pxzy->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPa,ja,Qx->RPQ', Y_KW__aa, t1_vxae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPa,jxay,Qy->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiPa,jxya,Qy->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jyQa,xy->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPa,jyaQ,xy->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPa,jyaz,Qyxz->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPa,jyza,Qyzx->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiPx,jy,Qy->RPQ', Y_KW__aa, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPx,jyQz,zy->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPx,jyzQ,zy->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiPx,jyzw,Qyzw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jQ,xy->RPQ', Y_KW__aa, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jxQz,yz->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jxyz,Qz->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jxzQ,yz->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jxzw,Qyzw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiPy,jxzy,Qz->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jy,Qx->RPQ', Y_KW__aa, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jz,Qyzx->RPQ', Y_KW__aa, t1_vxaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jzQw,xwyz->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jzQy,xz->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jzwQ,xwyz->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzuwx->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzuxw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzwux->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,jiPy,jzwu,Qyzwxu->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzxuw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzxwu->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jzwy,Qzwx->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jzyQ,xz->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jzyw,Qzxw->RPQ', Y_KW__aa, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,jPay,Qy->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jixa,jPya,Qy->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jixa,jyQa,Py->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jixa,jyaQ,Py->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPay,Qx->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPaz,Qyzx->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,jPya,Qx->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPza,Qyxz->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiya,jxQa,Py->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jxaQ,Py->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jzQa,Pxyz->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jzaQ,Pxzy->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ia,Pxya,xy->RPQ', Y_KW__bb, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,xPya,xy->RPQ', Y_KW__bb, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jy,xy->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,ijPx,jyxz,zy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jyzw,xyzw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jyzx,zy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPay,xy->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPxz,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPyz,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPzw,xywz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPzx,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPzy,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jy,xy->RPQ', Y_KW__bb, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,ijPx,jyxz,zy->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jyzw,xyzw->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jyzx,zy->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPay,xy->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPxz,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPyz,xz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPzw,xywz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPzx,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPzy,xz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ixPa,ya,xy->RPQ', Y_KW__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ixPa,yzwa,xwzy->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixaP,ya,xy->RPQ', Y_KW__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixaP,yzwa,xwzy->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixab,Pyab,xy->RPQ', Y_KW__bb, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixab,Pyba,xy->RPQ', Y_KW__bb, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pa,xy->RPQ', Y_KW__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzwa,xwyz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzya,xz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,zPwa,xwyz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,zPya,xz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pa,xy->RPQ', Y_KW__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzwa,xwzy->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixya,Pzya,xz->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,zPwa,xwyz->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,zPya,xz->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jy,xy->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPx,jyxz,zy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jyzw,xyzw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jyzx,zy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,jPay,xy->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jy,xy->RPQ', Y_KW__bb, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPx,jyxz,zy->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jyzw,xyzw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jyzx,zy->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,jPay,xy->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQab,xyab,Py->RPQ', Y_KW__bb, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQab,xyba,Py->RPQ', Y_KW__bb, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQab,yzba,Pxyz->RPQ', Y_KW__bb, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQax,ya,Py->RPQ', Y_KW__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQax,yzwa,Pwzy->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQay,xa,Py->RPQ', Y_KW__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQay,xzwa,Pwyz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQay,xzya,Pz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQay,za,Pxyz->RPQ', Y_KW__bb, t1_xaea, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iQay,zwua,Pxuwyz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iQay,zwua,Pxuwzy->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iQay,zwua,Pxuywz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iQay,zwua,Pxuyzw->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iQay,zwua,Pxuzwy->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iQay,zwua,Pxuzyw->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQay,zwya,Pxzw->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQay,zxwa,Pwyz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQay,zxya,Pz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQxa,ya,Py->RPQ', Y_KW__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQxa,yzwa,Pwzy->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQya,xa,Py->RPQ', Y_KW__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQya,xzwa,Pwzy->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,xzya,Pz->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQya,za,Pxzy->RPQ', Y_KW__bb, t1_xaae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQya,zwua,Pxuwyz->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQya,zwya,Pxwz->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQya,zxwa,Pwyz->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iQya,zxya,Pz->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pa,Qx->RPQ', Y_KW__bb, t1_xe, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,Pxya,Qy->RPQ', Y_KW__bb, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pyza,Qyzx->RPQ', Y_KW__bb, t1_xe, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,xPya,Qy->RPQ', Y_KW__bb, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ia,xyQa,Py->RPQ', Y_KW__bb, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,yPza,Qyxz->RPQ', Y_KW__bb, t1_xe, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ia,yxQa,Py->RPQ', Y_KW__bb, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ia,yzQa,Pxyz->RPQ', Y_KW__bb, t1_xe, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPa,ja,Qx->RPQ', Y_KW__bb, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPa,jxay,Qy->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPa,jxya,Qy->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPa,jyQa,xy->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jyaQ,xy->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPa,jyaz,Qyxz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPa,jyza,Qyxz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPx,jy,Qy->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPx,jyQz,zy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPx,jyzQ,zy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPx,jyzw,Qyzw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jQ,xy->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jxQz,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPy,jxyz,Qz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jxzQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jxzw,Qywz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jxzy,Qz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPy,jy,Qx->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jz,Qyxz->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzQw,xwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzQy,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzwQ,xwzy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jzwu,Qyzxwu->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jzwy,Qzxw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jzyQ,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPy,jzyw,Qzxw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijab,jPab,Qx->RPQ', Y_KW__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijab,jPba,Qx->RPQ', Y_KW__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,jPay,Qy->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxa,jPya,Qy->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxa,jyQa,Py->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,ijxa,jyaQ,Py->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,jPyz,Qz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,jPzw,Qywz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,jPzy,Qz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jQ,Py->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzQw,Pwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzQy,Pz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzwQ,Pwzy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,ijxy,jzyQ,Pz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,jPay,Qx->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,jPaz,Qyzx->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPya,Qx->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPza,Qyzx->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijya,jxQa,Py->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijya,jxaQ,Py->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijya,jzQa,Pxzy->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijya,jzaQ,Pxzy->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,jPyz,Qz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,jPzw,Qywz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,jPzy,Qz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jQ,Py->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzQw,Pwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzQy,Pz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzwQ,Pwzy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyx,jzyQ,Pz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPwu,Qyzuxw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPwy,Qzxw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPwz,Qywx->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPyw,Qzwx->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPyz,Qx->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPzw,Qywx->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPzy,Qx->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jQ,Pxzy->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuwzy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuywz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuyzw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuzwy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,ijyz,jwQu,Pxuzyw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwQy,Pxzw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwQz,Pxwy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwuQ,Pxuwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwyQ,Pxwz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jwzQ,Pxwy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxQw,Pwzy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jxQy,Pz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxQz,Py->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxwQ,Pwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxyQ,Pz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jxzQ,Py->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPa,ja,Qx->RPQ', Y_KW__bb, t1_xvae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPa,jxay,Qy->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPa,jxya,Qy->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPa,jyQa,xy->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jyaQ,xy->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPa,jyaz,Qyxz->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPa,jyza,Qyxz->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPx,jy,Qy->RPQ', Y_KW__bb, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPx,jyQz,zy->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPx,jyzQ,zy->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPx,jyzw,Qyzw->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jQ,xy->RPQ', Y_KW__bb, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jxQz,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPy,jxyz,Qz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jxzQ,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jxzw,Qywz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jxzy,Qz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPy,jy,Qx->RPQ', Y_KW__bb, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jz,Qyxz->RPQ', Y_KW__bb, t1_xvaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzQw,xwyz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzQy,xz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzwQ,xwzy->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jzwu,Qyzxwu->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijPy,jzwy,Qzxw->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jzyQ,xz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijPy,jzyw,Qzxw->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijab,jPab,Qx->RPQ', Y_KW__bb, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijab,jPba,Qx->RPQ', Y_KW__bb, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,jPay,Qy->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxa,jPya,Qy->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxa,jyQa,Py->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,ijxa,jyaQ,Py->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,jPyz,Qz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,jPzw,Qywz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,jPzy,Qz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jQ,Py->RPQ', Y_KW__bb, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzQw,Pwyz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzQy,Pz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzwQ,Pwzy->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,ijxy,jzyQ,Pz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,jPay,Qx->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,jPaz,Qyzx->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPya,Qx->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPza,Qyzx->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijya,jxQa,Py->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijya,jxaQ,Py->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijya,jzQa,Pxzy->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijya,jzaQ,Pxzy->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,jPyz,Qz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,jPzw,Qywz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,jPzy,Qz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jQ,Py->RPQ', Y_KW__bb, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzQw,Pwyz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzQy,Pz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzwQ,Pwzy->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyx,jzyQ,Pz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPwu,Qyzuxw->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPwy,Qzxw->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPwz,Qywx->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPyw,Qzwx->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,jPyz,Qx->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPzw,Qywx->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPzy,Qx->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jQ,Pxzy->RPQ', Y_KW__bb, t1_xvaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuwyz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuwzy->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuywz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuyzw->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuzwy->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,ijyz,jwQu,Pxuzyw->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwQy,Pxzw->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwQz,Pxwy->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwuQ,Pxuwyz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwyQ,Pxwz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jwzQ,Pxwy->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxQw,Pwzy->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jxQy,Pz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxQz,Py->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxwQ,Pwyz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxyQ,Pz->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jxzQ,Py->RPQ', Y_KW__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyPa,xa,Qy->RPQ', Y_KW__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyPa,xzQa,yz->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyPa,xzwa,Qzwy->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyPa,za,Qzxy->RPQ', Y_KW__bb, t1_xaae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPa,zwQa,xyzw->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyPa,zwua,Qwzuxy->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyPa,zwua,Qwzuyx->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyPa,zwua,Qwzxuy->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyPa,zwua,Qwzxyu->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyPa,zwua,Qwzyux->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyPa,zwua,Qwzyxu->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPa,zxQa,yz->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyPa,zxwa,Qzyw->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyaP,xa,Qy->RPQ', Y_KW__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaP,xzQa,yz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyaP,xzwa,Qzyw->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyaP,za,Qzyx->RPQ', Y_KW__bb, t1_xaea, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaP,zwQa,xywz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyaP,zwua,Qwzyxu->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += einsum('Rix,iyaP,zxQa,yz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyaP,zxwa,Qzyw->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyab,Pxab,Qy->RPQ', Y_KW__bb, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyab,Pxba,Qy->RPQ', Y_KW__bb, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyab,Pzab,Qzxy->RPQ', Y_KW__bb, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyab,Pzba,Qzyx->RPQ', Y_KW__bb, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,Pa,Qy->RPQ', Y_KW__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,Pzwa,Qzwy->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,zPwa,Qzyw->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyax,zwQa,Pyzw->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pa,Qzxy->RPQ', Y_KW__bb, t1_xaea, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwuxy->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyaz,Pwua,Qzwuyx->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwxuy->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwxyu->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwyux->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwyxu->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pwza,Qwyx->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,Pxwa,Qzwy->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,Pxza,Qy->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,wPua,Qzwxyu->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,wPza,Qwxy->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyaz,wuQa,Pxywuz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyaz,wxQa,Pywz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,xPwa,Qzwy->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,xPza,Qy->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyaz,xwQa,Pywz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,Pa,Qy->RPQ', Y_KW__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,Pzwa,Qzwy->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,zPwa,Qzyw->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxa,zwQa,Pyzw->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pa,Qzyx->RPQ', Y_KW__bb, t1_xaae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pwua,Qzwuxy->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pwza,Qwxy->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pxwa,Qzwy->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pxza,Qy->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,wPua,Qzwuxy->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,wPua,Qzwuyx->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,wPua,Qzwxuy->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,wPua,Qzwxyu->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,wPua,Qzwyux->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyza,wPua,Qzwyxu->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,wPza,Qwyx->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyza,wuQa,Pxyuwz->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyza,wuQa,Pxyuzw->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyza,wuQa,Pxywuz->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyza,wuQa,Pxywzu->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyza,wuQa,Pxyzuw->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyza,wuQa,Pxyzwu->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyza,wxQa,Pywz->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,xPwa,Qzyw->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,xPza,Qy->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyza,xwQa,Pyzw->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPa,ja,Qx->RPQ', Y_KW__bb, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPa,jxay,Qy->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiPa,jxya,Qy->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jyQa,xy->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPa,jyaQ,xy->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPa,jyaz,Qyxz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPa,jyza,Qyzx->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiPx,jy,Qy->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPx,jyQz,zy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPx,jyzQ,zy->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiPx,jyzw,Qyzw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jQ,xy->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jxQz,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jxyz,Qz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jxzQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jxzw,Qyzw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiPy,jxzy,Qz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jy,Qx->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jz,Qyzx->RPQ', Y_KW__bb, t1_xxaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jzQw,xwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jzQy,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jzwQ,xwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzuwx->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzuxw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzwux->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,jiPy,jzwu,Qyzwxu->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzxuw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzxwu->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jzwy,Qzwx->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jzyQ,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jzyw,Qzxw->RPQ', Y_KW__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,jPay,Qy->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jixa,jPya,Qy->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jixa,jyQa,Py->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jixa,jyaQ,Py->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPay,Qx->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPaz,Qyzx->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,jPya,Qx->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPza,Qyxz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiya,jxQa,Py->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jxaQ,Py->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jzQa,Pxyz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jzaQ,Pxzy->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPa,ja,Qx->RPQ', Y_KW__bb, t1_vxae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPa,jxay,Qy->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiPa,jxya,Qy->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jyQa,xy->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPa,jyaQ,xy->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPa,jyaz,Qyxz->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPa,jyza,Qyzx->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiPx,jy,Qy->RPQ', Y_KW__bb, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPx,jyQz,zy->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPx,jyzQ,zy->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiPx,jyzw,Qyzw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jQ,xy->RPQ', Y_KW__bb, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jxQz,yz->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jxyz,Qz->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jxzQ,yz->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jxzw,Qyzw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiPy,jxzy,Qz->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jy,Qx->RPQ', Y_KW__bb, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jz,Qyzx->RPQ', Y_KW__bb, t1_vxaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jzQw,xwyz->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jzQy,xz->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jzwQ,xwyz->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzuwx->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzuxw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzwux->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,jiPy,jzwu,Qyzwxu->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzxuw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,jiPy,jzwu,Qyzxwu->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jzwy,Qzwx->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jzyQ,xz->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiPy,jzyw,Qzxw->RPQ', Y_KW__bb, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,jPay,Qy->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jixa,jPya,Qy->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jixa,jyQa,Py->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jixa,jyaQ,Py->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPay,Qx->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPaz,Qyzx->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,jPya,Qx->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPza,Qyxz->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiya,jxQa,Py->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jxaQ,Py->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jzQa,Pxyz->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jzaQ,Pxzy->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    TY[:, s_a:f_a, s_a:f_a] += temp

    temp  = einsum('Rix,iP,xQ->RPQ', Y_KW__aa, t1_xe, t1_ae, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jxQa->RPQ', Y_KW__aa, t1_xxee, t1_xaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPa,jxaQ->RPQ', Y_KW__aa, t1_xxee, t1_xaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxP,jQ->RPQ', Y_KW__aa, t1_xxae, t1_xe, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijyP,jxQy->RPQ', Y_KW__aa, t1_xxae, t1_xaea, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jxyQ->RPQ', Y_KW__aa, t1_xxae, t1_xaae, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jxQa->RPQ', Y_KW__aa, t1_xvee, t1_vaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPa,jxaQ->RPQ', Y_KW__aa, t1_xvee, t1_vaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxP,jQ->RPQ', Y_KW__aa, t1_xvae, t1_ve, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijyP,jxQy->RPQ', Y_KW__aa, t1_xvae, t1_vaea, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jxyQ->RPQ', Y_KW__aa, t1_xvae, t1_vaae, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPa,jxQa->RPQ', Y_KW__aa, t1_xxee, t1_xaee, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jxaQ->RPQ', Y_KW__aa, t1_xxee, t1_xaee, optimize = einsum_type)
    temp -= einsum('Rix,jixP,jQ->RPQ', Y_KW__aa, t1_xxae, t1_xe, optimize = einsum_type)
    temp -= einsum('Rix,jiyP,jxQy->RPQ', Y_KW__aa, t1_xxae, t1_xaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiyP,jxyQ->RPQ', Y_KW__aa, t1_xxae, t1_xaae, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPa,jxQa->RPQ', Y_KW__aa, t1_vxee, t1_vaee, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jxaQ->RPQ', Y_KW__aa, t1_vxee, t1_vaee, optimize = einsum_type)
    temp -= einsum('Rix,jixP,jQ->RPQ', Y_KW__aa, t1_vxae, t1_ve, optimize = einsum_type)
    temp -= einsum('Rix,jiyP,jxQy->RPQ', Y_KW__aa, t1_vxae, t1_vaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiyP,jxyQ->RPQ', Y_KW__aa, t1_vxae, t1_vaae, optimize = einsum_type)
    temp += einsum('Rix,iP,xQ->RPQ', Y_KW__bb, t1_xe, t1_ae, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jxQa->RPQ', Y_KW__bb, t1_xxee, t1_xaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPa,jxaQ->RPQ', Y_KW__bb, t1_xxee, t1_xaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxP,jQ->RPQ', Y_KW__bb, t1_xxae, t1_xe, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijyP,jxQy->RPQ', Y_KW__bb, t1_xxae, t1_xaea, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jxyQ->RPQ', Y_KW__bb, t1_xxae, t1_xaae, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jxQa->RPQ', Y_KW__bb, t1_xvee, t1_vaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPa,jxaQ->RPQ', Y_KW__bb, t1_xvee, t1_vaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxP,jQ->RPQ', Y_KW__bb, t1_xvae, t1_ve, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijyP,jxQy->RPQ', Y_KW__bb, t1_xvae, t1_vaea, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jxyQ->RPQ', Y_KW__bb, t1_xvae, t1_vaae, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPa,jxQa->RPQ', Y_KW__bb, t1_xxee, t1_xaee, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jxaQ->RPQ', Y_KW__bb, t1_xxee, t1_xaee, optimize = einsum_type)
    temp -= einsum('Rix,jixP,jQ->RPQ', Y_KW__bb, t1_xxae, t1_xe, optimize = einsum_type)
    temp -= einsum('Rix,jiyP,jxQy->RPQ', Y_KW__bb, t1_xxae, t1_xaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiyP,jxyQ->RPQ', Y_KW__bb, t1_xxae, t1_xaae, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPa,jxQa->RPQ', Y_KW__bb, t1_vxee, t1_vaee, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jxaQ->RPQ', Y_KW__bb, t1_vxee, t1_vaee, optimize = einsum_type)
    temp -= einsum('Rix,jixP,jQ->RPQ', Y_KW__bb, t1_vxae, t1_ve, optimize = einsum_type)
    temp -= einsum('Rix,jiyP,jxQy->RPQ', Y_KW__bb, t1_vxae, t1_vaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiyP,jxyQ->RPQ', Y_KW__bb, t1_vxae, t1_vaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iP,xyzQ,zy->RPQ', Y_KW__aa, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iP,yQ,xy->RPQ', Y_KW__aa, t1_xe, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iP,yxzQ,zy->RPQ', Y_KW__aa, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iP,yzwQ,xwzy->RPQ', Y_KW__aa, t1_xe, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPa,jyQa,xy->RPQ', Y_KW__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jyaQ,xy->RPQ', Y_KW__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxP,jyQz,zy->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxP,jyzQ,zy->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jQ,xy->RPQ', Y_KW__aa, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jxQz,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyP,jxzQ,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jzQw,xwyz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jzQy,xz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyP,jzwQ,xwyz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyP,jzyQ,xz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPa,jyQa,xy->RPQ', Y_KW__aa, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jyaQ,xy->RPQ', Y_KW__aa, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxP,jyQz,zy->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxP,jyzQ,zy->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jQ,xy->RPQ', Y_KW__aa, t1_xvae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jxQz,yz->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyP,jxzQ,yz->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jzQw,xwyz->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jzQy,xz->RPQ', Y_KW__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyP,jzwQ,xwyz->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyP,jzyQ,xz->RPQ', Y_KW__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyPa,xzQa,yz->RPQ', Y_KW__aa, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPa,zwQa,xyzw->RPQ', Y_KW__aa, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPa,zxQa,yz->RPQ', Y_KW__aa, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPx,zQ,yz->RPQ', Y_KW__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPx,zwuQ,yuwz->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,wQ,xywz->RPQ', Y_KW__aa, t1_xaea, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,wuvQ,xyvuzw->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,wuzQ,xyuw->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyPz,wxuQ,zwyu->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyPz,wxzQ,yw->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyPz,xQ,zy->RPQ', Y_KW__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,xwuQ,zwyu->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,xwzQ,yw->RPQ', Y_KW__aa, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaP,xzQa,yz->RPQ', Y_KW__aa, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaP,zwQa,xywz->RPQ', Y_KW__aa, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyaP,zxQa,yz->RPQ', Y_KW__aa, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxP,zQ,yz->RPQ', Y_KW__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxP,zwuQ,yuwz->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,wQ,xyzw->RPQ', Y_KW__aa, t1_xaae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvuwz->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvuzw->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvwuz->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvwzu->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/3 * einsum('Rix,iyzP,wuvQ,xyvzuw->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvzwu->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,wuzQ,xywu->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,wxuQ,zwyu->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,wxzQ,yw->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,xQ,zy->RPQ', Y_KW__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,xwuQ,zwuy->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyzP,xwzQ,yw->RPQ', Y_KW__aa, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jyQa,xy->RPQ', Y_KW__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPa,jyaQ,xy->RPQ', Y_KW__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jixP,jyQz,zy->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixP,jyzQ,zy->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jQ,xy->RPQ', Y_KW__aa, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jxQz,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiyP,jxzQ,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jzQw,xwyz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jzQy,xz->RPQ', Y_KW__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jzwQ,xwzy->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiyP,jzyQ,xz->RPQ', Y_KW__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jyQa,xy->RPQ', Y_KW__aa, t1_vxee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPa,jyaQ,xy->RPQ', Y_KW__aa, t1_vxee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jixP,jyQz,zy->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixP,jyzQ,zy->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jQ,xy->RPQ', Y_KW__aa, t1_vxae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jxQz,yz->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiyP,jxzQ,yz->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jzQw,xwyz->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jzQy,xz->RPQ', Y_KW__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jzwQ,xwzy->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiyP,jzyQ,xz->RPQ', Y_KW__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iP,xyzQ,zy->RPQ', Y_KW__bb, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iP,yQ,xy->RPQ', Y_KW__bb, t1_xe, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iP,yxzQ,zy->RPQ', Y_KW__bb, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iP,yzwQ,xwzy->RPQ', Y_KW__bb, t1_xe, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPa,jyQa,xy->RPQ', Y_KW__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jyaQ,xy->RPQ', Y_KW__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxP,jyQz,zy->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxP,jyzQ,zy->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jQ,xy->RPQ', Y_KW__bb, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jxQz,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyP,jxzQ,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jzQw,xwyz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jzQy,xz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyP,jzwQ,xwyz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyP,jzyQ,xz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPa,jyQa,xy->RPQ', Y_KW__bb, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jyaQ,xy->RPQ', Y_KW__bb, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxP,jyQz,zy->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxP,jyzQ,zy->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jQ,xy->RPQ', Y_KW__bb, t1_xvae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jxQz,yz->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyP,jxzQ,yz->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jzQw,xwyz->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyP,jzQy,xz->RPQ', Y_KW__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyP,jzwQ,xwyz->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyP,jzyQ,xz->RPQ', Y_KW__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyPa,xzQa,yz->RPQ', Y_KW__bb, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPa,zwQa,xyzw->RPQ', Y_KW__bb, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPa,zxQa,yz->RPQ', Y_KW__bb, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPx,zQ,yz->RPQ', Y_KW__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPx,zwuQ,yuwz->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,wQ,xywz->RPQ', Y_KW__bb, t1_xaea, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,wuvQ,xyvuzw->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,wuzQ,xyuw->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyPz,wxuQ,zwyu->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyPz,wxzQ,yw->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyPz,xQ,zy->RPQ', Y_KW__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,xwuQ,zwyu->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,xwzQ,yw->RPQ', Y_KW__bb, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaP,xzQa,yz->RPQ', Y_KW__bb, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaP,zwQa,xywz->RPQ', Y_KW__bb, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyaP,zxQa,yz->RPQ', Y_KW__bb, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxP,zQ,yz->RPQ', Y_KW__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxP,zwuQ,yuwz->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,wQ,xyzw->RPQ', Y_KW__bb, t1_xaae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvuwz->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvuzw->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvwuz->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvwzu->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/3 * einsum('Rix,iyzP,wuvQ,xyvzuw->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvzwu->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,wuzQ,xywu->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,wxuQ,zwyu->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,wxzQ,yw->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,xQ,zy->RPQ', Y_KW__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,xwuQ,zwuy->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyzP,xwzQ,yw->RPQ', Y_KW__bb, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jyQa,xy->RPQ', Y_KW__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPa,jyaQ,xy->RPQ', Y_KW__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jixP,jyQz,zy->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixP,jyzQ,zy->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jQ,xy->RPQ', Y_KW__bb, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jxQz,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiyP,jxzQ,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jzQw,xwyz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jzQy,xz->RPQ', Y_KW__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jzwQ,xwzy->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiyP,jzyQ,xz->RPQ', Y_KW__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jyQa,xy->RPQ', Y_KW__bb, t1_vxee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPa,jyaQ,xy->RPQ', Y_KW__bb, t1_vxee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jixP,jyQz,zy->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixP,jyzQ,zy->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jQ,xy->RPQ', Y_KW__bb, t1_vxae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jxQz,yz->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiyP,jxzQ,yz->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jzQw,xwyz->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jzQy,xz->RPQ', Y_KW__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyP,jzwQ,xwzy->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiyP,jzyQ,xz->RPQ', Y_KW__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    TY[:, s_e:f_e, s_e:f_e] += temp   
 
    temp =- einsum('RPx,Qx->RPQ', Y_KW__aa, t2_va, optimize = einsum_type)
    temp -= einsum('RPx,Qx->RPQ', Y_KW__bb, t2_va, optimize = einsum_type)
    temp -= einsum('RPx,Qixa,ia->RPQ', Y_KW__aa, t1_vxae, t1_xe, optimize = einsum_type)
    temp -= einsum('RPx,Qixy,iy->RPQ', Y_KW__aa, t1_vxaa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyx,iy->RPQ', Y_KW__aa, t1_vxaa, t1_xa, optimize = einsum_type)
    temp -= einsum('RPx,Qixa,ia->RPQ', Y_KW__aa, t1_vvae, t1_ve, optimize = einsum_type)
    temp -= einsum('RPx,Qixy,iy->RPQ', Y_KW__aa, t1_vvaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyx,iy->RPQ', Y_KW__aa, t1_vvaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,ia->RPQ', Y_KW__aa, t1_xvae, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixab,Qiab->RPQ', Y_KW__aa, t1_xaee, t1_vxee, optimize = einsum_type)
    temp -= einsum('RPx,ixab,Qiba->RPQ', Y_KW__aa, t1_xaee, t1_vxee, optimize = einsum_type)
    temp -= einsum('RPx,ixay,Qiya->RPQ', Y_KW__aa, t1_xaea, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,iQya->RPQ', Y_KW__aa, t1_xaea, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,Qiya->RPQ', Y_KW__aa, t1_xaae, t1_vxae, optimize = einsum_type)
    temp -= einsum('RPx,ixya,iQya->RPQ', Y_KW__aa, t1_xaae, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qiyz->RPQ', Y_KW__aa, t1_xaaa, t1_vxaa, optimize = einsum_type)
    temp -= einsum('RPx,ixyz,Qizy->RPQ', Y_KW__aa, t1_xaaa, t1_vxaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,ia->RPQ', Y_KW__aa, t1_vvae, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixab,Qiab->RPQ', Y_KW__aa, t1_vaee, t1_vvee, optimize = einsum_type)
    temp -= einsum('RPx,ixab,Qiba->RPQ', Y_KW__aa, t1_vaee, t1_vvee, optimize = einsum_type)
    temp -= einsum('RPx,ixay,Qiya->RPQ', Y_KW__aa, t1_vaea, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,iQya->RPQ', Y_KW__aa, t1_vaea, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,Qiya->RPQ', Y_KW__aa, t1_vaae, t1_vvae, optimize = einsum_type)
    temp -= einsum('RPx,ixya,iQya->RPQ', Y_KW__aa, t1_vaae, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qiyz->RPQ', Y_KW__aa, t1_vaaa, t1_vvaa, optimize = einsum_type)
    temp -= einsum('RPx,ixyz,Qizy->RPQ', Y_KW__aa, t1_vaaa, t1_vvaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xa,Qa->RPQ', Y_KW__aa, t1_ae, t1_ve, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Piab,Qxab->RPQ', Y_KW__aa, t1_xxee, t1_vaee, optimize = einsum_type)
    temp += einsum('Rix,Piab,Qxba->RPQ', Y_KW__aa, t1_xxee, t1_vaee, optimize = einsum_type)
    temp += einsum('Rix,Pixa,Qa->RPQ', Y_KW__aa, t1_xxae, t1_ve, optimize = einsum_type)
    temp += einsum('Rix,Pixy,Qy->RPQ', Y_KW__aa, t1_xxaa, t1_va, optimize = einsum_type)
    temp += einsum('Rix,Piya,Qxay->RPQ', Y_KW__aa, t1_xxae, t1_vaea, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Piya,Qxya->RPQ', Y_KW__aa, t1_xxae, t1_vaae, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Piyx,Qy->RPQ', Y_KW__aa, t1_xxaa, t1_va, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Piyz,Qxyz->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, optimize = einsum_type)
    temp += einsum('Rix,Piyz,Qxzy->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiab,Pxab->RPQ', Y_KW__aa, t1_vxee, t1_xaee, optimize = einsum_type)
    temp += einsum('Rix,Qiab,Pxba->RPQ', Y_KW__aa, t1_vxee, t1_xaee, optimize = einsum_type)
    temp += einsum('Rix,Qixa,Pa->RPQ', Y_KW__aa, t1_vxae, t1_xe, optimize = einsum_type)
    temp += einsum('Rix,Qixy,Py->RPQ', Y_KW__aa, t1_vxaa, t1_xa, optimize = einsum_type)
    temp += einsum('Rix,Qiya,Pxay->RPQ', Y_KW__aa, t1_vxae, t1_xaea, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiya,Pxya->RPQ', Y_KW__aa, t1_vxae, t1_xaae, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiyx,Py->RPQ', Y_KW__aa, t1_vxaa, t1_xa, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiyz,Pxyz->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pxzy->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iPxa,Qa->RPQ', Y_KW__aa, t1_xxae, t1_ve, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iPya,Qxay->RPQ', Y_KW__aa, t1_xxae, t1_vaea, optimize = einsum_type)
    temp += einsum('Rix,iPya,Qxya->RPQ', Y_KW__aa, t1_xxae, t1_vaae, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iQxa,Pa->RPQ', Y_KW__aa, t1_xvae, t1_xe, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iQya,Pxay->RPQ', Y_KW__aa, t1_xvae, t1_xaea, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pxya->RPQ', Y_KW__aa, t1_xvae, t1_xaae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qy,xy->RPQ', Y_KW__aa, t2_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,Qixa,ia->RPQ', Y_KW__bb, t1_vxae, t1_xe, optimize = einsum_type)
    temp -= einsum('RPx,Qixy,iy->RPQ', Y_KW__bb, t1_vxaa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyx,iy->RPQ', Y_KW__bb, t1_vxaa, t1_xa, optimize = einsum_type)
    temp -= einsum('RPx,Qixa,ia->RPQ', Y_KW__bb, t1_vvae, t1_ve, optimize = einsum_type)
    temp -= einsum('RPx,Qixy,iy->RPQ', Y_KW__bb, t1_vvaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyx,iy->RPQ', Y_KW__bb, t1_vvaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,ia->RPQ', Y_KW__bb, t1_xvae, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixab,Qiab->RPQ', Y_KW__bb, t1_xaee, t1_vxee, optimize = einsum_type)
    temp -= einsum('RPx,ixab,Qiba->RPQ', Y_KW__bb, t1_xaee, t1_vxee, optimize = einsum_type)
    temp -= einsum('RPx,ixay,Qiya->RPQ', Y_KW__bb, t1_xaea, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,iQya->RPQ', Y_KW__bb, t1_xaea, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,Qiya->RPQ', Y_KW__bb, t1_xaae, t1_vxae, optimize = einsum_type)
    temp -= einsum('RPx,ixya,iQya->RPQ', Y_KW__bb, t1_xaae, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qiyz->RPQ', Y_KW__bb, t1_xaaa, t1_vxaa, optimize = einsum_type)
    temp -= einsum('RPx,ixyz,Qizy->RPQ', Y_KW__bb, t1_xaaa, t1_vxaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,ia->RPQ', Y_KW__bb, t1_vvae, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixab,Qiab->RPQ', Y_KW__bb, t1_vaee, t1_vvee, optimize = einsum_type)
    temp -= einsum('RPx,ixab,Qiba->RPQ', Y_KW__bb, t1_vaee, t1_vvee, optimize = einsum_type)
    temp -= einsum('RPx,ixay,Qiya->RPQ', Y_KW__bb, t1_vaea, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,iQya->RPQ', Y_KW__bb, t1_vaea, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,Qiya->RPQ', Y_KW__bb, t1_vaae, t1_vvae, optimize = einsum_type)
    temp -= einsum('RPx,ixya,iQya->RPQ', Y_KW__bb, t1_vaae, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qiyz->RPQ', Y_KW__bb, t1_vaaa, t1_vvaa, optimize = einsum_type)
    temp -= einsum('RPx,ixyz,Qizy->RPQ', Y_KW__bb, t1_vaaa, t1_vvaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xa,Qa->RPQ', Y_KW__bb, t1_ae, t1_ve, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Piab,Qxab->RPQ', Y_KW__bb, t1_xxee, t1_vaee, optimize = einsum_type)
    temp += einsum('Rix,Piab,Qxba->RPQ', Y_KW__bb, t1_xxee, t1_vaee, optimize = einsum_type)
    temp += einsum('Rix,Pixa,Qa->RPQ', Y_KW__bb, t1_xxae, t1_ve, optimize = einsum_type)
    temp += einsum('Rix,Pixy,Qy->RPQ', Y_KW__bb, t1_xxaa, t1_va, optimize = einsum_type)
    temp += einsum('Rix,Piya,Qxay->RPQ', Y_KW__bb, t1_xxae, t1_vaea, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Piya,Qxya->RPQ', Y_KW__bb, t1_xxae, t1_vaae, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Piyx,Qy->RPQ', Y_KW__bb, t1_xxaa, t1_va, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Piyz,Qxyz->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, optimize = einsum_type)
    temp += einsum('Rix,Piyz,Qxzy->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiab,Pxab->RPQ', Y_KW__bb, t1_vxee, t1_xaee, optimize = einsum_type)
    temp += einsum('Rix,Qiab,Pxba->RPQ', Y_KW__bb, t1_vxee, t1_xaee, optimize = einsum_type)
    temp += einsum('Rix,Qixa,Pa->RPQ', Y_KW__bb, t1_vxae, t1_xe, optimize = einsum_type)
    temp += einsum('Rix,Qixy,Py->RPQ', Y_KW__bb, t1_vxaa, t1_xa, optimize = einsum_type)
    temp += einsum('Rix,Qiya,Pxay->RPQ', Y_KW__bb, t1_vxae, t1_xaea, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiya,Pxya->RPQ', Y_KW__bb, t1_vxae, t1_xaae, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiyx,Py->RPQ', Y_KW__bb, t1_vxaa, t1_xa, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiyz,Pxyz->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pxzy->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iPxa,Qa->RPQ', Y_KW__bb, t1_xxae, t1_ve, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iPya,Qxay->RPQ', Y_KW__bb, t1_xxae, t1_vaea, optimize = einsum_type)
    temp += einsum('Rix,iPya,Qxya->RPQ', Y_KW__bb, t1_xxae, t1_vaae, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iQxa,Pa->RPQ', Y_KW__bb, t1_xvae, t1_xe, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iQya,Pxay->RPQ', Y_KW__bb, t1_xvae, t1_xaea, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pxya->RPQ', Y_KW__bb, t1_xvae, t1_xaae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qy,xy->RPQ', Y_KW__bb, t2_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qa,ya,xy->RPQ', Y_KW__aa, t1_ve, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qa,yzwa,xwzy->RPQ', Y_KW__aa, t1_ve, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiab,iyab,xy->RPQ', Y_KW__aa, t1_vxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiab,iyba,xy->RPQ', Y_KW__aa, t1_vxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,Qixa,iyaz,yz->RPQ', Y_KW__aa, t1_vxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixa,iyza,yz->RPQ', Y_KW__aa, t1_vxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,iz,yz->RPQ', Y_KW__aa, t1_vxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,izwu,yzwu->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,izwy,zw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,Qixy,izyw,zw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,ia,xy->RPQ', Y_KW__aa, t1_vxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,izaw,xwyz->RPQ', Y_KW__aa, t1_vxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,izay,xz->RPQ', Y_KW__aa, t1_vxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiya,izwa,xwyz->RPQ', Y_KW__aa, t1_vxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiya,izya,xz->RPQ', Y_KW__aa, t1_vxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,iz,yz->RPQ', Y_KW__aa, t1_vxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,izwu,yzwu->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,izwy,zw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyx,izyw,zw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iw,xwyz->RPQ', Y_KW__aa, t1_vxaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuv,xuvyzw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuy,xuwz->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuz,xuyw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwyu,xuzw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwyz,xw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iwzu,xuyw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iwzy,xw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iy,xz->RPQ', Y_KW__aa, t1_vxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iz,xy->RPQ', Y_KW__aa, t1_vxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiab,iyab,xy->RPQ', Y_KW__aa, t1_vvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiab,iyba,xy->RPQ', Y_KW__aa, t1_vvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,Qixa,iyaz,yz->RPQ', Y_KW__aa, t1_vvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixa,iyza,yz->RPQ', Y_KW__aa, t1_vvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,iz,yz->RPQ', Y_KW__aa, t1_vvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,izwu,yzwu->RPQ', Y_KW__aa, t1_vvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,izwy,zw->RPQ', Y_KW__aa, t1_vvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,Qixy,izyw,zw->RPQ', Y_KW__aa, t1_vvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,ia,xy->RPQ', Y_KW__aa, t1_vvae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,izaw,xwyz->RPQ', Y_KW__aa, t1_vvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,izay,xz->RPQ', Y_KW__aa, t1_vvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiya,izwa,xwyz->RPQ', Y_KW__aa, t1_vvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiya,izya,xz->RPQ', Y_KW__aa, t1_vvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,iz,yz->RPQ', Y_KW__aa, t1_vvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,izwu,yzwu->RPQ', Y_KW__aa, t1_vvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,izwy,zw->RPQ', Y_KW__aa, t1_vvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyx,izyw,zw->RPQ', Y_KW__aa, t1_vvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iw,xwyz->RPQ', Y_KW__aa, t1_vvaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuv,xuvyzw->RPQ', Y_KW__aa, t1_vvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuy,xuwz->RPQ', Y_KW__aa, t1_vvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuz,xuyw->RPQ', Y_KW__aa, t1_vvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwyu,xuzw->RPQ', Y_KW__aa, t1_vvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwyz,xw->RPQ', Y_KW__aa, t1_vvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iwzu,xuyw->RPQ', Y_KW__aa, t1_vvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iwzy,xw->RPQ', Y_KW__aa, t1_vvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iy,xz->RPQ', Y_KW__aa, t1_vvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iz,xy->RPQ', Y_KW__aa, t1_vvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyab,zwab,xyzw->RPQ', Y_KW__aa, t1_vaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyax,za,yz->RPQ', Y_KW__aa, t1_vaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyax,zwua,yuwz->RPQ', Y_KW__aa, t1_vaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyaz,wa,xywz->RPQ', Y_KW__aa, t1_vaea, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyaz,wuva,xyvuzw->RPQ', Y_KW__aa, t1_vaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyaz,wuza,xyuw->RPQ', Y_KW__aa, t1_vaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,Qyxa,za,yz->RPQ', Y_KW__aa, t1_vaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,Qyxa,zwua,yuwz->RPQ', Y_KW__aa, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyza,wa,xyzw->RPQ', Y_KW__aa, t1_vaae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvuwz->RPQ', Y_KW__aa, t1_vaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvuzw->RPQ', Y_KW__aa, t1_vaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvwuz->RPQ', Y_KW__aa, t1_vaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvwzu->RPQ', Y_KW__aa, t1_vaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPx,Qyza,wuva,xyvzuw->RPQ', Y_KW__aa, t1_vaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvzwu->RPQ', Y_KW__aa, t1_vaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyza,wuza,xywu->RPQ', Y_KW__aa, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,iyaz,yz->RPQ', Y_KW__aa, t1_xvae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxa,iyza,yz->RPQ', Y_KW__aa, t1_xvae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,ia,xy->RPQ', Y_KW__aa, t1_xvae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izaw,xwyz->RPQ', Y_KW__aa, t1_xvae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izay,xz->RPQ', Y_KW__aa, t1_xvae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izwa,xwzy->RPQ', Y_KW__aa, t1_xvae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQya,izya,xz->RPQ', Y_KW__aa, t1_xvae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,Qiza,yz->RPQ', Y_KW__aa, t1_xaea, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixay,iQza,yz->RPQ', Y_KW__aa, t1_xaea, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixya,Qiza,yz->RPQ', Y_KW__aa, t1_xaae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,iQza,yz->RPQ', Y_KW__aa, t1_xaae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiwu,zywu->RPQ', Y_KW__aa, t1_xaaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qiwy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiwz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiyw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qizw,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,iyaz,yz->RPQ', Y_KW__aa, t1_vvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxa,iyza,yz->RPQ', Y_KW__aa, t1_vvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,ia,xy->RPQ', Y_KW__aa, t1_vvae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izaw,xwyz->RPQ', Y_KW__aa, t1_vvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izay,xz->RPQ', Y_KW__aa, t1_vvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izwa,xwzy->RPQ', Y_KW__aa, t1_vvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQya,izya,xz->RPQ', Y_KW__aa, t1_vvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,Qiza,yz->RPQ', Y_KW__aa, t1_vaea, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixay,iQza,yz->RPQ', Y_KW__aa, t1_vaea, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixya,Qiza,yz->RPQ', Y_KW__aa, t1_vaae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,iQza,yz->RPQ', Y_KW__aa, t1_vaae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiwu,zywu->RPQ', Y_KW__aa, t1_vaaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qiwy,zw->RPQ', Y_KW__aa, t1_vaaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiwz,yw->RPQ', Y_KW__aa, t1_vaaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiyw,zw->RPQ', Y_KW__aa, t1_vaaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qizw,yw->RPQ', Y_KW__aa, t1_vaaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xa,Qyaz,yz->RPQ', Y_KW__aa, t1_ae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xa,Qyza,yz->RPQ', Y_KW__aa, t1_ae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xyab,Qzab,yz->RPQ', Y_KW__aa, t1_aaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyab,Qzba,yz->RPQ', Y_KW__aa, t1_aaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qa,yz->RPQ', Y_KW__aa, t1_aaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qwau,yuzw->RPQ', Y_KW__aa, t1_aaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qwaz,yw->RPQ', Y_KW__aa, t1_aaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qwua,yuwz->RPQ', Y_KW__aa, t1_aaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xyza,Qwza,yw->RPQ', Y_KW__aa, t1_aaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yxza,Qa,yz->RPQ', Y_KW__aa, t1_aaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yxza,Qwau,yuzw->RPQ', Y_KW__aa, t1_aaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yxza,Qwaz,yw->RPQ', Y_KW__aa, t1_aaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yxza,Qwua,yuzw->RPQ', Y_KW__aa, t1_aaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yxza,Qwza,yw->RPQ', Y_KW__aa, t1_aaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Piab,Qyab,xy->RPQ', Y_KW__aa, t1_xxee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piab,Qyba,xy->RPQ', Y_KW__aa, t1_xxee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Pixa,Qyaz,yz->RPQ', Y_KW__aa, t1_xxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Pixa,Qyza,yz->RPQ', Y_KW__aa, t1_xxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Pixy,Qz,yz->RPQ', Y_KW__aa, t1_xxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Pixy,Qzwu,yzwu->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Pixy,Qzwy,zw->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Pixy,Qzyw,zw->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,Qa,xy->RPQ', Y_KW__aa, t1_xxae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,Qxaz,yz->RPQ', Y_KW__aa, t1_xxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Piya,Qxza,yz->RPQ', Y_KW__aa, t1_xxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,Qzaw,xwyz->RPQ', Y_KW__aa, t1_xxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,Qzay,xz->RPQ', Y_KW__aa, t1_xxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,Qzwa,xwzy->RPQ', Y_KW__aa, t1_xxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Piya,Qzya,xz->RPQ', Y_KW__aa, t1_xxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Piyx,Qz,yz->RPQ', Y_KW__aa, t1_xxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Piyx,Qzwu,yzwu->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Piyx,Qzwy,zw->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Piyx,Qzyw,zw->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,Qw,xwzy->RPQ', Y_KW__aa, t1_xxaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Piyz,Qwuv,xuvwyz->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Piyz,Qwuv,xuvwzy->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Piyz,Qwuv,xuvywz->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Piyz,Qwuv,xuvyzw->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Piyz,Qwuv,xuvzwy->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/3 * einsum('Rix,Piyz,Qwuv,xuvzyw->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,Qwuy,xuzw->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,Qwuz,xuwy->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Piyz,Qwyu,xuzw->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Piyz,Qwyz,xw->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,Qwzu,xuyw->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,Qwzy,xw->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,Qxwu,yzwu->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,Qxwy,zw->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Piyz,Qxwz,yw->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Piyz,Qxyw,zw->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,Qxzw,yw->RPQ', Y_KW__aa, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Piyz,Qy,xz->RPQ', Y_KW__aa, t1_xxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,Qz,xy->RPQ', Y_KW__aa, t1_xxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiab,Pyab,xy->RPQ', Y_KW__aa, t1_vxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiab,Pyba,xy->RPQ', Y_KW__aa, t1_vxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qixa,Pyaz,yz->RPQ', Y_KW__aa, t1_vxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixa,Pyza,yz->RPQ', Y_KW__aa, t1_vxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixy,Pz,yz->RPQ', Y_KW__aa, t1_vxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixy,Pzwu,yzwu->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixy,Pzwy,zw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qixy,Pzyw,zw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pa,xy->RPQ', Y_KW__aa, t1_vxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pxaz,yz->RPQ', Y_KW__aa, t1_vxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiya,Pxza,yz->RPQ', Y_KW__aa, t1_vxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pzaw,xwyz->RPQ', Y_KW__aa, t1_vxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pzay,xz->RPQ', Y_KW__aa, t1_vxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pzwa,xwzy->RPQ', Y_KW__aa, t1_vxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiya,Pzya,xz->RPQ', Y_KW__aa, t1_vxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyx,Pz,yz->RPQ', Y_KW__aa, t1_vxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyx,Pzwu,yzwu->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyx,Pzwy,zw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiyx,Pzyw,zw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pw,xwzy->RPQ', Y_KW__aa, t1_vxaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvwyz->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvwzy->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvywz->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvyzw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvzwy->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/3 * einsum('Rix,Qiyz,Pwuv,xuvzyw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwuy,xuzw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwuz,xuwy->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pwyu,xuzw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pwyz,xw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwzu,xuyw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwzy,xw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pxwu,yzwu->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pxwy,zw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pxwz,yw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pxyw,zw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pxzw,yw->RPQ', Y_KW__aa, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Py,xz->RPQ', Y_KW__aa, t1_vxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pz,xy->RPQ', Y_KW__aa, t1_vxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iPxa,Qyaz,yz->RPQ', Y_KW__aa, t1_xxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iPxa,Qyza,yz->RPQ', Y_KW__aa, t1_xxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iPya,Qa,xy->RPQ', Y_KW__aa, t1_xxae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iPya,Qxaz,yz->RPQ', Y_KW__aa, t1_xxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPya,Qxza,yz->RPQ', Y_KW__aa, t1_xxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iPya,Qzaw,xwyz->RPQ', Y_KW__aa, t1_xxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iPya,Qzay,xz->RPQ', Y_KW__aa, t1_xxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPya,Qzwa,xwyz->RPQ', Y_KW__aa, t1_xxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPya,Qzya,xz->RPQ', Y_KW__aa, t1_xxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iQxa,Pyaz,yz->RPQ', Y_KW__aa, t1_xvae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQxa,Pyza,yz->RPQ', Y_KW__aa, t1_xvae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pa,xy->RPQ', Y_KW__aa, t1_xvae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pxaz,yz->RPQ', Y_KW__aa, t1_xvae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,Pxza,yz->RPQ', Y_KW__aa, t1_xvae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pzaw,xwyz->RPQ', Y_KW__aa, t1_xvae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pzay,xz->RPQ', Y_KW__aa, t1_xvae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,Pzwa,xwyz->RPQ', Y_KW__aa, t1_xvae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,Pzya,xz->RPQ', Y_KW__aa, t1_xvae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qa,ya,xy->RPQ', Y_KW__bb, t1_ve, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qa,yzwa,xwzy->RPQ', Y_KW__bb, t1_ve, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiab,iyab,xy->RPQ', Y_KW__bb, t1_vxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiab,iyba,xy->RPQ', Y_KW__bb, t1_vxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,Qixa,iyaz,yz->RPQ', Y_KW__bb, t1_vxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixa,iyza,yz->RPQ', Y_KW__bb, t1_vxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,iz,yz->RPQ', Y_KW__bb, t1_vxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,izwu,yzwu->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,izwy,zw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,Qixy,izyw,zw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,ia,xy->RPQ', Y_KW__bb, t1_vxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,izaw,xwyz->RPQ', Y_KW__bb, t1_vxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,izay,xz->RPQ', Y_KW__bb, t1_vxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiya,izwa,xwyz->RPQ', Y_KW__bb, t1_vxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiya,izya,xz->RPQ', Y_KW__bb, t1_vxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,iz,yz->RPQ', Y_KW__bb, t1_vxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,izwu,yzwu->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,izwy,zw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyx,izyw,zw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iw,xwyz->RPQ', Y_KW__bb, t1_vxaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuv,xuvyzw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuy,xuwz->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuz,xuyw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwyu,xuzw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwyz,xw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iwzu,xuyw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iwzy,xw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iy,xz->RPQ', Y_KW__bb, t1_vxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iz,xy->RPQ', Y_KW__bb, t1_vxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiab,iyab,xy->RPQ', Y_KW__bb, t1_vvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiab,iyba,xy->RPQ', Y_KW__bb, t1_vvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,Qixa,iyaz,yz->RPQ', Y_KW__bb, t1_vvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixa,iyza,yz->RPQ', Y_KW__bb, t1_vvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,iz,yz->RPQ', Y_KW__bb, t1_vvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,izwu,yzwu->RPQ', Y_KW__bb, t1_vvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qixy,izwy,zw->RPQ', Y_KW__bb, t1_vvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,Qixy,izyw,zw->RPQ', Y_KW__bb, t1_vvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,ia,xy->RPQ', Y_KW__bb, t1_vvae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,izaw,xwyz->RPQ', Y_KW__bb, t1_vvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiya,izay,xz->RPQ', Y_KW__bb, t1_vvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiya,izwa,xwyz->RPQ', Y_KW__bb, t1_vvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiya,izya,xz->RPQ', Y_KW__bb, t1_vvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,iz,yz->RPQ', Y_KW__bb, t1_vvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,izwu,yzwu->RPQ', Y_KW__bb, t1_vvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyx,izwy,zw->RPQ', Y_KW__bb, t1_vvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyx,izyw,zw->RPQ', Y_KW__bb, t1_vvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iw,xwyz->RPQ', Y_KW__bb, t1_vvaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuv,xuvyzw->RPQ', Y_KW__bb, t1_vvaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuy,xuwz->RPQ', Y_KW__bb, t1_vvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwuz,xuyw->RPQ', Y_KW__bb, t1_vvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwyu,xuzw->RPQ', Y_KW__bb, t1_vvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iwyz,xw->RPQ', Y_KW__bb, t1_vvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iwzu,xuyw->RPQ', Y_KW__bb, t1_vvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iwzy,xw->RPQ', Y_KW__bb, t1_vvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,Qiyz,iy,xz->RPQ', Y_KW__bb, t1_vvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qiyz,iz,xy->RPQ', Y_KW__bb, t1_vvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyab,zwab,xyzw->RPQ', Y_KW__bb, t1_vaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyax,za,yz->RPQ', Y_KW__bb, t1_vaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyax,zwua,yuwz->RPQ', Y_KW__bb, t1_vaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyaz,wa,xywz->RPQ', Y_KW__bb, t1_vaea, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyaz,wuva,xyvuzw->RPQ', Y_KW__bb, t1_vaea, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyaz,wuza,xyuw->RPQ', Y_KW__bb, t1_vaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,Qyxa,za,yz->RPQ', Y_KW__bb, t1_vaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,Qyxa,zwua,yuwz->RPQ', Y_KW__bb, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyza,wa,xyzw->RPQ', Y_KW__bb, t1_vaae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvuwz->RPQ', Y_KW__bb, t1_vaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvuzw->RPQ', Y_KW__bb, t1_vaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvwuz->RPQ', Y_KW__bb, t1_vaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvwzu->RPQ', Y_KW__bb, t1_vaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPx,Qyza,wuva,xyvzuw->RPQ', Y_KW__bb, t1_vaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvzwu->RPQ', Y_KW__bb, t1_vaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyza,wuza,xywu->RPQ', Y_KW__bb, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,iyaz,yz->RPQ', Y_KW__bb, t1_xvae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxa,iyza,yz->RPQ', Y_KW__bb, t1_xvae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,ia,xy->RPQ', Y_KW__bb, t1_xvae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izaw,xwyz->RPQ', Y_KW__bb, t1_xvae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izay,xz->RPQ', Y_KW__bb, t1_xvae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izwa,xwzy->RPQ', Y_KW__bb, t1_xvae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQya,izya,xz->RPQ', Y_KW__bb, t1_xvae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,Qiza,yz->RPQ', Y_KW__bb, t1_xaea, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixay,iQza,yz->RPQ', Y_KW__bb, t1_xaea, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixya,Qiza,yz->RPQ', Y_KW__bb, t1_xaae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,iQza,yz->RPQ', Y_KW__bb, t1_xaae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiwu,zywu->RPQ', Y_KW__bb, t1_xaaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qiwy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiwz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiyw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qizw,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,iyaz,yz->RPQ', Y_KW__bb, t1_vvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxa,iyza,yz->RPQ', Y_KW__bb, t1_vvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,ia,xy->RPQ', Y_KW__bb, t1_vvae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izaw,xwyz->RPQ', Y_KW__bb, t1_vvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izay,xz->RPQ', Y_KW__bb, t1_vvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izwa,xwzy->RPQ', Y_KW__bb, t1_vvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQya,izya,xz->RPQ', Y_KW__bb, t1_vvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,Qiza,yz->RPQ', Y_KW__bb, t1_vaea, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixay,iQza,yz->RPQ', Y_KW__bb, t1_vaea, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixya,Qiza,yz->RPQ', Y_KW__bb, t1_vaae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,iQza,yz->RPQ', Y_KW__bb, t1_vaae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiwu,zywu->RPQ', Y_KW__bb, t1_vaaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qiwy,zw->RPQ', Y_KW__bb, t1_vaaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiwz,yw->RPQ', Y_KW__bb, t1_vaaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,Qiyw,zw->RPQ', Y_KW__bb, t1_vaaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,Qizw,yw->RPQ', Y_KW__bb, t1_vaaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xa,Qyaz,yz->RPQ', Y_KW__bb, t1_ae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xa,Qyza,yz->RPQ', Y_KW__bb, t1_ae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xyab,Qzab,yz->RPQ', Y_KW__bb, t1_aaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyab,Qzba,yz->RPQ', Y_KW__bb, t1_aaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qa,yz->RPQ', Y_KW__bb, t1_aaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qwau,yuzw->RPQ', Y_KW__bb, t1_aaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qwaz,yw->RPQ', Y_KW__bb, t1_aaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qwua,yuwz->RPQ', Y_KW__bb, t1_aaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xyza,Qwza,yw->RPQ', Y_KW__bb, t1_aaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yxza,Qa,yz->RPQ', Y_KW__bb, t1_aaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yxza,Qwau,yuzw->RPQ', Y_KW__bb, t1_aaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yxza,Qwaz,yw->RPQ', Y_KW__bb, t1_aaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yxza,Qwua,yuzw->RPQ', Y_KW__bb, t1_aaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yxza,Qwza,yw->RPQ', Y_KW__bb, t1_aaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Piab,Qyab,xy->RPQ', Y_KW__bb, t1_xxee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piab,Qyba,xy->RPQ', Y_KW__bb, t1_xxee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Pixa,Qyaz,yz->RPQ', Y_KW__bb, t1_xxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Pixa,Qyza,yz->RPQ', Y_KW__bb, t1_xxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Pixy,Qz,yz->RPQ', Y_KW__bb, t1_xxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Pixy,Qzwu,yzwu->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Pixy,Qzwy,zw->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Pixy,Qzyw,zw->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,Qa,xy->RPQ', Y_KW__bb, t1_xxae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,Qxaz,yz->RPQ', Y_KW__bb, t1_xxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Piya,Qxza,yz->RPQ', Y_KW__bb, t1_xxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,Qzaw,xwyz->RPQ', Y_KW__bb, t1_xxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,Qzay,xz->RPQ', Y_KW__bb, t1_xxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,Qzwa,xwzy->RPQ', Y_KW__bb, t1_xxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Piya,Qzya,xz->RPQ', Y_KW__bb, t1_xxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Piyx,Qz,yz->RPQ', Y_KW__bb, t1_xxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Piyx,Qzwu,yzwu->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Piyx,Qzwy,zw->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Piyx,Qzyw,zw->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,Qw,xwzy->RPQ', Y_KW__bb, t1_xxaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Piyz,Qwuv,xuvwyz->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Piyz,Qwuv,xuvwzy->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Piyz,Qwuv,xuvywz->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Piyz,Qwuv,xuvyzw->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Piyz,Qwuv,xuvzwy->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/3 * einsum('Rix,Piyz,Qwuv,xuvzyw->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,Qwuy,xuzw->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,Qwuz,xuwy->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Piyz,Qwyu,xuzw->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Piyz,Qwyz,xw->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,Qwzu,xuyw->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,Qwzy,xw->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,Qxwu,yzwu->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,Qxwy,zw->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Piyz,Qxwz,yw->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Piyz,Qxyw,zw->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,Qxzw,yw->RPQ', Y_KW__bb, t1_xxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Piyz,Qy,xz->RPQ', Y_KW__bb, t1_xxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,Qz,xy->RPQ', Y_KW__bb, t1_xxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiab,Pyab,xy->RPQ', Y_KW__bb, t1_vxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiab,Pyba,xy->RPQ', Y_KW__bb, t1_vxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qixa,Pyaz,yz->RPQ', Y_KW__bb, t1_vxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixa,Pyza,yz->RPQ', Y_KW__bb, t1_vxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixy,Pz,yz->RPQ', Y_KW__bb, t1_vxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixy,Pzwu,yzwu->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qixy,Pzwy,zw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qixy,Pzyw,zw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pa,xy->RPQ', Y_KW__bb, t1_vxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pxaz,yz->RPQ', Y_KW__bb, t1_vxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiya,Pxza,yz->RPQ', Y_KW__bb, t1_vxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pzaw,xwyz->RPQ', Y_KW__bb, t1_vxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pzay,xz->RPQ', Y_KW__bb, t1_vxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiya,Pzwa,xwzy->RPQ', Y_KW__bb, t1_vxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiya,Pzya,xz->RPQ', Y_KW__bb, t1_vxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyx,Pz,yz->RPQ', Y_KW__bb, t1_vxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyx,Pzwu,yzwu->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyx,Pzwy,zw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Rix,Qiyx,Pzyw,zw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pw,xwzy->RPQ', Y_KW__bb, t1_vxaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvwyz->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvwzy->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvywz->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvyzw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Qiyz,Pwuv,xuvzwy->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/3 * einsum('Rix,Qiyz,Pwuv,xuvzyw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwuy,xuzw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwuz,xuwy->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pwyu,xuzw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pwyz,xw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwzu,xuyw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pwzy,xw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pxwu,yzwu->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pxwy,zw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pxwz,yw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Pxyw,zw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pxzw,yw->RPQ', Y_KW__bb, t1_vxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,Qiyz,Py,xz->RPQ', Y_KW__bb, t1_vxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Qiyz,Pz,xy->RPQ', Y_KW__bb, t1_vxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iPxa,Qyaz,yz->RPQ', Y_KW__bb, t1_xxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iPxa,Qyza,yz->RPQ', Y_KW__bb, t1_xxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iPya,Qa,xy->RPQ', Y_KW__bb, t1_xxae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iPya,Qxaz,yz->RPQ', Y_KW__bb, t1_xxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPya,Qxza,yz->RPQ', Y_KW__bb, t1_xxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iPya,Qzaw,xwyz->RPQ', Y_KW__bb, t1_xxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iPya,Qzay,xz->RPQ', Y_KW__bb, t1_xxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPya,Qzwa,xwyz->RPQ', Y_KW__bb, t1_xxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPya,Qzya,xz->RPQ', Y_KW__bb, t1_xxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Rix,iQxa,Pyaz,yz->RPQ', Y_KW__bb, t1_xvae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQxa,Pyza,yz->RPQ', Y_KW__bb, t1_xvae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pa,xy->RPQ', Y_KW__bb, t1_xvae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pxaz,yz->RPQ', Y_KW__bb, t1_xvae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,Pxza,yz->RPQ', Y_KW__bb, t1_xvae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pzaw,xwyz->RPQ', Y_KW__bb, t1_xvae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iQya,Pzay,xz->RPQ', Y_KW__bb, t1_xvae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,Pzwa,xwyz->RPQ', Y_KW__bb, t1_xvae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQya,Pzya,xz->RPQ', Y_KW__bb, t1_xvae, t1_xaae, rdm_ca, optimize = einsum_type)
    TY[:, s_c:f_c, s_v:f_v] += temp   
 
    temp =- einsum('RPx,Qx->RPQ', Y_KW__aa, t2_aa, optimize = einsum_type)
    temp -= einsum('RPx,Qx->RPQ', Y_KW__bb, t2_aa, optimize = einsum_type)
    temp -= einsum('RPx,iQax,ia->RPQ', Y_KW__aa, t1_xaea, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,ia->RPQ', Y_KW__aa, t1_xaae, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxy,iy->RPQ', Y_KW__aa, t1_xaaa, t1_xa, optimize = einsum_type)
    temp -= einsum('RPx,iQyx,iy->RPQ', Y_KW__aa, t1_xaaa, t1_xa, optimize = einsum_type)
    temp -= einsum('RPx,ijxa,ijQa->RPQ', Y_KW__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxa,jiQa->RPQ', Y_KW__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('RPx,ijxy,ijQy->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,jiQy->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp -= einsum('RPx,ijxa,ijQa->RPQ', Y_KW__aa, t1_xvae, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxa,jiQa->RPQ', Y_KW__aa, t1_xvae, t1_vxae, optimize = einsum_type)
    temp -= einsum('RPx,ijxy,ijQy->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,jiQy->RPQ', Y_KW__aa, t1_xvaa, t1_vxaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ix,iQ->RPQ', Y_KW__aa, t1_xa, t1_xa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQa,ia->RPQ', Y_KW__aa, t1_xaae, t1_xe, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQy,iy->RPQ', Y_KW__aa, t1_xaaa, t1_xa, optimize = einsum_type)
    temp += einsum('RPx,ixaQ,ia->RPQ', Y_KW__aa, t1_xaea, t1_xe, optimize = einsum_type)
    temp -= einsum('RPx,ixab,iQab->RPQ', Y_KW__aa, t1_xaee, t1_xaee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixab,iQba->RPQ', Y_KW__aa, t1_xaee, t1_xaee, optimize = einsum_type)
    temp -= einsum('RPx,ixay,iQay->RPQ', Y_KW__aa, t1_xaea, t1_xaea, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,iQya->RPQ', Y_KW__aa, t1_xaea, t1_xaae, optimize = einsum_type)
    temp += einsum('RPx,ixyQ,iy->RPQ', Y_KW__aa, t1_xaaa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,iQay->RPQ', Y_KW__aa, t1_xaae, t1_xaea, optimize = einsum_type)
    temp -= einsum('RPx,ixya,iQya->RPQ', Y_KW__aa, t1_xaae, t1_xaae, optimize = einsum_type)
    temp -= einsum('RPx,ixyz,iQyz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,iQzy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, optimize = einsum_type)
    temp -= einsum('RPx,iQax,ia->RPQ', Y_KW__aa, t1_vaea, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,ia->RPQ', Y_KW__aa, t1_vaae, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxy,iy->RPQ', Y_KW__aa, t1_vaaa, t1_va, optimize = einsum_type)
    temp -= einsum('RPx,iQyx,iy->RPQ', Y_KW__aa, t1_vaaa, t1_va, optimize = einsum_type)
    temp -= einsum('RPx,ijxa,ijQa->RPQ', Y_KW__aa, t1_vxae, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxa,jiQa->RPQ', Y_KW__aa, t1_vxae, t1_xvae, optimize = einsum_type)
    temp -= einsum('RPx,ijxy,ijQy->RPQ', Y_KW__aa, t1_vxaa, t1_vxaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,jiQy->RPQ', Y_KW__aa, t1_vxaa, t1_xvaa, optimize = einsum_type)
    temp -= einsum('RPx,ijxa,ijQa->RPQ', Y_KW__aa, t1_vvae, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxa,jiQa->RPQ', Y_KW__aa, t1_vvae, t1_vvae, optimize = einsum_type)
    temp -= einsum('RPx,ijxy,ijQy->RPQ', Y_KW__aa, t1_vvaa, t1_vvaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,jiQy->RPQ', Y_KW__aa, t1_vvaa, t1_vvaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ix,iQ->RPQ', Y_KW__aa, t1_va, t1_va, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQa,ia->RPQ', Y_KW__aa, t1_vaae, t1_ve, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQy,iy->RPQ', Y_KW__aa, t1_vaaa, t1_va, optimize = einsum_type)
    temp += einsum('RPx,ixaQ,ia->RPQ', Y_KW__aa, t1_vaea, t1_ve, optimize = einsum_type)
    temp -= einsum('RPx,ixab,iQab->RPQ', Y_KW__aa, t1_vaee, t1_vaee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixab,iQba->RPQ', Y_KW__aa, t1_vaee, t1_vaee, optimize = einsum_type)
    temp -= einsum('RPx,ixay,iQay->RPQ', Y_KW__aa, t1_vaea, t1_vaea, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,iQya->RPQ', Y_KW__aa, t1_vaea, t1_vaae, optimize = einsum_type)
    temp += einsum('RPx,ixyQ,iy->RPQ', Y_KW__aa, t1_vaaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,iQay->RPQ', Y_KW__aa, t1_vaae, t1_vaea, optimize = einsum_type)
    temp -= einsum('RPx,ixya,iQya->RPQ', Y_KW__aa, t1_vaae, t1_vaae, optimize = einsum_type)
    temp -= einsum('RPx,ixyz,iQyz->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,iQzy->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xa,Qa->RPQ', Y_KW__aa, t1_ae, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,Pa->RPQ', Y_KW__aa, t1_xe, t1_xe, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,Pjab->RPQ', Y_KW__aa, t1_xxee, t1_xxee, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KW__aa, t1_xxee, t1_xxee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KW__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KW__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,Pjab->RPQ', Y_KW__aa, t1_xvee, t1_xvee, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KW__aa, t1_xvee, t1_xvee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KW__aa, t1_xvae, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KW__aa, t1_xvae, t1_vxae, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ix,Px->RPQ', Y_KW__aa, t1_xa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KW__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KW__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KW__aa, t1_vxae, t1_xvae, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KW__aa, t1_vxae, t1_vxae, optimize = einsum_type)
    temp += einsum('Rix,PiQa,xa->RPQ', Y_KW__aa, t1_xxae, t1_ae, optimize = einsum_type)
    temp -= einsum('Rix,Piab,Qxab->RPQ', Y_KW__aa, t1_xxee, t1_aaee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piab,Qxba->RPQ', Y_KW__aa, t1_xxee, t1_aaee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Pixa,Qa->RPQ', Y_KW__aa, t1_xxae, t1_ae, optimize = einsum_type)
    temp -= einsum('Rix,Piya,Qxya->RPQ', Y_KW__aa, t1_xxae, t1_aaae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piya,xQya->RPQ', Y_KW__aa, t1_xxae, t1_aaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPQa,xa->RPQ', Y_KW__aa, t1_xxae, t1_ae, optimize = einsum_type)
    temp -= einsum('Rix,iPxa,Qa->RPQ', Y_KW__aa, t1_xxae, t1_ae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,Qxya->RPQ', Y_KW__aa, t1_xxae, t1_aaae, optimize = einsum_type)
    temp -= einsum('Rix,iPya,xQya->RPQ', Y_KW__aa, t1_xxae, t1_aaae, optimize = einsum_type)
    temp -= einsum('Rix,iQ,Px->RPQ', Y_KW__aa, t1_xa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQab,Pxab->RPQ', Y_KW__aa, t1_xaee, t1_xaee, optimize = einsum_type)
    temp -= einsum('Rix,iQab,Pxba->RPQ', Y_KW__aa, t1_xaee, t1_xaee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQax,Pa->RPQ', Y_KW__aa, t1_xaea, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQay,Pxay->RPQ', Y_KW__aa, t1_xaea, t1_xaea, optimize = einsum_type)
    temp -= einsum('Rix,iQay,Pxya->RPQ', Y_KW__aa, t1_xaea, t1_xaae, optimize = einsum_type)
    temp -= einsum('Rix,iQxa,Pa->RPQ', Y_KW__aa, t1_xaae, t1_xe, optimize = einsum_type)
    temp -= einsum('Rix,iQxy,Py->RPQ', Y_KW__aa, t1_xaaa, t1_xa, optimize = einsum_type)
    temp -= einsum('Rix,iQya,Pxay->RPQ', Y_KW__aa, t1_xaae, t1_xaea, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pxya->RPQ', Y_KW__aa, t1_xaae, t1_xaae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyx,Py->RPQ', Y_KW__aa, t1_xaaa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pxyz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, optimize = einsum_type)
    temp -= einsum('Rix,iQyz,Pxzy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, optimize = einsum_type)
    temp += einsum('Rix,ia,PxQa->RPQ', Y_KW__aa, t1_xe, t1_xaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,PxaQ->RPQ', Y_KW__aa, t1_xe, t1_xaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxa,PjQa->RPQ', Y_KW__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,jPQa->RPQ', Y_KW__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxy,PjQy->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjyQ->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyx,PjQy->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjyQ->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxa,PjQa->RPQ', Y_KW__aa, t1_xvae, t1_xvae, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,jPQa->RPQ', Y_KW__aa, t1_xvae, t1_vxae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxy,PjQy->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjyQ->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyx,PjQy->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjyQ->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
    temp += einsum('Rix,iy,PxQy->RPQ', Y_KW__aa, t1_xa, t1_xaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PxyQ->RPQ', Y_KW__aa, t1_xa, t1_xaaa, optimize = einsum_type)
    temp += einsum('Rix,iy,PyQx->RPQ', Y_KW__aa, t1_xa, t1_xaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PyxQ->RPQ', Y_KW__aa, t1_xa, t1_xaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQx,Py->RPQ', Y_KW__aa, t1_xaaa, t1_xa, optimize = einsum_type)
    temp += einsum('Rix,iyxQ,Py->RPQ', Y_KW__aa, t1_xaaa, t1_xa, optimize = einsum_type)
    temp -= einsum('Rix,jixa,PjQa->RPQ', Y_KW__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,jPQa->RPQ', Y_KW__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('Rix,jixa,PjQa->RPQ', Y_KW__aa, t1_vxae, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,jPQa->RPQ', Y_KW__aa, t1_vxae, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qy,xy->RPQ', Y_KW__aa, t2_aa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,iQax,ia->RPQ', Y_KW__bb, t1_xaea, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,ia->RPQ', Y_KW__bb, t1_xaae, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxy,iy->RPQ', Y_KW__bb, t1_xaaa, t1_xa, optimize = einsum_type)
    temp -= einsum('RPx,iQyx,iy->RPQ', Y_KW__bb, t1_xaaa, t1_xa, optimize = einsum_type)
    temp -= einsum('RPx,ijxa,ijQa->RPQ', Y_KW__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxa,jiQa->RPQ', Y_KW__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('RPx,ijxy,ijQy->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,jiQy->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp -= einsum('RPx,ijxa,ijQa->RPQ', Y_KW__bb, t1_xvae, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxa,jiQa->RPQ', Y_KW__bb, t1_xvae, t1_vxae, optimize = einsum_type)
    temp -= einsum('RPx,ijxy,ijQy->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,jiQy->RPQ', Y_KW__bb, t1_xvaa, t1_vxaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ix,iQ->RPQ', Y_KW__bb, t1_xa, t1_xa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQa,ia->RPQ', Y_KW__bb, t1_xaae, t1_xe, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQy,iy->RPQ', Y_KW__bb, t1_xaaa, t1_xa, optimize = einsum_type)
    temp += einsum('RPx,ixaQ,ia->RPQ', Y_KW__bb, t1_xaea, t1_xe, optimize = einsum_type)
    temp -= einsum('RPx,ixab,iQab->RPQ', Y_KW__bb, t1_xaee, t1_xaee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixab,iQba->RPQ', Y_KW__bb, t1_xaee, t1_xaee, optimize = einsum_type)
    temp -= einsum('RPx,ixay,iQay->RPQ', Y_KW__bb, t1_xaea, t1_xaea, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,iQya->RPQ', Y_KW__bb, t1_xaea, t1_xaae, optimize = einsum_type)
    temp += einsum('RPx,ixyQ,iy->RPQ', Y_KW__bb, t1_xaaa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,iQay->RPQ', Y_KW__bb, t1_xaae, t1_xaea, optimize = einsum_type)
    temp -= einsum('RPx,ixya,iQya->RPQ', Y_KW__bb, t1_xaae, t1_xaae, optimize = einsum_type)
    temp -= einsum('RPx,ixyz,iQyz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,iQzy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, optimize = einsum_type)
    temp -= einsum('RPx,iQax,ia->RPQ', Y_KW__bb, t1_vaea, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,ia->RPQ', Y_KW__bb, t1_vaae, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxy,iy->RPQ', Y_KW__bb, t1_vaaa, t1_va, optimize = einsum_type)
    temp -= einsum('RPx,iQyx,iy->RPQ', Y_KW__bb, t1_vaaa, t1_va, optimize = einsum_type)
    temp -= einsum('RPx,ijxa,ijQa->RPQ', Y_KW__bb, t1_vxae, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxa,jiQa->RPQ', Y_KW__bb, t1_vxae, t1_xvae, optimize = einsum_type)
    temp -= einsum('RPx,ijxy,ijQy->RPQ', Y_KW__bb, t1_vxaa, t1_vxaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,jiQy->RPQ', Y_KW__bb, t1_vxaa, t1_xvaa, optimize = einsum_type)
    temp -= einsum('RPx,ijxa,ijQa->RPQ', Y_KW__bb, t1_vvae, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxa,jiQa->RPQ', Y_KW__bb, t1_vvae, t1_vvae, optimize = einsum_type)
    temp -= einsum('RPx,ijxy,ijQy->RPQ', Y_KW__bb, t1_vvaa, t1_vvaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,jiQy->RPQ', Y_KW__bb, t1_vvaa, t1_vvaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ix,iQ->RPQ', Y_KW__bb, t1_va, t1_va, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQa,ia->RPQ', Y_KW__bb, t1_vaae, t1_ve, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQy,iy->RPQ', Y_KW__bb, t1_vaaa, t1_va, optimize = einsum_type)
    temp += einsum('RPx,ixaQ,ia->RPQ', Y_KW__bb, t1_vaea, t1_ve, optimize = einsum_type)
    temp -= einsum('RPx,ixab,iQab->RPQ', Y_KW__bb, t1_vaee, t1_vaee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixab,iQba->RPQ', Y_KW__bb, t1_vaee, t1_vaee, optimize = einsum_type)
    temp -= einsum('RPx,ixay,iQay->RPQ', Y_KW__bb, t1_vaea, t1_vaea, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,iQya->RPQ', Y_KW__bb, t1_vaea, t1_vaae, optimize = einsum_type)
    temp += einsum('RPx,ixyQ,iy->RPQ', Y_KW__bb, t1_vaaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,iQay->RPQ', Y_KW__bb, t1_vaae, t1_vaea, optimize = einsum_type)
    temp -= einsum('RPx,ixya,iQya->RPQ', Y_KW__bb, t1_vaae, t1_vaae, optimize = einsum_type)
    temp -= einsum('RPx,ixyz,iQyz->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,iQzy->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xa,Qa->RPQ', Y_KW__bb, t1_ae, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,Pa->RPQ', Y_KW__bb, t1_xe, t1_xe, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,Pjab->RPQ', Y_KW__bb, t1_xxee, t1_xxee, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KW__bb, t1_xxee, t1_xxee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KW__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KW__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,Pjab->RPQ', Y_KW__bb, t1_xvee, t1_xvee, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KW__bb, t1_xvee, t1_xvee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KW__bb, t1_xvae, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KW__bb, t1_xvae, t1_vxae, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ix,Px->RPQ', Y_KW__bb, t1_xa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KW__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KW__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KW__bb, t1_vxae, t1_xvae, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KW__bb, t1_vxae, t1_vxae, optimize = einsum_type)
    temp += einsum('Rix,PiQa,xa->RPQ', Y_KW__bb, t1_xxae, t1_ae, optimize = einsum_type)
    temp -= einsum('Rix,Piab,Qxab->RPQ', Y_KW__bb, t1_xxee, t1_aaee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piab,Qxba->RPQ', Y_KW__bb, t1_xxee, t1_aaee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Pixa,Qa->RPQ', Y_KW__bb, t1_xxae, t1_ae, optimize = einsum_type)
    temp -= einsum('Rix,Piya,Qxya->RPQ', Y_KW__bb, t1_xxae, t1_aaae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piya,xQya->RPQ', Y_KW__bb, t1_xxae, t1_aaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPQa,xa->RPQ', Y_KW__bb, t1_xxae, t1_ae, optimize = einsum_type)
    temp -= einsum('Rix,iPxa,Qa->RPQ', Y_KW__bb, t1_xxae, t1_ae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,Qxya->RPQ', Y_KW__bb, t1_xxae, t1_aaae, optimize = einsum_type)
    temp -= einsum('Rix,iPya,xQya->RPQ', Y_KW__bb, t1_xxae, t1_aaae, optimize = einsum_type)
    temp -= einsum('Rix,iQ,Px->RPQ', Y_KW__bb, t1_xa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQab,Pxab->RPQ', Y_KW__bb, t1_xaee, t1_xaee, optimize = einsum_type)
    temp -= einsum('Rix,iQab,Pxba->RPQ', Y_KW__bb, t1_xaee, t1_xaee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQax,Pa->RPQ', Y_KW__bb, t1_xaea, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQay,Pxay->RPQ', Y_KW__bb, t1_xaea, t1_xaea, optimize = einsum_type)
    temp -= einsum('Rix,iQay,Pxya->RPQ', Y_KW__bb, t1_xaea, t1_xaae, optimize = einsum_type)
    temp -= einsum('Rix,iQxa,Pa->RPQ', Y_KW__bb, t1_xaae, t1_xe, optimize = einsum_type)
    temp -= einsum('Rix,iQxy,Py->RPQ', Y_KW__bb, t1_xaaa, t1_xa, optimize = einsum_type)
    temp -= einsum('Rix,iQya,Pxay->RPQ', Y_KW__bb, t1_xaae, t1_xaea, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pxya->RPQ', Y_KW__bb, t1_xaae, t1_xaae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyx,Py->RPQ', Y_KW__bb, t1_xaaa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pxyz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, optimize = einsum_type)
    temp -= einsum('Rix,iQyz,Pxzy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, optimize = einsum_type)
    temp += einsum('Rix,ia,PxQa->RPQ', Y_KW__bb, t1_xe, t1_xaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,PxaQ->RPQ', Y_KW__bb, t1_xe, t1_xaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxa,PjQa->RPQ', Y_KW__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,jPQa->RPQ', Y_KW__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxy,PjQy->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjyQ->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyx,PjQy->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjyQ->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxa,PjQa->RPQ', Y_KW__bb, t1_xvae, t1_xvae, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,jPQa->RPQ', Y_KW__bb, t1_xvae, t1_vxae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxy,PjQy->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjyQ->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyx,PjQy->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjyQ->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, optimize = einsum_type)
    temp += einsum('Rix,iy,PxQy->RPQ', Y_KW__bb, t1_xa, t1_xaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PxyQ->RPQ', Y_KW__bb, t1_xa, t1_xaaa, optimize = einsum_type)
    temp += einsum('Rix,iy,PyQx->RPQ', Y_KW__bb, t1_xa, t1_xaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PyxQ->RPQ', Y_KW__bb, t1_xa, t1_xaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQx,Py->RPQ', Y_KW__bb, t1_xaaa, t1_xa, optimize = einsum_type)
    temp += einsum('Rix,iyxQ,Py->RPQ', Y_KW__bb, t1_xaaa, t1_xa, optimize = einsum_type)
    temp -= einsum('Rix,jixa,PjQa->RPQ', Y_KW__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,jPQa->RPQ', Y_KW__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('Rix,jixa,PjQa->RPQ', Y_KW__bb, t1_vxae, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,jPQa->RPQ', Y_KW__bb, t1_vxae, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,Qy,xy->RPQ', Y_KW__bb, t2_aa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qa,ya,xy->RPQ', Y_KW__aa, t1_ae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qa,yzwa,xwzy->RPQ', Y_KW__aa, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyab,zwab,xyzw->RPQ', Y_KW__aa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,Qyxa,za,yz->RPQ', Y_KW__aa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,Qyxa,zwua,yuwz->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyza,wa,xyzw->RPQ', Y_KW__aa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvuwz->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvuzw->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvwuz->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvwzu->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPx,Qyza,wuva,xyvzuw->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvzwu->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyza,wuza,xywu->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iQ,iy,xy->RPQ', Y_KW__aa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iQ,iyzw,xyzw->RPQ', Y_KW__aa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQab,iyab,xy->RPQ', Y_KW__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQab,iyba,xy->RPQ', Y_KW__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,iQax,iyaz,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQax,iyza,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQay,ia,xy->RPQ', Y_KW__aa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQay,izaw,xwyz->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQay,izay,xz->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQay,izwa,xwyz->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQay,izya,xz->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,iyaz,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxa,iyza,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxy,iz,yz->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxy,izwu,yzwu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxy,izwy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxy,izyw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,ia,xy->RPQ', Y_KW__aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izaw,xwyz->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izay,xz->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izwa,xwzy->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQya,izya,xz->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyx,iz,yz->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyx,izwu,yzwu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyx,izwy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,iQyx,izyw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iw,xwzy->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvwyz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvwzy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvywz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvyzw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvzwy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPx,iQyz,iwuv,xuvzyw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iwuy,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iwuz,xuwy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyz,iwyu,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyz,iwyz,xw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iwzu,xuyw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iwzy,xw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyz,iy,xz->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iz,xy->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQa,ijya,xy->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQa,jiya,xy->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQy,ijyz,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQy,ijzw,xyzw->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQy,jiyz,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,ijQz,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijxy,jiQz,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQa,ijya,xy->RPQ', Y_KW__aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQa,jiya,xy->RPQ', Y_KW__aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQy,ijyz,xz->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQy,ijzw,xyzw->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQy,jiyz,xz->RPQ', Y_KW__aa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,ijQz,yz->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijxy,jiQz,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ix,iyQz,zy->RPQ', Y_KW__aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ix,iyzQ,zy->RPQ', Y_KW__aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQa,iyaz,zy->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQa,iyza,zy->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,iz,yz->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,izwu,yzwu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,izwy,wz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQy,izyw,wz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RPx,ixaQ,iyaz,zy->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixaQ,iyza,zy->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,iQaz,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixay,iQza,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,iz,yz->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,izwu,yzwu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,izwy,wz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RPx,ixyQ,izyw,wz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixya,iQaz,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,iQza,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,iQwu,zyuw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,iQwy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,iQwz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,iQyw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,iQzw,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,ia,xy->RPQ', Y_KW__aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,izaw,xzyw->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,izwa,xzwy->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iw,xzwy->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwuvy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPx,iyQz,iwuv,xzwuyv->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwvuy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwvyu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwyuv->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwyvu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iwuz,xwuy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iwzu,xwyu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iz,xy->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyaQ,ia,xy->RPQ', Y_KW__aa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyaQ,izaw,xzyw->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyaQ,izwa,xzyw->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyax,izQa,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyax,izaQ,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxa,izQa,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxa,izaQ,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iQ,zy->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iwQu,zwyu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iwQz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxz,iwuQ,zwyu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxz,iwzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iw,xzyw->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iwuv,xzwyuv->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iwuz,xwyu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzQ,iwzu,xwyu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzQ,iz,xy->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iQ,zy->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwQu,zwyu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwQz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwuQ,zwuy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzx,iwzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iQ,iy,xy->RPQ', Y_KW__aa, t1_va, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iQ,iyzw,xyzw->RPQ', Y_KW__aa, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQab,iyab,xy->RPQ', Y_KW__aa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQab,iyba,xy->RPQ', Y_KW__aa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,iQax,iyaz,yz->RPQ', Y_KW__aa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQax,iyza,yz->RPQ', Y_KW__aa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQay,ia,xy->RPQ', Y_KW__aa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQay,izaw,xwyz->RPQ', Y_KW__aa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQay,izay,xz->RPQ', Y_KW__aa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQay,izwa,xwyz->RPQ', Y_KW__aa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQay,izya,xz->RPQ', Y_KW__aa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,iyaz,yz->RPQ', Y_KW__aa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxa,iyza,yz->RPQ', Y_KW__aa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxy,iz,yz->RPQ', Y_KW__aa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxy,izwu,yzwu->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxy,izwy,zw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxy,izyw,zw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,ia,xy->RPQ', Y_KW__aa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izaw,xwyz->RPQ', Y_KW__aa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izay,xz->RPQ', Y_KW__aa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izwa,xwzy->RPQ', Y_KW__aa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQya,izya,xz->RPQ', Y_KW__aa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyx,iz,yz->RPQ', Y_KW__aa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyx,izwu,yzwu->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyx,izwy,zw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,iQyx,izyw,zw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iw,xwzy->RPQ', Y_KW__aa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvwyz->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvwzy->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvywz->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvyzw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvzwy->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPx,iQyz,iwuv,xuvzyw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iwuy,xuzw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iwuz,xuwy->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyz,iwyu,xuzw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyz,iwyz,xw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iwzu,xuyw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iwzy,xw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyz,iy,xz->RPQ', Y_KW__aa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iz,xy->RPQ', Y_KW__aa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQa,ijya,xy->RPQ', Y_KW__aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQa,jiya,xy->RPQ', Y_KW__aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQy,ijyz,xz->RPQ', Y_KW__aa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQy,ijzw,xyzw->RPQ', Y_KW__aa, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQy,jiyz,xz->RPQ', Y_KW__aa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,ijQz,yz->RPQ', Y_KW__aa, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijxy,jiQz,yz->RPQ', Y_KW__aa, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQa,ijya,xy->RPQ', Y_KW__aa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQa,jiya,xy->RPQ', Y_KW__aa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQy,ijyz,xz->RPQ', Y_KW__aa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQy,ijzw,xyzw->RPQ', Y_KW__aa, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQy,jiyz,xz->RPQ', Y_KW__aa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,ijQz,yz->RPQ', Y_KW__aa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijxy,jiQz,yz->RPQ', Y_KW__aa, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ix,iyQz,zy->RPQ', Y_KW__aa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ix,iyzQ,zy->RPQ', Y_KW__aa, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQa,iyaz,zy->RPQ', Y_KW__aa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQa,iyza,zy->RPQ', Y_KW__aa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,iz,yz->RPQ', Y_KW__aa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,izwu,yzwu->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,izwy,wz->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQy,izyw,wz->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RPx,ixaQ,iyaz,zy->RPQ', Y_KW__aa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixaQ,iyza,zy->RPQ', Y_KW__aa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,iQaz,yz->RPQ', Y_KW__aa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixay,iQza,yz->RPQ', Y_KW__aa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,iz,yz->RPQ', Y_KW__aa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,izwu,yzwu->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,izwy,wz->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RPx,ixyQ,izyw,wz->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixya,iQaz,yz->RPQ', Y_KW__aa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,iQza,yz->RPQ', Y_KW__aa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,iQwu,zyuw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,iQwy,zw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,iQwz,yw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,iQyw,zw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,iQzw,yw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,ia,xy->RPQ', Y_KW__aa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,izaw,xzyw->RPQ', Y_KW__aa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,izwa,xzwy->RPQ', Y_KW__aa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iw,xzwy->RPQ', Y_KW__aa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwuvy->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPx,iyQz,iwuv,xzwuyv->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwvuy->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwvyu->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwyuv->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwyvu->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iwuz,xwuy->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iwzu,xwyu->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iz,xy->RPQ', Y_KW__aa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyaQ,ia,xy->RPQ', Y_KW__aa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyaQ,izaw,xzyw->RPQ', Y_KW__aa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyaQ,izwa,xzyw->RPQ', Y_KW__aa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyax,izQa,yz->RPQ', Y_KW__aa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyax,izaQ,yz->RPQ', Y_KW__aa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxa,izQa,yz->RPQ', Y_KW__aa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxa,izaQ,yz->RPQ', Y_KW__aa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iQ,zy->RPQ', Y_KW__aa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iwQu,zwyu->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iwQz,yw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxz,iwuQ,zwyu->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxz,iwzQ,yw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iw,xzyw->RPQ', Y_KW__aa, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iwuv,xzwyuv->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iwuz,xwyu->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzQ,iwzu,xwyu->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzQ,iz,xy->RPQ', Y_KW__aa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iQ,zy->RPQ', Y_KW__aa, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwQu,zwyu->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwQz,yw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwuQ,zwuy->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzx,iwzQ,yw->RPQ', Y_KW__aa, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xa,Qyza,yz->RPQ', Y_KW__aa, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xa,yQza,yz->RPQ', Y_KW__aa, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,xyQa,za,yz->RPQ', Y_KW__aa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,xyQa,zwua,yuwz->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xyab,Qzab,yz->RPQ', Y_KW__aa, t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyab,Qzba,yz->RPQ', Y_KW__aa, t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qa,yz->RPQ', Y_KW__aa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qwua,yuwz->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xyza,Qwza,yw->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,wQua,yuzw->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,wQza,yw->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yQxa,za,yz->RPQ', Y_KW__aa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yQxa,zwua,yuwz->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yQza,wa,xywz->RPQ', Y_KW__aa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yQza,wuva,xyvuzw->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yQza,wuza,xyuw->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,yxQa,za,yz->RPQ', Y_KW__aa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,yxQa,zwua,yuwz->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yxza,Qa,yz->RPQ', Y_KW__aa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yxza,Qwua,yuzw->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yxza,Qwza,yw->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yxza,wQua,yuzw->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yxza,wQza,yw->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,yzQa,wa,xwyz->RPQ', Y_KW__aa, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,yzQa,wuva,xuwvyz->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,yzQa,wuva,xuwvzy->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,yzQa,wuva,xuwyvz->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPx,yzQa,wuva,xuwyzv->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,yzQa,wuva,xuwzvy->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,yzQa,wuva,xuwzyv->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,yzxa,wuQa,yzwu->RPQ', Y_KW__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,Pxay,xy->RPQ', Y_KW__aa, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ia,Pxya,xy->RPQ', Y_KW__aa, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KW__aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KW__aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ix,Pyxz,yz->RPQ', Y_KW__aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ix,Pyzx,yz->RPQ', Y_KW__aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixab,Pyab,xy->RPQ', Y_KW__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixab,Pyba,xy->RPQ', Y_KW__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pa,xy->RPQ', Y_KW__aa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pzaw,xwyz->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pzay,xz->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzwa,xwyz->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzya,xz->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pa,xy->RPQ', Y_KW__aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzaw,xwyz->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzay,xz->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzwa,xwzy->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixya,Pzya,xz->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwuy,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwuz,xuwy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Pwyu,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Pwyz,xw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwzu,xuyw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwzy,xw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixyz,Pxwu,yzwu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Py,xz->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pz,xy->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KW__aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KW__aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,xyza,yz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,ya,xy->RPQ', Y_KW__aa, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,PiQa,yxza,yz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,yzwa,xwzy->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piab,Qyab,xy->RPQ', Y_KW__aa, t1_xxee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piab,Qyba,xy->RPQ', Y_KW__aa, t1_xxee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piab,xyab,Qy->RPQ', Y_KW__aa, t1_xxee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piab,xyba,Qy->RPQ', Y_KW__aa, t1_xxee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piab,yzab,Qxyz->RPQ', Y_KW__aa, t1_xxee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Pixa,Qyza,yz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Pixa,yQza,yz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Pixa,ya,Qy->RPQ', Y_KW__aa, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Pixa,yzwa,Qwzy->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,Qa,xy->RPQ', Y_KW__aa, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piya,Qxza,yz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,Qzwa,xwzy->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piya,Qzya,xz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,xQza,yz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,xa,Qy->RPQ', Y_KW__aa, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piya,xzwa,Qwyz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piya,xzya,Qz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,zQwa,xwyz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,zQya,xz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piya,za,Qxyz->RPQ', Y_KW__aa, t1_xxae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuwyz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuwzy->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Piya,zwua,Qxuywz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuyzw->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuzwy->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuzyw->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piya,zwya,Qxzw->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,zxwa,Qwyz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,zxya,Qz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPQa,xyza,yz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPQa,ya,xy->RPQ', Y_KW__aa, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPQa,yxza,yz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPQa,yzwa,xwzy->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPxa,Qyza,yz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iPxa,yQza,yz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPxa,ya,Qy->RPQ', Y_KW__aa, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPxa,yzwa,Qwzy->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,Qa,xy->RPQ', Y_KW__aa, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iPya,Qxza,yz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iPya,Qzwa,xwyz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iPya,Qzya,xz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,xQza,yz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,xa,Qy->RPQ', Y_KW__aa, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,xzwa,Qwzy->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPya,xzya,Qz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,zQwa,xwyz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,zQya,xz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,za,Qxzy->RPQ', Y_KW__aa, t1_xxae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,zwua,Qxuwyz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,zwya,Qxwz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,zxwa,Qwyz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,zxya,Qz->RPQ', Y_KW__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Py,xy->RPQ', Y_KW__aa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iQ,Pyxz,yz->RPQ', Y_KW__aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Pyzw,xyzw->RPQ', Y_KW__aa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Pyzx,yz->RPQ', Y_KW__aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQab,Pyab,xy->RPQ', Y_KW__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQab,Pyba,xy->RPQ', Y_KW__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQax,Pyaz,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQax,Pyza,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pa,xy->RPQ', Y_KW__aa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pxaz,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQay,Pxza,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pzaw,xwyz->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pzay,xz->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pzwa,xwzy->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQay,Pzya,xz->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iQxa,Pyaz,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQxa,Pyza,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQxy,Pz,yz->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQxy,Pzwu,yzwu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQxy,Pzwy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iQxy,Pzyw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pa,xy->RPQ', Y_KW__aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pxaz,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQya,Pxza,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pzaw,xwyz->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pzay,xz->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQya,Pzwa,xwyz->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQya,Pzya,xz->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyx,Pz,yz->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyx,Pzwu,yzwu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyx,Pzwy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyx,Pzyw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyz,Pw,xwyz->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyz,Pwuv,xuvyzw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pwuy,xuwz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pwuz,xuyw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pwyu,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pwyz,xw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pwzu,xuyw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pwzy,xw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyz,Pxwu,zywu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pxwy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pxwz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pxyw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pxzw,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Py,xz->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pz,xy->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pa,Qx->RPQ', Y_KW__aa, t1_xe, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pxay,Qy->RPQ', Y_KW__aa, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,Pxya,Qy->RPQ', Y_KW__aa, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,PyQa,xy->RPQ', Y_KW__aa, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,PyaQ,xy->RPQ', Y_KW__aa, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pyaz,Qyxz->RPQ', Y_KW__aa, t1_xe, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pyza,Qyzx->RPQ', Y_KW__aa, t1_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijab,Pjab,Qx->RPQ', Y_KW__aa, t1_xxee, t1_xxee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijab,Pjba,Qx->RPQ', Y_KW__aa, t1_xxee, t1_xxee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,Pjya,Qy->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxa,jPya,Qy->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjQz,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,Pjyz,Qz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,PjzQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,Pjzw,Qyzw->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,Pjzy,Qz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijya,PjQa,xy->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,Pjya,Qx->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,Pjza,Qyzx->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,jPQa,xy->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPya,Qx->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPza,Qyzx->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjQz,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,Pjyz,Qz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,PjzQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,Pjzw,Qyzw->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,Pjzy,Qz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjQw,xwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjQy,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyz,PjQz,xy->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjwQ,xwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzuwx->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzuxw->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzwux->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,ijyz,Pjwu,Qyzwxu->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzxuw->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzxwu->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjwy,Qzwx->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,Pjwz,Qywx->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjyQ,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjyw,Qzxw->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,Pjyz,Qx->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjzQ,xy->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjzw,Qywx->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjzy,Qx->RPQ', Y_KW__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijab,Pjab,Qx->RPQ', Y_KW__aa, t1_xvee, t1_xvee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijab,Pjba,Qx->RPQ', Y_KW__aa, t1_xvee, t1_xvee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,Pjya,Qy->RPQ', Y_KW__aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxa,jPya,Qy->RPQ', Y_KW__aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjQz,yz->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,Pjyz,Qz->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,PjzQ,yz->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,Pjzw,Qyzw->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,Pjzy,Qz->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijya,PjQa,xy->RPQ', Y_KW__aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,Pjya,Qx->RPQ', Y_KW__aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,Pjza,Qyzx->RPQ', Y_KW__aa, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,jPQa,xy->RPQ', Y_KW__aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPya,Qx->RPQ', Y_KW__aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPza,Qyzx->RPQ', Y_KW__aa, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjQz,yz->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,Pjyz,Qz->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,PjzQ,yz->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,Pjzw,Qyzw->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,Pjzy,Qz->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjQw,xwyz->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjQy,xz->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyz,PjQz,xy->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjwQ,xwyz->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzuwx->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzuxw->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzwux->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,ijyz,Pjwu,Qyzwxu->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzxuw->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzxwu->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjwy,Qzwx->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,Pjwz,Qywx->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjyQ,xz->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjyw,Qzxw->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,Pjyz,Qx->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjzQ,xy->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjzw,Qywx->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjzy,Qx->RPQ', Y_KW__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pxyz,Qz->RPQ', Y_KW__aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,Pxzy,Qz->RPQ', Y_KW__aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Py,Qx->RPQ', Y_KW__aa, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PyQz,xz->RPQ', Y_KW__aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pyxz,Qz->RPQ', Y_KW__aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,PyzQ,xz->RPQ', Y_KW__aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pyzw,Qxzw->RPQ', Y_KW__aa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,Pyzx,Qz->RPQ', Y_KW__aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PzQy,xz->RPQ', Y_KW__aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pzwy,Qzwx->RPQ', Y_KW__aa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,PzyQ,xz->RPQ', Y_KW__aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pzyw,Qzxw->RPQ', Y_KW__aa, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQx,Pz,yz->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQx,Pzwu,yzwu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQx,Pzwy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQx,Pzyw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQz,Pw,xywz->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywuvz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rix,iyQz,Pwuv,xywuzv->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywvuz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywvzu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywzuv->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywzvu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQz,Pwux,zuyw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwuy,xwuz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,iyQz,Pwxu,zuyw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQz,Pwxy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwyu,xwzu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwyx,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyQz,Px,zy->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Py,xz->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pzwu,xywu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pzwx,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQz,Pzxw,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyab,Pxab,Qy->RPQ', Y_KW__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyab,Pxba,Qy->RPQ', Y_KW__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyab,Pzab,Qzxy->RPQ', Y_KW__aa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyab,Pzba,Qzyx->RPQ', Y_KW__aa, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,Pa,Qy->RPQ', Y_KW__aa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyax,PzQa,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,PzaQ,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,Pzaw,Qzyw->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,Pzwa,Qzwy->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pa,Qzxy->RPQ', Y_KW__aa, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,PwQa,xywz->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,PwaQ,xywz->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pwau,Qzwxyu->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pwaz,Qwxy->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwuxy->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyaz,Pwua,Qzwuyx->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwxuy->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwxyu->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwyux->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwyxu->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pwza,Qwyx->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyaz,PxQa,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,PxaQ,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pxaw,Qzwy->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pxaz,Qy->RPQ', Y_KW__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,Pxwa,Qzwy->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,Pxza,Qy->RPQ', Y_KW__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxQ,Pz,yz->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxQ,Pzwu,yzwu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxQ,Pzwy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxQ,Pzyw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,Pa,Qy->RPQ', Y_KW__aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxa,PzQa,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,PzaQ,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,Pzaw,Qzyw->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,Pzwa,Qzwy->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,iyxz,PwQy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxz,PwQz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,Pwuy,Qwuz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,Pwuz,Qwuy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,PwyQ,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,Pwyu,Qwzu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,PwzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,Pwzu,Qwyu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,Py,Qz->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxz,PyQw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,PywQ,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,Pywu,Qzwu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,Pz,Qy->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxz,PzQw,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,PzwQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,Pzwu,Qywu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pw,xyzw->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwuv,xywzuv->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwux,zuwy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pwuy,xwzu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwxu,zuyw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pwxy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pwyu,xwzu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pwyx,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Px,zy->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Py,xz->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pzwu,xyuw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pzwx,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pzxw,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pa,Qzyx->RPQ', Y_KW__aa, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,PwQa,xyzw->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,PwaQ,xyzw->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwuxy->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwuyx->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwxuy->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwxyu->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwyux->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyza,Pwau,Qzwyxu->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pwaz,Qwyx->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pwua,Qzwuxy->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pwza,Qwxy->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,PxQa,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,PxaQ,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pxaw,Qzyw->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,Pxaz,Qy->RPQ', Y_KW__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pxwa,Qzwy->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pxza,Qy->RPQ', Y_KW__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PuQw,xyzu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,PuQy,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PuQz,xyuw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Puvw,Qzuvxy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,Puvy,Qxuvzw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuvxy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzw,Puvz,Qwuvyx->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuxvy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuxyv->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuyvx->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuyxv->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PuwQ,xyzu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuvxy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuvyx->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuxvy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuxyv->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuyvx->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzw,Puwv,Qzuyxv->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Puwz,Quyx->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,Puxy,Quzw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,PuyQ,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuvwz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuvzw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuwvz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyzw,Puyv,Qxuwzv->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuzvw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuzwv->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,Puyx,Quwz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PuzQ,xyuw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Puzv,Qwuxyv->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Puzw,Quxy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pw,Qzyx->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PwQu,xyzu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PwQx,yz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PwuQ,xyzu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyuvz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzw,Pwuv,Qxyuzv->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyvuz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyvzu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyzuv->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyzvu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pwux,Qyuz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PwxQ,yz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pwxu,Qyzu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PxQw,yz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyzw,PxQz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pxuw,Qzuy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,Pxuz,Qwuy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PxwQ,yz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pxwu,Qzyu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,Pxwz,Qy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PxzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pxzu,Qwuy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pxzw,Qy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,Py,Qxwz->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,PyQu,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,PyuQ,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwuvx->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyzw,Pyuv,Qzwuxv->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwvux->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwvxu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwxuv->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwxvu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pz,Qwxy->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PzQu,xyuw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyzw,PzQx,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PzuQ,xyuw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pzuv,Qxyuvw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,Pzux,Qyuw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PzxQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pzxu,Qyuw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzx,PwQy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzx,PwQz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,Pwuy,Qwuz->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,Pwuz,Qwuy->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,PwyQ,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,Pwyu,Qwzu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,PwzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,Pwzu,Qwyu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,Py,Qz->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzx,PyQw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,PywQ,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,Pywu,Qzwu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,Pz,Qy->RPQ', Y_KW__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzx,PzQw,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,PzwQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,Pzwu,Qywu->RPQ', Y_KW__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,Pjya,Qy->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jixa,jPya,Qy->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,PjQa,xy->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,Pjya,Qx->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,Pjza,Qyzx->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPQa,xy->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,jPya,Qx->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPza,Qyxz->RPQ', Y_KW__aa, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,Pjya,Qy->RPQ', Y_KW__aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jixa,jPya,Qy->RPQ', Y_KW__aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,PjQa,xy->RPQ', Y_KW__aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,Pjya,Qx->RPQ', Y_KW__aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,Pjza,Qyzx->RPQ', Y_KW__aa, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPQa,xy->RPQ', Y_KW__aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,jPya,Qx->RPQ', Y_KW__aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPza,Qyxz->RPQ', Y_KW__aa, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qa,ya,xy->RPQ', Y_KW__bb, t1_ae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qa,yzwa,xwzy->RPQ', Y_KW__bb, t1_ae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyab,zwab,xyzw->RPQ', Y_KW__bb, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,Qyxa,za,yz->RPQ', Y_KW__bb, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,Qyxa,zwua,yuwz->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyza,wa,xyzw->RPQ', Y_KW__bb, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvuwz->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvuzw->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvwuz->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvwzu->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPx,Qyza,wuva,xyvzuw->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,Qyza,wuva,xyvzwu->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,Qyza,wuza,xywu->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iQ,iy,xy->RPQ', Y_KW__bb, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iQ,iyzw,xyzw->RPQ', Y_KW__bb, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQab,iyab,xy->RPQ', Y_KW__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQab,iyba,xy->RPQ', Y_KW__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,iQax,iyaz,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQax,iyza,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQay,ia,xy->RPQ', Y_KW__bb, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQay,izaw,xwyz->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQay,izay,xz->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQay,izwa,xwyz->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQay,izya,xz->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,iyaz,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxa,iyza,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxy,iz,yz->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxy,izwu,yzwu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxy,izwy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxy,izyw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,ia,xy->RPQ', Y_KW__bb, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izaw,xwyz->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izay,xz->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izwa,xwzy->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQya,izya,xz->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyx,iz,yz->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyx,izwu,yzwu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyx,izwy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,iQyx,izyw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iw,xwzy->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvwyz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvwzy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvywz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvyzw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvzwy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPx,iQyz,iwuv,xuvzyw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iwuy,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iwuz,xuwy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyz,iwyu,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyz,iwyz,xw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iwzu,xuyw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iwzy,xw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyz,iy,xz->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iz,xy->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQa,ijya,xy->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQa,jiya,xy->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQy,ijyz,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQy,ijzw,xyzw->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQy,jiyz,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,ijQz,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijxy,jiQz,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQa,ijya,xy->RPQ', Y_KW__bb, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQa,jiya,xy->RPQ', Y_KW__bb, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQy,ijyz,xz->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQy,ijzw,xyzw->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQy,jiyz,xz->RPQ', Y_KW__bb, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,ijQz,yz->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijxy,jiQz,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ix,iyQz,zy->RPQ', Y_KW__bb, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ix,iyzQ,zy->RPQ', Y_KW__bb, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQa,iyaz,zy->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQa,iyza,zy->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,iz,yz->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,izwu,yzwu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,izwy,wz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQy,izyw,wz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RPx,ixaQ,iyaz,zy->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixaQ,iyza,zy->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,iQaz,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixay,iQza,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,iz,yz->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,izwu,yzwu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,izwy,wz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RPx,ixyQ,izyw,wz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixya,iQaz,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,iQza,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,iQwu,zyuw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,iQwy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,iQwz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,iQyw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,iQzw,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,ia,xy->RPQ', Y_KW__bb, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,izaw,xzyw->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,izwa,xzwy->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iw,xzwy->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwuvy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPx,iyQz,iwuv,xzwuyv->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwvuy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwvyu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwyuv->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwyvu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iwuz,xwuy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iwzu,xwyu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iz,xy->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyaQ,ia,xy->RPQ', Y_KW__bb, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyaQ,izaw,xzyw->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyaQ,izwa,xzyw->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyax,izQa,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyax,izaQ,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxa,izQa,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxa,izaQ,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iQ,zy->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iwQu,zwyu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iwQz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxz,iwuQ,zwyu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxz,iwzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iw,xzyw->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iwuv,xzwyuv->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iwuz,xwyu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzQ,iwzu,xwyu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzQ,iz,xy->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iQ,zy->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwQu,zwyu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwQz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwuQ,zwuy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzx,iwzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iQ,iy,xy->RPQ', Y_KW__bb, t1_va, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iQ,iyzw,xyzw->RPQ', Y_KW__bb, t1_va, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQab,iyab,xy->RPQ', Y_KW__bb, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQab,iyba,xy->RPQ', Y_KW__bb, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,iQax,iyaz,yz->RPQ', Y_KW__bb, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQax,iyza,yz->RPQ', Y_KW__bb, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQay,ia,xy->RPQ', Y_KW__bb, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQay,izaw,xwyz->RPQ', Y_KW__bb, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQay,izay,xz->RPQ', Y_KW__bb, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQay,izwa,xwyz->RPQ', Y_KW__bb, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQay,izya,xz->RPQ', Y_KW__bb, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxa,iyaz,yz->RPQ', Y_KW__bb, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxa,iyza,yz->RPQ', Y_KW__bb, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxy,iz,yz->RPQ', Y_KW__bb, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxy,izwu,yzwu->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQxy,izwy,zw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQxy,izyw,zw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,ia,xy->RPQ', Y_KW__bb, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izaw,xwyz->RPQ', Y_KW__bb, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izay,xz->RPQ', Y_KW__bb, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQya,izwa,xwzy->RPQ', Y_KW__bb, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQya,izya,xz->RPQ', Y_KW__bb, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyx,iz,yz->RPQ', Y_KW__bb, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyx,izwu,yzwu->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyx,izwy,zw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,iQyx,izyw,zw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iw,xwzy->RPQ', Y_KW__bb, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvwyz->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvwzy->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvywz->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvyzw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,iQyz,iwuv,xuvzwy->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPx,iQyz,iwuv,xuvzyw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iwuy,xuzw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iwuz,xuwy->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyz,iwyu,xuzw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyz,iwyz,xw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iwzu,xuyw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iwzy,xw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,iQyz,iy,xz->RPQ', Y_KW__bb, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,iQyz,iz,xy->RPQ', Y_KW__bb, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQa,ijya,xy->RPQ', Y_KW__bb, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQa,jiya,xy->RPQ', Y_KW__bb, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQy,ijyz,xz->RPQ', Y_KW__bb, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQy,ijzw,xyzw->RPQ', Y_KW__bb, t1_vxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQy,jiyz,xz->RPQ', Y_KW__bb, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,ijQz,yz->RPQ', Y_KW__bb, t1_vxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijxy,jiQz,yz->RPQ', Y_KW__bb, t1_vxaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQa,ijya,xy->RPQ', Y_KW__bb, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQa,jiya,xy->RPQ', Y_KW__bb, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQy,ijyz,xz->RPQ', Y_KW__bb, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQy,ijzw,xyzw->RPQ', Y_KW__bb, t1_vvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQy,jiyz,xz->RPQ', Y_KW__bb, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,ijQz,yz->RPQ', Y_KW__bb, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijxy,jiQz,yz->RPQ', Y_KW__bb, t1_vvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ix,iyQz,zy->RPQ', Y_KW__bb, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ix,iyzQ,zy->RPQ', Y_KW__bb, t1_va, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQa,iyaz,zy->RPQ', Y_KW__bb, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQa,iyza,zy->RPQ', Y_KW__bb, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,iz,yz->RPQ', Y_KW__bb, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,izwu,yzwu->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,izwy,wz->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQy,izyw,wz->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RPx,ixaQ,iyaz,zy->RPQ', Y_KW__bb, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixaQ,iyza,zy->RPQ', Y_KW__bb, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixay,iQaz,yz->RPQ', Y_KW__bb, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixay,iQza,yz->RPQ', Y_KW__bb, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,iz,yz->RPQ', Y_KW__bb, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,izwu,yzwu->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,izwy,wz->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RPx,ixyQ,izyw,wz->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixya,iQaz,yz->RPQ', Y_KW__bb, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixya,iQza,yz->RPQ', Y_KW__bb, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,iQwu,zyuw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,iQwy,zw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,iQwz,yw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ixyz,iQyw,zw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ixyz,iQzw,yw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,ia,xy->RPQ', Y_KW__bb, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,izaw,xzyw->RPQ', Y_KW__bb, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,izwa,xzwy->RPQ', Y_KW__bb, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iw,xzwy->RPQ', Y_KW__bb, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwuvy->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPx,iyQz,iwuv,xzwuyv->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwvuy->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwvyu->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwyuv->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwyvu->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iwuz,xwuy->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iwzu,xwyu->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iz,xy->RPQ', Y_KW__bb, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyaQ,ia,xy->RPQ', Y_KW__bb, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyaQ,izaw,xzyw->RPQ', Y_KW__bb, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyaQ,izwa,xzyw->RPQ', Y_KW__bb, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyax,izQa,yz->RPQ', Y_KW__bb, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyax,izaQ,yz->RPQ', Y_KW__bb, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxa,izQa,yz->RPQ', Y_KW__bb, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxa,izaQ,yz->RPQ', Y_KW__bb, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iQ,zy->RPQ', Y_KW__bb, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iwQu,zwyu->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iwQz,yw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxz,iwuQ,zwyu->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxz,iwzQ,yw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iw,xzyw->RPQ', Y_KW__bb, t1_vaaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iwuv,xzwyuv->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iwuz,xwyu->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzQ,iwzu,xwyu->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzQ,iz,xy->RPQ', Y_KW__bb, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iQ,zy->RPQ', Y_KW__bb, t1_vaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwQu,zwyu->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwQz,yw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwuQ,zwuy->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzx,iwzQ,yw->RPQ', Y_KW__bb, t1_vaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xa,Qyza,yz->RPQ', Y_KW__bb, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xa,yQza,yz->RPQ', Y_KW__bb, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,xyQa,za,yz->RPQ', Y_KW__bb, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,xyQa,zwua,yuwz->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xyab,Qzab,yz->RPQ', Y_KW__bb, t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyab,Qzba,yz->RPQ', Y_KW__bb, t1_aaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qa,yz->RPQ', Y_KW__bb, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,Qwua,yuwz->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,xyza,Qwza,yw->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,wQua,yuzw->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,xyza,wQza,yw->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yQxa,za,yz->RPQ', Y_KW__bb, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yQxa,zwua,yuwz->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yQza,wa,xywz->RPQ', Y_KW__bb, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yQza,wuva,xyvuzw->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yQza,wuza,xyuw->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,yxQa,za,yz->RPQ', Y_KW__bb, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,yxQa,zwua,yuwz->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yxza,Qa,yz->RPQ', Y_KW__bb, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yxza,Qwua,yuzw->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,yxza,Qwza,yw->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yxza,wQua,yuzw->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yxza,wQza,yw->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,yzQa,wa,xwyz->RPQ', Y_KW__bb, t1_aaae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,yzQa,wuva,xuwvyz->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,yzQa,wuva,xuwvzy->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,yzQa,wuva,xuwyvz->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPx,yzQa,wuva,xuwyzv->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,yzQa,wuva,xuwzvy->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,yzQa,wuva,xuwzyv->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,yzxa,wuQa,yzwu->RPQ', Y_KW__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,Pxay,xy->RPQ', Y_KW__bb, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ia,Pxya,xy->RPQ', Y_KW__bb, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KW__bb, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KW__bb, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ix,Pyxz,yz->RPQ', Y_KW__bb, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ix,Pyzx,yz->RPQ', Y_KW__bb, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixab,Pyab,xy->RPQ', Y_KW__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixab,Pyba,xy->RPQ', Y_KW__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pa,xy->RPQ', Y_KW__bb, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pzaw,xwyz->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pzay,xz->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzwa,xwyz->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzya,xz->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pa,xy->RPQ', Y_KW__bb, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzaw,xwyz->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzay,xz->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzwa,xwzy->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixya,Pzya,xz->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwuy,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwuz,xuwy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Pwyu,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Pwyz,xw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwzu,xuyw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwzy,xw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixyz,Pxwu,yzwu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Py,xz->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pz,xy->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KW__bb, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KW__bb, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,xyza,yz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,ya,xy->RPQ', Y_KW__bb, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,PiQa,yxza,yz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,yzwa,xwzy->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piab,Qyab,xy->RPQ', Y_KW__bb, t1_xxee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piab,Qyba,xy->RPQ', Y_KW__bb, t1_xxee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piab,xyab,Qy->RPQ', Y_KW__bb, t1_xxee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piab,xyba,Qy->RPQ', Y_KW__bb, t1_xxee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piab,yzab,Qxyz->RPQ', Y_KW__bb, t1_xxee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Pixa,Qyza,yz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Pixa,yQza,yz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Pixa,ya,Qy->RPQ', Y_KW__bb, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Pixa,yzwa,Qwzy->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,Qa,xy->RPQ', Y_KW__bb, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piya,Qxza,yz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,Qzwa,xwzy->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piya,Qzya,xz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,xQza,yz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,xa,Qy->RPQ', Y_KW__bb, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piya,xzwa,Qwyz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piya,xzya,Qz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,zQwa,xwyz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,zQya,xz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piya,za,Qxyz->RPQ', Y_KW__bb, t1_xxae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuwyz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuwzy->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Piya,zwua,Qxuywz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuyzw->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuzwy->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuzyw->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piya,zwya,Qxzw->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,zxwa,Qwyz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,zxya,Qz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPQa,xyza,yz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPQa,ya,xy->RPQ', Y_KW__bb, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPQa,yxza,yz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPQa,yzwa,xwzy->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPxa,Qyza,yz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iPxa,yQza,yz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPxa,ya,Qy->RPQ', Y_KW__bb, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPxa,yzwa,Qwzy->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,Qa,xy->RPQ', Y_KW__bb, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iPya,Qxza,yz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iPya,Qzwa,xwyz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iPya,Qzya,xz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,xQza,yz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,xa,Qy->RPQ', Y_KW__bb, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,xzwa,Qwzy->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPya,xzya,Qz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,zQwa,xwyz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,zQya,xz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,za,Qxzy->RPQ', Y_KW__bb, t1_xxae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,zwua,Qxuwyz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,zwya,Qxwz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,zxwa,Qwyz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,zxya,Qz->RPQ', Y_KW__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Py,xy->RPQ', Y_KW__bb, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iQ,Pyxz,yz->RPQ', Y_KW__bb, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Pyzw,xyzw->RPQ', Y_KW__bb, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Pyzx,yz->RPQ', Y_KW__bb, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQab,Pyab,xy->RPQ', Y_KW__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQab,Pyba,xy->RPQ', Y_KW__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQax,Pyaz,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQax,Pyza,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pa,xy->RPQ', Y_KW__bb, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pxaz,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQay,Pxza,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pzaw,xwyz->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pzay,xz->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pzwa,xwzy->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQay,Pzya,xz->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iQxa,Pyaz,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQxa,Pyza,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQxy,Pz,yz->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQxy,Pzwu,yzwu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQxy,Pzwy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iQxy,Pzyw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pa,xy->RPQ', Y_KW__bb, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pxaz,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQya,Pxza,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pzaw,xwyz->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pzay,xz->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQya,Pzwa,xwyz->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQya,Pzya,xz->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyx,Pz,yz->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyx,Pzwu,yzwu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyx,Pzwy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyx,Pzyw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyz,Pw,xwyz->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyz,Pwuv,xuvyzw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pwuy,xuwz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pwuz,xuyw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pwyu,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pwyz,xw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pwzu,xuyw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pwzy,xw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyz,Pxwu,zywu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pxwy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pxwz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pxyw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pxzw,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Py,xz->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pz,xy->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pa,Qx->RPQ', Y_KW__bb, t1_xe, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pxay,Qy->RPQ', Y_KW__bb, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,Pxya,Qy->RPQ', Y_KW__bb, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,PyQa,xy->RPQ', Y_KW__bb, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,PyaQ,xy->RPQ', Y_KW__bb, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pyaz,Qyxz->RPQ', Y_KW__bb, t1_xe, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pyza,Qyzx->RPQ', Y_KW__bb, t1_xe, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijab,Pjab,Qx->RPQ', Y_KW__bb, t1_xxee, t1_xxee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijab,Pjba,Qx->RPQ', Y_KW__bb, t1_xxee, t1_xxee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,Pjya,Qy->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxa,jPya,Qy->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjQz,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,Pjyz,Qz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,PjzQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,Pjzw,Qyzw->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,Pjzy,Qz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijya,PjQa,xy->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,Pjya,Qx->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,Pjza,Qyzx->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,jPQa,xy->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPya,Qx->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPza,Qyzx->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjQz,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,Pjyz,Qz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,PjzQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,Pjzw,Qyzw->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,Pjzy,Qz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjQw,xwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjQy,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyz,PjQz,xy->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjwQ,xwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzuwx->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzuxw->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzwux->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,ijyz,Pjwu,Qyzwxu->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzxuw->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzxwu->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjwy,Qzwx->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,Pjwz,Qywx->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjyQ,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjyw,Qzxw->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,Pjyz,Qx->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjzQ,xy->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjzw,Qywx->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjzy,Qx->RPQ', Y_KW__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijab,Pjab,Qx->RPQ', Y_KW__bb, t1_xvee, t1_xvee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijab,Pjba,Qx->RPQ', Y_KW__bb, t1_xvee, t1_xvee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,Pjya,Qy->RPQ', Y_KW__bb, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxa,jPya,Qy->RPQ', Y_KW__bb, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjQz,yz->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,Pjyz,Qz->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,PjzQ,yz->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,Pjzw,Qyzw->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,Pjzy,Qz->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijya,PjQa,xy->RPQ', Y_KW__bb, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,Pjya,Qx->RPQ', Y_KW__bb, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,Pjza,Qyzx->RPQ', Y_KW__bb, t1_xvae, t1_xvae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,jPQa,xy->RPQ', Y_KW__bb, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPya,Qx->RPQ', Y_KW__bb, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPza,Qyzx->RPQ', Y_KW__bb, t1_xvae, t1_vxae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjQz,yz->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,Pjyz,Qz->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,PjzQ,yz->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,Pjzw,Qyzw->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,Pjzy,Qz->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjQw,xwyz->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjQy,xz->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyz,PjQz,xy->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjwQ,xwyz->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzuwx->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzuxw->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzwux->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,ijyz,Pjwu,Qyzwxu->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzxuw->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzxwu->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjwy,Qzwx->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,Pjwz,Qywx->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjyQ,xz->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjyw,Qzxw->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,Pjyz,Qx->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjzQ,xy->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjzw,Qywx->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjzy,Qx->RPQ', Y_KW__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pxyz,Qz->RPQ', Y_KW__bb, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,Pxzy,Qz->RPQ', Y_KW__bb, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Py,Qx->RPQ', Y_KW__bb, t1_xa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PyQz,xz->RPQ', Y_KW__bb, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pyxz,Qz->RPQ', Y_KW__bb, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,PyzQ,xz->RPQ', Y_KW__bb, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pyzw,Qxzw->RPQ', Y_KW__bb, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,Pyzx,Qz->RPQ', Y_KW__bb, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PzQy,xz->RPQ', Y_KW__bb, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pzwy,Qzwx->RPQ', Y_KW__bb, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,PzyQ,xz->RPQ', Y_KW__bb, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pzyw,Qzxw->RPQ', Y_KW__bb, t1_xa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQx,Pz,yz->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQx,Pzwu,yzwu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQx,Pzwy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQx,Pzyw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQz,Pw,xywz->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywuvz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rix,iyQz,Pwuv,xywuzv->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywvuz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywvzu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywzuv->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywzvu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQz,Pwux,zuyw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwuy,xwuz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,iyQz,Pwxu,zuyw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQz,Pwxy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwyu,xwzu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwyx,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyQz,Px,zy->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Py,xz->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pzwu,xywu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pzwx,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQz,Pzxw,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyab,Pxab,Qy->RPQ', Y_KW__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyab,Pxba,Qy->RPQ', Y_KW__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyab,Pzab,Qzxy->RPQ', Y_KW__bb, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyab,Pzba,Qzyx->RPQ', Y_KW__bb, t1_xaee, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,Pa,Qy->RPQ', Y_KW__bb, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyax,PzQa,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,PzaQ,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,Pzaw,Qzyw->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,Pzwa,Qzwy->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pa,Qzxy->RPQ', Y_KW__bb, t1_xaea, t1_xe, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,PwQa,xywz->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,PwaQ,xywz->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pwau,Qzwxyu->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pwaz,Qwxy->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwuxy->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyaz,Pwua,Qzwuyx->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwxuy->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwxyu->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwyux->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwyxu->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pwza,Qwyx->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyaz,PxQa,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,PxaQ,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pxaw,Qzwy->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pxaz,Qy->RPQ', Y_KW__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,Pxwa,Qzwy->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,Pxza,Qy->RPQ', Y_KW__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxQ,Pz,yz->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxQ,Pzwu,yzwu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxQ,Pzwy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxQ,Pzyw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,Pa,Qy->RPQ', Y_KW__bb, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxa,PzQa,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,PzaQ,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,Pzaw,Qzyw->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,Pzwa,Qzwy->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,iyxz,PwQy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxz,PwQz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,Pwuy,Qwuz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,Pwuz,Qwuy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,PwyQ,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,Pwyu,Qwzu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,PwzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,Pwzu,Qwyu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,Py,Qz->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxz,PyQw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,PywQ,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,Pywu,Qzwu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,Pz,Qy->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxz,PzQw,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,PzwQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,Pzwu,Qywu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pw,xyzw->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwuv,xywzuv->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwux,zuwy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pwuy,xwzu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwxu,zuyw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pwxy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pwyu,xwzu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pwyx,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Px,zy->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Py,xz->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pzwu,xyuw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pzwx,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pzxw,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pa,Qzyx->RPQ', Y_KW__bb, t1_xaae, t1_xe, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,PwQa,xyzw->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,PwaQ,xyzw->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwuxy->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwuyx->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwxuy->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwxyu->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwyux->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyza,Pwau,Qzwyxu->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pwaz,Qwyx->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pwua,Qzwuxy->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pwza,Qwxy->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,PxQa,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,PxaQ,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pxaw,Qzyw->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,Pxaz,Qy->RPQ', Y_KW__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pxwa,Qzwy->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pxza,Qy->RPQ', Y_KW__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PuQw,xyzu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,PuQy,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PuQz,xyuw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Puvw,Qzuvxy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,Puvy,Qxuvzw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuvxy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzw,Puvz,Qwuvyx->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuxvy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuxyv->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuyvx->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuyxv->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PuwQ,xyzu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuvxy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuvyx->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuxvy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuxyv->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuyvx->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzw,Puwv,Qzuyxv->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Puwz,Quyx->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,Puxy,Quzw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,PuyQ,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuvwz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuvzw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuwvz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyzw,Puyv,Qxuwzv->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuzvw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuzwv->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,Puyx,Quwz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PuzQ,xyuw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Puzv,Qwuxyv->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Puzw,Quxy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pw,Qzyx->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PwQu,xyzu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PwQx,yz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PwuQ,xyzu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyuvz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzw,Pwuv,Qxyuzv->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyvuz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyvzu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyzuv->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyzvu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pwux,Qyuz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PwxQ,yz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pwxu,Qyzu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PxQw,yz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyzw,PxQz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pxuw,Qzuy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,Pxuz,Qwuy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PxwQ,yz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pxwu,Qzyu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,Pxwz,Qy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PxzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pxzu,Qwuy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pxzw,Qy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,Py,Qxwz->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,PyQu,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,PyuQ,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwuvx->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyzw,Pyuv,Qzwuxv->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwvux->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwvxu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwxuv->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwxvu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pz,Qwxy->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PzQu,xyuw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyzw,PzQx,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PzuQ,xyuw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pzuv,Qxyuvw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,Pzux,Qyuw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PzxQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pzxu,Qyuw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzx,PwQy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzx,PwQz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,Pwuy,Qwuz->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,Pwuz,Qwuy->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,PwyQ,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,Pwyu,Qwzu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,PwzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,Pwzu,Qwyu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,Py,Qz->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzx,PyQw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,PywQ,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,Pywu,Qzwu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,Pz,Qy->RPQ', Y_KW__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzx,PzQw,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,PzwQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,Pzwu,Qywu->RPQ', Y_KW__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,Pjya,Qy->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jixa,jPya,Qy->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,PjQa,xy->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,Pjya,Qx->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,Pjza,Qyzx->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPQa,xy->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,jPya,Qx->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPza,Qyxz->RPQ', Y_KW__bb, t1_xxae, t1_xxae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,Pjya,Qy->RPQ', Y_KW__bb, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jixa,jPya,Qy->RPQ', Y_KW__bb, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,PjQa,xy->RPQ', Y_KW__bb, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,Pjya,Qx->RPQ', Y_KW__bb, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,Pjza,Qyzx->RPQ', Y_KW__bb, t1_vxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPQa,xy->RPQ', Y_KW__bb, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,jPya,Qx->RPQ', Y_KW__bb, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPza,Qyxz->RPQ', Y_KW__bb, t1_vxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
    TY[:, s_c:f_c, s_a:f_a] += temp   
 
    temp =- 1/2 * einsum('RiQ,ia,Pa->RPQ', Y_KW__aa, t1_xe, t1_ve, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,Pjab->RPQ', Y_KW__aa, t1_xxee, t1_vxee, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KW__aa, t1_xxee, t1_vxee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KW__aa, t1_xxae, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KW__aa, t1_xxae, t1_xvae, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,Pjab->RPQ', Y_KW__aa, t1_xvee, t1_vvee, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KW__aa, t1_xvee, t1_vvee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KW__aa, t1_xvae, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KW__aa, t1_xvae, t1_vvae, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ix,Px->RPQ', Y_KW__aa, t1_xa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KW__aa, t1_xxae, t1_vxae, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KW__aa, t1_xxae, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KW__aa, t1_vxae, t1_vvae, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KW__aa, t1_vxae, t1_vvae, optimize = einsum_type)
    temp += einsum('Rix,PiQa,xa->RPQ', Y_KW__aa, t1_vxae, t1_ae, optimize = einsum_type)
    temp -= einsum('Rix,Piab,Qxab->RPQ', Y_KW__aa, t1_vxee, t1_aaee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piab,Qxba->RPQ', Y_KW__aa, t1_vxee, t1_aaee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Pixa,Qa->RPQ', Y_KW__aa, t1_vxae, t1_ae, optimize = einsum_type)
    temp -= einsum('Rix,Piya,Qxya->RPQ', Y_KW__aa, t1_vxae, t1_aaae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piya,xQya->RPQ', Y_KW__aa, t1_vxae, t1_aaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPQa,xa->RPQ', Y_KW__aa, t1_xvae, t1_ae, optimize = einsum_type)
    temp -= einsum('Rix,iPxa,Qa->RPQ', Y_KW__aa, t1_xvae, t1_ae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,Qxya->RPQ', Y_KW__aa, t1_xvae, t1_aaae, optimize = einsum_type)
    temp -= einsum('Rix,iPya,xQya->RPQ', Y_KW__aa, t1_xvae, t1_aaae, optimize = einsum_type)
    temp -= einsum('Rix,iQ,Px->RPQ', Y_KW__aa, t1_xa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQab,Pxab->RPQ', Y_KW__aa, t1_xaee, t1_vaee, optimize = einsum_type)
    temp -= einsum('Rix,iQab,Pxba->RPQ', Y_KW__aa, t1_xaee, t1_vaee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQax,Pa->RPQ', Y_KW__aa, t1_xaea, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQay,Pxay->RPQ', Y_KW__aa, t1_xaea, t1_vaea, optimize = einsum_type)
    temp -= einsum('Rix,iQay,Pxya->RPQ', Y_KW__aa, t1_xaea, t1_vaae, optimize = einsum_type)
    temp -= einsum('Rix,iQxa,Pa->RPQ', Y_KW__aa, t1_xaae, t1_ve, optimize = einsum_type)
    temp -= einsum('Rix,iQxy,Py->RPQ', Y_KW__aa, t1_xaaa, t1_va, optimize = einsum_type)
    temp -= einsum('Rix,iQya,Pxay->RPQ', Y_KW__aa, t1_xaae, t1_vaea, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pxya->RPQ', Y_KW__aa, t1_xaae, t1_vaae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyx,Py->RPQ', Y_KW__aa, t1_xaaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pxyz->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, optimize = einsum_type)
    temp -= einsum('Rix,iQyz,Pxzy->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, optimize = einsum_type)
    temp += einsum('Rix,ia,PxQa->RPQ', Y_KW__aa, t1_xe, t1_vaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,PxaQ->RPQ', Y_KW__aa, t1_xe, t1_vaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxa,PjQa->RPQ', Y_KW__aa, t1_xxae, t1_vxae, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,jPQa->RPQ', Y_KW__aa, t1_xxae, t1_xvae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxy,PjQy->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjyQ->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyx,PjQy->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjyQ->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxa,PjQa->RPQ', Y_KW__aa, t1_xvae, t1_vvae, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,jPQa->RPQ', Y_KW__aa, t1_xvae, t1_vvae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxy,PjQy->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjyQ->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyx,PjQy->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjyQ->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, optimize = einsum_type)
    temp += einsum('Rix,iy,PxQy->RPQ', Y_KW__aa, t1_xa, t1_vaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PxyQ->RPQ', Y_KW__aa, t1_xa, t1_vaaa, optimize = einsum_type)
    temp += einsum('Rix,iy,PyQx->RPQ', Y_KW__aa, t1_xa, t1_vaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PyxQ->RPQ', Y_KW__aa, t1_xa, t1_vaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQx,Py->RPQ', Y_KW__aa, t1_xaaa, t1_va, optimize = einsum_type)
    temp += einsum('Rix,iyxQ,Py->RPQ', Y_KW__aa, t1_xaaa, t1_va, optimize = einsum_type)
    temp -= einsum('Rix,jixa,PjQa->RPQ', Y_KW__aa, t1_xxae, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,jPQa->RPQ', Y_KW__aa, t1_xxae, t1_xvae, optimize = einsum_type)
    temp -= einsum('Rix,jixa,PjQa->RPQ', Y_KW__aa, t1_vxae, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,jPQa->RPQ', Y_KW__aa, t1_vxae, t1_vvae, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,Pa->RPQ', Y_KW__bb, t1_xe, t1_ve, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,Pjab->RPQ', Y_KW__bb, t1_xxee, t1_vxee, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KW__bb, t1_xxee, t1_vxee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KW__bb, t1_xxae, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KW__bb, t1_xxae, t1_xvae, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,Pjab->RPQ', Y_KW__bb, t1_xvee, t1_vvee, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KW__bb, t1_xvee, t1_vvee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KW__bb, t1_xvae, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KW__bb, t1_xvae, t1_vvae, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ix,Px->RPQ', Y_KW__bb, t1_xa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KW__bb, t1_xxae, t1_vxae, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KW__bb, t1_xxae, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KW__bb, t1_vxae, t1_vvae, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KW__bb, t1_vxae, t1_vvae, optimize = einsum_type)
    temp += einsum('Rix,PiQa,xa->RPQ', Y_KW__bb, t1_vxae, t1_ae, optimize = einsum_type)
    temp -= einsum('Rix,Piab,Qxab->RPQ', Y_KW__bb, t1_vxee, t1_aaee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piab,Qxba->RPQ', Y_KW__bb, t1_vxee, t1_aaee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Pixa,Qa->RPQ', Y_KW__bb, t1_vxae, t1_ae, optimize = einsum_type)
    temp -= einsum('Rix,Piya,Qxya->RPQ', Y_KW__bb, t1_vxae, t1_aaae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piya,xQya->RPQ', Y_KW__bb, t1_vxae, t1_aaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPQa,xa->RPQ', Y_KW__bb, t1_xvae, t1_ae, optimize = einsum_type)
    temp -= einsum('Rix,iPxa,Qa->RPQ', Y_KW__bb, t1_xvae, t1_ae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,Qxya->RPQ', Y_KW__bb, t1_xvae, t1_aaae, optimize = einsum_type)
    temp -= einsum('Rix,iPya,xQya->RPQ', Y_KW__bb, t1_xvae, t1_aaae, optimize = einsum_type)
    temp -= einsum('Rix,iQ,Px->RPQ', Y_KW__bb, t1_xa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQab,Pxab->RPQ', Y_KW__bb, t1_xaee, t1_vaee, optimize = einsum_type)
    temp -= einsum('Rix,iQab,Pxba->RPQ', Y_KW__bb, t1_xaee, t1_vaee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQax,Pa->RPQ', Y_KW__bb, t1_xaea, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQay,Pxay->RPQ', Y_KW__bb, t1_xaea, t1_vaea, optimize = einsum_type)
    temp -= einsum('Rix,iQay,Pxya->RPQ', Y_KW__bb, t1_xaea, t1_vaae, optimize = einsum_type)
    temp -= einsum('Rix,iQxa,Pa->RPQ', Y_KW__bb, t1_xaae, t1_ve, optimize = einsum_type)
    temp -= einsum('Rix,iQxy,Py->RPQ', Y_KW__bb, t1_xaaa, t1_va, optimize = einsum_type)
    temp -= einsum('Rix,iQya,Pxay->RPQ', Y_KW__bb, t1_xaae, t1_vaea, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pxya->RPQ', Y_KW__bb, t1_xaae, t1_vaae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyx,Py->RPQ', Y_KW__bb, t1_xaaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pxyz->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, optimize = einsum_type)
    temp -= einsum('Rix,iQyz,Pxzy->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, optimize = einsum_type)
    temp += einsum('Rix,ia,PxQa->RPQ', Y_KW__bb, t1_xe, t1_vaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,PxaQ->RPQ', Y_KW__bb, t1_xe, t1_vaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxa,PjQa->RPQ', Y_KW__bb, t1_xxae, t1_vxae, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,jPQa->RPQ', Y_KW__bb, t1_xxae, t1_xvae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxy,PjQy->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjyQ->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyx,PjQy->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjyQ->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxa,PjQa->RPQ', Y_KW__bb, t1_xvae, t1_vvae, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,jPQa->RPQ', Y_KW__bb, t1_xvae, t1_vvae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxy,PjQy->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjyQ->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyx,PjQy->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjyQ->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, optimize = einsum_type)
    temp += einsum('Rix,iy,PxQy->RPQ', Y_KW__bb, t1_xa, t1_vaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PxyQ->RPQ', Y_KW__bb, t1_xa, t1_vaaa, optimize = einsum_type)
    temp += einsum('Rix,iy,PyQx->RPQ', Y_KW__bb, t1_xa, t1_vaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PyxQ->RPQ', Y_KW__bb, t1_xa, t1_vaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQx,Py->RPQ', Y_KW__bb, t1_xaaa, t1_va, optimize = einsum_type)
    temp += einsum('Rix,iyxQ,Py->RPQ', Y_KW__bb, t1_xaaa, t1_va, optimize = einsum_type)
    temp -= einsum('Rix,jixa,PjQa->RPQ', Y_KW__bb, t1_xxae, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,jPQa->RPQ', Y_KW__bb, t1_xxae, t1_xvae, optimize = einsum_type)
    temp -= einsum('Rix,jixa,PjQa->RPQ', Y_KW__bb, t1_vxae, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,jPQa->RPQ', Y_KW__bb, t1_vxae, t1_vvae, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,Pxay,xy->RPQ', Y_KW__aa, t1_xe, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ia,Pxya,xy->RPQ', Y_KW__aa, t1_xe, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KW__aa, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KW__aa, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KW__aa, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KW__aa, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ix,Pyxz,yz->RPQ', Y_KW__aa, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ix,Pyzx,yz->RPQ', Y_KW__aa, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixab,Pyab,xy->RPQ', Y_KW__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixab,Pyba,xy->RPQ', Y_KW__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pa,xy->RPQ', Y_KW__aa, t1_xaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pzaw,xwyz->RPQ', Y_KW__aa, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pzay,xz->RPQ', Y_KW__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzwa,xwyz->RPQ', Y_KW__aa, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzya,xz->RPQ', Y_KW__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pa,xy->RPQ', Y_KW__aa, t1_xaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzaw,xwyz->RPQ', Y_KW__aa, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzay,xz->RPQ', Y_KW__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzwa,xwzy->RPQ', Y_KW__aa, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixya,Pzya,xz->RPQ', Y_KW__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwuy,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwuz,xuwy->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Pwyu,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Pwyz,xw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwzu,xuyw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwzy,xw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixyz,Pxwu,yzwu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Py,xz->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pz,xy->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KW__aa, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KW__aa, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KW__aa, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KW__aa, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,xyza,yz->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,ya,xy->RPQ', Y_KW__aa, t1_vxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,PiQa,yxza,yz->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,yzwa,xwzy->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piab,Qyab,xy->RPQ', Y_KW__aa, t1_vxee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piab,Qyba,xy->RPQ', Y_KW__aa, t1_vxee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piab,xyab,Qy->RPQ', Y_KW__aa, t1_vxee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piab,xyba,Qy->RPQ', Y_KW__aa, t1_vxee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piab,yzab,Qxyz->RPQ', Y_KW__aa, t1_vxee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Pixa,Qyza,yz->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Pixa,yQza,yz->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Pixa,ya,Qy->RPQ', Y_KW__aa, t1_vxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Pixa,yzwa,Qwzy->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,Qa,xy->RPQ', Y_KW__aa, t1_vxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piya,Qxza,yz->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,Qzwa,xwzy->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piya,Qzya,xz->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,xQza,yz->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,xa,Qy->RPQ', Y_KW__aa, t1_vxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piya,xzwa,Qwyz->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piya,xzya,Qz->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,zQwa,xwyz->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,zQya,xz->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piya,za,Qxyz->RPQ', Y_KW__aa, t1_vxae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuwyz->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuwzy->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Piya,zwua,Qxuywz->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuyzw->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuzwy->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuzyw->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piya,zwya,Qxzw->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,zxwa,Qwyz->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,zxya,Qz->RPQ', Y_KW__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPQa,xyza,yz->RPQ', Y_KW__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPQa,ya,xy->RPQ', Y_KW__aa, t1_xvae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPQa,yxza,yz->RPQ', Y_KW__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPQa,yzwa,xwzy->RPQ', Y_KW__aa, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPxa,Qyza,yz->RPQ', Y_KW__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iPxa,yQza,yz->RPQ', Y_KW__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPxa,ya,Qy->RPQ', Y_KW__aa, t1_xvae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPxa,yzwa,Qwzy->RPQ', Y_KW__aa, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,Qa,xy->RPQ', Y_KW__aa, t1_xvae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iPya,Qxza,yz->RPQ', Y_KW__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iPya,Qzwa,xwyz->RPQ', Y_KW__aa, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iPya,Qzya,xz->RPQ', Y_KW__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,xQza,yz->RPQ', Y_KW__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,xa,Qy->RPQ', Y_KW__aa, t1_xvae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,xzwa,Qwzy->RPQ', Y_KW__aa, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPya,xzya,Qz->RPQ', Y_KW__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,zQwa,xwyz->RPQ', Y_KW__aa, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,zQya,xz->RPQ', Y_KW__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,za,Qxzy->RPQ', Y_KW__aa, t1_xvae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,zwua,Qxuwyz->RPQ', Y_KW__aa, t1_xvae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,zwya,Qxwz->RPQ', Y_KW__aa, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,zxwa,Qwyz->RPQ', Y_KW__aa, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,zxya,Qz->RPQ', Y_KW__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Py,xy->RPQ', Y_KW__aa, t1_xa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iQ,Pyxz,yz->RPQ', Y_KW__aa, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Pyzw,xyzw->RPQ', Y_KW__aa, t1_xa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Pyzx,yz->RPQ', Y_KW__aa, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQab,Pyab,xy->RPQ', Y_KW__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQab,Pyba,xy->RPQ', Y_KW__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQax,Pyaz,yz->RPQ', Y_KW__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQax,Pyza,yz->RPQ', Y_KW__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pa,xy->RPQ', Y_KW__aa, t1_xaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pxaz,yz->RPQ', Y_KW__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQay,Pxza,yz->RPQ', Y_KW__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pzaw,xwyz->RPQ', Y_KW__aa, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pzay,xz->RPQ', Y_KW__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pzwa,xwzy->RPQ', Y_KW__aa, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQay,Pzya,xz->RPQ', Y_KW__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iQxa,Pyaz,yz->RPQ', Y_KW__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQxa,Pyza,yz->RPQ', Y_KW__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQxy,Pz,yz->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQxy,Pzwu,yzwu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQxy,Pzwy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iQxy,Pzyw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pa,xy->RPQ', Y_KW__aa, t1_xaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pxaz,yz->RPQ', Y_KW__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQya,Pxza,yz->RPQ', Y_KW__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pzaw,xwyz->RPQ', Y_KW__aa, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pzay,xz->RPQ', Y_KW__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQya,Pzwa,xwyz->RPQ', Y_KW__aa, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQya,Pzya,xz->RPQ', Y_KW__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyx,Pz,yz->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyx,Pzwu,yzwu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyx,Pzwy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyx,Pzyw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyz,Pw,xwyz->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyz,Pwuv,xuvyzw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pwuy,xuwz->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pwuz,xuyw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pwyu,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pwyz,xw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pwzu,xuyw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pwzy,xw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyz,Pxwu,zywu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pxwy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pxwz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pxyw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pxzw,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Py,xz->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pz,xy->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pa,Qx->RPQ', Y_KW__aa, t1_xe, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pxay,Qy->RPQ', Y_KW__aa, t1_xe, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,Pxya,Qy->RPQ', Y_KW__aa, t1_xe, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,PyQa,xy->RPQ', Y_KW__aa, t1_xe, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,PyaQ,xy->RPQ', Y_KW__aa, t1_xe, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pyaz,Qyxz->RPQ', Y_KW__aa, t1_xe, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pyza,Qyzx->RPQ', Y_KW__aa, t1_xe, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijab,Pjab,Qx->RPQ', Y_KW__aa, t1_xxee, t1_vxee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijab,Pjba,Qx->RPQ', Y_KW__aa, t1_xxee, t1_vxee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,Pjya,Qy->RPQ', Y_KW__aa, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxa,jPya,Qy->RPQ', Y_KW__aa, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjQz,yz->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,Pjyz,Qz->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,PjzQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,Pjzw,Qyzw->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,Pjzy,Qz->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijya,PjQa,xy->RPQ', Y_KW__aa, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,Pjya,Qx->RPQ', Y_KW__aa, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,Pjza,Qyzx->RPQ', Y_KW__aa, t1_xxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,jPQa,xy->RPQ', Y_KW__aa, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPya,Qx->RPQ', Y_KW__aa, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPza,Qyzx->RPQ', Y_KW__aa, t1_xxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjQz,yz->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,Pjyz,Qz->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,PjzQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,Pjzw,Qyzw->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,Pjzy,Qz->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjQw,xwyz->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjQy,xz->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyz,PjQz,xy->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjwQ,xwyz->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzuwx->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzuxw->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzwux->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,ijyz,Pjwu,Qyzwxu->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzxuw->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzxwu->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjwy,Qzwx->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,Pjwz,Qywx->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjyQ,xz->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjyw,Qzxw->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,Pjyz,Qx->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjzQ,xy->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjzw,Qywx->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjzy,Qx->RPQ', Y_KW__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijab,Pjab,Qx->RPQ', Y_KW__aa, t1_xvee, t1_vvee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijab,Pjba,Qx->RPQ', Y_KW__aa, t1_xvee, t1_vvee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,Pjya,Qy->RPQ', Y_KW__aa, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxa,jPya,Qy->RPQ', Y_KW__aa, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjQz,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,Pjyz,Qz->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,PjzQ,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,Pjzw,Qyzw->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,Pjzy,Qz->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijya,PjQa,xy->RPQ', Y_KW__aa, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,Pjya,Qx->RPQ', Y_KW__aa, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,Pjza,Qyzx->RPQ', Y_KW__aa, t1_xvae, t1_vvae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,jPQa,xy->RPQ', Y_KW__aa, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPya,Qx->RPQ', Y_KW__aa, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPza,Qyzx->RPQ', Y_KW__aa, t1_xvae, t1_vvae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjQz,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,Pjyz,Qz->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,PjzQ,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,Pjzw,Qyzw->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,Pjzy,Qz->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjQw,xwyz->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjQy,xz->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyz,PjQz,xy->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjwQ,xwyz->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzuwx->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzuxw->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzwux->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,ijyz,Pjwu,Qyzwxu->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzxuw->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzxwu->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjwy,Qzwx->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,Pjwz,Qywx->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjyQ,xz->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjyw,Qzxw->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,Pjyz,Qx->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjzQ,xy->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjzw,Qywx->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjzy,Qx->RPQ', Y_KW__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pxyz,Qz->RPQ', Y_KW__aa, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,Pxzy,Qz->RPQ', Y_KW__aa, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Py,Qx->RPQ', Y_KW__aa, t1_xa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PyQz,xz->RPQ', Y_KW__aa, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pyxz,Qz->RPQ', Y_KW__aa, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,PyzQ,xz->RPQ', Y_KW__aa, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pyzw,Qxzw->RPQ', Y_KW__aa, t1_xa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,Pyzx,Qz->RPQ', Y_KW__aa, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PzQy,xz->RPQ', Y_KW__aa, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pzwy,Qzwx->RPQ', Y_KW__aa, t1_xa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,PzyQ,xz->RPQ', Y_KW__aa, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pzyw,Qzxw->RPQ', Y_KW__aa, t1_xa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQx,Pz,yz->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQx,Pzwu,yzwu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQx,Pzwy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQx,Pzyw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQz,Pw,xywz->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywuvz->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rix,iyQz,Pwuv,xywuzv->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywvuz->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywvzu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywzuv->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywzvu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQz,Pwux,zuyw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwuy,xwuz->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,iyQz,Pwxu,zuyw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQz,Pwxy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwyu,xwzu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwyx,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyQz,Px,zy->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Py,xz->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pzwu,xywu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pzwx,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQz,Pzxw,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyab,Pxab,Qy->RPQ', Y_KW__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyab,Pxba,Qy->RPQ', Y_KW__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyab,Pzab,Qzxy->RPQ', Y_KW__aa, t1_xaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyab,Pzba,Qzyx->RPQ', Y_KW__aa, t1_xaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,Pa,Qy->RPQ', Y_KW__aa, t1_xaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyax,PzQa,yz->RPQ', Y_KW__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,PzaQ,yz->RPQ', Y_KW__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,Pzaw,Qzyw->RPQ', Y_KW__aa, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,Pzwa,Qzwy->RPQ', Y_KW__aa, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pa,Qzxy->RPQ', Y_KW__aa, t1_xaea, t1_ve, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,PwQa,xywz->RPQ', Y_KW__aa, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,PwaQ,xywz->RPQ', Y_KW__aa, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pwau,Qzwxyu->RPQ', Y_KW__aa, t1_xaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pwaz,Qwxy->RPQ', Y_KW__aa, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwuxy->RPQ', Y_KW__aa, t1_xaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyaz,Pwua,Qzwuyx->RPQ', Y_KW__aa, t1_xaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwxuy->RPQ', Y_KW__aa, t1_xaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwxyu->RPQ', Y_KW__aa, t1_xaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwyux->RPQ', Y_KW__aa, t1_xaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwyxu->RPQ', Y_KW__aa, t1_xaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pwza,Qwyx->RPQ', Y_KW__aa, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyaz,PxQa,yz->RPQ', Y_KW__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,PxaQ,yz->RPQ', Y_KW__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pxaw,Qzwy->RPQ', Y_KW__aa, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pxaz,Qy->RPQ', Y_KW__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,Pxwa,Qzwy->RPQ', Y_KW__aa, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,Pxza,Qy->RPQ', Y_KW__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxQ,Pz,yz->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxQ,Pzwu,yzwu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxQ,Pzwy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxQ,Pzyw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,Pa,Qy->RPQ', Y_KW__aa, t1_xaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxa,PzQa,yz->RPQ', Y_KW__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,PzaQ,yz->RPQ', Y_KW__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,Pzaw,Qzyw->RPQ', Y_KW__aa, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,Pzwa,Qzwy->RPQ', Y_KW__aa, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,iyxz,PwQy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxz,PwQz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,Pwuy,Qwuz->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,Pwuz,Qwuy->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,PwyQ,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,Pwyu,Qwzu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,PwzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,Pwzu,Qwyu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,Py,Qz->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxz,PyQw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,PywQ,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,Pywu,Qzwu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,Pz,Qy->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxz,PzQw,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,PzwQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,Pzwu,Qywu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pw,xyzw->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwuv,xywzuv->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwux,zuwy->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pwuy,xwzu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwxu,zuyw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pwxy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pwyu,xwzu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pwyx,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Px,zy->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Py,xz->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pzwu,xyuw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pzwx,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pzxw,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pa,Qzyx->RPQ', Y_KW__aa, t1_xaae, t1_ve, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,PwQa,xyzw->RPQ', Y_KW__aa, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,PwaQ,xyzw->RPQ', Y_KW__aa, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwuxy->RPQ', Y_KW__aa, t1_xaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwuyx->RPQ', Y_KW__aa, t1_xaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwxuy->RPQ', Y_KW__aa, t1_xaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwxyu->RPQ', Y_KW__aa, t1_xaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwyux->RPQ', Y_KW__aa, t1_xaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyza,Pwau,Qzwyxu->RPQ', Y_KW__aa, t1_xaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pwaz,Qwyx->RPQ', Y_KW__aa, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pwua,Qzwuxy->RPQ', Y_KW__aa, t1_xaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pwza,Qwxy->RPQ', Y_KW__aa, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,PxQa,yz->RPQ', Y_KW__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,PxaQ,yz->RPQ', Y_KW__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pxaw,Qzyw->RPQ', Y_KW__aa, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,Pxaz,Qy->RPQ', Y_KW__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pxwa,Qzwy->RPQ', Y_KW__aa, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pxza,Qy->RPQ', Y_KW__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PuQw,xyzu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,PuQy,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PuQz,xyuw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Puvw,Qzuvxy->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,Puvy,Qxuvzw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuvxy->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzw,Puvz,Qwuvyx->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuxvy->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuxyv->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuyvx->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuyxv->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PuwQ,xyzu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuvxy->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuvyx->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuxvy->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuxyv->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuyvx->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzw,Puwv,Qzuyxv->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Puwz,Quyx->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,Puxy,Quzw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,PuyQ,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuvwz->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuvzw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuwvz->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyzw,Puyv,Qxuwzv->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuzvw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuzwv->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,Puyx,Quwz->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PuzQ,xyuw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Puzv,Qwuxyv->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Puzw,Quxy->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pw,Qzyx->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PwQu,xyzu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PwQx,yz->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PwuQ,xyzu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyuvz->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzw,Pwuv,Qxyuzv->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyvuz->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyvzu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyzuv->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyzvu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pwux,Qyuz->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PwxQ,yz->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pwxu,Qyzu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PxQw,yz->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyzw,PxQz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pxuw,Qzuy->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,Pxuz,Qwuy->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PxwQ,yz->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pxwu,Qzyu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,Pxwz,Qy->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PxzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pxzu,Qwuy->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pxzw,Qy->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,Py,Qxwz->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,PyQu,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,PyuQ,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwuvx->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyzw,Pyuv,Qzwuxv->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwvux->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwvxu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwxuv->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwxvu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pz,Qwxy->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PzQu,xyuw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyzw,PzQx,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PzuQ,xyuw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pzuv,Qxyuvw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,Pzux,Qyuw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PzxQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pzxu,Qyuw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzx,PwQy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzx,PwQz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,Pwuy,Qwuz->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,Pwuz,Qwuy->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,PwyQ,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,Pwyu,Qwzu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,PwzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,Pwzu,Qwyu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,Py,Qz->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzx,PyQw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,PywQ,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,Pywu,Qzwu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,Pz,Qy->RPQ', Y_KW__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzx,PzQw,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,PzwQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,Pzwu,Qywu->RPQ', Y_KW__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,Pjya,Qy->RPQ', Y_KW__aa, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jixa,jPya,Qy->RPQ', Y_KW__aa, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,PjQa,xy->RPQ', Y_KW__aa, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,Pjya,Qx->RPQ', Y_KW__aa, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,Pjza,Qyzx->RPQ', Y_KW__aa, t1_xxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPQa,xy->RPQ', Y_KW__aa, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,jPya,Qx->RPQ', Y_KW__aa, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPza,Qyxz->RPQ', Y_KW__aa, t1_xxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,Pjya,Qy->RPQ', Y_KW__aa, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jixa,jPya,Qy->RPQ', Y_KW__aa, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,PjQa,xy->RPQ', Y_KW__aa, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,Pjya,Qx->RPQ', Y_KW__aa, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,Pjza,Qyzx->RPQ', Y_KW__aa, t1_vxae, t1_vvae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPQa,xy->RPQ', Y_KW__aa, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,jPya,Qx->RPQ', Y_KW__aa, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPza,Qyxz->RPQ', Y_KW__aa, t1_vxae, t1_vvae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,Pxay,xy->RPQ', Y_KW__bb, t1_xe, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ia,Pxya,xy->RPQ', Y_KW__bb, t1_xe, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KW__bb, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KW__bb, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KW__bb, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KW__bb, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ix,Pyxz,yz->RPQ', Y_KW__bb, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ix,Pyzx,yz->RPQ', Y_KW__bb, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixab,Pyab,xy->RPQ', Y_KW__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixab,Pyba,xy->RPQ', Y_KW__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pa,xy->RPQ', Y_KW__bb, t1_xaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pzaw,xwyz->RPQ', Y_KW__bb, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pzay,xz->RPQ', Y_KW__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzwa,xwyz->RPQ', Y_KW__bb, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzya,xz->RPQ', Y_KW__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pa,xy->RPQ', Y_KW__bb, t1_xaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzaw,xwyz->RPQ', Y_KW__bb, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzay,xz->RPQ', Y_KW__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzwa,xwzy->RPQ', Y_KW__bb, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixya,Pzya,xz->RPQ', Y_KW__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwuy,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwuz,xuwy->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Pwyu,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Pwyz,xw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwzu,xuyw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwzy,xw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixyz,Pxwu,yzwu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Py,xz->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pz,xy->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KW__bb, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KW__bb, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KW__bb, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KW__bb, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,xyza,yz->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,ya,xy->RPQ', Y_KW__bb, t1_vxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,PiQa,yxza,yz->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,yzwa,xwzy->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piab,Qyab,xy->RPQ', Y_KW__bb, t1_vxee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piab,Qyba,xy->RPQ', Y_KW__bb, t1_vxee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piab,xyab,Qy->RPQ', Y_KW__bb, t1_vxee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piab,xyba,Qy->RPQ', Y_KW__bb, t1_vxee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piab,yzab,Qxyz->RPQ', Y_KW__bb, t1_vxee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Pixa,Qyza,yz->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Pixa,yQza,yz->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Pixa,ya,Qy->RPQ', Y_KW__bb, t1_vxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Pixa,yzwa,Qwzy->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,Qa,xy->RPQ', Y_KW__bb, t1_vxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piya,Qxza,yz->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,Qzwa,xwzy->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piya,Qzya,xz->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,xQza,yz->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,xa,Qy->RPQ', Y_KW__bb, t1_vxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piya,xzwa,Qwyz->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piya,xzya,Qz->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,zQwa,xwyz->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,Piya,zQya,xz->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piya,za,Qxyz->RPQ', Y_KW__bb, t1_vxae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuwyz->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuwzy->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,Piya,zwua,Qxuywz->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuyzw->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuzwy->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,Piya,zwua,Qxuzyw->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piya,zwya,Qxzw->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,zxwa,Qwyz->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piya,zxya,Qz->RPQ', Y_KW__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPQa,xyza,yz->RPQ', Y_KW__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPQa,ya,xy->RPQ', Y_KW__bb, t1_xvae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPQa,yxza,yz->RPQ', Y_KW__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPQa,yzwa,xwzy->RPQ', Y_KW__bb, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPxa,Qyza,yz->RPQ', Y_KW__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iPxa,yQza,yz->RPQ', Y_KW__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPxa,ya,Qy->RPQ', Y_KW__bb, t1_xvae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPxa,yzwa,Qwzy->RPQ', Y_KW__bb, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,Qa,xy->RPQ', Y_KW__bb, t1_xvae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iPya,Qxza,yz->RPQ', Y_KW__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iPya,Qzwa,xwyz->RPQ', Y_KW__bb, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iPya,Qzya,xz->RPQ', Y_KW__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,xQza,yz->RPQ', Y_KW__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,xa,Qy->RPQ', Y_KW__bb, t1_xvae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,xzwa,Qwzy->RPQ', Y_KW__bb, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iPya,xzya,Qz->RPQ', Y_KW__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,zQwa,xwyz->RPQ', Y_KW__bb, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPya,zQya,xz->RPQ', Y_KW__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,za,Qxzy->RPQ', Y_KW__bb, t1_xvae, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,zwua,Qxuwyz->RPQ', Y_KW__bb, t1_xvae, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,zwya,Qxwz->RPQ', Y_KW__bb, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,zxwa,Qwyz->RPQ', Y_KW__bb, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iPya,zxya,Qz->RPQ', Y_KW__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Py,xy->RPQ', Y_KW__bb, t1_xa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iQ,Pyxz,yz->RPQ', Y_KW__bb, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Pyzw,xyzw->RPQ', Y_KW__bb, t1_xa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Pyzx,yz->RPQ', Y_KW__bb, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQab,Pyab,xy->RPQ', Y_KW__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQab,Pyba,xy->RPQ', Y_KW__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQax,Pyaz,yz->RPQ', Y_KW__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQax,Pyza,yz->RPQ', Y_KW__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pa,xy->RPQ', Y_KW__bb, t1_xaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pxaz,yz->RPQ', Y_KW__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQay,Pxza,yz->RPQ', Y_KW__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pzaw,xwyz->RPQ', Y_KW__bb, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pzay,xz->RPQ', Y_KW__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQay,Pzwa,xwzy->RPQ', Y_KW__bb, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQay,Pzya,xz->RPQ', Y_KW__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iQxa,Pyaz,yz->RPQ', Y_KW__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQxa,Pyza,yz->RPQ', Y_KW__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQxy,Pz,yz->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iQxy,Pzwu,yzwu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQxy,Pzwy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iQxy,Pzyw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pa,xy->RPQ', Y_KW__bb, t1_xaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pxaz,yz->RPQ', Y_KW__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQya,Pxza,yz->RPQ', Y_KW__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pzaw,xwyz->RPQ', Y_KW__bb, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQya,Pzay,xz->RPQ', Y_KW__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQya,Pzwa,xwyz->RPQ', Y_KW__bb, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQya,Pzya,xz->RPQ', Y_KW__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyx,Pz,yz->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyx,Pzwu,yzwu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyx,Pzwy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyx,Pzyw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyz,Pw,xwyz->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyz,Pwuv,xuvyzw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pwuy,xuwz->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pwuz,xuyw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pwyu,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pwyz,xw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pwzu,xuyw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pwzy,xw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQyz,Pxwu,zywu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pxwy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pxwz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Pxyw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pxzw,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iQyz,Py,xz->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQyz,Pz,xy->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pa,Qx->RPQ', Y_KW__bb, t1_xe, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pxay,Qy->RPQ', Y_KW__bb, t1_xe, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,Pxya,Qy->RPQ', Y_KW__bb, t1_xe, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,PyQa,xy->RPQ', Y_KW__bb, t1_xe, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,PyaQ,xy->RPQ', Y_KW__bb, t1_xe, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pyaz,Qyxz->RPQ', Y_KW__bb, t1_xe, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,Pyza,Qyzx->RPQ', Y_KW__bb, t1_xe, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijab,Pjab,Qx->RPQ', Y_KW__bb, t1_xxee, t1_vxee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijab,Pjba,Qx->RPQ', Y_KW__bb, t1_xxee, t1_vxee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,Pjya,Qy->RPQ', Y_KW__bb, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxa,jPya,Qy->RPQ', Y_KW__bb, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjQz,yz->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,Pjyz,Qz->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,PjzQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,Pjzw,Qyzw->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,Pjzy,Qz->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijya,PjQa,xy->RPQ', Y_KW__bb, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,Pjya,Qx->RPQ', Y_KW__bb, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,Pjza,Qyzx->RPQ', Y_KW__bb, t1_xxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,jPQa,xy->RPQ', Y_KW__bb, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPya,Qx->RPQ', Y_KW__bb, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPza,Qyzx->RPQ', Y_KW__bb, t1_xxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjQz,yz->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,Pjyz,Qz->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,PjzQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,Pjzw,Qyzw->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,Pjzy,Qz->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjQw,xwyz->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjQy,xz->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyz,PjQz,xy->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjwQ,xwyz->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzuwx->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzuxw->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzwux->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,ijyz,Pjwu,Qyzwxu->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzxuw->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzxwu->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjwy,Qzwx->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,Pjwz,Qywx->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjyQ,xz->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjyw,Qzxw->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,Pjyz,Qx->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjzQ,xy->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjzw,Qywx->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjzy,Qx->RPQ', Y_KW__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijab,Pjab,Qx->RPQ', Y_KW__bb, t1_xvee, t1_vvee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijab,Pjba,Qx->RPQ', Y_KW__bb, t1_xvee, t1_vvee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,Pjya,Qy->RPQ', Y_KW__bb, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxa,jPya,Qy->RPQ', Y_KW__bb, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjQz,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,Pjyz,Qz->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,PjzQ,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,Pjzw,Qyzw->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,Pjzy,Qz->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijya,PjQa,xy->RPQ', Y_KW__bb, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,Pjya,Qx->RPQ', Y_KW__bb, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,Pjza,Qyzx->RPQ', Y_KW__bb, t1_xvae, t1_vvae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,jPQa,xy->RPQ', Y_KW__bb, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPya,Qx->RPQ', Y_KW__bb, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijya,jPza,Qyzx->RPQ', Y_KW__bb, t1_xvae, t1_vvae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjQz,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,Pjyz,Qz->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,PjzQ,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,Pjzw,Qyzw->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,Pjzy,Qz->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjQw,xwyz->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjQy,xz->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyz,PjQz,xy->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjwQ,xwyz->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzuwx->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzuxw->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzwux->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,ijyz,Pjwu,Qyzwxu->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzxuw->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,ijyz,Pjwu,Qyzxwu->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjwy,Qzwx->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,Pjwz,Qywx->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjyQ,xz->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjyw,Qzxw->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,Pjyz,Qx->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjzQ,xy->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjzw,Qywx->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,Pjzy,Qx->RPQ', Y_KW__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pxyz,Qz->RPQ', Y_KW__bb, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,Pxzy,Qz->RPQ', Y_KW__bb, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Py,Qx->RPQ', Y_KW__bb, t1_xa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PyQz,xz->RPQ', Y_KW__bb, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pyxz,Qz->RPQ', Y_KW__bb, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,PyzQ,xz->RPQ', Y_KW__bb, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pyzw,Qxzw->RPQ', Y_KW__bb, t1_xa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,Pyzx,Qz->RPQ', Y_KW__bb, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PzQy,xz->RPQ', Y_KW__bb, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pzwy,Qzwx->RPQ', Y_KW__bb, t1_xa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,PzyQ,xz->RPQ', Y_KW__bb, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,Pzyw,Qzxw->RPQ', Y_KW__bb, t1_xa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQx,Pz,yz->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQx,Pzwu,yzwu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQx,Pzwy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQx,Pzyw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQz,Pw,xywz->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywuvz->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rix,iyQz,Pwuv,xywuzv->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywvuz->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywvzu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywzuv->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywzvu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQz,Pwux,zuyw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwuy,xwuz->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,iyQz,Pwxu,zuyw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQz,Pwxy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwyu,xwzu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwyx,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyQz,Px,zy->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Py,xz->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pzwu,xywu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pzwx,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQz,Pzxw,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyab,Pxab,Qy->RPQ', Y_KW__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyab,Pxba,Qy->RPQ', Y_KW__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyab,Pzab,Qzxy->RPQ', Y_KW__bb, t1_xaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyab,Pzba,Qzyx->RPQ', Y_KW__bb, t1_xaee, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,Pa,Qy->RPQ', Y_KW__bb, t1_xaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyax,PzQa,yz->RPQ', Y_KW__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,PzaQ,yz->RPQ', Y_KW__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,Pzaw,Qzyw->RPQ', Y_KW__bb, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,Pzwa,Qzwy->RPQ', Y_KW__bb, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pa,Qzxy->RPQ', Y_KW__bb, t1_xaea, t1_ve, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,PwQa,xywz->RPQ', Y_KW__bb, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,PwaQ,xywz->RPQ', Y_KW__bb, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pwau,Qzwxyu->RPQ', Y_KW__bb, t1_xaea, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pwaz,Qwxy->RPQ', Y_KW__bb, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwuxy->RPQ', Y_KW__bb, t1_xaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyaz,Pwua,Qzwuyx->RPQ', Y_KW__bb, t1_xaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwxuy->RPQ', Y_KW__bb, t1_xaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwxyu->RPQ', Y_KW__bb, t1_xaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwyux->RPQ', Y_KW__bb, t1_xaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyaz,Pwua,Qzwyxu->RPQ', Y_KW__bb, t1_xaea, t1_vaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pwza,Qwyx->RPQ', Y_KW__bb, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyaz,PxQa,yz->RPQ', Y_KW__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,PxaQ,yz->RPQ', Y_KW__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pxaw,Qzwy->RPQ', Y_KW__bb, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,Pxaz,Qy->RPQ', Y_KW__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,Pxwa,Qzwy->RPQ', Y_KW__bb, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,Pxza,Qy->RPQ', Y_KW__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxQ,Pz,yz->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxQ,Pzwu,yzwu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxQ,Pzwy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxQ,Pzyw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,Pa,Qy->RPQ', Y_KW__bb, t1_xaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxa,PzQa,yz->RPQ', Y_KW__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,PzaQ,yz->RPQ', Y_KW__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,Pzaw,Qzyw->RPQ', Y_KW__bb, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,Pzwa,Qzwy->RPQ', Y_KW__bb, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,iyxz,PwQy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxz,PwQz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,Pwuy,Qwuz->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,Pwuz,Qwuy->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,PwyQ,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,Pwyu,Qwzu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,PwzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,Pwzu,Qwyu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,Py,Qz->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxz,PyQw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,PywQ,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,Pywu,Qzwu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,Pz,Qy->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxz,PzQw,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,PzwQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,Pzwu,Qywu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pw,xyzw->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwuv,xywzuv->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwux,zuwy->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pwuy,xwzu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwxu,zuyw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pwxy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pwyu,xwzu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pwyx,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Px,zy->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Py,xz->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pzwu,xyuw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pzwx,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pzxw,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pa,Qzyx->RPQ', Y_KW__bb, t1_xaae, t1_ve, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,PwQa,xyzw->RPQ', Y_KW__bb, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,PwaQ,xyzw->RPQ', Y_KW__bb, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwuxy->RPQ', Y_KW__bb, t1_xaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwuyx->RPQ', Y_KW__bb, t1_xaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwxuy->RPQ', Y_KW__bb, t1_xaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwxyu->RPQ', Y_KW__bb, t1_xaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyza,Pwau,Qzwyux->RPQ', Y_KW__bb, t1_xaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyza,Pwau,Qzwyxu->RPQ', Y_KW__bb, t1_xaae, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pwaz,Qwyx->RPQ', Y_KW__bb, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pwua,Qzwuxy->RPQ', Y_KW__bb, t1_xaae, t1_vaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pwza,Qwxy->RPQ', Y_KW__bb, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,PxQa,yz->RPQ', Y_KW__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,PxaQ,yz->RPQ', Y_KW__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pxaw,Qzyw->RPQ', Y_KW__bb, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,Pxaz,Qy->RPQ', Y_KW__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pxwa,Qzwy->RPQ', Y_KW__bb, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,Pxza,Qy->RPQ', Y_KW__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PuQw,xyzu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,PuQy,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PuQz,xyuw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Puvw,Qzuvxy->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,Puvy,Qxuvzw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuvxy->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzw,Puvz,Qwuvyx->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuxvy->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuxyv->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuyvx->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puvz,Qwuyxv->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PuwQ,xyzu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuvxy->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuvyx->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuxvy->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuxyv->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Puwv,Qzuyvx->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzw,Puwv,Qzuyxv->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Puwz,Quyx->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,Puxy,Quzw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,PuyQ,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuvwz->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuvzw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuwvz->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyzw,Puyv,Qxuwzv->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuzvw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Puyv,Qxuzwv->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,Puyx,Quwz->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PuzQ,xyuw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Puzv,Qwuxyv->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Puzw,Quxy->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pw,Qzyx->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PwQu,xyzu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PwQx,yz->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PwuQ,xyzu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyuvz->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzw,Pwuv,Qxyuzv->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyvuz->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyvzu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyzuv->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,Pwuv,Qxyzvu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pwux,Qyuz->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PwxQ,yz->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pwxu,Qyzu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PxQw,yz->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyzw,PxQz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pxuw,Qzuy->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,Pxuz,Qwuy->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PxwQ,yz->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pxwu,Qzyu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,Pxwz,Qy->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PxzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pxzu,Qwuy->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pxzw,Qy->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,Py,Qxwz->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,PyQu,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,PyuQ,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwuvx->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyzw,Pyuv,Qzwuxv->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwvux->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwvxu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwxuv->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,Pyuv,Qzwxvu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pz,Qwxy->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PzQu,xyuw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyzw,PzQx,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PzuQ,xyuw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pzuv,Qxyuvw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,Pzux,Qyuw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PzxQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,Pzxu,Qyuw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzx,PwQy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzx,PwQz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,Pwuy,Qwuz->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,Pwuz,Qwuy->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,PwyQ,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,Pwyu,Qwzu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,PwzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,Pwzu,Qwyu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,Py,Qz->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzx,PyQw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,PywQ,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,Pywu,Qzwu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,Pz,Qy->RPQ', Y_KW__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzx,PzQw,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,PzwQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,Pzwu,Qywu->RPQ', Y_KW__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,Pjya,Qy->RPQ', Y_KW__bb, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jixa,jPya,Qy->RPQ', Y_KW__bb, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,PjQa,xy->RPQ', Y_KW__bb, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,Pjya,Qx->RPQ', Y_KW__bb, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,Pjza,Qyzx->RPQ', Y_KW__bb, t1_xxae, t1_vxae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPQa,xy->RPQ', Y_KW__bb, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,jPya,Qx->RPQ', Y_KW__bb, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPza,Qyxz->RPQ', Y_KW__bb, t1_xxae, t1_xvae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,Pjya,Qy->RPQ', Y_KW__bb, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jixa,jPya,Qy->RPQ', Y_KW__bb, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,PjQa,xy->RPQ', Y_KW__bb, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,Pjya,Qx->RPQ', Y_KW__bb, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,Pjza,Qyzx->RPQ', Y_KW__bb, t1_vxae, t1_vvae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPQa,xy->RPQ', Y_KW__bb, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,jPya,Qx->RPQ', Y_KW__bb, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,jPza,Qyxz->RPQ', Y_KW__bb, t1_vxae, t1_vvae, rdm_ccaa, optimize = einsum_type)
    TY[:, s_v:f_v, s_a:f_a] += temp    
 
    temp  = einsum('RPx,xQ->RPQ', Y_KW__aa, t2_ae, optimize = einsum_type)
    temp += einsum('RPx,xQ->RPQ', Y_KW__bb, t2_ae, optimize = einsum_type)
    temp -= einsum('RPx,ijxa,ijQa->RPQ', Y_KW__aa, t1_xxae, t1_xxee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxa,jiQa->RPQ', Y_KW__aa, t1_xxae, t1_xxee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,ijyQ->RPQ', Y_KW__aa, t1_xxaa, t1_xxae, optimize = einsum_type)
    temp -= einsum('RPx,ijxy,jiyQ->RPQ', Y_KW__aa, t1_xxaa, t1_xxae, optimize = einsum_type)
    temp -= einsum('RPx,ijxa,ijQa->RPQ', Y_KW__aa, t1_xvae, t1_xvee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxa,jiQa->RPQ', Y_KW__aa, t1_xvae, t1_vxee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,ijyQ->RPQ', Y_KW__aa, t1_xvaa, t1_xvae, optimize = einsum_type)
    temp -= einsum('RPx,ijxy,jiyQ->RPQ', Y_KW__aa, t1_xvaa, t1_vxae, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ix,iQ->RPQ', Y_KW__aa, t1_xa, t1_xe, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQa,ia->RPQ', Y_KW__aa, t1_xaee, t1_xe, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQy,iy->RPQ', Y_KW__aa, t1_xaea, t1_xa, optimize = einsum_type)
    temp += einsum('RPx,ixaQ,ia->RPQ', Y_KW__aa, t1_xaee, t1_xe, optimize = einsum_type)
    temp += einsum('RPx,ixyQ,iy->RPQ', Y_KW__aa, t1_xaae, t1_xa, optimize = einsum_type)
    temp -= einsum('RPx,ijxa,ijQa->RPQ', Y_KW__aa, t1_vxae, t1_vxee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxa,jiQa->RPQ', Y_KW__aa, t1_vxae, t1_xvee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,ijyQ->RPQ', Y_KW__aa, t1_vxaa, t1_vxae, optimize = einsum_type)
    temp -= einsum('RPx,ijxy,jiyQ->RPQ', Y_KW__aa, t1_vxaa, t1_xvae, optimize = einsum_type)
    temp -= einsum('RPx,ijxa,ijQa->RPQ', Y_KW__aa, t1_vvae, t1_vvee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxa,jiQa->RPQ', Y_KW__aa, t1_vvae, t1_vvee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,ijyQ->RPQ', Y_KW__aa, t1_vvaa, t1_vvae, optimize = einsum_type)
    temp -= einsum('RPx,ijxy,jiyQ->RPQ', Y_KW__aa, t1_vvaa, t1_vvae, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ix,iQ->RPQ', Y_KW__aa, t1_va, t1_ve, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQa,ia->RPQ', Y_KW__aa, t1_vaee, t1_ve, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQy,iy->RPQ', Y_KW__aa, t1_vaea, t1_va, optimize = einsum_type)
    temp += einsum('RPx,ixaQ,ia->RPQ', Y_KW__aa, t1_vaee, t1_ve, optimize = einsum_type)
    temp += einsum('RPx,ixyQ,iy->RPQ', Y_KW__aa, t1_vaae, t1_va, optimize = einsum_type)
    temp += einsum('Rix,PiQa,xa->RPQ', Y_KW__aa, t1_xxee, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiaQ,xa->RPQ', Y_KW__aa, t1_xxee, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Pixy,yQ->RPQ', Y_KW__aa, t1_xxaa, t1_ae, optimize = einsum_type)
    temp += einsum('Rix,Piyx,yQ->RPQ', Y_KW__aa, t1_xxaa, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,yzxQ->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, optimize = einsum_type)
    temp += einsum('Rix,Piyz,zyxQ->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, optimize = einsum_type)
    temp -= einsum('Rix,iQ,Px->RPQ', Y_KW__aa, t1_xe, t1_xa, optimize = einsum_type)
    temp += einsum('Rix,ia,PxQa->RPQ', Y_KW__aa, t1_xe, t1_xaee, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,PxaQ->RPQ', Y_KW__aa, t1_xe, t1_xaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxa,PjQa->RPQ', Y_KW__aa, t1_xxae, t1_xxee, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,PjaQ->RPQ', Y_KW__aa, t1_xxae, t1_xxee, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjyQ->RPQ', Y_KW__aa, t1_xxaa, t1_xxae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxy,jPyQ->RPQ', Y_KW__aa, t1_xxaa, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjyQ->RPQ', Y_KW__aa, t1_xxaa, t1_xxae, optimize = einsum_type)
    temp -= einsum('Rix,ijyx,jPyQ->RPQ', Y_KW__aa, t1_xxaa, t1_xxae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxa,PjQa->RPQ', Y_KW__aa, t1_xvae, t1_xvee, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,PjaQ->RPQ', Y_KW__aa, t1_xvae, t1_xvee, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjyQ->RPQ', Y_KW__aa, t1_xvaa, t1_xvae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxy,jPyQ->RPQ', Y_KW__aa, t1_xvaa, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjyQ->RPQ', Y_KW__aa, t1_xvaa, t1_xvae, optimize = einsum_type)
    temp -= einsum('Rix,ijyx,jPyQ->RPQ', Y_KW__aa, t1_xvaa, t1_vxae, optimize = einsum_type)
    temp += einsum('Rix,iy,PxQy->RPQ', Y_KW__aa, t1_xa, t1_xaea, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PxyQ->RPQ', Y_KW__aa, t1_xa, t1_xaae, optimize = einsum_type)
    temp += einsum('Rix,iy,PyQx->RPQ', Y_KW__aa, t1_xa, t1_xaea, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PyxQ->RPQ', Y_KW__aa, t1_xa, t1_xaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQx,Py->RPQ', Y_KW__aa, t1_xaea, t1_xa, optimize = einsum_type)
    temp += einsum('Rix,iyxQ,Py->RPQ', Y_KW__aa, t1_xaae, t1_xa, optimize = einsum_type)
    temp -= einsum('Rix,jixa,PjQa->RPQ', Y_KW__aa, t1_xxae, t1_xxee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,PjaQ->RPQ', Y_KW__aa, t1_xxae, t1_xxee, optimize = einsum_type)
    temp -= einsum('Rix,jixa,PjQa->RPQ', Y_KW__aa, t1_vxae, t1_xvee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,PjaQ->RPQ', Y_KW__aa, t1_vxae, t1_xvee, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yQ,xy->RPQ', Y_KW__aa, t2_ae, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPx,ijxa,ijQa->RPQ', Y_KW__bb, t1_xxae, t1_xxee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxa,jiQa->RPQ', Y_KW__bb, t1_xxae, t1_xxee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,ijyQ->RPQ', Y_KW__bb, t1_xxaa, t1_xxae, optimize = einsum_type)
    temp -= einsum('RPx,ijxy,jiyQ->RPQ', Y_KW__bb, t1_xxaa, t1_xxae, optimize = einsum_type)
    temp -= einsum('RPx,ijxa,ijQa->RPQ', Y_KW__bb, t1_xvae, t1_xvee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxa,jiQa->RPQ', Y_KW__bb, t1_xvae, t1_vxee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,ijyQ->RPQ', Y_KW__bb, t1_xvaa, t1_xvae, optimize = einsum_type)
    temp -= einsum('RPx,ijxy,jiyQ->RPQ', Y_KW__bb, t1_xvaa, t1_vxae, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ix,iQ->RPQ', Y_KW__bb, t1_xa, t1_xe, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQa,ia->RPQ', Y_KW__bb, t1_xaee, t1_xe, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQy,iy->RPQ', Y_KW__bb, t1_xaea, t1_xa, optimize = einsum_type)
    temp += einsum('RPx,ixaQ,ia->RPQ', Y_KW__bb, t1_xaee, t1_xe, optimize = einsum_type)
    temp += einsum('RPx,ixyQ,iy->RPQ', Y_KW__bb, t1_xaae, t1_xa, optimize = einsum_type)
    temp -= einsum('RPx,ijxa,ijQa->RPQ', Y_KW__bb, t1_vxae, t1_vxee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxa,jiQa->RPQ', Y_KW__bb, t1_vxae, t1_xvee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,ijyQ->RPQ', Y_KW__bb, t1_vxaa, t1_vxae, optimize = einsum_type)
    temp -= einsum('RPx,ijxy,jiyQ->RPQ', Y_KW__bb, t1_vxaa, t1_xvae, optimize = einsum_type)
    temp -= einsum('RPx,ijxa,ijQa->RPQ', Y_KW__bb, t1_vvae, t1_vvee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxa,jiQa->RPQ', Y_KW__bb, t1_vvae, t1_vvee, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,ijyQ->RPQ', Y_KW__bb, t1_vvaa, t1_vvae, optimize = einsum_type)
    temp -= einsum('RPx,ijxy,jiyQ->RPQ', Y_KW__bb, t1_vvaa, t1_vvae, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ix,iQ->RPQ', Y_KW__bb, t1_va, t1_ve, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQa,ia->RPQ', Y_KW__bb, t1_vaee, t1_ve, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQy,iy->RPQ', Y_KW__bb, t1_vaea, t1_va, optimize = einsum_type)
    temp += einsum('RPx,ixaQ,ia->RPQ', Y_KW__bb, t1_vaee, t1_ve, optimize = einsum_type)
    temp += einsum('RPx,ixyQ,iy->RPQ', Y_KW__bb, t1_vaae, t1_va, optimize = einsum_type)
    temp += einsum('Rix,PiQa,xa->RPQ', Y_KW__bb, t1_xxee, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiaQ,xa->RPQ', Y_KW__bb, t1_xxee, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Pixy,yQ->RPQ', Y_KW__bb, t1_xxaa, t1_ae, optimize = einsum_type)
    temp += einsum('Rix,Piyx,yQ->RPQ', Y_KW__bb, t1_xxaa, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,yzxQ->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, optimize = einsum_type)
    temp += einsum('Rix,Piyz,zyxQ->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, optimize = einsum_type)
    temp -= einsum('Rix,iQ,Px->RPQ', Y_KW__bb, t1_xe, t1_xa, optimize = einsum_type)
    temp += einsum('Rix,ia,PxQa->RPQ', Y_KW__bb, t1_xe, t1_xaee, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,PxaQ->RPQ', Y_KW__bb, t1_xe, t1_xaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxa,PjQa->RPQ', Y_KW__bb, t1_xxae, t1_xxee, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,PjaQ->RPQ', Y_KW__bb, t1_xxae, t1_xxee, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjyQ->RPQ', Y_KW__bb, t1_xxaa, t1_xxae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxy,jPyQ->RPQ', Y_KW__bb, t1_xxaa, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjyQ->RPQ', Y_KW__bb, t1_xxaa, t1_xxae, optimize = einsum_type)
    temp -= einsum('Rix,ijyx,jPyQ->RPQ', Y_KW__bb, t1_xxaa, t1_xxae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxa,PjQa->RPQ', Y_KW__bb, t1_xvae, t1_xvee, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,PjaQ->RPQ', Y_KW__bb, t1_xvae, t1_xvee, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjyQ->RPQ', Y_KW__bb, t1_xvaa, t1_xvae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxy,jPyQ->RPQ', Y_KW__bb, t1_xvaa, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjyQ->RPQ', Y_KW__bb, t1_xvaa, t1_xvae, optimize = einsum_type)
    temp -= einsum('Rix,ijyx,jPyQ->RPQ', Y_KW__bb, t1_xvaa, t1_vxae, optimize = einsum_type)
    temp += einsum('Rix,iy,PxQy->RPQ', Y_KW__bb, t1_xa, t1_xaea, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PxyQ->RPQ', Y_KW__bb, t1_xa, t1_xaae, optimize = einsum_type)
    temp += einsum('Rix,iy,PyQx->RPQ', Y_KW__bb, t1_xa, t1_xaea, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PyxQ->RPQ', Y_KW__bb, t1_xa, t1_xaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQx,Py->RPQ', Y_KW__bb, t1_xaea, t1_xa, optimize = einsum_type)
    temp += einsum('Rix,iyxQ,Py->RPQ', Y_KW__bb, t1_xaae, t1_xa, optimize = einsum_type)
    temp -= einsum('Rix,jixa,PjQa->RPQ', Y_KW__bb, t1_xxae, t1_xxee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,PjaQ->RPQ', Y_KW__bb, t1_xxae, t1_xxee, optimize = einsum_type)
    temp -= einsum('Rix,jixa,PjQa->RPQ', Y_KW__bb, t1_vxae, t1_xvee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,PjaQ->RPQ', Y_KW__bb, t1_vxae, t1_xvee, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,yQ,xy->RPQ', Y_KW__bb, t2_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iQ,iy,xy->RPQ', Y_KW__aa, t1_xe, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iQ,iyzw,xyzw->RPQ', Y_KW__aa, t1_xe, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQa,ijya,xy->RPQ', Y_KW__aa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQa,jiya,xy->RPQ', Y_KW__aa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijxy,ijzQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,jizQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijyQ,ijyz,xz->RPQ', Y_KW__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijyQ,jiyz,xz->RPQ', Y_KW__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijyQ,jizw,xyzw->RPQ', Y_KW__aa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQa,ijya,xy->RPQ', Y_KW__aa, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQa,jiya,xy->RPQ', Y_KW__aa, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijxy,ijzQ,yz->RPQ', Y_KW__aa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,jizQ,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijyQ,ijyz,xz->RPQ', Y_KW__aa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijyQ,jiyz,xz->RPQ', Y_KW__aa, t1_xvae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijyQ,jizw,xyzw->RPQ', Y_KW__aa, t1_xvae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ix,iyQz,zy->RPQ', Y_KW__aa, t1_xa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ix,iyzQ,zy->RPQ', Y_KW__aa, t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQa,iyaz,zy->RPQ', Y_KW__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQa,iyza,zy->RPQ', Y_KW__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,iz,yz->RPQ', Y_KW__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,izwu,yzwu->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,izwy,wz->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQy,izyw,wz->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RPx,ixaQ,iyaz,zy->RPQ', Y_KW__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixaQ,iyza,zy->RPQ', Y_KW__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,iz,yz->RPQ', Y_KW__aa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,izwu,yzwu->RPQ', Y_KW__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,izwy,wz->RPQ', Y_KW__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RPx,ixyQ,izyw,wz->RPQ', Y_KW__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,ia,xy->RPQ', Y_KW__aa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,izaw,xzyw->RPQ', Y_KW__aa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,izwa,xzwy->RPQ', Y_KW__aa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iw,xzwy->RPQ', Y_KW__aa, t1_xaea, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwuvy->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPx,iyQz,iwuv,xzwuyv->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwvuy->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwvyu->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwyuv->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwyvu->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iwuz,xwuy->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iwzu,xwyu->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iz,xy->RPQ', Y_KW__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyaQ,ia,xy->RPQ', Y_KW__aa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyaQ,izaw,xzyw->RPQ', Y_KW__aa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyaQ,izwa,xzyw->RPQ', Y_KW__aa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyax,izQa,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyax,izaQ,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxa,izQa,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxa,izaQ,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iQ,zy->RPQ', Y_KW__aa, t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iwQu,zwyu->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iwQz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxz,iwuQ,zwyu->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxz,iwzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iw,xzyw->RPQ', Y_KW__aa, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iwuv,xzwyuv->RPQ', Y_KW__aa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iwuz,xwyu->RPQ', Y_KW__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzQ,iwzu,xwyu->RPQ', Y_KW__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzQ,iz,xy->RPQ', Y_KW__aa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iQ,zy->RPQ', Y_KW__aa, t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwQu,zwyu->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwQz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwuQ,zwuy->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzx,iwzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iQ,iy,xy->RPQ', Y_KW__aa, t1_ve, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iQ,iyzw,xyzw->RPQ', Y_KW__aa, t1_ve, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQa,ijya,xy->RPQ', Y_KW__aa, t1_vxee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQa,jiya,xy->RPQ', Y_KW__aa, t1_vxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijxy,ijzQ,yz->RPQ', Y_KW__aa, t1_vxaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,jizQ,yz->RPQ', Y_KW__aa, t1_vxaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijyQ,ijyz,xz->RPQ', Y_KW__aa, t1_vxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijyQ,jiyz,xz->RPQ', Y_KW__aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijyQ,jizw,xyzw->RPQ', Y_KW__aa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQa,ijya,xy->RPQ', Y_KW__aa, t1_vvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQa,jiya,xy->RPQ', Y_KW__aa, t1_vvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijxy,ijzQ,yz->RPQ', Y_KW__aa, t1_vvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,jizQ,yz->RPQ', Y_KW__aa, t1_vvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijyQ,ijyz,xz->RPQ', Y_KW__aa, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijyQ,jiyz,xz->RPQ', Y_KW__aa, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijyQ,jizw,xyzw->RPQ', Y_KW__aa, t1_vvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ix,iyQz,zy->RPQ', Y_KW__aa, t1_va, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ix,iyzQ,zy->RPQ', Y_KW__aa, t1_va, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQa,iyaz,zy->RPQ', Y_KW__aa, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQa,iyza,zy->RPQ', Y_KW__aa, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,iz,yz->RPQ', Y_KW__aa, t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,izwu,yzwu->RPQ', Y_KW__aa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,izwy,wz->RPQ', Y_KW__aa, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQy,izyw,wz->RPQ', Y_KW__aa, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RPx,ixaQ,iyaz,zy->RPQ', Y_KW__aa, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixaQ,iyza,zy->RPQ', Y_KW__aa, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,iz,yz->RPQ', Y_KW__aa, t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,izwu,yzwu->RPQ', Y_KW__aa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,izwy,wz->RPQ', Y_KW__aa, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RPx,ixyQ,izyw,wz->RPQ', Y_KW__aa, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,ia,xy->RPQ', Y_KW__aa, t1_vaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,izaw,xzyw->RPQ', Y_KW__aa, t1_vaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,izwa,xzwy->RPQ', Y_KW__aa, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iw,xzwy->RPQ', Y_KW__aa, t1_vaea, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwuvy->RPQ', Y_KW__aa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPx,iyQz,iwuv,xzwuyv->RPQ', Y_KW__aa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwvuy->RPQ', Y_KW__aa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwvyu->RPQ', Y_KW__aa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwyuv->RPQ', Y_KW__aa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwyvu->RPQ', Y_KW__aa, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iwuz,xwuy->RPQ', Y_KW__aa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iwzu,xwyu->RPQ', Y_KW__aa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iz,xy->RPQ', Y_KW__aa, t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyaQ,ia,xy->RPQ', Y_KW__aa, t1_vaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyaQ,izaw,xzyw->RPQ', Y_KW__aa, t1_vaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyaQ,izwa,xzyw->RPQ', Y_KW__aa, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyax,izQa,yz->RPQ', Y_KW__aa, t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyax,izaQ,yz->RPQ', Y_KW__aa, t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxa,izQa,yz->RPQ', Y_KW__aa, t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxa,izaQ,yz->RPQ', Y_KW__aa, t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iQ,zy->RPQ', Y_KW__aa, t1_vaaa, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iwQu,zwyu->RPQ', Y_KW__aa, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iwQz,yw->RPQ', Y_KW__aa, t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxz,iwuQ,zwyu->RPQ', Y_KW__aa, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxz,iwzQ,yw->RPQ', Y_KW__aa, t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iw,xzyw->RPQ', Y_KW__aa, t1_vaae, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iwuv,xzwyuv->RPQ', Y_KW__aa, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iwuz,xwyu->RPQ', Y_KW__aa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzQ,iwzu,xwyu->RPQ', Y_KW__aa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzQ,iz,xy->RPQ', Y_KW__aa, t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iQ,zy->RPQ', Y_KW__aa, t1_vaaa, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwQu,zwyu->RPQ', Y_KW__aa, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwQz,yw->RPQ', Y_KW__aa, t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwuQ,zwuy->RPQ', Y_KW__aa, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzx,iwzQ,yw->RPQ', Y_KW__aa, t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,xyQa,za,yz->RPQ', Y_KW__aa, t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,xyQa,zwua,yuwz->RPQ', Y_KW__aa, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,yxQa,za,yz->RPQ', Y_KW__aa, t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,yxQa,zwua,yuwz->RPQ', Y_KW__aa, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,yzQa,wa,xwyz->RPQ', Y_KW__aa, t1_aaee, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,yzQa,wuva,xuwvyz->RPQ', Y_KW__aa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,yzQa,wuva,xuwvzy->RPQ', Y_KW__aa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,yzQa,wuva,xuwyvz->RPQ', Y_KW__aa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPx,yzQa,wuva,xuwyzv->RPQ', Y_KW__aa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,yzQa,wuva,xuwzvy->RPQ', Y_KW__aa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPx,yzQa,wuva,xuwzyv->RPQ', Y_KW__aa, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,yzxa,wuQa,yzwu->RPQ', Y_KW__aa, t1_aaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,xyza,yz->RPQ', Y_KW__aa, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,ya,xy->RPQ', Y_KW__aa, t1_xxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,PiQa,yxza,yz->RPQ', Y_KW__aa, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,yzwa,xwzy->RPQ', Y_KW__aa, t1_xxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,PiaQ,xyza,yz->RPQ', Y_KW__aa, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,PiaQ,ya,xy->RPQ', Y_KW__aa, t1_xxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiaQ,yxza,yz->RPQ', Y_KW__aa, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,PiaQ,yzwa,xwzy->RPQ', Y_KW__aa, t1_xxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Pixy,yzwQ,wz->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Pixy,zQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Pixy,zwuQ,yuwz->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Pixy,zywQ,wz->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyx,yzwQ,wz->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,Piyx,zQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,Piyx,zwuQ,yuwz->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Piyx,zywQ,wz->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piyz,wQ,xwzy->RPQ', Y_KW__aa, t1_xxaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piyz,wuvQ,xuwzyv->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piyz,wuxQ,yzuw->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,wyuQ,xwzu->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,wyxQ,zw->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,wzuQ,xwyu->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,wzxQ,yw->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,yQ,xz->RPQ', Y_KW__aa, t1_xxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,ywuQ,xwzu->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,ywxQ,zw->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,yzwQ,xw->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,zQ,xy->RPQ', Y_KW__aa, t1_xxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,zwuQ,xwuy->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,zwxQ,yw->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,zywQ,xw->RPQ', Y_KW__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Py,xy->RPQ', Y_KW__aa, t1_xe, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iQ,Pyxz,yz->RPQ', Y_KW__aa, t1_xe, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Pyzw,xyzw->RPQ', Y_KW__aa, t1_xe, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Pyzx,yz->RPQ', Y_KW__aa, t1_xe, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,PyQa,xy->RPQ', Y_KW__aa, t1_xe, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,PyaQ,xy->RPQ', Y_KW__aa, t1_xe, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,PjzQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,jPzQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijya,PjQa,xy->RPQ', Y_KW__aa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,PjaQ,xy->RPQ', Y_KW__aa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,PjzQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,jPzQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjwQ,xwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjyQ,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjzQ,xy->RPQ', Y_KW__aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPwQ,xwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPyQ,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyz,jPzQ,xy->RPQ', Y_KW__aa, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,PjzQ,yz->RPQ', Y_KW__aa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,jPzQ,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijya,PjQa,xy->RPQ', Y_KW__aa, t1_xvae, t1_xvee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,PjaQ,xy->RPQ', Y_KW__aa, t1_xvae, t1_xvee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,PjzQ,yz->RPQ', Y_KW__aa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,jPzQ,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjwQ,xwyz->RPQ', Y_KW__aa, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjyQ,xz->RPQ', Y_KW__aa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjzQ,xy->RPQ', Y_KW__aa, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPwQ,xwyz->RPQ', Y_KW__aa, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPyQ,xz->RPQ', Y_KW__aa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyz,jPzQ,xy->RPQ', Y_KW__aa, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PyQz,xz->RPQ', Y_KW__aa, t1_xa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,PyzQ,xz->RPQ', Y_KW__aa, t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PzQy,xz->RPQ', Y_KW__aa, t1_xa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,PzyQ,xz->RPQ', Y_KW__aa, t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQx,Pz,yz->RPQ', Y_KW__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQx,Pzwu,yzwu->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQx,Pzwy,zw->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQx,Pzyw,zw->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQz,Pw,xywz->RPQ', Y_KW__aa, t1_xaea, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywuvz->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rix,iyQz,Pwuv,xywuzv->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywvuz->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywvzu->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywzuv->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywzvu->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQz,Pwux,zuyw->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwuy,xwuz->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,iyQz,Pwxu,zuyw->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQz,Pwxy,zw->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwyu,xwzu->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwyx,zw->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyQz,Px,zy->RPQ', Y_KW__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Py,xz->RPQ', Y_KW__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pzwu,xywu->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pzwx,yw->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQz,Pzxw,yw->RPQ', Y_KW__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyax,PzQa,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,PzaQ,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,PwQa,xywz->RPQ', Y_KW__aa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,PwaQ,xywz->RPQ', Y_KW__aa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyaz,PxQa,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,PxaQ,yz->RPQ', Y_KW__aa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxQ,Pz,yz->RPQ', Y_KW__aa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxQ,Pzwu,yzwu->RPQ', Y_KW__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxQ,Pzwy,zw->RPQ', Y_KW__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxQ,Pzyw,zw->RPQ', Y_KW__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxa,PzQa,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,PzaQ,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxz,PwQy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxz,PwQz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,PwyQ,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,PwzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxz,PyQw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,PywQ,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxz,PzQw,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,PzwQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pw,xyzw->RPQ', Y_KW__aa, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwuv,xywzuv->RPQ', Y_KW__aa, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwux,zuwy->RPQ', Y_KW__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pwuy,xwzu->RPQ', Y_KW__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwxu,zuyw->RPQ', Y_KW__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pwxy,zw->RPQ', Y_KW__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pwyu,xwzu->RPQ', Y_KW__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pwyx,zw->RPQ', Y_KW__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Px,zy->RPQ', Y_KW__aa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Py,xz->RPQ', Y_KW__aa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pzwu,xyuw->RPQ', Y_KW__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pzwx,yw->RPQ', Y_KW__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pzxw,yw->RPQ', Y_KW__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,PwQa,xyzw->RPQ', Y_KW__aa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,PwaQ,xyzw->RPQ', Y_KW__aa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,PxQa,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,PxaQ,yz->RPQ', Y_KW__aa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PuQw,xyzu->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,PuQy,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PuQz,xyuw->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PuwQ,xyzu->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,PuyQ,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PuzQ,xyuw->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PwQu,xyzu->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PwQx,yz->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PwuQ,xyzu->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PwxQ,yz->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PxQw,yz->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyzw,PxQz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PxwQ,yz->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PxzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,PyQu,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,PyuQ,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PzQu,xyuw->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyzw,PzQx,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PzuQ,xyuw->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PzxQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzx,PwQy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzx,PwQz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,PwyQ,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,PwzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzx,PyQw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,PywQ,zw->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzx,PzQw,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,PzwQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,PjQa,xy->RPQ', Y_KW__aa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,PjaQ,xy->RPQ', Y_KW__aa, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,PjQa,xy->RPQ', Y_KW__aa, t1_vxae, t1_xvee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,PjaQ,xy->RPQ', Y_KW__aa, t1_vxae, t1_xvee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iQ,iy,xy->RPQ', Y_KW__bb, t1_xe, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iQ,iyzw,xyzw->RPQ', Y_KW__bb, t1_xe, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQa,ijya,xy->RPQ', Y_KW__bb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQa,jiya,xy->RPQ', Y_KW__bb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijxy,ijzQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,jizQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijyQ,ijyz,xz->RPQ', Y_KW__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijyQ,jiyz,xz->RPQ', Y_KW__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijyQ,jizw,xyzw->RPQ', Y_KW__bb, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQa,ijya,xy->RPQ', Y_KW__bb, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQa,jiya,xy->RPQ', Y_KW__bb, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijxy,ijzQ,yz->RPQ', Y_KW__bb, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,jizQ,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijyQ,ijyz,xz->RPQ', Y_KW__bb, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijyQ,jiyz,xz->RPQ', Y_KW__bb, t1_xvae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijyQ,jizw,xyzw->RPQ', Y_KW__bb, t1_xvae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ix,iyQz,zy->RPQ', Y_KW__bb, t1_xa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ix,iyzQ,zy->RPQ', Y_KW__bb, t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQa,iyaz,zy->RPQ', Y_KW__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQa,iyza,zy->RPQ', Y_KW__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,iz,yz->RPQ', Y_KW__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,izwu,yzwu->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,izwy,wz->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQy,izyw,wz->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RPx,ixaQ,iyaz,zy->RPQ', Y_KW__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixaQ,iyza,zy->RPQ', Y_KW__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,iz,yz->RPQ', Y_KW__bb, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,izwu,yzwu->RPQ', Y_KW__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,izwy,wz->RPQ', Y_KW__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RPx,ixyQ,izyw,wz->RPQ', Y_KW__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,ia,xy->RPQ', Y_KW__bb, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,izaw,xzyw->RPQ', Y_KW__bb, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,izwa,xzwy->RPQ', Y_KW__bb, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iw,xzwy->RPQ', Y_KW__bb, t1_xaea, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwuvy->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPx,iyQz,iwuv,xzwuyv->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwvuy->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwvyu->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwyuv->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwyvu->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iwuz,xwuy->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iwzu,xwyu->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iz,xy->RPQ', Y_KW__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyaQ,ia,xy->RPQ', Y_KW__bb, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyaQ,izaw,xzyw->RPQ', Y_KW__bb, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyaQ,izwa,xzyw->RPQ', Y_KW__bb, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyax,izQa,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyax,izaQ,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxa,izQa,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxa,izaQ,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iQ,zy->RPQ', Y_KW__bb, t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iwQu,zwyu->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iwQz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxz,iwuQ,zwyu->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxz,iwzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iw,xzyw->RPQ', Y_KW__bb, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iwuv,xzwyuv->RPQ', Y_KW__bb, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iwuz,xwyu->RPQ', Y_KW__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzQ,iwzu,xwyu->RPQ', Y_KW__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzQ,iz,xy->RPQ', Y_KW__bb, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iQ,zy->RPQ', Y_KW__bb, t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwQu,zwyu->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwQz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwuQ,zwuy->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzx,iwzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iQ,iy,xy->RPQ', Y_KW__bb, t1_ve, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iQ,iyzw,xyzw->RPQ', Y_KW__bb, t1_ve, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQa,ijya,xy->RPQ', Y_KW__bb, t1_vxee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQa,jiya,xy->RPQ', Y_KW__bb, t1_vxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijxy,ijzQ,yz->RPQ', Y_KW__bb, t1_vxaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,jizQ,yz->RPQ', Y_KW__bb, t1_vxaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijyQ,ijyz,xz->RPQ', Y_KW__bb, t1_vxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijyQ,jiyz,xz->RPQ', Y_KW__bb, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijyQ,jizw,xyzw->RPQ', Y_KW__bb, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijQa,ijya,xy->RPQ', Y_KW__bb, t1_vvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijQa,jiya,xy->RPQ', Y_KW__bb, t1_vvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijxy,ijzQ,yz->RPQ', Y_KW__bb, t1_vvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijxy,jizQ,yz->RPQ', Y_KW__bb, t1_vvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,ijyQ,ijyz,xz->RPQ', Y_KW__bb, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijyQ,jiyz,xz->RPQ', Y_KW__bb, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,ijyQ,jizw,xyzw->RPQ', Y_KW__bb, t1_vvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ix,iyQz,zy->RPQ', Y_KW__bb, t1_va, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ix,iyzQ,zy->RPQ', Y_KW__bb, t1_va, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQa,iyaz,zy->RPQ', Y_KW__bb, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQa,iyza,zy->RPQ', Y_KW__bb, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,iz,yz->RPQ', Y_KW__bb, t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,izwu,yzwu->RPQ', Y_KW__bb, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,ixQy,izwy,wz->RPQ', Y_KW__bb, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixQy,izyw,wz->RPQ', Y_KW__bb, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RPx,ixaQ,iyaz,zy->RPQ', Y_KW__bb, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixaQ,iyza,zy->RPQ', Y_KW__bb, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,iz,yz->RPQ', Y_KW__bb, t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,izwu,yzwu->RPQ', Y_KW__bb, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,ixyQ,izwy,wz->RPQ', Y_KW__bb, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RPx,ixyQ,izyw,wz->RPQ', Y_KW__bb, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,ia,xy->RPQ', Y_KW__bb, t1_vaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,izaw,xzyw->RPQ', Y_KW__bb, t1_vaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQa,izwa,xzwy->RPQ', Y_KW__bb, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iw,xzwy->RPQ', Y_KW__bb, t1_vaea, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwuvy->RPQ', Y_KW__bb, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPx,iyQz,iwuv,xzwuyv->RPQ', Y_KW__bb, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwvuy->RPQ', Y_KW__bb, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwvyu->RPQ', Y_KW__bb, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwyuv->RPQ', Y_KW__bb, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPx,iyQz,iwuv,xzwyvu->RPQ', Y_KW__bb, t1_vaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iwuz,xwuy->RPQ', Y_KW__bb, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iwzu,xwyu->RPQ', Y_KW__bb, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyQz,iz,xy->RPQ', Y_KW__bb, t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyaQ,ia,xy->RPQ', Y_KW__bb, t1_vaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyaQ,izaw,xzyw->RPQ', Y_KW__bb, t1_vaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyaQ,izwa,xzyw->RPQ', Y_KW__bb, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyax,izQa,yz->RPQ', Y_KW__bb, t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyax,izaQ,yz->RPQ', Y_KW__bb, t1_vaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxa,izQa,yz->RPQ', Y_KW__bb, t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxa,izaQ,yz->RPQ', Y_KW__bb, t1_vaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iQ,zy->RPQ', Y_KW__bb, t1_vaaa, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iwQu,zwyu->RPQ', Y_KW__bb, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyxz,iwQz,yw->RPQ', Y_KW__bb, t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxz,iwuQ,zwyu->RPQ', Y_KW__bb, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyxz,iwzQ,yw->RPQ', Y_KW__bb, t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iw,xzyw->RPQ', Y_KW__bb, t1_vaae, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iwuv,xzwyuv->RPQ', Y_KW__bb, t1_vaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzQ,iwuz,xwyu->RPQ', Y_KW__bb, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzQ,iwzu,xwyu->RPQ', Y_KW__bb, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzQ,iz,xy->RPQ', Y_KW__bb, t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iQ,zy->RPQ', Y_KW__bb, t1_vaaa, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwQu,zwyu->RPQ', Y_KW__bb, t1_vaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwQz,yw->RPQ', Y_KW__bb, t1_vaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPx,iyzx,iwuQ,zwuy->RPQ', Y_KW__bb, t1_vaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPx,iyzx,iwzQ,yw->RPQ', Y_KW__bb, t1_vaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,xyQa,za,yz->RPQ', Y_KW__bb, t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPx,xyQa,zwua,yuwz->RPQ', Y_KW__bb, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,yxQa,za,yz->RPQ', Y_KW__bb, t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,yxQa,zwua,yuwz->RPQ', Y_KW__bb, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,yzQa,wa,xwyz->RPQ', Y_KW__bb, t1_aaee, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,yzQa,wuva,xuwyzv->RPQ', Y_KW__bb, t1_aaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPx,yzxa,wuQa,yzwu->RPQ', Y_KW__bb, t1_aaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,xyza,yz->RPQ', Y_KW__bb, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,ya,xy->RPQ', Y_KW__bb, t1_xxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,PiQa,yxza,yz->RPQ', Y_KW__bb, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,yzwa,xwzy->RPQ', Y_KW__bb, t1_xxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,PiaQ,xyza,yz->RPQ', Y_KW__bb, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,PiaQ,ya,xy->RPQ', Y_KW__bb, t1_xxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiaQ,yxza,yz->RPQ', Y_KW__bb, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,PiaQ,yzwa,xwzy->RPQ', Y_KW__bb, t1_xxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Pixy,yzwQ,wz->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Pixy,zQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Pixy,zwuQ,yuwz->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Pixy,zywQ,wz->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyx,yzwQ,wz->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,Piyx,zQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,Piyx,zwuQ,yuwz->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Piyx,zywQ,wz->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piyz,wQ,xwzy->RPQ', Y_KW__bb, t1_xxaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piyz,wuvQ,xuwzyv->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piyz,wuxQ,yzuw->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,wyuQ,xwzu->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,wyxQ,zw->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,wzuQ,xwyu->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,wzxQ,yw->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,yQ,xz->RPQ', Y_KW__bb, t1_xxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,ywuQ,xwzu->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,ywxQ,zw->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,yzwQ,xw->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,zQ,xy->RPQ', Y_KW__bb, t1_xxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,zwuQ,xwuy->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,zwxQ,yw->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,zywQ,xw->RPQ', Y_KW__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Py,xy->RPQ', Y_KW__bb, t1_xe, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iQ,Pyxz,yz->RPQ', Y_KW__bb, t1_xe, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Pyzw,xyzw->RPQ', Y_KW__bb, t1_xe, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Pyzx,yz->RPQ', Y_KW__bb, t1_xe, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,PyQa,xy->RPQ', Y_KW__bb, t1_xe, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,PyaQ,xy->RPQ', Y_KW__bb, t1_xe, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,PjzQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,jPzQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijya,PjQa,xy->RPQ', Y_KW__bb, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,PjaQ,xy->RPQ', Y_KW__bb, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,PjzQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,jPzQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjwQ,xwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjyQ,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjzQ,xy->RPQ', Y_KW__bb, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPwQ,xwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xxae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPyQ,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyz,jPzQ,xy->RPQ', Y_KW__bb, t1_xxaa, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,PjzQ,yz->RPQ', Y_KW__bb, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,jPzQ,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijya,PjQa,xy->RPQ', Y_KW__bb, t1_xvae, t1_xvee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,PjaQ,xy->RPQ', Y_KW__bb, t1_xvae, t1_xvee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,PjzQ,yz->RPQ', Y_KW__bb, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,jPzQ,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjwQ,xwyz->RPQ', Y_KW__bb, t1_xvaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjyQ,xz->RPQ', Y_KW__bb, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjzQ,xy->RPQ', Y_KW__bb, t1_xvaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPwQ,xwyz->RPQ', Y_KW__bb, t1_xvaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPyQ,xz->RPQ', Y_KW__bb, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyz,jPzQ,xy->RPQ', Y_KW__bb, t1_xvaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PyQz,xz->RPQ', Y_KW__bb, t1_xa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,PyzQ,xz->RPQ', Y_KW__bb, t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PzQy,xz->RPQ', Y_KW__bb, t1_xa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,PzyQ,xz->RPQ', Y_KW__bb, t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQx,Pz,yz->RPQ', Y_KW__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQx,Pzwu,yzwu->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQx,Pzwy,zw->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQx,Pzyw,zw->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQz,Pw,xywz->RPQ', Y_KW__bb, t1_xaea, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywuvz->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rix,iyQz,Pwuv,xywuzv->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywvuz->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywvzu->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywzuv->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywzvu->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQz,Pwux,zuyw->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwuy,xwuz->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,iyQz,Pwxu,zuyw->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQz,Pwxy,zw->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwyu,xwzu->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwyx,zw->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyQz,Px,zy->RPQ', Y_KW__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Py,xz->RPQ', Y_KW__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pzwu,xywu->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pzwx,yw->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQz,Pzxw,yw->RPQ', Y_KW__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyax,PzQa,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,PzaQ,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,PwQa,xywz->RPQ', Y_KW__bb, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,PwaQ,xywz->RPQ', Y_KW__bb, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyaz,PxQa,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,PxaQ,yz->RPQ', Y_KW__bb, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxQ,Pz,yz->RPQ', Y_KW__bb, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxQ,Pzwu,yzwu->RPQ', Y_KW__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxQ,Pzwy,zw->RPQ', Y_KW__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxQ,Pzyw,zw->RPQ', Y_KW__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxa,PzQa,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,PzaQ,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxz,PwQy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxz,PwQz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,PwyQ,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,PwzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxz,PyQw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,PywQ,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxz,PzQw,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,PzwQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pw,xyzw->RPQ', Y_KW__bb, t1_xaae, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwuv,xywzuv->RPQ', Y_KW__bb, t1_xaae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwux,zuwy->RPQ', Y_KW__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pwuy,xwzu->RPQ', Y_KW__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwxu,zuyw->RPQ', Y_KW__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pwxy,zw->RPQ', Y_KW__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pwyu,xwzu->RPQ', Y_KW__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pwyx,zw->RPQ', Y_KW__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Px,zy->RPQ', Y_KW__bb, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Py,xz->RPQ', Y_KW__bb, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pzwu,xyuw->RPQ', Y_KW__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pzwx,yw->RPQ', Y_KW__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pzxw,yw->RPQ', Y_KW__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,PwQa,xyzw->RPQ', Y_KW__bb, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,PwaQ,xyzw->RPQ', Y_KW__bb, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,PxQa,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,PxaQ,yz->RPQ', Y_KW__bb, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PuQw,xyzu->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,PuQy,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PuQz,xyuw->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PuwQ,xyzu->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,PuyQ,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PuzQ,xyuw->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PwQu,xyzu->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PwQx,yz->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PwuQ,xyzu->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PwxQ,yz->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PxQw,yz->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyzw,PxQz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PxwQ,yz->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PxzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,PyQu,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,PyuQ,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PzQu,xyuw->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyzw,PzQx,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PzuQ,xyuw->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PzxQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzx,PwQy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzx,PwQz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,PwyQ,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,PwzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzx,PyQw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,PywQ,zw->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzx,PzQw,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,PzwQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,PjQa,xy->RPQ', Y_KW__bb, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,PjaQ,xy->RPQ', Y_KW__bb, t1_xxae, t1_xxee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,PjQa,xy->RPQ', Y_KW__bb, t1_vxae, t1_xvee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,PjaQ,xy->RPQ', Y_KW__bb, t1_vxae, t1_xvee, rdm_ca, optimize = einsum_type)
    TY[:, s_c:f_c, s_e:f_e] += temp   
 
    temp  = einsum('Rix,PiQa,xa->RPQ', Y_KW__aa, t1_vxee, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiaQ,xa->RPQ', Y_KW__aa, t1_vxee, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Pixy,yQ->RPQ', Y_KW__aa, t1_vxaa, t1_ae, optimize = einsum_type)
    temp += einsum('Rix,Piyx,yQ->RPQ', Y_KW__aa, t1_vxaa, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,yzxQ->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, optimize = einsum_type)
    temp += einsum('Rix,Piyz,zyxQ->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, optimize = einsum_type)
    temp -= einsum('Rix,iQ,Px->RPQ', Y_KW__aa, t1_xe, t1_va, optimize = einsum_type)
    temp += einsum('Rix,ia,PxQa->RPQ', Y_KW__aa, t1_xe, t1_vaee, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,PxaQ->RPQ', Y_KW__aa, t1_xe, t1_vaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxa,PjQa->RPQ', Y_KW__aa, t1_xxae, t1_vxee, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,PjaQ->RPQ', Y_KW__aa, t1_xxae, t1_vxee, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjyQ->RPQ', Y_KW__aa, t1_xxaa, t1_vxae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxy,jPyQ->RPQ', Y_KW__aa, t1_xxaa, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjyQ->RPQ', Y_KW__aa, t1_xxaa, t1_vxae, optimize = einsum_type)
    temp -= einsum('Rix,ijyx,jPyQ->RPQ', Y_KW__aa, t1_xxaa, t1_xvae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxa,PjQa->RPQ', Y_KW__aa, t1_xvae, t1_vvee, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,PjaQ->RPQ', Y_KW__aa, t1_xvae, t1_vvee, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjyQ->RPQ', Y_KW__aa, t1_xvaa, t1_vvae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxy,jPyQ->RPQ', Y_KW__aa, t1_xvaa, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjyQ->RPQ', Y_KW__aa, t1_xvaa, t1_vvae, optimize = einsum_type)
    temp -= einsum('Rix,ijyx,jPyQ->RPQ', Y_KW__aa, t1_xvaa, t1_vvae, optimize = einsum_type)
    temp += einsum('Rix,iy,PxQy->RPQ', Y_KW__aa, t1_xa, t1_vaea, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PxyQ->RPQ', Y_KW__aa, t1_xa, t1_vaae, optimize = einsum_type)
    temp += einsum('Rix,iy,PyQx->RPQ', Y_KW__aa, t1_xa, t1_vaea, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PyxQ->RPQ', Y_KW__aa, t1_xa, t1_vaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQx,Py->RPQ', Y_KW__aa, t1_xaea, t1_va, optimize = einsum_type)
    temp += einsum('Rix,iyxQ,Py->RPQ', Y_KW__aa, t1_xaae, t1_va, optimize = einsum_type)
    temp -= einsum('Rix,jixa,PjQa->RPQ', Y_KW__aa, t1_xxae, t1_vxee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,PjaQ->RPQ', Y_KW__aa, t1_xxae, t1_vxee, optimize = einsum_type)
    temp -= einsum('Rix,jixa,PjQa->RPQ', Y_KW__aa, t1_vxae, t1_vvee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,PjaQ->RPQ', Y_KW__aa, t1_vxae, t1_vvee, optimize = einsum_type)
    temp += einsum('Rix,PiQa,xa->RPQ', Y_KW__bb, t1_vxee, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiaQ,xa->RPQ', Y_KW__bb, t1_vxee, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Pixy,yQ->RPQ', Y_KW__bb, t1_vxaa, t1_ae, optimize = einsum_type)
    temp += einsum('Rix,Piyx,yQ->RPQ', Y_KW__bb, t1_vxaa, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,yzxQ->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, optimize = einsum_type)
    temp += einsum('Rix,Piyz,zyxQ->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, optimize = einsum_type)
    temp -= einsum('Rix,iQ,Px->RPQ', Y_KW__bb, t1_xe, t1_va, optimize = einsum_type)
    temp += einsum('Rix,ia,PxQa->RPQ', Y_KW__bb, t1_xe, t1_vaee, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,PxaQ->RPQ', Y_KW__bb, t1_xe, t1_vaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxa,PjQa->RPQ', Y_KW__bb, t1_xxae, t1_vxee, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,PjaQ->RPQ', Y_KW__bb, t1_xxae, t1_vxee, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjyQ->RPQ', Y_KW__bb, t1_xxaa, t1_vxae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxy,jPyQ->RPQ', Y_KW__bb, t1_xxaa, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjyQ->RPQ', Y_KW__bb, t1_xxaa, t1_vxae, optimize = einsum_type)
    temp -= einsum('Rix,ijyx,jPyQ->RPQ', Y_KW__bb, t1_xxaa, t1_xvae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxa,PjQa->RPQ', Y_KW__bb, t1_xvae, t1_vvee, optimize = einsum_type)
    temp -= einsum('Rix,ijxa,PjaQ->RPQ', Y_KW__bb, t1_xvae, t1_vvee, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,PjyQ->RPQ', Y_KW__bb, t1_xvaa, t1_vvae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxy,jPyQ->RPQ', Y_KW__bb, t1_xvaa, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,PjyQ->RPQ', Y_KW__bb, t1_xvaa, t1_vvae, optimize = einsum_type)
    temp -= einsum('Rix,ijyx,jPyQ->RPQ', Y_KW__bb, t1_xvaa, t1_vvae, optimize = einsum_type)
    temp += einsum('Rix,iy,PxQy->RPQ', Y_KW__bb, t1_xa, t1_vaea, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PxyQ->RPQ', Y_KW__bb, t1_xa, t1_vaae, optimize = einsum_type)
    temp += einsum('Rix,iy,PyQx->RPQ', Y_KW__bb, t1_xa, t1_vaea, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PyxQ->RPQ', Y_KW__bb, t1_xa, t1_vaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQx,Py->RPQ', Y_KW__bb, t1_xaea, t1_va, optimize = einsum_type)
    temp += einsum('Rix,iyxQ,Py->RPQ', Y_KW__bb, t1_xaae, t1_va, optimize = einsum_type)
    temp -= einsum('Rix,jixa,PjQa->RPQ', Y_KW__bb, t1_xxae, t1_vxee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,PjaQ->RPQ', Y_KW__bb, t1_xxae, t1_vxee, optimize = einsum_type)
    temp -= einsum('Rix,jixa,PjQa->RPQ', Y_KW__bb, t1_vxae, t1_vvee, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixa,PjaQ->RPQ', Y_KW__bb, t1_vxae, t1_vvee, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,xyza,yz->RPQ', Y_KW__aa, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,ya,xy->RPQ', Y_KW__aa, t1_vxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,PiQa,yxza,yz->RPQ', Y_KW__aa, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,yzwa,xwzy->RPQ', Y_KW__aa, t1_vxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,PiaQ,xyza,yz->RPQ', Y_KW__aa, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,PiaQ,ya,xy->RPQ', Y_KW__aa, t1_vxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiaQ,yxza,yz->RPQ', Y_KW__aa, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,PiaQ,yzwa,xwzy->RPQ', Y_KW__aa, t1_vxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Pixy,yzwQ,wz->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Pixy,zQ,yz->RPQ', Y_KW__aa, t1_vxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Pixy,zwuQ,yuwz->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Pixy,zywQ,wz->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyx,yzwQ,wz->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,Piyx,zQ,yz->RPQ', Y_KW__aa, t1_vxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,Piyx,zwuQ,yuwz->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Piyx,zywQ,wz->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piyz,wQ,xwzy->RPQ', Y_KW__aa, t1_vxaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piyz,wuvQ,xuwzyv->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piyz,wuxQ,yzuw->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,wyuQ,xwzu->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,wyxQ,zw->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,wzuQ,xwyu->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,wzxQ,yw->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,yQ,xz->RPQ', Y_KW__aa, t1_vxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,ywuQ,xwzu->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,ywxQ,zw->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,yzwQ,xw->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,zQ,xy->RPQ', Y_KW__aa, t1_vxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,zwuQ,xwuy->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,zwxQ,yw->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,zywQ,xw->RPQ', Y_KW__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Py,xy->RPQ', Y_KW__aa, t1_xe, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iQ,Pyxz,yz->RPQ', Y_KW__aa, t1_xe, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Pyzw,xyzw->RPQ', Y_KW__aa, t1_xe, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Pyzx,yz->RPQ', Y_KW__aa, t1_xe, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,PyQa,xy->RPQ', Y_KW__aa, t1_xe, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,PyaQ,xy->RPQ', Y_KW__aa, t1_xe, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,PjzQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,jPzQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijya,PjQa,xy->RPQ', Y_KW__aa, t1_xxae, t1_vxee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,PjaQ,xy->RPQ', Y_KW__aa, t1_xxae, t1_vxee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,PjzQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,jPzQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjwQ,xwyz->RPQ', Y_KW__aa, t1_xxaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjyQ,xz->RPQ', Y_KW__aa, t1_xxaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjzQ,xy->RPQ', Y_KW__aa, t1_xxaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPwQ,xwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPyQ,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyz,jPzQ,xy->RPQ', Y_KW__aa, t1_xxaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,PjzQ,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,jPzQ,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijya,PjQa,xy->RPQ', Y_KW__aa, t1_xvae, t1_vvee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,PjaQ,xy->RPQ', Y_KW__aa, t1_xvae, t1_vvee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,PjzQ,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,jPzQ,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjwQ,xwyz->RPQ', Y_KW__aa, t1_xvaa, t1_vvae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjyQ,xz->RPQ', Y_KW__aa, t1_xvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjzQ,xy->RPQ', Y_KW__aa, t1_xvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPwQ,xwyz->RPQ', Y_KW__aa, t1_xvaa, t1_vvae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPyQ,xz->RPQ', Y_KW__aa, t1_xvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyz,jPzQ,xy->RPQ', Y_KW__aa, t1_xvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PyQz,xz->RPQ', Y_KW__aa, t1_xa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,PyzQ,xz->RPQ', Y_KW__aa, t1_xa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PzQy,xz->RPQ', Y_KW__aa, t1_xa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,PzyQ,xz->RPQ', Y_KW__aa, t1_xa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQx,Pz,yz->RPQ', Y_KW__aa, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQx,Pzwu,yzwu->RPQ', Y_KW__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQx,Pzwy,zw->RPQ', Y_KW__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQx,Pzyw,zw->RPQ', Y_KW__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQz,Pw,xywz->RPQ', Y_KW__aa, t1_xaea, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywuvz->RPQ', Y_KW__aa, t1_xaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rix,iyQz,Pwuv,xywuzv->RPQ', Y_KW__aa, t1_xaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywvuz->RPQ', Y_KW__aa, t1_xaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywvzu->RPQ', Y_KW__aa, t1_xaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywzuv->RPQ', Y_KW__aa, t1_xaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywzvu->RPQ', Y_KW__aa, t1_xaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQz,Pwux,zuyw->RPQ', Y_KW__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwuy,xwuz->RPQ', Y_KW__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,iyQz,Pwxu,zuyw->RPQ', Y_KW__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQz,Pwxy,zw->RPQ', Y_KW__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwyu,xwzu->RPQ', Y_KW__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwyx,zw->RPQ', Y_KW__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyQz,Px,zy->RPQ', Y_KW__aa, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Py,xz->RPQ', Y_KW__aa, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pzwu,xywu->RPQ', Y_KW__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pzwx,yw->RPQ', Y_KW__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQz,Pzxw,yw->RPQ', Y_KW__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyax,PzQa,yz->RPQ', Y_KW__aa, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,PzaQ,yz->RPQ', Y_KW__aa, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,PwQa,xywz->RPQ', Y_KW__aa, t1_xaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,PwaQ,xywz->RPQ', Y_KW__aa, t1_xaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyaz,PxQa,yz->RPQ', Y_KW__aa, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,PxaQ,yz->RPQ', Y_KW__aa, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxQ,Pz,yz->RPQ', Y_KW__aa, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxQ,Pzwu,yzwu->RPQ', Y_KW__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxQ,Pzwy,zw->RPQ', Y_KW__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxQ,Pzyw,zw->RPQ', Y_KW__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxa,PzQa,yz->RPQ', Y_KW__aa, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,PzaQ,yz->RPQ', Y_KW__aa, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxz,PwQy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxz,PwQz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,PwyQ,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,PwzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxz,PyQw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,PywQ,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxz,PzQw,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,PzwQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pw,xyzw->RPQ', Y_KW__aa, t1_xaae, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwuv,xywzuv->RPQ', Y_KW__aa, t1_xaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwux,zuwy->RPQ', Y_KW__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pwuy,xwzu->RPQ', Y_KW__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwxu,zuyw->RPQ', Y_KW__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pwxy,zw->RPQ', Y_KW__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pwyu,xwzu->RPQ', Y_KW__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pwyx,zw->RPQ', Y_KW__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Px,zy->RPQ', Y_KW__aa, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Py,xz->RPQ', Y_KW__aa, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pzwu,xyuw->RPQ', Y_KW__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pzwx,yw->RPQ', Y_KW__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pzxw,yw->RPQ', Y_KW__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,PwQa,xyzw->RPQ', Y_KW__aa, t1_xaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,PwaQ,xyzw->RPQ', Y_KW__aa, t1_xaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,PxQa,yz->RPQ', Y_KW__aa, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,PxaQ,yz->RPQ', Y_KW__aa, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PuQw,xyzu->RPQ', Y_KW__aa, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,PuQy,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PuQz,xyuw->RPQ', Y_KW__aa, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PuwQ,xyzu->RPQ', Y_KW__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,PuyQ,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PuzQ,xyuw->RPQ', Y_KW__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PwQu,xyzu->RPQ', Y_KW__aa, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PwQx,yz->RPQ', Y_KW__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PwuQ,xyzu->RPQ', Y_KW__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PwxQ,yz->RPQ', Y_KW__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PxQw,yz->RPQ', Y_KW__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyzw,PxQz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PxwQ,yz->RPQ', Y_KW__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PxzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,PyQu,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,PyuQ,xuzw->RPQ', Y_KW__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PzQu,xyuw->RPQ', Y_KW__aa, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyzw,PzQx,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PzuQ,xyuw->RPQ', Y_KW__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PzxQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzx,PwQy,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzx,PwQz,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,PwyQ,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,PwzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzx,PyQw,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,PywQ,zw->RPQ', Y_KW__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzx,PzQw,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,PzwQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,PjQa,xy->RPQ', Y_KW__aa, t1_xxae, t1_vxee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,PjaQ,xy->RPQ', Y_KW__aa, t1_xxae, t1_vxee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,PjQa,xy->RPQ', Y_KW__aa, t1_vxae, t1_vvee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,PjaQ,xy->RPQ', Y_KW__aa, t1_vxae, t1_vvee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,xyza,yz->RPQ', Y_KW__bb, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,ya,xy->RPQ', Y_KW__bb, t1_vxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,PiQa,yxza,yz->RPQ', Y_KW__bb, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiQa,yzwa,xwzy->RPQ', Y_KW__bb, t1_vxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,PiaQ,xyza,yz->RPQ', Y_KW__bb, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,PiaQ,ya,xy->RPQ', Y_KW__bb, t1_vxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,PiaQ,yxza,yz->RPQ', Y_KW__bb, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,PiaQ,yzwa,xwzy->RPQ', Y_KW__bb, t1_vxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Pixy,yzwQ,wz->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Pixy,zQ,yz->RPQ', Y_KW__bb, t1_vxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Pixy,zwuQ,yuwz->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Pixy,zywQ,wz->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyx,yzwQ,wz->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,Piyx,zQ,yz->RPQ', Y_KW__bb, t1_vxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,Piyx,zwuQ,yuwz->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,Piyx,zywQ,wz->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piyz,wQ,xwzy->RPQ', Y_KW__bb, t1_vxaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piyz,wuvQ,xuwzyv->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,Piyz,wuxQ,yzuw->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,wyuQ,xwzu->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,wyxQ,zw->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,wzuQ,xwyu->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,wzxQ,yw->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,yQ,xz->RPQ', Y_KW__bb, t1_vxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,ywuQ,xwzu->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,ywxQ,zw->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,yzwQ,xw->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,zQ,xy->RPQ', Y_KW__bb, t1_vxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,Piyz,zwuQ,xwuy->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,zwxQ,yw->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,Piyz,zywQ,xw->RPQ', Y_KW__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Py,xy->RPQ', Y_KW__bb, t1_xe, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iQ,Pyxz,yz->RPQ', Y_KW__bb, t1_xe, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Pyzw,xyzw->RPQ', Y_KW__bb, t1_xe, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iQ,Pyzx,yz->RPQ', Y_KW__bb, t1_xe, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ia,PyQa,xy->RPQ', Y_KW__bb, t1_xe, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ia,PyaQ,xy->RPQ', Y_KW__bb, t1_xe, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,PjzQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,jPzQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijya,PjQa,xy->RPQ', Y_KW__bb, t1_xxae, t1_vxee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,PjaQ,xy->RPQ', Y_KW__bb, t1_xxae, t1_vxee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,PjzQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,jPzQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjwQ,xwyz->RPQ', Y_KW__bb, t1_xxaa, t1_vxae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjyQ,xz->RPQ', Y_KW__bb, t1_xxaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjzQ,xy->RPQ', Y_KW__bb, t1_xxaa, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPwQ,xwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xvae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPyQ,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyz,jPzQ,xy->RPQ', Y_KW__bb, t1_xxaa, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijxy,PjzQ,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxy,jPzQ,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijya,PjQa,xy->RPQ', Y_KW__bb, t1_xvae, t1_vvee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijya,PjaQ,xy->RPQ', Y_KW__bb, t1_xvae, t1_vvee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyx,PjzQ,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyx,jPzQ,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjwQ,xwyz->RPQ', Y_KW__bb, t1_xvaa, t1_vvae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ijyz,PjyQ,xz->RPQ', Y_KW__bb, t1_xvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,PjzQ,xy->RPQ', Y_KW__bb, t1_xvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPwQ,xwyz->RPQ', Y_KW__bb, t1_xvaa, t1_vvae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyz,jPyQ,xz->RPQ', Y_KW__bb, t1_xvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyz,jPzQ,xy->RPQ', Y_KW__bb, t1_xvaa, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PyQz,xz->RPQ', Y_KW__bb, t1_xa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,PyzQ,xz->RPQ', Y_KW__bb, t1_xa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iy,PzQy,xz->RPQ', Y_KW__bb, t1_xa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iy,PzyQ,xz->RPQ', Y_KW__bb, t1_xa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQx,Pz,yz->RPQ', Y_KW__bb, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQx,Pzwu,yzwu->RPQ', Y_KW__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQx,Pzwy,zw->RPQ', Y_KW__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQx,Pzyw,zw->RPQ', Y_KW__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQz,Pw,xywz->RPQ', Y_KW__bb, t1_xaea, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywuvz->RPQ', Y_KW__bb, t1_xaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rix,iyQz,Pwuv,xywuzv->RPQ', Y_KW__bb, t1_xaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywvuz->RPQ', Y_KW__bb, t1_xaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywvzu->RPQ', Y_KW__bb, t1_xaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywzuv->RPQ', Y_KW__bb, t1_xaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQz,Pwuv,xywzvu->RPQ', Y_KW__bb, t1_xaea, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyQz,Pwux,zuyw->RPQ', Y_KW__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwuy,xwuz->RPQ', Y_KW__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,iyQz,Pwxu,zuyw->RPQ', Y_KW__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQz,Pwxy,zw->RPQ', Y_KW__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwyu,xwzu->RPQ', Y_KW__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pwyx,zw->RPQ', Y_KW__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyQz,Px,zy->RPQ', Y_KW__bb, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Py,xz->RPQ', Y_KW__bb, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pzwu,xywu->RPQ', Y_KW__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyQz,Pzwx,yw->RPQ', Y_KW__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQz,Pzxw,yw->RPQ', Y_KW__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyax,PzQa,yz->RPQ', Y_KW__bb, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyax,PzaQ,yz->RPQ', Y_KW__bb, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,PwQa,xywz->RPQ', Y_KW__bb, t1_xaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyaz,PwaQ,xywz->RPQ', Y_KW__bb, t1_xaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyaz,PxQa,yz->RPQ', Y_KW__bb, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaz,PxaQ,yz->RPQ', Y_KW__bb, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxQ,Pz,yz->RPQ', Y_KW__bb, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxQ,Pzwu,yzwu->RPQ', Y_KW__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxQ,Pzwy,zw->RPQ', Y_KW__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxQ,Pzyw,zw->RPQ', Y_KW__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxa,PzQa,yz->RPQ', Y_KW__bb, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxa,PzaQ,yz->RPQ', Y_KW__bb, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxz,PwQy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxz,PwQz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,PwyQ,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,PwzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iyxz,PyQw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,PywQ,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxz,PzQw,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,PzwQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pw,xyzw->RPQ', Y_KW__bb, t1_xaae, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwuv,xywzuv->RPQ', Y_KW__bb, t1_xaae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwux,zuwy->RPQ', Y_KW__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pwuy,xwzu->RPQ', Y_KW__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Pwxu,zuyw->RPQ', Y_KW__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pwxy,zw->RPQ', Y_KW__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pwyu,xwzu->RPQ', Y_KW__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pwyx,zw->RPQ', Y_KW__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzQ,Px,zy->RPQ', Y_KW__bb, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Py,xz->RPQ', Y_KW__bb, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pzwu,xyuw->RPQ', Y_KW__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzQ,Pzwx,yw->RPQ', Y_KW__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzQ,Pzxw,yw->RPQ', Y_KW__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,PwQa,xyzw->RPQ', Y_KW__bb, t1_xaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,PwaQ,xyzw->RPQ', Y_KW__bb, t1_xaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyza,PxQa,yz->RPQ', Y_KW__bb, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyza,PxaQ,yz->RPQ', Y_KW__bb, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PuQw,xyzu->RPQ', Y_KW__bb, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,PuQy,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PuQz,xyuw->RPQ', Y_KW__bb, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PuwQ,xyzu->RPQ', Y_KW__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,PuyQ,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PuzQ,xyuw->RPQ', Y_KW__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PwQu,xyzu->RPQ', Y_KW__bb, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PwQx,yz->RPQ', Y_KW__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PwuQ,xyzu->RPQ', Y_KW__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PwxQ,yz->RPQ', Y_KW__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PxQw,yz->RPQ', Y_KW__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyzw,PxQz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PxwQ,yz->RPQ', Y_KW__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PxzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,PyQu,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,PyuQ,xuzw->RPQ', Y_KW__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PzQu,xyuw->RPQ', Y_KW__bb, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyzw,PzQx,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,PzuQ,xyuw->RPQ', Y_KW__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzw,PzxQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzx,PwQy,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzx,PwQz,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,PwyQ,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,PwzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzx,PyQw,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,PywQ,zw->RPQ', Y_KW__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzx,PzQw,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,PzwQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,PjQa,xy->RPQ', Y_KW__bb, t1_xxae, t1_vxee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,PjaQ,xy->RPQ', Y_KW__bb, t1_xxae, t1_vxee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiya,PjQa,xy->RPQ', Y_KW__bb, t1_vxae, t1_vvee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,jiya,PjaQ,xy->RPQ', Y_KW__bb, t1_vxae, t1_vvee, rdm_ca, optimize = einsum_type)
    TY[:, s_v:f_v, s_e:f_e] += temp   
 
    temp  = einsum('RiP,iQ->RPQ', Y_KW__aa, t2_xe, optimize = einsum_type)
    temp += einsum('RiP,iQ->RPQ', Y_KW__bb, t2_xe, optimize = einsum_type)
    temp += einsum('RiP,ijQa,ja->RPQ', Y_KW__aa, t1_xxee, t1_xe, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,ijxQ,jx->RPQ', Y_KW__aa, t1_xxae, t1_xa, optimize = einsum_type)
    temp += einsum('RiP,ijQa,ja->RPQ', Y_KW__aa, t1_xvee, t1_ve, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,ijxQ,jx->RPQ', Y_KW__aa, t1_xvae, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RiP,ix,xQ->RPQ', Y_KW__aa, t1_xa, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jiQa,ja->RPQ', Y_KW__aa, t1_xxee, t1_xe, optimize = einsum_type)
    temp += einsum('RiP,jixQ,jx->RPQ', Y_KW__aa, t1_xxae, t1_xa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jiQa,ja->RPQ', Y_KW__aa, t1_vxee, t1_ve, optimize = einsum_type)
    temp += einsum('RiP,jixQ,jx->RPQ', Y_KW__aa, t1_vxae, t1_va, optimize = einsum_type)
    temp += einsum('Rix,iP,xQ->RPQ', Y_KW__aa, t1_xa, t1_ae, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jxQa->RPQ', Y_KW__aa, t1_xxae, t1_xaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPa,jxaQ->RPQ', Y_KW__aa, t1_xxae, t1_xaee, optimize = einsum_type)
    temp -= einsum('Rix,ijPx,jQ->RPQ', Y_KW__aa, t1_xxaa, t1_xe, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jxQy->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPy,jxyQ->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, optimize = einsum_type)
    temp -= einsum('Rix,ijQa,jxPa->RPQ', Y_KW__aa, t1_xxee, t1_xaae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijQa,jxaP->RPQ', Y_KW__aa, t1_xxee, t1_xaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxQ,jP->RPQ', Y_KW__aa, t1_xxae, t1_xa, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijyQ,jxPy->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jxyP->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jxQa->RPQ', Y_KW__aa, t1_xvae, t1_vaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPa,jxaQ->RPQ', Y_KW__aa, t1_xvae, t1_vaee, optimize = einsum_type)
    temp -= einsum('Rix,ijPx,jQ->RPQ', Y_KW__aa, t1_xvaa, t1_ve, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jxQy->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPy,jxyQ->RPQ', Y_KW__aa, t1_xvaa, t1_vaae, optimize = einsum_type)
    temp -= einsum('Rix,ijQa,jxPa->RPQ', Y_KW__aa, t1_xvee, t1_vaae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijQa,jxaP->RPQ', Y_KW__aa, t1_xvee, t1_vaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxQ,jP->RPQ', Y_KW__aa, t1_xvae, t1_va, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijyQ,jxPy->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jxyP->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPa,jxQa->RPQ', Y_KW__aa, t1_xxae, t1_xaee, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jxaQ->RPQ', Y_KW__aa, t1_xxae, t1_xaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPx,jQ->RPQ', Y_KW__aa, t1_xxaa, t1_xe, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPy,jxQy->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jxyQ->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiQa,jxPa->RPQ', Y_KW__aa, t1_xxee, t1_xaae, optimize = einsum_type)
    temp -= einsum('Rix,jiQa,jxaP->RPQ', Y_KW__aa, t1_xxee, t1_xaea, optimize = einsum_type)
    temp -= einsum('Rix,jixQ,jP->RPQ', Y_KW__aa, t1_xxae, t1_xa, optimize = einsum_type)
    temp -= einsum('Rix,jiyQ,jxPy->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiyQ,jxyP->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPa,jxQa->RPQ', Y_KW__aa, t1_vxae, t1_vaee, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jxaQ->RPQ', Y_KW__aa, t1_vxae, t1_vaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPx,jQ->RPQ', Y_KW__aa, t1_vxaa, t1_ve, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPy,jxQy->RPQ', Y_KW__aa, t1_vxaa, t1_vaea, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jxyQ->RPQ', Y_KW__aa, t1_vxaa, t1_vaae, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiQa,jxPa->RPQ', Y_KW__aa, t1_vxee, t1_vaae, optimize = einsum_type)
    temp -= einsum('Rix,jiQa,jxaP->RPQ', Y_KW__aa, t1_vxee, t1_vaea, optimize = einsum_type)
    temp -= einsum('Rix,jixQ,jP->RPQ', Y_KW__aa, t1_vxae, t1_va, optimize = einsum_type)
    temp -= einsum('Rix,jiyQ,jxPy->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiyQ,jxyP->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQ,Px->RPQ', Y_KW__aa, t2_xe, rdm_ca, optimize = einsum_type)
    temp += einsum('RiP,ijQa,ja->RPQ', Y_KW__bb, t1_xxee, t1_xe, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,ijxQ,jx->RPQ', Y_KW__bb, t1_xxae, t1_xa, optimize = einsum_type)
    temp += einsum('RiP,ijQa,ja->RPQ', Y_KW__bb, t1_xvee, t1_ve, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,ijxQ,jx->RPQ', Y_KW__bb, t1_xvae, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RiP,ix,xQ->RPQ', Y_KW__bb, t1_xa, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jiQa,ja->RPQ', Y_KW__bb, t1_xxee, t1_xe, optimize = einsum_type)
    temp += einsum('RiP,jixQ,jx->RPQ', Y_KW__bb, t1_xxae, t1_xa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jiQa,ja->RPQ', Y_KW__bb, t1_vxee, t1_ve, optimize = einsum_type)
    temp += einsum('RiP,jixQ,jx->RPQ', Y_KW__bb, t1_vxae, t1_va, optimize = einsum_type)
    temp += einsum('Rix,iP,xQ->RPQ', Y_KW__bb, t1_xa, t1_ae, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jxQa->RPQ', Y_KW__bb, t1_xxae, t1_xaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPa,jxaQ->RPQ', Y_KW__bb, t1_xxae, t1_xaee, optimize = einsum_type)
    temp -= einsum('Rix,ijPx,jQ->RPQ', Y_KW__bb, t1_xxaa, t1_xe, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jxQy->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPy,jxyQ->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, optimize = einsum_type)
    temp -= einsum('Rix,ijQa,jxPa->RPQ', Y_KW__bb, t1_xxee, t1_xaae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijQa,jxaP->RPQ', Y_KW__bb, t1_xxee, t1_xaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxQ,jP->RPQ', Y_KW__bb, t1_xxae, t1_xa, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijyQ,jxPy->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jxyP->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jxQa->RPQ', Y_KW__bb, t1_xvae, t1_vaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPa,jxaQ->RPQ', Y_KW__bb, t1_xvae, t1_vaee, optimize = einsum_type)
    temp -= einsum('Rix,ijPx,jQ->RPQ', Y_KW__bb, t1_xvaa, t1_ve, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jxQy->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijPy,jxyQ->RPQ', Y_KW__bb, t1_xvaa, t1_vaae, optimize = einsum_type)
    temp -= einsum('Rix,ijQa,jxPa->RPQ', Y_KW__bb, t1_xvee, t1_vaae, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijQa,jxaP->RPQ', Y_KW__bb, t1_xvee, t1_vaea, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxQ,jP->RPQ', Y_KW__bb, t1_xvae, t1_va, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijyQ,jxPy->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jxyP->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPa,jxQa->RPQ', Y_KW__bb, t1_xxae, t1_xaee, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jxaQ->RPQ', Y_KW__bb, t1_xxae, t1_xaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPx,jQ->RPQ', Y_KW__bb, t1_xxaa, t1_xe, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPy,jxQy->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jxyQ->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiQa,jxPa->RPQ', Y_KW__bb, t1_xxee, t1_xaae, optimize = einsum_type)
    temp -= einsum('Rix,jiQa,jxaP->RPQ', Y_KW__bb, t1_xxee, t1_xaea, optimize = einsum_type)
    temp -= einsum('Rix,jixQ,jP->RPQ', Y_KW__bb, t1_xxae, t1_xa, optimize = einsum_type)
    temp -= einsum('Rix,jiyQ,jxPy->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiyQ,jxyP->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPa,jxQa->RPQ', Y_KW__bb, t1_vxae, t1_vaee, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jxaQ->RPQ', Y_KW__bb, t1_vxae, t1_vaee, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPx,jQ->RPQ', Y_KW__bb, t1_vxaa, t1_ve, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPy,jxQy->RPQ', Y_KW__bb, t1_vxaa, t1_vaea, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jxyQ->RPQ', Y_KW__bb, t1_vxaa, t1_vaae, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiQa,jxPa->RPQ', Y_KW__bb, t1_vxee, t1_vaae, optimize = einsum_type)
    temp -= einsum('Rix,jiQa,jxaP->RPQ', Y_KW__bb, t1_vxee, t1_vaea, optimize = einsum_type)
    temp -= einsum('Rix,jixQ,jP->RPQ', Y_KW__bb, t1_vxae, t1_va, optimize = einsum_type)
    temp -= einsum('Rix,jiyQ,jxPy->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiyQ,jxyP->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iQ,Px->RPQ', Y_KW__bb, t2_xe, rdm_ca, optimize = einsum_type)
    temp += einsum('RiP,ijQa,jxay,yx->RPQ', Y_KW__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,ijQa,jxya,yx->RPQ', Y_KW__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiP,ijxQ,jy,xy->RPQ', Y_KW__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,ijxQ,jyxz,zy->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiP,ijxQ,jyzw,xyzw->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiP,ijxQ,jyzx,zy->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RiP,ijQa,jxay,yx->RPQ', Y_KW__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,ijQa,jxya,yx->RPQ', Y_KW__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiP,ijxQ,jy,xy->RPQ', Y_KW__aa, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,ijxQ,jyxz,zy->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiP,ijxQ,jyzw,xyzw->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiP,ijxQ,jyzx,zy->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiP,ix,xyzQ,zy->RPQ', Y_KW__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiP,ix,yxzQ,zy->RPQ', Y_KW__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiP,ixQa,ya,xy->RPQ', Y_KW__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiP,ixQa,yzwa,xwzy->RPQ', Y_KW__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiP,ixaQ,ya,xy->RPQ', Y_KW__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiP,ixaQ,yzwa,xwzy->RPQ', Y_KW__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiP,ixyz,wuxQ,yzuw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiP,ixyz,wyuQ,xwzu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiP,ixyz,wzuQ,xwyu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiP,ixyz,yQ,xz->RPQ', Y_KW__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiP,ixyz,ywuQ,xwzu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiP,ixyz,yzwQ,xw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiP,ixyz,zQ,xy->RPQ', Y_KW__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiP,ixyz,zwuQ,xwuy->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiP,ixyz,zywQ,xw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jiQa,jxay,yx->RPQ', Y_KW__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiP,jiQa,jxya,yx->RPQ', Y_KW__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jixQ,jy,xy->RPQ', Y_KW__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('RiP,jixQ,jyxz,zy->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jixQ,jyzw,xyzw->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jixQ,jyzx,zy->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jiQa,jxay,yx->RPQ', Y_KW__aa, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiP,jiQa,jxya,yx->RPQ', Y_KW__aa, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jixQ,jy,xy->RPQ', Y_KW__aa, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('RiP,jixQ,jyxz,zy->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jixQ,jyzw,xyzw->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jixQ,jyzx,zy->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iP,xyzQ,zy->RPQ', Y_KW__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iP,yQ,xy->RPQ', Y_KW__aa, t1_xa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iP,yxzQ,zy->RPQ', Y_KW__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iP,yzwQ,xwzy->RPQ', Y_KW__aa, t1_xa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,iPxy,zQ,yz->RPQ', Y_KW__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iPxy,zwuQ,yuwz->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPyx,zQ,yz->RPQ', Y_KW__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPyx,zwuQ,yuwz->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPyz,wQ,xwyz->RPQ', Y_KW__aa, t1_xaaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iPyz,wuvQ,xuwvyz->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iPyz,wuvQ,xuwvzy->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iPyz,wuvQ,xuwyvz->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rix,iPyz,wuvQ,xuwyzv->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iPyz,wuvQ,xuwzvy->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iPyz,wuvQ,xuwzyv->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPyz,wuxQ,zyuw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ia,xyQa,Py->RPQ', Y_KW__aa, t1_xe, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ia,yxQa,Py->RPQ', Y_KW__aa, t1_xe, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ia,yzQa,Pxyz->RPQ', Y_KW__aa, t1_xe, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPa,jyQa,xy->RPQ', Y_KW__aa, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jyaQ,xy->RPQ', Y_KW__aa, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPx,jyQz,zy->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPx,jyzQ,zy->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jQ,xy->RPQ', Y_KW__aa, t1_xxaa, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jxQz,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jxzQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzQw,xwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzQy,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzwQ,xwzy->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jzyQ,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijQa,ja,Px->RPQ', Y_KW__aa, t1_xxee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijQa,jxay,Py->RPQ', Y_KW__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijQa,jxya,Py->RPQ', Y_KW__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijQa,jyPa,xy->RPQ', Y_KW__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijQa,jyaP,xy->RPQ', Y_KW__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijQa,jyaz,Pyxz->RPQ', Y_KW__aa, t1_xxee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijQa,jyza,Pyxz->RPQ', Y_KW__aa, t1_xxee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxQ,jy,Py->RPQ', Y_KW__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxQ,jyPz,zy->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxQ,jyzP,zy->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxQ,jyzw,Pyzw->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxa,jyQa,Py->RPQ', Y_KW__aa, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,ijxa,jyaQ,Py->RPQ', Y_KW__aa, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jQ,Py->RPQ', Y_KW__aa, t1_xxaa, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzQw,Pwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzQy,Pz->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzwQ,Pwzy->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,ijxy,jzyQ,Pz->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jP,xy->RPQ', Y_KW__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jxPz,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jxyz,Pz->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyQ,jxzP,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jxzw,Pyzw->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyQ,jxzy,Pz->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jy,Px->RPQ', Y_KW__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jz,Pyzx->RPQ', Y_KW__aa, t1_xxae, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jzPw,xwyz->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jzPy,xz->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyQ,jzwP,xwyz->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzuwx->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzuxw->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzwux->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,ijyQ,jzwu,Pyzwxu->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzxuw->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzxwu->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jzwy,Pzwx->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyQ,jzyP,xz->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jzyw,Pzxw->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijya,jxQa,Py->RPQ', Y_KW__aa, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijya,jxaQ,Py->RPQ', Y_KW__aa, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijya,jzQa,Pxzy->RPQ', Y_KW__aa, t1_xxae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijya,jzaQ,Pxzy->RPQ', Y_KW__aa, t1_xxae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jQ,Py->RPQ', Y_KW__aa, t1_xxaa, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzQw,Pwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzQy,Pz->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzwQ,Pwzy->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyx,jzyQ,Pz->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jQ,Pxzy->RPQ', Y_KW__aa, t1_xxaa, t1_xe, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuwzy->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuywz->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuyzw->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuzwy->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,ijyz,jwQu,Pxuzyw->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwQy,Pxzw->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwQz,Pxwy->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwuQ,Pxuwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwyQ,Pxwz->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jwzQ,Pxwy->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxQw,Pwzy->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jxQy,Pz->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxQz,Py->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxwQ,Pwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxyQ,Pz->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jxzQ,Py->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPa,jyQa,xy->RPQ', Y_KW__aa, t1_xvae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jyaQ,xy->RPQ', Y_KW__aa, t1_xvae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPx,jyQz,zy->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPx,jyzQ,zy->RPQ', Y_KW__aa, t1_xvaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jQ,xy->RPQ', Y_KW__aa, t1_xvaa, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jxQz,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jxzQ,yz->RPQ', Y_KW__aa, t1_xvaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzQw,xwyz->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzQy,xz->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzwQ,xwzy->RPQ', Y_KW__aa, t1_xvaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jzyQ,xz->RPQ', Y_KW__aa, t1_xvaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijQa,ja,Px->RPQ', Y_KW__aa, t1_xvee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijQa,jxay,Py->RPQ', Y_KW__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijQa,jxya,Py->RPQ', Y_KW__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijQa,jyPa,xy->RPQ', Y_KW__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijQa,jyaP,xy->RPQ', Y_KW__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijQa,jyaz,Pyxz->RPQ', Y_KW__aa, t1_xvee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijQa,jyza,Pyxz->RPQ', Y_KW__aa, t1_xvee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxQ,jy,Py->RPQ', Y_KW__aa, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxQ,jyPz,zy->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxQ,jyzP,zy->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxQ,jyzw,Pyzw->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxa,jyQa,Py->RPQ', Y_KW__aa, t1_xvae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,ijxa,jyaQ,Py->RPQ', Y_KW__aa, t1_xvae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jQ,Py->RPQ', Y_KW__aa, t1_xvaa, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzQw,Pwyz->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzQy,Pz->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzwQ,Pwzy->RPQ', Y_KW__aa, t1_xvaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,ijxy,jzyQ,Pz->RPQ', Y_KW__aa, t1_xvaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jP,xy->RPQ', Y_KW__aa, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jxPz,yz->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jxyz,Pz->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyQ,jxzP,yz->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jxzw,Pyzw->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyQ,jxzy,Pz->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jy,Px->RPQ', Y_KW__aa, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jz,Pyzx->RPQ', Y_KW__aa, t1_xvae, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jzPw,xwyz->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jzPy,xz->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyQ,jzwP,xwyz->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzuwx->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzuxw->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzwux->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,ijyQ,jzwu,Pyzwxu->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzxuw->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzxwu->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jzwy,Pzwx->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyQ,jzyP,xz->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jzyw,Pzxw->RPQ', Y_KW__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijya,jxQa,Py->RPQ', Y_KW__aa, t1_xvae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijya,jxaQ,Py->RPQ', Y_KW__aa, t1_xvae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijya,jzQa,Pxzy->RPQ', Y_KW__aa, t1_xvae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijya,jzaQ,Pxzy->RPQ', Y_KW__aa, t1_xvae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jQ,Py->RPQ', Y_KW__aa, t1_xvaa, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzQw,Pwyz->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzQy,Pz->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzwQ,Pwzy->RPQ', Y_KW__aa, t1_xvaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyx,jzyQ,Pz->RPQ', Y_KW__aa, t1_xvaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jQ,Pxzy->RPQ', Y_KW__aa, t1_xvaa, t1_ve, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuwyz->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuwzy->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuywz->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuyzw->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuzwy->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,ijyz,jwQu,Pxuzyw->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwQy,Pxzw->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwQz,Pxwy->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwuQ,Pxuwyz->RPQ', Y_KW__aa, t1_xvaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwyQ,Pxwz->RPQ', Y_KW__aa, t1_xvaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jwzQ,Pxwy->RPQ', Y_KW__aa, t1_xvaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxQw,Pwzy->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jxQy,Pz->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxQz,Py->RPQ', Y_KW__aa, t1_xvaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxwQ,Pwyz->RPQ', Y_KW__aa, t1_xvaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxyQ,Pz->RPQ', Y_KW__aa, t1_xvaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jxzQ,Py->RPQ', Y_KW__aa, t1_xvaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iy,xzyQ,Pz->RPQ', Y_KW__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iy,yQ,Px->RPQ', Y_KW__aa, t1_xa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iy,yzwQ,Pwzx->RPQ', Y_KW__aa, t1_xa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iy,yzxQ,Pz->RPQ', Y_KW__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iy,zwyQ,Pxwz->RPQ', Y_KW__aa, t1_xa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iy,zxyQ,Pz->RPQ', Y_KW__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iy,zywQ,Pwxz->RPQ', Y_KW__aa, t1_xa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iy,zyxQ,Pz->RPQ', Y_KW__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyPa,xzQa,yz->RPQ', Y_KW__aa, t1_xaae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPa,zwQa,xyzw->RPQ', Y_KW__aa, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPa,zxQa,yz->RPQ', Y_KW__aa, t1_xaae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPx,zQ,yz->RPQ', Y_KW__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPx,zwuQ,yuwz->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,wQ,xywz->RPQ', Y_KW__aa, t1_xaaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,wuvQ,xyvuzw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,wuzQ,xyuw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyPz,wxuQ,zwyu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyPz,wxzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyPz,xQ,zy->RPQ', Y_KW__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,xwuQ,zwyu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,xwzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyQa,xa,Py->RPQ', Y_KW__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyQa,xzPa,yz->RPQ', Y_KW__aa, t1_xaee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyQa,xzwa,Pzwy->RPQ', Y_KW__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyQa,za,Pzxy->RPQ', Y_KW__aa, t1_xaee, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQa,zwPa,xyzw->RPQ', Y_KW__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyQa,zwua,Pwzuxy->RPQ', Y_KW__aa, t1_xaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyQa,zwua,Pwzuyx->RPQ', Y_KW__aa, t1_xaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyQa,zwua,Pwzxuy->RPQ', Y_KW__aa, t1_xaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQa,zwua,Pwzxyu->RPQ', Y_KW__aa, t1_xaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyQa,zwua,Pwzyux->RPQ', Y_KW__aa, t1_xaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyQa,zwua,Pwzyxu->RPQ', Y_KW__aa, t1_xaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQa,zxPa,yz->RPQ', Y_KW__aa, t1_xaee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyQa,zxwa,Pzyw->RPQ', Y_KW__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaP,xzQa,yz->RPQ', Y_KW__aa, t1_xaea, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaP,zwQa,xywz->RPQ', Y_KW__aa, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyaP,zxQa,yz->RPQ', Y_KW__aa, t1_xaea, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyaQ,xa,Py->RPQ', Y_KW__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaQ,xzPa,yz->RPQ', Y_KW__aa, t1_xaee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyaQ,xzwa,Pzyw->RPQ', Y_KW__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyaQ,za,Pzyx->RPQ', Y_KW__aa, t1_xaee, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaQ,zwPa,xywz->RPQ', Y_KW__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyaQ,zwua,Pwzyxu->RPQ', Y_KW__aa, t1_xaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += einsum('Rix,iyaQ,zxPa,yz->RPQ', Y_KW__aa, t1_xaee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyaQ,zxwa,Pzyw->RPQ', Y_KW__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyax,zwQa,Pyzw->RPQ', Y_KW__aa, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyaz,wuQa,Pxyuwz->RPQ', Y_KW__aa, t1_xaea, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyaz,wuQa,Pxyuzw->RPQ', Y_KW__aa, t1_xaea, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyaz,wuQa,Pxywuz->RPQ', Y_KW__aa, t1_xaea, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyaz,wuQa,Pxywzu->RPQ', Y_KW__aa, t1_xaea, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyaz,wuQa,Pxyzuw->RPQ', Y_KW__aa, t1_xaea, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyaz,wuQa,Pxyzwu->RPQ', Y_KW__aa, t1_xaea, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyaz,wxQa,Pywz->RPQ', Y_KW__aa, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyaz,xwQa,Pywz->RPQ', Y_KW__aa, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyxP,zQ,yz->RPQ', Y_KW__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxP,zwuQ,yuwz->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxa,zwQa,Pyzw->RPQ', Y_KW__aa, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,wuyQ,Pzuw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,wuzQ,Pyuw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,wyuQ,Puzw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,wzuQ,Puyw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,yQ,Pz->RPQ', Y_KW__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,ywuQ,Puwz->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,zQ,Py->RPQ', Y_KW__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,zwuQ,Puwy->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,wQ,xyzw->RPQ', Y_KW__aa, t1_xaaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvuwz->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvuzw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvwuz->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvwzu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/3 * einsum('Rix,iyzP,wuvQ,xyvzuw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvzwu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,wuzQ,xywu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,wxuQ,zwyu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,wxzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,xQ,zy->RPQ', Y_KW__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,xwuQ,zwuy->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyzP,xwzQ,yw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/24 * einsum('Rix,iyza,wuQa,Pxyuwz->RPQ', Y_KW__aa, t1_xaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    temp += 1/24 * einsum('Rix,iyza,wuQa,Pxyuzw->RPQ', Y_KW__aa, t1_xaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    temp += 1/24 * einsum('Rix,iyza,wuQa,Pxywuz->RPQ', Y_KW__aa, t1_xaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    temp -= 5/24 * einsum('Rix,iyza,wuQa,Pxywzu->RPQ', Y_KW__aa, t1_xaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    temp += 1/24 * einsum('Rix,iyza,wuQa,Pxyzuw->RPQ', Y_KW__aa, t1_xaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    temp += 1/24 * einsum('Rix,iyza,wuQa,Pxyzwu->RPQ', Y_KW__aa, t1_xaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyza,wxQa,Pywz->RPQ', Y_KW__aa, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyza,xwQa,Pyzw->RPQ', Y_KW__aa, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,uvwQ,Pxyvzu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,uvyQ,Pzwvxu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uvzQ,Pxyuvw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uvzQ,Pxyuwv->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyzw,uvzQ,Pxyvuw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uvzQ,Pxyvwu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uvzQ,Pxywuv->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uvzQ,Pxywvu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uwvQ,Pzvuxy->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uwvQ,Pzvuyx->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uwvQ,Pzvxuy->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uwvQ,Pzvxyu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uwvQ,Pzvyux->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyzw,uwvQ,Pzvyxu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,uwxQ,Pzyu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,uxwQ,Pyzu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,uxzQ,Pyuw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,uyvQ,Pxvuwz->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,uyvQ,Pxvuzw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,uyvQ,Pxvwuz->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzw,uyvQ,Pxvwzu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,uyvQ,Pxvzuw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,uyvQ,Pxvzwu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,uzvQ,Pwvxyu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,uzxQ,Pwuy->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,wQ,Pzyx->RPQ', Y_KW__aa, t1_xaaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,wuvQ,Pzvuxy->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,wuxQ,Pzuy->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,wzuQ,Puxy->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,wzxQ,Py->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,xuwQ,Pyuz->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,xuzQ,Pyuw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,xyuQ,Puwz->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,yQ,Pxwz->RPQ', Y_KW__aa, t1_xaaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,yuvQ,Pxvuzw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,yxuQ,Puzw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,zQ,Pwxy->RPQ', Y_KW__aa, t1_xaaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,zuvQ,Pwvuxy->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyzw,zuvQ,Pwvuyx->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,zuvQ,Pwvxuy->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,zuvQ,Pwvxyu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,zuvQ,Pwvyux->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,zuvQ,Pwvyxu->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,zuxQ,Pwuy->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,zwuQ,Puyx->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,zwxQ,Py->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,wuyQ,Pzuw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,wuzQ,Pyuw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,wyuQ,Puzw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,wzuQ,Puyw->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,yQ,Pz->RPQ', Y_KW__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,ywuQ,Puwz->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,zQ,Py->RPQ', Y_KW__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,zwuQ,Puwy->RPQ', Y_KW__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jyQa,xy->RPQ', Y_KW__aa, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPa,jyaQ,xy->RPQ', Y_KW__aa, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPx,jyQz,zy->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPx,jyzQ,zy->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jQ,xy->RPQ', Y_KW__aa, t1_xxaa, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jxQz,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jxzQ,yz->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jzQw,xwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jzQy,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jzwQ,xwyz->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jzyQ,xz->RPQ', Y_KW__aa, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiQa,ja,Px->RPQ', Y_KW__aa, t1_xxee, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiQa,jxay,Py->RPQ', Y_KW__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiQa,jxya,Py->RPQ', Y_KW__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiQa,jyPa,xy->RPQ', Y_KW__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiQa,jyaP,xy->RPQ', Y_KW__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiQa,jyaz,Pyxz->RPQ', Y_KW__aa, t1_xxee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiQa,jyza,Pyzx->RPQ', Y_KW__aa, t1_xxee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jixQ,jy,Py->RPQ', Y_KW__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jixQ,jyPz,zy->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixQ,jyzP,zy->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jixQ,jyzw,Pyzw->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jixa,jyQa,Py->RPQ', Y_KW__aa, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jixa,jyaQ,Py->RPQ', Y_KW__aa, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jP,xy->RPQ', Y_KW__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jxPz,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiyQ,jxyz,Pz->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiyQ,jxzP,yz->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jxzw,Pywz->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jxzy,Pz->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiyQ,jy,Px->RPQ', Y_KW__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jz,Pyxz->RPQ', Y_KW__aa, t1_xxae, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jzPw,xwyz->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jzPy,xz->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jzwP,xwzy->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jzwu,Pyzxwu->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jzwy,Pzxw->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiyQ,jzyP,xz->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiyQ,jzyw,Pzxw->RPQ', Y_KW__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiya,jxQa,Py->RPQ', Y_KW__aa, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jxaQ,Py->RPQ', Y_KW__aa, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jzQa,Pxyz->RPQ', Y_KW__aa, t1_xxae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jzaQ,Pxzy->RPQ', Y_KW__aa, t1_xxae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jyQa,xy->RPQ', Y_KW__aa, t1_vxae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPa,jyaQ,xy->RPQ', Y_KW__aa, t1_vxae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPx,jyQz,zy->RPQ', Y_KW__aa, t1_vxaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPx,jyzQ,zy->RPQ', Y_KW__aa, t1_vxaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jQ,xy->RPQ', Y_KW__aa, t1_vxaa, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jxQz,yz->RPQ', Y_KW__aa, t1_vxaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jxzQ,yz->RPQ', Y_KW__aa, t1_vxaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jzQw,xwyz->RPQ', Y_KW__aa, t1_vxaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jzQy,xz->RPQ', Y_KW__aa, t1_vxaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jzwQ,xwyz->RPQ', Y_KW__aa, t1_vxaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jzyQ,xz->RPQ', Y_KW__aa, t1_vxaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiQa,ja,Px->RPQ', Y_KW__aa, t1_vxee, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiQa,jxay,Py->RPQ', Y_KW__aa, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiQa,jxya,Py->RPQ', Y_KW__aa, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiQa,jyPa,xy->RPQ', Y_KW__aa, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiQa,jyaP,xy->RPQ', Y_KW__aa, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiQa,jyaz,Pyxz->RPQ', Y_KW__aa, t1_vxee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiQa,jyza,Pyzx->RPQ', Y_KW__aa, t1_vxee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jixQ,jy,Py->RPQ', Y_KW__aa, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jixQ,jyPz,zy->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixQ,jyzP,zy->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jixQ,jyzw,Pyzw->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jixa,jyQa,Py->RPQ', Y_KW__aa, t1_vxae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jixa,jyaQ,Py->RPQ', Y_KW__aa, t1_vxae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jP,xy->RPQ', Y_KW__aa, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jxPz,yz->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiyQ,jxyz,Pz->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiyQ,jxzP,yz->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jxzw,Pywz->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jxzy,Pz->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiyQ,jy,Px->RPQ', Y_KW__aa, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jz,Pyxz->RPQ', Y_KW__aa, t1_vxae, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jzPw,xwyz->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jzPy,xz->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jzwP,xwzy->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jzwu,Pyzxwu->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jzwy,Pzxw->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiyQ,jzyP,xz->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiyQ,jzyw,Pzxw->RPQ', Y_KW__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiya,jxQa,Py->RPQ', Y_KW__aa, t1_vxae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jxaQ,Py->RPQ', Y_KW__aa, t1_vxae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jzQa,Pxyz->RPQ', Y_KW__aa, t1_vxae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jzaQ,Pxzy->RPQ', Y_KW__aa, t1_vxae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += einsum('RiP,ijQa,jxay,yx->RPQ', Y_KW__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,ijQa,jxya,yx->RPQ', Y_KW__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiP,ijxQ,jy,xy->RPQ', Y_KW__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,ijxQ,jyxz,zy->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiP,ijxQ,jyzw,xyzw->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiP,ijxQ,jyzx,zy->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RiP,ijQa,jxay,yx->RPQ', Y_KW__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,ijQa,jxya,yx->RPQ', Y_KW__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiP,ijxQ,jy,xy->RPQ', Y_KW__bb, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,ijxQ,jyxz,zy->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiP,ijxQ,jyzw,xyzw->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiP,ijxQ,jyzx,zy->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiP,ix,xyzQ,zy->RPQ', Y_KW__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiP,ix,yxzQ,zy->RPQ', Y_KW__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiP,ixQa,ya,xy->RPQ', Y_KW__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiP,ixQa,yzwa,xwzy->RPQ', Y_KW__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiP,ixaQ,ya,xy->RPQ', Y_KW__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiP,ixaQ,yzwa,xwzy->RPQ', Y_KW__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiP,ixyz,wuxQ,yzuw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiP,ixyz,wyuQ,xwzu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiP,ixyz,wzuQ,xwyu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiP,ixyz,yQ,xz->RPQ', Y_KW__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiP,ixyz,ywuQ,xwzu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiP,ixyz,yzwQ,xw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiP,ixyz,zQ,xy->RPQ', Y_KW__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiP,ixyz,zwuQ,xwuy->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiP,ixyz,zywQ,xw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jiQa,jxay,yx->RPQ', Y_KW__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiP,jiQa,jxya,yx->RPQ', Y_KW__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jixQ,jy,xy->RPQ', Y_KW__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('RiP,jixQ,jyxz,zy->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jixQ,jyzw,xyzw->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jixQ,jyzx,zy->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jiQa,jxay,yx->RPQ', Y_KW__bb, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiP,jiQa,jxya,yx->RPQ', Y_KW__bb, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jixQ,jy,xy->RPQ', Y_KW__bb, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('RiP,jixQ,jyxz,zy->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jixQ,jyzw,xyzw->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiP,jixQ,jyzx,zy->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iP,xyzQ,zy->RPQ', Y_KW__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iP,yQ,xy->RPQ', Y_KW__bb, t1_xa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iP,yxzQ,zy->RPQ', Y_KW__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iP,yzwQ,xwzy->RPQ', Y_KW__bb, t1_xa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,iPxy,zQ,yz->RPQ', Y_KW__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,iPxy,zwuQ,yuwz->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPyx,zQ,yz->RPQ', Y_KW__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPyx,zwuQ,yuwz->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPyz,wQ,xwyz->RPQ', Y_KW__bb, t1_xaaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iPyz,wuvQ,xuwvyz->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iPyz,wuvQ,xuwvzy->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iPyz,wuvQ,xuwyvz->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rix,iPyz,wuvQ,xuwyzv->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iPyz,wuvQ,xuwzvy->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iPyz,wuvQ,xuwzyv->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iPyz,wuxQ,zyuw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ia,xyQa,Py->RPQ', Y_KW__bb, t1_xe, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ia,yxQa,Py->RPQ', Y_KW__bb, t1_xe, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,ia,yzQa,Pxyz->RPQ', Y_KW__bb, t1_xe, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPa,jyQa,xy->RPQ', Y_KW__bb, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jyaQ,xy->RPQ', Y_KW__bb, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPx,jyQz,zy->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPx,jyzQ,zy->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jQ,xy->RPQ', Y_KW__bb, t1_xxaa, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jxQz,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jxzQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzQw,xwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzQy,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzwQ,xwzy->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jzyQ,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijQa,ja,Px->RPQ', Y_KW__bb, t1_xxee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijQa,jxay,Py->RPQ', Y_KW__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijQa,jxya,Py->RPQ', Y_KW__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijQa,jyPa,xy->RPQ', Y_KW__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijQa,jyaP,xy->RPQ', Y_KW__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijQa,jyaz,Pyxz->RPQ', Y_KW__bb, t1_xxee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijQa,jyza,Pyxz->RPQ', Y_KW__bb, t1_xxee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxQ,jy,Py->RPQ', Y_KW__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxQ,jyPz,zy->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxQ,jyzP,zy->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxQ,jyzw,Pyzw->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxa,jyQa,Py->RPQ', Y_KW__bb, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,ijxa,jyaQ,Py->RPQ', Y_KW__bb, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jQ,Py->RPQ', Y_KW__bb, t1_xxaa, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzQw,Pwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzQy,Pz->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzwQ,Pwzy->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,ijxy,jzyQ,Pz->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jP,xy->RPQ', Y_KW__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jxPz,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jxyz,Pz->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyQ,jxzP,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jxzw,Pyzw->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyQ,jxzy,Pz->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jy,Px->RPQ', Y_KW__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jz,Pyzx->RPQ', Y_KW__bb, t1_xxae, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jzPw,xwyz->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jzPy,xz->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyQ,jzwP,xwyz->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzuwx->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzuxw->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzwux->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,ijyQ,jzwu,Pyzwxu->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzxuw->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzxwu->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jzwy,Pzwx->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyQ,jzyP,xz->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jzyw,Pzxw->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijya,jxQa,Py->RPQ', Y_KW__bb, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijya,jxaQ,Py->RPQ', Y_KW__bb, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijya,jzQa,Pxzy->RPQ', Y_KW__bb, t1_xxae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijya,jzaQ,Pxzy->RPQ', Y_KW__bb, t1_xxae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jQ,Py->RPQ', Y_KW__bb, t1_xxaa, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzQw,Pwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzQy,Pz->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzwQ,Pwzy->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyx,jzyQ,Pz->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jQ,Pxzy->RPQ', Y_KW__bb, t1_xxaa, t1_xe, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuwzy->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuywz->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuyzw->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuzwy->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,ijyz,jwQu,Pxuzyw->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwQy,Pxzw->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwQz,Pxwy->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwuQ,Pxuwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwyQ,Pxwz->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jwzQ,Pxwy->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxQw,Pwzy->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jxQy,Pz->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxQz,Py->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxwQ,Pwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxyQ,Pz->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jxzQ,Py->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPa,jyQa,xy->RPQ', Y_KW__bb, t1_xvae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPa,jyaQ,xy->RPQ', Y_KW__bb, t1_xvae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPx,jyQz,zy->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPx,jyzQ,zy->RPQ', Y_KW__bb, t1_xvaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jQ,xy->RPQ', Y_KW__bb, t1_xvaa, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jxQz,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jxzQ,yz->RPQ', Y_KW__bb, t1_xvaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzQw,xwyz->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzQy,xz->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijPy,jzwQ,xwzy->RPQ', Y_KW__bb, t1_xvaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijPy,jzyQ,xz->RPQ', Y_KW__bb, t1_xvaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijQa,ja,Px->RPQ', Y_KW__bb, t1_xvee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijQa,jxay,Py->RPQ', Y_KW__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijQa,jxya,Py->RPQ', Y_KW__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijQa,jyPa,xy->RPQ', Y_KW__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijQa,jyaP,xy->RPQ', Y_KW__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijQa,jyaz,Pyxz->RPQ', Y_KW__bb, t1_xvee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijQa,jyza,Pyxz->RPQ', Y_KW__bb, t1_xvee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxQ,jy,Py->RPQ', Y_KW__bb, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Rix,ijxQ,jyPz,zy->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijxQ,jyzP,zy->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxQ,jyzw,Pyzw->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxa,jyQa,Py->RPQ', Y_KW__bb, t1_xvae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,ijxa,jyaQ,Py->RPQ', Y_KW__bb, t1_xvae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jQ,Py->RPQ', Y_KW__bb, t1_xvaa, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzQw,Pwyz->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzQy,Pz->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijxy,jzwQ,Pwzy->RPQ', Y_KW__bb, t1_xvaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,ijxy,jzyQ,Pz->RPQ', Y_KW__bb, t1_xvaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jP,xy->RPQ', Y_KW__bb, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jxPz,yz->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jxyz,Pz->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyQ,jxzP,yz->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jxzw,Pyzw->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyQ,jxzy,Pz->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jy,Px->RPQ', Y_KW__bb, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jz,Pyzx->RPQ', Y_KW__bb, t1_xvae, t1_va, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jzPw,xwyz->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,ijyQ,jzPy,xz->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyQ,jzwP,xwyz->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzuwx->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzuxw->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzwux->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,ijyQ,jzwu,Pyzwxu->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzxuw->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyQ,jzwu,Pyzxwu->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jzwy,Pzwx->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,ijyQ,jzyP,xz->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyQ,jzyw,Pzxw->RPQ', Y_KW__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijya,jxQa,Py->RPQ', Y_KW__bb, t1_xvae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijya,jxaQ,Py->RPQ', Y_KW__bb, t1_xvae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijya,jzQa,Pxzy->RPQ', Y_KW__bb, t1_xvae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijya,jzaQ,Pxzy->RPQ', Y_KW__bb, t1_xvae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jQ,Py->RPQ', Y_KW__bb, t1_xvaa, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzQw,Pwyz->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzQy,Pz->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyx,jzwQ,Pwzy->RPQ', Y_KW__bb, t1_xvaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyx,jzyQ,Pz->RPQ', Y_KW__bb, t1_xvaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jQ,Pxzy->RPQ', Y_KW__bb, t1_xvaa, t1_ve, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuwyz->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuwzy->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuywz->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuyzw->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,ijyz,jwQu,Pxuzwy->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,ijyz,jwQu,Pxuzyw->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwQy,Pxzw->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwQz,Pxwy->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwuQ,Pxuwyz->RPQ', Y_KW__bb, t1_xvaa, t1_vaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jwyQ,Pxwz->RPQ', Y_KW__bb, t1_xvaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jwzQ,Pxwy->RPQ', Y_KW__bb, t1_xvaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxQw,Pwzy->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jxQy,Pz->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxQz,Py->RPQ', Y_KW__bb, t1_xvaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxwQ,Pwyz->RPQ', Y_KW__bb, t1_xvaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,ijyz,jxyQ,Pz->RPQ', Y_KW__bb, t1_xvaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,ijyz,jxzQ,Py->RPQ', Y_KW__bb, t1_xvaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iy,xzyQ,Pz->RPQ', Y_KW__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iy,yQ,Px->RPQ', Y_KW__bb, t1_xa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iy,yzwQ,Pwzx->RPQ', Y_KW__bb, t1_xa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iy,yzxQ,Pz->RPQ', Y_KW__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iy,zwyQ,Pxwz->RPQ', Y_KW__bb, t1_xa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iy,zxyQ,Pz->RPQ', Y_KW__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iy,zywQ,Pwxz->RPQ', Y_KW__bb, t1_xa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iy,zyxQ,Pz->RPQ', Y_KW__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyPa,xzQa,yz->RPQ', Y_KW__bb, t1_xaae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPa,zwQa,xyzw->RPQ', Y_KW__bb, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPa,zxQa,yz->RPQ', Y_KW__bb, t1_xaae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPx,zQ,yz->RPQ', Y_KW__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPx,zwuQ,yuwz->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,wQ,xywz->RPQ', Y_KW__bb, t1_xaaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,wuvQ,xyvuzw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,wuzQ,xyuw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyPz,wxuQ,zwyu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyPz,wxzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyPz,xQ,zy->RPQ', Y_KW__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,xwuQ,zwyu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyPz,xwzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyQa,xa,Py->RPQ', Y_KW__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyQa,xzPa,yz->RPQ', Y_KW__bb, t1_xaee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyQa,xzwa,Pzwy->RPQ', Y_KW__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyQa,za,Pzxy->RPQ', Y_KW__bb, t1_xaee, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQa,zwPa,xyzw->RPQ', Y_KW__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyQa,zwua,Pwzuxy->RPQ', Y_KW__bb, t1_xaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyQa,zwua,Pwzuyx->RPQ', Y_KW__bb, t1_xaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyQa,zwua,Pwzxuy->RPQ', Y_KW__bb, t1_xaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyQa,zwua,Pwzxyu->RPQ', Y_KW__bb, t1_xaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyQa,zwua,Pwzyux->RPQ', Y_KW__bb, t1_xaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyQa,zwua,Pwzyxu->RPQ', Y_KW__bb, t1_xaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyQa,zxPa,yz->RPQ', Y_KW__bb, t1_xaee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyQa,zxwa,Pzyw->RPQ', Y_KW__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaP,xzQa,yz->RPQ', Y_KW__bb, t1_xaea, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaP,zwQa,xywz->RPQ', Y_KW__bb, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyaP,zxQa,yz->RPQ', Y_KW__bb, t1_xaea, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyaQ,xa,Py->RPQ', Y_KW__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaQ,xzPa,yz->RPQ', Y_KW__bb, t1_xaee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyaQ,xzwa,Pzyw->RPQ', Y_KW__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyaQ,za,Pzyx->RPQ', Y_KW__bb, t1_xaee, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyaQ,zwPa,xywz->RPQ', Y_KW__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyaQ,zwua,Pwzyxu->RPQ', Y_KW__bb, t1_xaee, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += einsum('Rix,iyaQ,zxPa,yz->RPQ', Y_KW__bb, t1_xaee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyaQ,zxwa,Pzyw->RPQ', Y_KW__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyax,zwQa,Pyzw->RPQ', Y_KW__bb, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyaz,wuQa,Pxywuz->RPQ', Y_KW__bb, t1_xaea, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyaz,wxQa,Pywz->RPQ', Y_KW__bb, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyaz,xwQa,Pywz->RPQ', Y_KW__bb, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyxP,zQ,yz->RPQ', Y_KW__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Rix,iyxP,zwuQ,yuwz->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxa,zwQa,Pyzw->RPQ', Y_KW__bb, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,wuyQ,Pzuw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,wuzQ,Pyuw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,wyuQ,Puzw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,wzuQ,Puyw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,yQ,Pz->RPQ', Y_KW__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyxz,ywuQ,Puwz->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,zQ,Py->RPQ', Y_KW__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyxz,zwuQ,Puwy->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,wQ,xyzw->RPQ', Y_KW__bb, t1_xaaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvuwz->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvuzw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvwuz->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvwzu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/3 * einsum('Rix,iyzP,wuvQ,xyvzuw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzP,wuvQ,xyvzwu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,wuzQ,xywu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,wxuQ,zwyu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,wxzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,xQ,zy->RPQ', Y_KW__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,iyzP,xwuQ,zwuy->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Rix,iyzP,xwzQ,yw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/24 * einsum('Rix,iyza,wuQa,Pxyuwz->RPQ', Y_KW__bb, t1_xaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    temp += 1/24 * einsum('Rix,iyza,wuQa,Pxyuzw->RPQ', Y_KW__bb, t1_xaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    temp += 1/24 * einsum('Rix,iyza,wuQa,Pxywuz->RPQ', Y_KW__bb, t1_xaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    temp -= 5/24 * einsum('Rix,iyza,wuQa,Pxywzu->RPQ', Y_KW__bb, t1_xaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    temp += 1/24 * einsum('Rix,iyza,wuQa,Pxyzuw->RPQ', Y_KW__bb, t1_xaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    temp += 1/24 * einsum('Rix,iyza,wuQa,Pxyzwu->RPQ', Y_KW__bb, t1_xaae, t1_aaee, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyza,wxQa,Pywz->RPQ', Y_KW__bb, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyza,xwQa,Pyzw->RPQ', Y_KW__bb, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,uvwQ,Pxyvzu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,uvyQ,Pzwvxu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uvzQ,Pxyuvw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uvzQ,Pxyuwv->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyzw,uvzQ,Pxyvuw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uvzQ,Pxyvwu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uvzQ,Pxywuv->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uvzQ,Pxywvu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uwvQ,Pzvuxy->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uwvQ,Pzvuyx->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uwvQ,Pzvxuy->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uwvQ,Pzvxyu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,uwvQ,Pzvyux->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyzw,uwvQ,Pzvyxu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,uwxQ,Pzyu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,uxwQ,Pyzu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,uxzQ,Pyuw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,uyvQ,Pxvuwz->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,uyvQ,Pxvuzw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,uyvQ,Pxvwuz->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rix,iyzw,uyvQ,Pxvwzu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,uyvQ,Pxvzuw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rix,iyzw,uyvQ,Pxvzwu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,uzvQ,Pwvxyu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,uzxQ,Pwuy->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,wQ,Pzyx->RPQ', Y_KW__bb, t1_xaaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,wuvQ,Pzvuxy->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,wuxQ,Pzuy->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,wzuQ,Puxy->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,wzxQ,Py->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,xuwQ,Pyuz->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,xuzQ,Pyuw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,xyuQ,Puwz->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,yQ,Pxwz->RPQ', Y_KW__bb, t1_xaaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,yuvQ,Pxvuzw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzw,yxuQ,Puzw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,zQ,Pwxy->RPQ', Y_KW__bb, t1_xaaa, t1_ae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,zuvQ,Pwvuxy->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rix,iyzw,zuvQ,Pwvuyx->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,zuvQ,Pwvxuy->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,zuvQ,Pwvxyu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,zuvQ,Pwvyux->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rix,iyzw,zuvQ,Pwvyxu->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_cccaaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,zuxQ,Pwuy->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzw,zwuQ,Puyx->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,iyzw,zwxQ,Py->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,wuyQ,Pzuw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,wuzQ,Pyuw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,wyuQ,Puzw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,wzuQ,Puyw->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,yQ,Pz->RPQ', Y_KW__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,iyzx,ywuQ,Puwz->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,zQ,Py->RPQ', Y_KW__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rix,iyzx,zwuQ,Puwy->RPQ', Y_KW__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jyQa,xy->RPQ', Y_KW__bb, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPa,jyaQ,xy->RPQ', Y_KW__bb, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPx,jyQz,zy->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPx,jyzQ,zy->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jQ,xy->RPQ', Y_KW__bb, t1_xxaa, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jxQz,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jxzQ,yz->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jzQw,xwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jzQy,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jzwQ,xwyz->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jzyQ,xz->RPQ', Y_KW__bb, t1_xxaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiQa,ja,Px->RPQ', Y_KW__bb, t1_xxee, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiQa,jxay,Py->RPQ', Y_KW__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiQa,jxya,Py->RPQ', Y_KW__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiQa,jyPa,xy->RPQ', Y_KW__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiQa,jyaP,xy->RPQ', Y_KW__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiQa,jyaz,Pyxz->RPQ', Y_KW__bb, t1_xxee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiQa,jyza,Pyzx->RPQ', Y_KW__bb, t1_xxee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jixQ,jy,Py->RPQ', Y_KW__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jixQ,jyPz,zy->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixQ,jyzP,zy->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jixQ,jyzw,Pyzw->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jixa,jyQa,Py->RPQ', Y_KW__bb, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jixa,jyaQ,Py->RPQ', Y_KW__bb, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jP,xy->RPQ', Y_KW__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jxPz,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiyQ,jxyz,Pz->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiyQ,jxzP,yz->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jxzw,Pywz->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jxzy,Pz->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiyQ,jy,Px->RPQ', Y_KW__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jz,Pyxz->RPQ', Y_KW__bb, t1_xxae, t1_xa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jzPw,xwyz->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jzPy,xz->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jzwP,xwzy->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jzwu,Pyzxwu->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jzwy,Pzxw->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiyQ,jzyP,xz->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiyQ,jzyw,Pzxw->RPQ', Y_KW__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiya,jxQa,Py->RPQ', Y_KW__bb, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jxaQ,Py->RPQ', Y_KW__bb, t1_xxae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jzQa,Pxyz->RPQ', Y_KW__bb, t1_xxae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jzaQ,Pxzy->RPQ', Y_KW__bb, t1_xxae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPa,jyQa,xy->RPQ', Y_KW__bb, t1_vxae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPa,jyaQ,xy->RPQ', Y_KW__bb, t1_vxae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Rix,jiPx,jyQz,zy->RPQ', Y_KW__bb, t1_vxaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPx,jyzQ,zy->RPQ', Y_KW__bb, t1_vxaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jQ,xy->RPQ', Y_KW__bb, t1_vxaa, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jxQz,yz->RPQ', Y_KW__bb, t1_vxaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jxzQ,yz->RPQ', Y_KW__bb, t1_vxaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jzQw,xwyz->RPQ', Y_KW__bb, t1_vxaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiPy,jzQy,xz->RPQ', Y_KW__bb, t1_vxaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jzwQ,xwyz->RPQ', Y_KW__bb, t1_vxaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiPy,jzyQ,xz->RPQ', Y_KW__bb, t1_vxaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiQa,ja,Px->RPQ', Y_KW__bb, t1_vxee, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiQa,jxay,Py->RPQ', Y_KW__bb, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiQa,jxya,Py->RPQ', Y_KW__bb, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiQa,jyPa,xy->RPQ', Y_KW__bb, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiQa,jyaP,xy->RPQ', Y_KW__bb, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiQa,jyaz,Pyxz->RPQ', Y_KW__bb, t1_vxee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiQa,jyza,Pyzx->RPQ', Y_KW__bb, t1_vxee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jixQ,jy,Py->RPQ', Y_KW__bb, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jixQ,jyPz,zy->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jixQ,jyzP,zy->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jixQ,jyzw,Pyzw->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jixa,jyQa,Py->RPQ', Y_KW__bb, t1_vxae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jixa,jyaQ,Py->RPQ', Y_KW__bb, t1_vxae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jP,xy->RPQ', Y_KW__bb, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jxPz,yz->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiyQ,jxyz,Pz->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Rix,jiyQ,jxzP,yz->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jxzw,Pywz->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jxzy,Pz->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiyQ,jy,Px->RPQ', Y_KW__bb, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jz,Pyxz->RPQ', Y_KW__bb, t1_vxae, t1_va, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jzPw,xwyz->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jzPy,xz->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rix,jiyQ,jzwP,xwzy->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jzwu,Pyzxwu->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, rdm_cccaaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiyQ,jzwy,Pzxw->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Rix,jiyQ,jzyP,xz->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiyQ,jzyw,Pzxw->RPQ', Y_KW__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rix,jiya,jxQa,Py->RPQ', Y_KW__bb, t1_vxae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jxaQ,Py->RPQ', Y_KW__bb, t1_vxae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jzQa,Pxyz->RPQ', Y_KW__bb, t1_vxae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rix,jiya,jzaQ,Pxzy->RPQ', Y_KW__bb, t1_vxae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    TY[:, s_a:f_a, s_e:f_e] += temp

    mr_adc.log.timer_debug("computing T q2-h0 CA", *cput1)

def compute_TY__q2_h0__CE(mr_adc, Y_KC__aa, Y_KC__bb, TY):

    cput1 = (logger.process_clock(), logger.perf_counter())

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Dimensions
    s_c = 0
    f_c = s_c + mr_adc.ncvs
    s_v = f_c
    f_v = s_v + mr_adc.nval
    s_a = f_v
    f_a = s_a + mr_adc.ncas
    s_e = f_a
    f_e = s_e + mr_adc.nextern
 
    ## Amplitudes
    t1_xa = mr_adc.t1.xa
    t1_xe = mr_adc.t1.xe
    t1_va = mr_adc.t1.va
    t1_ve = mr_adc.t1.ve
    t1_ae = mr_adc.t1.ae

    t2_xa = mr_adc.t2.xa
    t2_xe = mr_adc.t2.xe
    t2_ve = mr_adc.t2.ve
    t2_ae = mr_adc.t2.ae

    t1_xxaa = mr_adc.t1.xxaa
    t1_xxae = mr_adc.t1.xxae
    t1_xxee = mr_adc.t1.xxee

    t1_xvaa = mr_adc.t1.xvaa
    t1_xvae = mr_adc.t1.xvae
    t1_xvee = mr_adc.t1.xvee

    t1_xaaa = mr_adc.t1.xaaa
    t1_xaae = mr_adc.t1.xaae
    t1_xaea = mr_adc.t1.xaea
    t1_xaee = mr_adc.t1.xaee

    t1_vxaa = mr_adc.t1.vxaa
    t1_vxae = mr_adc.t1.vxae
    t1_vxee = mr_adc.t1.vxee

    t1_vvaa = mr_adc.t1.vvaa
    t1_vvae = mr_adc.t1.vvae
    t1_vvee = mr_adc.t1.vvee

    t1_vaaa = mr_adc.t1.vaaa
    t1_vaae = mr_adc.t1.vaae
    t1_vaea = mr_adc.t1.vaea
    t1_vaee = mr_adc.t1.vaee

    t1_aaae = mr_adc.t1.aaae
    t1_aaee = mr_adc.t1.aaee
 
    # Reduced Density Matrices
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa

    temp =- einsum('RPa,Qa->RPQ', Y_KC__aa, t2_xe, optimize = einsum_type)
    temp -= einsum('RPa,Qa->RPQ', Y_KC__bb, t2_xe, optimize = einsum_type)
    temp -= einsum('RPa,Qiab,ib->RPQ', Y_KC__aa, t1_xxee, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiba,ib->RPQ', Y_KC__aa, t1_xxee, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qixa,ix->RPQ', Y_KC__aa, t1_xxae, t1_xa, optimize = einsum_type)
    temp -= einsum('RPa,Qiab,ib->RPQ', Y_KC__aa, t1_xvee, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiba,ib->RPQ', Y_KC__aa, t1_xvee, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qixa,ix->RPQ', Y_KC__aa, t1_xvae, t1_va, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,ix->RPQ', Y_KC__aa, t1_xxae, t1_xa, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,ix->RPQ', Y_KC__aa, t1_vxae, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xa,Qx->RPQ', Y_KC__aa, t1_ae, t1_xa, optimize = einsum_type)
    temp += einsum('Ria,Qiab,Pb->RPQ', Y_KC__aa, t1_xxee, t1_xe, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qiba,Pb->RPQ', Y_KC__aa, t1_xxee, t1_xe, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qixa,Px->RPQ', Y_KC__aa, t1_xxae, t1_xa, optimize = einsum_type)
    temp += einsum('Ria,iQxa,Px->RPQ', Y_KC__aa, t1_xxae, t1_xa, optimize = einsum_type)
    temp -= einsum('RPa,Qiab,ib->RPQ', Y_KC__bb, t1_xxee, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiba,ib->RPQ', Y_KC__bb, t1_xxee, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qixa,ix->RPQ', Y_KC__bb, t1_xxae, t1_xa, optimize = einsum_type)
    temp -= einsum('RPa,Qiab,ib->RPQ', Y_KC__bb, t1_xvee, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiba,ib->RPQ', Y_KC__bb, t1_xvee, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qixa,ix->RPQ', Y_KC__bb, t1_xvae, t1_va, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,ix->RPQ', Y_KC__bb, t1_xxae, t1_xa, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,ix->RPQ', Y_KC__bb, t1_vxae, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xa,Qx->RPQ', Y_KC__bb, t1_ae, t1_xa, optimize = einsum_type)
    temp += einsum('Ria,Qiab,Pb->RPQ', Y_KC__bb, t1_xxee, t1_xe, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qiba,Pb->RPQ', Y_KC__bb, t1_xxee, t1_xe, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qixa,Px->RPQ', Y_KC__bb, t1_xxae, t1_xa, optimize = einsum_type)
    temp += einsum('Ria,iQxa,Px->RPQ', Y_KC__bb, t1_xxae, t1_xa, optimize = einsum_type)
    temp -= einsum('RPa,Qiab,ixby,xy->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiab,ixyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiba,ixby,xy->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qiba,ixyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iy,xy->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qixa,iyxz,yz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iyzw,xyzw->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iyzx,yz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,Qiab,ixby,xy->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiab,ixyb,xy->RPQ', Y_KC__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiba,ixby,xy->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qiba,ixyb,xy->RPQ', Y_KC__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iy,xy->RPQ', Y_KC__aa, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qixa,iyxz,yz->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iyzw,xyzw->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iyzx,yz->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,Qxab,yb,xy->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,Qxab,yzwb,xwzy->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,Qxba,yb,xy->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,Qxba,yzwb,xwzy->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__aa, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xa,Qyxz,yz->RPQ', Y_KC__aa, t1_ae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xa,Qyzx,yz->RPQ', Y_KC__aa, t1_ae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qwux,zuwy->RPQ', Y_KC__aa, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qwuy,zuxw->RPQ', Y_KC__aa, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qwxu,zuyw->RPQ', Y_KC__aa, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qwxy,zw->RPQ', Y_KC__aa, t1_aaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xyza,Qwyu,zuxw->RPQ', Y_KC__aa, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xyza,Qwyx,zw->RPQ', Y_KC__aa, t1_aaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qx,zy->RPQ', Y_KC__aa, t1_aaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xyza,Qy,zx->RPQ', Y_KC__aa, t1_aaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,xyza,Qzwu,yxwu->RPQ', Y_KC__aa, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,Qiab,Pxby,xy->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Qiab,Pxyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qiba,Pxby,xy->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qiba,Pxyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qixa,Py,xy->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qixa,Pyxz,yz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qixa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,Qixa,Pyzx,yz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,Qiab,ixby,xy->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiab,ixyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiba,ixby,xy->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qiba,ixyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iy,xy->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qixa,iyxz,yz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iyzw,xyzw->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iyzx,yz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,Qiab,ixby,xy->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiab,ixyb,xy->RPQ', Y_KC__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiba,ixby,xy->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qiba,ixyb,xy->RPQ', Y_KC__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iy,xy->RPQ', Y_KC__bb, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qixa,iyxz,yz->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iyzw,xyzw->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iyzx,yz->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,Qxab,yb,xy->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,Qxab,yzwb,xwzy->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,Qxba,yb,xy->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,Qxba,yzwb,xwzy->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__bb, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xa,Qyxz,yz->RPQ', Y_KC__bb, t1_ae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xa,Qyzx,yz->RPQ', Y_KC__bb, t1_ae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qwux,zuwy->RPQ', Y_KC__bb, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qwuy,zuxw->RPQ', Y_KC__bb, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qwxu,zuyw->RPQ', Y_KC__bb, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qwxy,zw->RPQ', Y_KC__bb, t1_aaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xyza,Qwyu,zuxw->RPQ', Y_KC__bb, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xyza,Qwyx,zw->RPQ', Y_KC__bb, t1_aaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qx,zy->RPQ', Y_KC__bb, t1_aaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xyza,Qy,zx->RPQ', Y_KC__bb, t1_aaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,xyza,Qzwu,yxwu->RPQ', Y_KC__bb, t1_aaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,Qiab,Pxby,xy->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Qiab,Pxyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qiba,Pxby,xy->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qiba,Pxyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qixa,Py,xy->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qixa,Pyxz,yz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qixa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,Qixa,Pyzx,yz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    TY[:, s_c:f_c, s_c:f_c] += temp   
 
    temp  = einsum('Ria,Qiab,Pb->RPQ', Y_KC__aa, t1_vxee, t1_ve, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qiba,Pb->RPQ', Y_KC__aa, t1_vxee, t1_ve, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qixa,Px->RPQ', Y_KC__aa, t1_vxae, t1_va, optimize = einsum_type)
    temp += einsum('Ria,iQxa,Px->RPQ', Y_KC__aa, t1_xvae, t1_va, optimize = einsum_type)
    temp += einsum('Ria,Qiab,Pb->RPQ', Y_KC__bb, t1_vxee, t1_ve, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qiba,Pb->RPQ', Y_KC__bb, t1_vxee, t1_ve, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qixa,Px->RPQ', Y_KC__bb, t1_vxae, t1_va, optimize = einsum_type)
    temp += einsum('Ria,iQxa,Px->RPQ', Y_KC__bb, t1_xvae, t1_va, optimize = einsum_type)
    temp += einsum('Ria,Qiab,Pxby,xy->RPQ', Y_KC__aa, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Qiab,Pxyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qiba,Pxby,xy->RPQ', Y_KC__aa, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qiba,Pxyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qixa,Py,xy->RPQ', Y_KC__aa, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qixa,Pyxz,yz->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qixa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,Qixa,Pyzx,yz->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__aa, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qiab,Pxby,xy->RPQ', Y_KC__bb, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Qiab,Pxyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qiba,Pxby,xy->RPQ', Y_KC__bb, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qiba,Pxyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qixa,Py,xy->RPQ', Y_KC__bb, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qixa,Pyxz,yz->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qixa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,Qixa,Pyzx,yz->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__bb, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    TY[:, s_v:f_v, s_v:f_v] += temp   
 
    temp =- einsum('Ria,iP,Qa->RPQ', Y_KC__aa, t1_xa, t1_ae, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__aa, t1_xxae, t1_xa, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__aa, t1_xvae, t1_va, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jQ->RPQ', Y_KC__aa, t1_xxae, t1_xa, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jQ->RPQ', Y_KC__aa, t1_vxae, t1_va, optimize = einsum_type)
    temp -= einsum('Ria,iP,Qa->RPQ', Y_KC__bb, t1_xa, t1_ae, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__bb, t1_xxae, t1_xa, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__bb, t1_xvae, t1_va, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jQ->RPQ', Y_KC__bb, t1_xxae, t1_xa, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jQ->RPQ', Y_KC__bb, t1_vxae, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iP,Qxya,xy->RPQ', Y_KC__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iP,xQya,xy->RPQ', Y_KC__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQab,xb,Px->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQab,xyzb,Pzyx->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,iQba,xb,Px->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,iQba,xyzb,Pzyx->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQxy,xa,Py->RPQ', Y_KC__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,iQxy,xyza,Pz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,iQxy,xzwa,Pzyw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,iQxy,ya,Px->RPQ', Y_KC__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQxy,yxza,Pz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,iQxy,yzwa,Pzwx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQxy,zwPa,yxzw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQxy,zxwa,Pzyw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,iQxy,zywa,Pzxw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijPa,jx,Qx->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijPa,jxyz,Qxyz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ijab,jPbx,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,jPbx,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijba,jxQb,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,jPxy,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,jPyx,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,jPyz,Qxzy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jQ,Px->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyQx,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijPa,jx,Qx->RPQ', Y_KC__aa, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijPa,jxyz,Qxyz->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ijab,jPbx,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,jPbx,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijba,jxQb,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,jPxy,Qy->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,jPyx,Qy->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,jPyz,Qxzy->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jQ,Px->RPQ', Y_KC__aa, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyQx,Py->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ix,Qxya,Py->RPQ', Y_KC__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ix,xQya,Py->RPQ', Y_KC__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ix,xyPa,Qy->RPQ', Y_KC__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ix,yxPa,Qy->RPQ', Y_KC__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixPy,Qa,yx->RPQ', Y_KC__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixPy,Qyza,xz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixPy,Qzwa,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ixPy,yQza,xz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixPy,ya,Qx->RPQ', Y_KC__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixPy,yzwa,Qwzx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ixPy,zQwa,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixPy,zwxa,Qywz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixPy,zywa,Qwxz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,Pb,Qx->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,Pyzb,Qyzx->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,yPzb,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixab,yzQb,Pxyz->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,Pb,Qx->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,Pyzb,Qyzx->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,yPzb,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixba,yzQb,Pxyz->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyP,Qa,yx->RPQ', Y_KC__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixyP,Qyza,xz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyP,Qzwa,ywzx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyP,yQza,xz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyP,ya,Qx->RPQ', Y_KC__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyP,yzwa,Qwxz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyP,zQwa,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyP,zwxa,Qyzw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyP,zywa,Qwxz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,Qwxa,Pwzy->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,Qywa,Pxwz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,Qzwa,Pxwy->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,wQxa,Pwyz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyz,wyPa,Qzwx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,wzPa,Qywx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,yQwa,Pxwz->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,ywPa,Qzwx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,yzPa,Qx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,zQwa,Pxyw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,zwPa,Qyxw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyz,zyPa,Qx->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jiPa,jx,Qx->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jiPa,jxyz,Qxyz->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,jPxy,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,jPyx,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,jPyz,Qxzy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jiPa,jx,Qx->RPQ', Y_KC__aa, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jiPa,jxyz,Qxyz->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,jPxy,Qy->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,jPyx,Qy->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,jPyz,Qxzy->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__aa, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iP,Qxya,xy->RPQ', Y_KC__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iP,xQya,xy->RPQ', Y_KC__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQab,xb,Px->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQab,xyzb,Pzyx->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,iQba,xb,Px->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,iQba,xyzb,Pzyx->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQxy,xa,Py->RPQ', Y_KC__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,iQxy,xyza,Pz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,iQxy,xzwa,Pzyw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,iQxy,ya,Px->RPQ', Y_KC__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQxy,yxza,Pz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,iQxy,yzwa,Pzwx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQxy,zwPa,yxzw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQxy,zxwa,Pzyw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,iQxy,zywa,Pzxw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijPa,jx,Qx->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijPa,jxyz,Qxyz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ijab,jPbx,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,jPbx,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijba,jxQb,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,jPxy,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,jPyx,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,jPyz,Qxzy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jQ,Px->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyQx,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijPa,jx,Qx->RPQ', Y_KC__bb, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijPa,jxyz,Qxyz->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ijab,jPbx,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,jPbx,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijba,jxQb,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,jPxy,Qy->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,jPyx,Qy->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,jPyz,Qxzy->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jQ,Px->RPQ', Y_KC__bb, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyQx,Py->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ix,Qxya,Py->RPQ', Y_KC__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ix,xQya,Py->RPQ', Y_KC__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ix,xyPa,Qy->RPQ', Y_KC__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ix,yxPa,Qy->RPQ', Y_KC__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixPy,Qa,yx->RPQ', Y_KC__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixPy,Qyza,xz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixPy,Qzwa,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ixPy,yQza,xz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixPy,ya,Qx->RPQ', Y_KC__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixPy,yzwa,Qwzx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ixPy,zQwa,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixPy,zwxa,Qywz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixPy,zywa,Qwxz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,Pb,Qx->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,Pyzb,Qyzx->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,yPzb,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixab,yzQb,Pxyz->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,Pb,Qx->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,Pyzb,Qyzx->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,yPzb,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixba,yzQb,Pxyz->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyP,Qa,yx->RPQ', Y_KC__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixyP,Qyza,xz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyP,Qzwa,ywzx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyP,yQza,xz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyP,ya,Qx->RPQ', Y_KC__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyP,yzwa,Qwxz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyP,zQwa,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyP,zwxa,Qyzw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyP,zywa,Qwxz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,Qwxa,Pwzy->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,Qywa,Pxwz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,Qzwa,Pxwy->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,wQxa,Pwyz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyz,wyPa,Qzwx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,wzPa,Qywx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,yQwa,Pxwz->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,ywPa,Qzwx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,yzPa,Qx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,zQwa,Pxyw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,zwPa,Qyxw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyz,zyPa,Qx->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jiPa,jx,Qx->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jiPa,jxyz,Qxyz->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,jPxy,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,jPyx,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,jPyz,Qxzy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jiPa,jx,Qx->RPQ', Y_KC__bb, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jiPa,jxyz,Qxyz->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,jPxy,Qy->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,jPyx,Qy->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,jPyz,Qxzy->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__bb, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    TY[:, s_a:f_a, s_a:f_a] += temp   
 
    temp  = einsum('RiQ,iP->RPQ', Y_KC__aa, t2_xe, optimize = einsum_type)
    temp += einsum('RiQ,iP->RPQ', Y_KC__bb, t2_xe, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,ja->RPQ', Y_KC__aa, t1_xxee, t1_xe, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijxP,jx->RPQ', Y_KC__aa, t1_xxae, t1_xa, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,ja->RPQ', Y_KC__aa, t1_xvee, t1_ve, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijxP,jx->RPQ', Y_KC__aa, t1_xvae, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ix,xP->RPQ', Y_KC__aa, t1_xa, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KC__aa, t1_xxee, t1_xe, optimize = einsum_type)
    temp += einsum('RiQ,jixP,jx->RPQ', Y_KC__aa, t1_xxae, t1_xa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KC__aa, t1_vxee, t1_ve, optimize = einsum_type)
    temp += einsum('RiQ,jixP,jx->RPQ', Y_KC__aa, t1_vxae, t1_va, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__aa, t1_xxee, t1_xe, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__aa, t1_xvee, t1_ve, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jQ->RPQ', Y_KC__aa, t1_xxee, t1_xe, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jQ->RPQ', Y_KC__aa, t1_vxee, t1_ve, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,ja->RPQ', Y_KC__bb, t1_xxee, t1_xe, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijxP,jx->RPQ', Y_KC__bb, t1_xxae, t1_xa, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,ja->RPQ', Y_KC__bb, t1_xvee, t1_ve, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijxP,jx->RPQ', Y_KC__bb, t1_xvae, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ix,xP->RPQ', Y_KC__bb, t1_xa, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KC__bb, t1_xxee, t1_xe, optimize = einsum_type)
    temp += einsum('RiQ,jixP,jx->RPQ', Y_KC__bb, t1_xxae, t1_xa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KC__bb, t1_vxee, t1_ve, optimize = einsum_type)
    temp += einsum('RiQ,jixP,jx->RPQ', Y_KC__bb, t1_vxae, t1_va, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__bb, t1_xxee, t1_xe, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__bb, t1_xvee, t1_ve, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jQ->RPQ', Y_KC__bb, t1_xxee, t1_xe, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jQ->RPQ', Y_KC__bb, t1_vxee, t1_ve, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ijxP,jy,xy->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijxP,jyxz,zy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ijxP,jyzw,xyzw->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ijxP,jyzx,zy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KC__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ijxP,jy,xy->RPQ', Y_KC__aa, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijxP,jyxz,zy->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ijxP,jyzw,xyzw->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ijxP,jyzx,zy->RPQ', Y_KC__aa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ix,xyzP,zy->RPQ', Y_KC__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ix,yxzP,zy->RPQ', Y_KC__aa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ixPa,ya,xy->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ixPa,yzwa,xwzy->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixaP,ya,xy->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixaP,yzwa,xwzy->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,wuxP,yzuw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ixyz,wyuP,xwzu->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixyz,wzuP,xwyu->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ixyz,yP,xz->RPQ', Y_KC__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixyz,ywuP,xwzu->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixyz,yzwP,xw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixyz,zP,xy->RPQ', Y_KC__aa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixyz,zwuP,xwuy->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ixyz,zywP,xw->RPQ', Y_KC__aa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jixP,jy,xy->RPQ', Y_KC__aa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,jixP,jyxz,zy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jixP,jyzw,xyzw->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jixP,jyzx,zy->RPQ', Y_KC__aa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KC__aa, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KC__aa, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jixP,jy,xy->RPQ', Y_KC__aa, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,jixP,jyxz,zy->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jixP,jyzw,xyzw->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jixP,jyzx,zy->RPQ', Y_KC__aa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__aa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixPa,yQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixPa,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,ixaP,yQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixaP,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__aa, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__aa, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ijxP,jy,xy->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijxP,jyxz,zy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ijxP,jyzw,xyzw->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ijxP,jyzx,zy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KC__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ijxP,jy,xy->RPQ', Y_KC__bb, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijxP,jyxz,zy->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ijxP,jyzw,xyzw->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ijxP,jyzx,zy->RPQ', Y_KC__bb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ix,xyzP,zy->RPQ', Y_KC__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ix,yxzP,zy->RPQ', Y_KC__bb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ixPa,ya,xy->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ixPa,yzwa,xwzy->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixaP,ya,xy->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixaP,yzwa,xwzy->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,wuxP,yzuw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ixyz,wyuP,xwzu->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixyz,wzuP,xwyu->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ixyz,yP,xz->RPQ', Y_KC__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixyz,ywuP,xwzu->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixyz,yzwP,xw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixyz,zP,xy->RPQ', Y_KC__bb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixyz,zwuP,xwuy->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ixyz,zywP,xw->RPQ', Y_KC__bb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jixP,jy,xy->RPQ', Y_KC__bb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,jixP,jyxz,zy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jixP,jyzw,xyzw->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jixP,jyzx,zy->RPQ', Y_KC__bb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KC__bb, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KC__bb, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jixP,jy,xy->RPQ', Y_KC__bb, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,jixP,jyxz,zy->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jixP,jyzw,xyzw->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jixP,jyzx,zy->RPQ', Y_KC__bb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__bb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixPa,yQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixPa,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,ixaP,yQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixaP,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__bb, t1_vxee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__bb, t1_vxee, t1_vaae, rdm_ca, optimize = einsum_type)
    TY[:, s_e:f_e, s_e:f_e] += temp   
 
    temp =- einsum('RPa,Qa->RPQ', Y_KC__aa, t2_ve, optimize = einsum_type)
    temp -= einsum('RPa,Qa->RPQ', Y_KC__bb, t2_ve, optimize = einsum_type)
    temp -= einsum('RPa,Qiab,ib->RPQ', Y_KC__aa, t1_vxee, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiba,ib->RPQ', Y_KC__aa, t1_vxee, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qixa,ix->RPQ', Y_KC__aa, t1_vxae, t1_xa, optimize = einsum_type)
    temp -= einsum('RPa,Qiab,ib->RPQ', Y_KC__aa, t1_vvee, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiba,ib->RPQ', Y_KC__aa, t1_vvee, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qixa,ix->RPQ', Y_KC__aa, t1_vvae, t1_va, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,ix->RPQ', Y_KC__aa, t1_xvae, t1_xa, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,ix->RPQ', Y_KC__aa, t1_vvae, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xa,Qx->RPQ', Y_KC__aa, t1_ae, t1_va, optimize = einsum_type)
    temp += einsum('Ria,Piab,Qb->RPQ', Y_KC__aa, t1_xxee, t1_ve, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Piba,Qb->RPQ', Y_KC__aa, t1_xxee, t1_ve, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Pixa,Qx->RPQ', Y_KC__aa, t1_xxae, t1_va, optimize = einsum_type)
    temp += einsum('Ria,Qiab,Pb->RPQ', Y_KC__aa, t1_vxee, t1_xe, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qiba,Pb->RPQ', Y_KC__aa, t1_vxee, t1_xe, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qixa,Px->RPQ', Y_KC__aa, t1_vxae, t1_xa, optimize = einsum_type)
    temp += einsum('Ria,iPxa,Qx->RPQ', Y_KC__aa, t1_xxae, t1_va, optimize = einsum_type)
    temp += einsum('Ria,iQxa,Px->RPQ', Y_KC__aa, t1_xvae, t1_xa, optimize = einsum_type)
    temp -= einsum('RPa,Qiab,ib->RPQ', Y_KC__bb, t1_vxee, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiba,ib->RPQ', Y_KC__bb, t1_vxee, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qixa,ix->RPQ', Y_KC__bb, t1_vxae, t1_xa, optimize = einsum_type)
    temp -= einsum('RPa,Qiab,ib->RPQ', Y_KC__bb, t1_vvee, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiba,ib->RPQ', Y_KC__bb, t1_vvee, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qixa,ix->RPQ', Y_KC__bb, t1_vvae, t1_va, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,ix->RPQ', Y_KC__bb, t1_xvae, t1_xa, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,ix->RPQ', Y_KC__bb, t1_vvae, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xa,Qx->RPQ', Y_KC__bb, t1_ae, t1_va, optimize = einsum_type)
    temp += einsum('Ria,Piab,Qb->RPQ', Y_KC__bb, t1_xxee, t1_ve, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Piba,Qb->RPQ', Y_KC__bb, t1_xxee, t1_ve, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Pixa,Qx->RPQ', Y_KC__bb, t1_xxae, t1_va, optimize = einsum_type)
    temp += einsum('Ria,Qiab,Pb->RPQ', Y_KC__bb, t1_vxee, t1_xe, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qiba,Pb->RPQ', Y_KC__bb, t1_vxee, t1_xe, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qixa,Px->RPQ', Y_KC__bb, t1_vxae, t1_xa, optimize = einsum_type)
    temp += einsum('Ria,iPxa,Qx->RPQ', Y_KC__bb, t1_xxae, t1_va, optimize = einsum_type)
    temp += einsum('Ria,iQxa,Px->RPQ', Y_KC__bb, t1_xvae, t1_xa, optimize = einsum_type)
    temp -= einsum('RPa,Qiab,ixby,xy->RPQ', Y_KC__aa, t1_vxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiab,ixyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiba,ixby,xy->RPQ', Y_KC__aa, t1_vxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qiba,ixyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iy,xy->RPQ', Y_KC__aa, t1_vxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qixa,iyxz,yz->RPQ', Y_KC__aa, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iyzw,xyzw->RPQ', Y_KC__aa, t1_vxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iyzx,yz->RPQ', Y_KC__aa, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,Qiab,ixby,xy->RPQ', Y_KC__aa, t1_vvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiab,ixyb,xy->RPQ', Y_KC__aa, t1_vvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiba,ixby,xy->RPQ', Y_KC__aa, t1_vvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qiba,ixyb,xy->RPQ', Y_KC__aa, t1_vvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iy,xy->RPQ', Y_KC__aa, t1_vvae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qixa,iyxz,yz->RPQ', Y_KC__aa, t1_vvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iyzw,xyzw->RPQ', Y_KC__aa, t1_vvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iyzx,yz->RPQ', Y_KC__aa, t1_vvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,Qxab,yb,xy->RPQ', Y_KC__aa, t1_vaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,Qxab,yzwb,xwzy->RPQ', Y_KC__aa, t1_vaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,Qxba,yb,xy->RPQ', Y_KC__aa, t1_vaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,Qxba,yzwb,xwzy->RPQ', Y_KC__aa, t1_vaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__aa, t1_xvae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__aa, t1_xvae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__aa, t1_xvae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__aa, t1_xvae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__aa, t1_vvae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__aa, t1_vvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__aa, t1_vvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__aa, t1_vvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xa,Qyxz,yz->RPQ', Y_KC__aa, t1_ae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xa,Qyzx,yz->RPQ', Y_KC__aa, t1_ae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qwux,zuwy->RPQ', Y_KC__aa, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qwuy,zuxw->RPQ', Y_KC__aa, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qwxu,zuyw->RPQ', Y_KC__aa, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qwxy,zw->RPQ', Y_KC__aa, t1_aaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xyza,Qwyu,zuxw->RPQ', Y_KC__aa, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xyza,Qwyx,zw->RPQ', Y_KC__aa, t1_aaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qx,zy->RPQ', Y_KC__aa, t1_aaae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xyza,Qy,zx->RPQ', Y_KC__aa, t1_aaae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,xyza,Qzwu,yxwu->RPQ', Y_KC__aa, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,Piab,Qxby,xy->RPQ', Y_KC__aa, t1_xxee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Piab,Qxyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Piba,Qxby,xy->RPQ', Y_KC__aa, t1_xxee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Piba,Qxyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Pixa,Qy,xy->RPQ', Y_KC__aa, t1_xxae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Pixa,Qyxz,yz->RPQ', Y_KC__aa, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Pixa,Qyzw,xyzw->RPQ', Y_KC__aa, t1_xxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,Pixa,Qyzx,yz->RPQ', Y_KC__aa, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qiab,Pxby,xy->RPQ', Y_KC__aa, t1_vxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Qiab,Pxyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qiba,Pxby,xy->RPQ', Y_KC__aa, t1_vxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qiba,Pxyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qixa,Py,xy->RPQ', Y_KC__aa, t1_vxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qixa,Pyxz,yz->RPQ', Y_KC__aa, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qixa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_vxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,Qixa,Pyzx,yz->RPQ', Y_KC__aa, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iPxa,Qy,xy->RPQ', Y_KC__aa, t1_xxae, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,iPxa,Qyxz,yz->RPQ', Y_KC__aa, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iPxa,Qyzw,xyzw->RPQ', Y_KC__aa, t1_xxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iPxa,Qyzx,yz->RPQ', Y_KC__aa, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__aa, t1_xvae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__aa, t1_xvae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xvae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__aa, t1_xvae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,Qiab,ixby,xy->RPQ', Y_KC__bb, t1_vxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiab,ixyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiba,ixby,xy->RPQ', Y_KC__bb, t1_vxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qiba,ixyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iy,xy->RPQ', Y_KC__bb, t1_vxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qixa,iyxz,yz->RPQ', Y_KC__bb, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iyzw,xyzw->RPQ', Y_KC__bb, t1_vxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iyzx,yz->RPQ', Y_KC__bb, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,Qiab,ixby,xy->RPQ', Y_KC__bb, t1_vvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiab,ixyb,xy->RPQ', Y_KC__bb, t1_vvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qiba,ixby,xy->RPQ', Y_KC__bb, t1_vvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qiba,ixyb,xy->RPQ', Y_KC__bb, t1_vvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iy,xy->RPQ', Y_KC__bb, t1_vvae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,Qixa,iyxz,yz->RPQ', Y_KC__bb, t1_vvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iyzw,xyzw->RPQ', Y_KC__bb, t1_vvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,Qixa,iyzx,yz->RPQ', Y_KC__bb, t1_vvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,Qxab,yb,xy->RPQ', Y_KC__bb, t1_vaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,Qxab,yzwb,xwzy->RPQ', Y_KC__bb, t1_vaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,Qxba,yb,xy->RPQ', Y_KC__bb, t1_vaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,Qxba,yzwb,xwzy->RPQ', Y_KC__bb, t1_vaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__bb, t1_xvae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__bb, t1_xvae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__bb, t1_xvae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__bb, t1_xvae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__bb, t1_vvae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__bb, t1_vvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__bb, t1_vvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__bb, t1_vvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xa,Qyxz,yz->RPQ', Y_KC__bb, t1_ae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xa,Qyzx,yz->RPQ', Y_KC__bb, t1_ae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qwux,zuwy->RPQ', Y_KC__bb, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qwuy,zuxw->RPQ', Y_KC__bb, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qwxu,zuyw->RPQ', Y_KC__bb, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qwxy,zw->RPQ', Y_KC__bb, t1_aaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xyza,Qwyu,zuxw->RPQ', Y_KC__bb, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xyza,Qwyx,zw->RPQ', Y_KC__bb, t1_aaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,Qx,zy->RPQ', Y_KC__bb, t1_aaae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,xyza,Qy,zx->RPQ', Y_KC__bb, t1_aaae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,xyza,Qzwu,yxwu->RPQ', Y_KC__bb, t1_aaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,Piab,Qxby,xy->RPQ', Y_KC__bb, t1_xxee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Piab,Qxyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Piba,Qxby,xy->RPQ', Y_KC__bb, t1_xxee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Piba,Qxyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Pixa,Qy,xy->RPQ', Y_KC__bb, t1_xxae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Pixa,Qyxz,yz->RPQ', Y_KC__bb, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Pixa,Qyzw,xyzw->RPQ', Y_KC__bb, t1_xxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,Pixa,Qyzx,yz->RPQ', Y_KC__bb, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qiab,Pxby,xy->RPQ', Y_KC__bb, t1_vxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Qiab,Pxyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qiba,Pxby,xy->RPQ', Y_KC__bb, t1_vxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qiba,Pxyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qixa,Py,xy->RPQ', Y_KC__bb, t1_vxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 2 * einsum('Ria,Qixa,Pyxz,yz->RPQ', Y_KC__bb, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Qixa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_vxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,Qixa,Pyzx,yz->RPQ', Y_KC__bb, t1_vxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iPxa,Qy,xy->RPQ', Y_KC__bb, t1_xxae, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,iPxa,Qyxz,yz->RPQ', Y_KC__bb, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iPxa,Qyzw,xyzw->RPQ', Y_KC__bb, t1_xxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iPxa,Qyzx,yz->RPQ', Y_KC__bb, t1_xxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__bb, t1_xvae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__bb, t1_xvae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xvae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__bb, t1_xvae, t1_xaaa, rdm_ca, optimize = einsum_type)
    TY[:, s_c:f_c, s_v:f_v] += temp   
 
    temp =- einsum('RPa,Qa->RPQ', Y_KC__aa, t2_ae, optimize = einsum_type)
    temp -= einsum('RPa,Qa->RPQ', Y_KC__bb, t2_ae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQab,ib->RPQ', Y_KC__aa, t1_xaee, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQax,ix->RPQ', Y_KC__aa, t1_xaea, t1_xa, optimize = einsum_type)
    temp -= einsum('RPa,iQba,ib->RPQ', Y_KC__aa, t1_xaee, t1_xe, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,ix->RPQ', Y_KC__aa, t1_xaae, t1_xa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ia,iQ->RPQ', Y_KC__aa, t1_xe, t1_xa, optimize = einsum_type)
    temp -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__aa, t1_xxee, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__aa, t1_xxee, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,ijQx->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, optimize = einsum_type)
    temp -= einsum('RPa,ijxa,jiQx->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, optimize = einsum_type)
    temp -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__aa, t1_xvee, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__aa, t1_xvee, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,ijQx->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, optimize = einsum_type)
    temp -= einsum('RPa,ijxa,jiQx->RPQ', Y_KC__aa, t1_xvae, t1_vxaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQab,ib->RPQ', Y_KC__aa, t1_vaee, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQax,ix->RPQ', Y_KC__aa, t1_vaea, t1_va, optimize = einsum_type)
    temp -= einsum('RPa,iQba,ib->RPQ', Y_KC__aa, t1_vaee, t1_ve, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,ix->RPQ', Y_KC__aa, t1_vaae, t1_va, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ia,iQ->RPQ', Y_KC__aa, t1_ve, t1_va, optimize = einsum_type)
    temp -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__aa, t1_vxee, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__aa, t1_vxee, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,ijQx->RPQ', Y_KC__aa, t1_vxae, t1_vxaa, optimize = einsum_type)
    temp -= einsum('RPa,ijxa,jiQx->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, optimize = einsum_type)
    temp -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__aa, t1_vvee, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__aa, t1_vvee, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,ijQx->RPQ', Y_KC__aa, t1_vvae, t1_vvaa, optimize = einsum_type)
    temp -= einsum('RPa,ijxa,jiQx->RPQ', Y_KC__aa, t1_vvae, t1_vvaa, optimize = einsum_type)
    temp -= einsum('Ria,PiQx,xa->RPQ', Y_KC__aa, t1_xxaa, t1_ae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Piab,Qb->RPQ', Y_KC__aa, t1_xxee, t1_ae, optimize = einsum_type)
    temp -= einsum('Ria,Piba,Qb->RPQ', Y_KC__aa, t1_xxee, t1_ae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PixQ,xa->RPQ', Y_KC__aa, t1_xxaa, t1_ae, optimize = einsum_type)
    temp += einsum('Ria,Pixy,xyQa->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,yxQa->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, optimize = einsum_type)
    temp -= einsum('Ria,iQ,Pa->RPQ', Y_KC__aa, t1_xa, t1_xe, optimize = einsum_type)
    temp -= einsum('Ria,iQab,Pb->RPQ', Y_KC__aa, t1_xaee, t1_xe, optimize = einsum_type)
    temp -= einsum('Ria,iQax,Px->RPQ', Y_KC__aa, t1_xaea, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQba,Pb->RPQ', Y_KC__aa, t1_xaee, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQxa,Px->RPQ', Y_KC__aa, t1_xaae, t1_xa, optimize = einsum_type)
    temp += 2 * einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_xxae, optimize = einsum_type)
    temp -= einsum('Ria,ijab,jPQb->RPQ', Y_KC__aa, t1_xxee, t1_xxae, optimize = einsum_type)
    temp -= einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,jPQb->RPQ', Y_KC__aa, t1_xxee, t1_xxae, optimize = einsum_type)
    temp -= einsum('Ria,ijxa,PjQx->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, optimize = einsum_type)
    temp += 2 * einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_xvae, optimize = einsum_type)
    temp -= einsum('Ria,ijab,jPQb->RPQ', Y_KC__aa, t1_xvee, t1_vxae, optimize = einsum_type)
    temp -= einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,jPQb->RPQ', Y_KC__aa, t1_xvee, t1_vxae, optimize = einsum_type)
    temp -= einsum('Ria,ijxa,PjQx->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, optimize = einsum_type)
    temp += einsum('Ria,ix,PxQa->RPQ', Y_KC__aa, t1_xa, t1_xaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ix,PxaQ->RPQ', Y_KC__aa, t1_xa, t1_xaea, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQa,Px->RPQ', Y_KC__aa, t1_xaae, t1_xa, optimize = einsum_type)
    temp += einsum('Ria,ixaQ,Px->RPQ', Y_KC__aa, t1_xaea, t1_xa, optimize = einsum_type)
    temp += 2 * einsum('Ria,jixa,PjQx->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, optimize = einsum_type)
    temp += 2 * einsum('Ria,jixa,PjQx->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQab,ib->RPQ', Y_KC__bb, t1_xaee, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQax,ix->RPQ', Y_KC__bb, t1_xaea, t1_xa, optimize = einsum_type)
    temp -= einsum('RPa,iQba,ib->RPQ', Y_KC__bb, t1_xaee, t1_xe, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,ix->RPQ', Y_KC__bb, t1_xaae, t1_xa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ia,iQ->RPQ', Y_KC__bb, t1_xe, t1_xa, optimize = einsum_type)
    temp -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__bb, t1_xxee, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__bb, t1_xxee, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,ijQx->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, optimize = einsum_type)
    temp -= einsum('RPa,ijxa,jiQx->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, optimize = einsum_type)
    temp -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__bb, t1_xvee, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__bb, t1_xvee, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,ijQx->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, optimize = einsum_type)
    temp -= einsum('RPa,ijxa,jiQx->RPQ', Y_KC__bb, t1_xvae, t1_vxaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQab,ib->RPQ', Y_KC__bb, t1_vaee, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQax,ix->RPQ', Y_KC__bb, t1_vaea, t1_va, optimize = einsum_type)
    temp -= einsum('RPa,iQba,ib->RPQ', Y_KC__bb, t1_vaee, t1_ve, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,ix->RPQ', Y_KC__bb, t1_vaae, t1_va, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ia,iQ->RPQ', Y_KC__bb, t1_ve, t1_va, optimize = einsum_type)
    temp -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__bb, t1_vxee, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__bb, t1_vxee, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,ijQx->RPQ', Y_KC__bb, t1_vxae, t1_vxaa, optimize = einsum_type)
    temp -= einsum('RPa,ijxa,jiQx->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, optimize = einsum_type)
    temp -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__bb, t1_vvee, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__bb, t1_vvee, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,ijQx->RPQ', Y_KC__bb, t1_vvae, t1_vvaa, optimize = einsum_type)
    temp -= einsum('RPa,ijxa,jiQx->RPQ', Y_KC__bb, t1_vvae, t1_vvaa, optimize = einsum_type)
    temp -= einsum('Ria,PiQx,xa->RPQ', Y_KC__bb, t1_xxaa, t1_ae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Piab,Qb->RPQ', Y_KC__bb, t1_xxee, t1_ae, optimize = einsum_type)
    temp -= einsum('Ria,Piba,Qb->RPQ', Y_KC__bb, t1_xxee, t1_ae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PixQ,xa->RPQ', Y_KC__bb, t1_xxaa, t1_ae, optimize = einsum_type)
    temp += einsum('Ria,Pixy,xyQa->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,yxQa->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, optimize = einsum_type)
    temp -= einsum('Ria,iQ,Pa->RPQ', Y_KC__bb, t1_xa, t1_xe, optimize = einsum_type)
    temp -= einsum('Ria,iQab,Pb->RPQ', Y_KC__bb, t1_xaee, t1_xe, optimize = einsum_type)
    temp -= einsum('Ria,iQax,Px->RPQ', Y_KC__bb, t1_xaea, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQba,Pb->RPQ', Y_KC__bb, t1_xaee, t1_xe, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQxa,Px->RPQ', Y_KC__bb, t1_xaae, t1_xa, optimize = einsum_type)
    temp += 2 * einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_xxae, optimize = einsum_type)
    temp -= einsum('Ria,ijab,jPQb->RPQ', Y_KC__bb, t1_xxee, t1_xxae, optimize = einsum_type)
    temp -= einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,jPQb->RPQ', Y_KC__bb, t1_xxee, t1_xxae, optimize = einsum_type)
    temp -= einsum('Ria,ijxa,PjQx->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, optimize = einsum_type)
    temp += 2 * einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_xvae, optimize = einsum_type)
    temp -= einsum('Ria,ijab,jPQb->RPQ', Y_KC__bb, t1_xvee, t1_vxae, optimize = einsum_type)
    temp -= einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,jPQb->RPQ', Y_KC__bb, t1_xvee, t1_vxae, optimize = einsum_type)
    temp -= einsum('Ria,ijxa,PjQx->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, optimize = einsum_type)
    temp += einsum('Ria,ix,PxQa->RPQ', Y_KC__bb, t1_xa, t1_xaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ix,PxaQ->RPQ', Y_KC__bb, t1_xa, t1_xaea, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQa,Px->RPQ', Y_KC__bb, t1_xaae, t1_xa, optimize = einsum_type)
    temp += einsum('Ria,ixaQ,Px->RPQ', Y_KC__bb, t1_xaea, t1_xa, optimize = einsum_type)
    temp += 2 * einsum('Ria,jixa,PjQx->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, optimize = einsum_type)
    temp += 2 * einsum('Ria,jixa,PjQx->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,Qxab,yb,xy->RPQ', Y_KC__aa, t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,Qxab,yzwb,xwzy->RPQ', Y_KC__aa, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,Qxba,yb,xy->RPQ', Y_KC__aa, t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,Qxba,yzwb,xwzy->RPQ', Y_KC__aa, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQab,ixby,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,iQab,ixyb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,iQax,iy,xy->RPQ', Y_KC__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQax,iyxz,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,iQax,iyzw,xyzw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,iQax,iyzx,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,iQba,ixby,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQba,ixyb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__aa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ia,ixQy,yx->RPQ', Y_KC__aa, t1_xe, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ia,ixyQ,yx->RPQ', Y_KC__aa, t1_xe, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,ijxa,ijQy,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,jiQy,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,ijxa,ijQy,xy->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,jiQy,xy->RPQ', Y_KC__aa, t1_xvae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixab,iyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixab,iybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,iQ,yx->RPQ', Y_KC__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,izQw,yzxw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,izQy,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixay,izwQ,yzxw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixay,izyQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixba,iyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixba,iybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,iQ,yx->RPQ', Y_KC__aa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izQw,yzxw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izQy,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izwQ,yzwx->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixya,izyQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQab,ixby,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,iQab,ixyb,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,iQax,iy,xy->RPQ', Y_KC__aa, t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQax,iyxz,yz->RPQ', Y_KC__aa, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,iQax,iyzw,xyzw->RPQ', Y_KC__aa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,iQax,iyzx,yz->RPQ', Y_KC__aa, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,iQba,ixby,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQba,ixyb,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__aa, t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__aa, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__aa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__aa, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ia,ixQy,yx->RPQ', Y_KC__aa, t1_ve, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ia,ixyQ,yx->RPQ', Y_KC__aa, t1_ve, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,ijxa,ijQy,xy->RPQ', Y_KC__aa, t1_vxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,jiQy,xy->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,ijxa,ijQy,xy->RPQ', Y_KC__aa, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,jiQy,xy->RPQ', Y_KC__aa, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixab,iyQb,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixab,iybQ,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,iQ,yx->RPQ', Y_KC__aa, t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,izQw,yzxw->RPQ', Y_KC__aa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,izQy,xz->RPQ', Y_KC__aa, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixay,izwQ,yzxw->RPQ', Y_KC__aa, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixay,izyQ,xz->RPQ', Y_KC__aa, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixba,iyQb,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixba,iybQ,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,iQ,yx->RPQ', Y_KC__aa, t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izQw,yzxw->RPQ', Y_KC__aa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izQy,xz->RPQ', Y_KC__aa, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izwQ,yzwx->RPQ', Y_KC__aa, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixya,izyQ,xz->RPQ', Y_KC__aa, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyab,zwQb,xyzw->RPQ', Y_KC__aa, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PiQx,xyza,zy->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,PiQx,yxza,zy->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Piab,Qxyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Piab,xQyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Piab,xb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Piab,xyzb,Qzyx->RPQ', Y_KC__aa, t1_xxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Piba,Qxyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,Piba,xQyb,xy->RPQ', Y_KC__aa, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Piba,xb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Piba,xyzb,Qzyx->RPQ', Y_KC__aa, t1_xxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,PixQ,xyza,zy->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PixQ,yxza,zy->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,xa,Qy->RPQ', Y_KC__aa, t1_xxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,xyza,Qz->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,xzwa,Qzwy->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,ya,Qx->RPQ', Y_KC__aa, t1_xxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,yxza,Qz->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Pixy,yzQa,xz->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,yzwa,Qzxw->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Pixy,zxQa,yz->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,zxwa,Qzyw->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,zywa,Qzxw->RPQ', Y_KC__aa, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,iQ,Pxay,xy->RPQ', Y_KC__aa, t1_xa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__aa, t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iQab,Pxby,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQab,Pxyb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,iQax,Py,xy->RPQ', Y_KC__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iQax,Pyxz,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,iQax,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQax,Pyzx,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQba,Pxby,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,iQba,Pxyb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__aa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,Pjxy,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,Pjxy,Qy->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ix,Pxay,Qy->RPQ', Y_KC__aa, t1_xa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ix,Pxya,Qy->RPQ', Y_KC__aa, t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQa,Py,xy->RPQ', Y_KC__aa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQa,Pyxz,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQa,Pyzx,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__aa, t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQy,Pyaz,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,Pzaw,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQy,Pzax,yz->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,Pzxa,yz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,Pb,Qx->RPQ', Y_KC__aa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,Pybz,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,Pyzb,Qyzx->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,Px,Qy->RPQ', Y_KC__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,Pxzw,Qyzw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,Py,Qx->RPQ', Y_KC__aa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,Pyzw,Qxzw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,Pzwx,Qzwy->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,Pzwy,Qzwx->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,Pzxw,Qzyw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,Pzyw,Qzxw->RPQ', Y_KC__aa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,Pb,Qx->RPQ', Y_KC__aa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,Pybz,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,Pyzb,Qyzx->RPQ', Y_KC__aa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__aa, t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyQ,Pyaz,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pzaw,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyQ,Pzax,yz->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,Px,Qy->RPQ', Y_KC__aa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,PxzQ,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,Pxzw,Qyzw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,Py,Qx->RPQ', Y_KC__aa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,PyzQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,Pyzw,Qxzw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,Pzwx,Qzwy->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,Pzwy,Qzwx->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,PzxQ,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,Pzxw,Qzyw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,PzyQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,Pzyw,Qzxw->RPQ', Y_KC__aa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,Pwax,Qwyz->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,Pwxa,Qwzy->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,PyaQ,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,Pyaw,Qxwz->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,Pywa,Qxwz->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,PzaQ,xy->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,Pzaw,Qxyw->RPQ', Y_KC__aa, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,Pzwa,Qxwy->RPQ', Y_KC__aa, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,Qxab,yb,xy->RPQ', Y_KC__bb, t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,Qxab,yzwb,xwzy->RPQ', Y_KC__bb, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,Qxba,yb,xy->RPQ', Y_KC__bb, t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,Qxba,yzwb,xwzy->RPQ', Y_KC__bb, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQab,ixby,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,iQab,ixyb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,iQax,iy,xy->RPQ', Y_KC__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQax,iyxz,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,iQax,iyzw,xyzw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,iQax,iyzx,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,iQba,ixby,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQba,ixyb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__bb, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ia,ixQy,yx->RPQ', Y_KC__bb, t1_xe, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ia,ixyQ,yx->RPQ', Y_KC__bb, t1_xe, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,ijxa,ijQy,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,jiQy,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,ijxa,ijQy,xy->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,jiQy,xy->RPQ', Y_KC__bb, t1_xvae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixab,iyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixab,iybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,iQ,yx->RPQ', Y_KC__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,izQw,yzxw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,izQy,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixay,izwQ,yzxw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixay,izyQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixba,iyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixba,iybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,iQ,yx->RPQ', Y_KC__bb, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izQw,yzxw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izQy,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izwQ,yzwx->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixya,izyQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQab,ixby,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,iQab,ixyb,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,iQax,iy,xy->RPQ', Y_KC__bb, t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQax,iyxz,yz->RPQ', Y_KC__bb, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,iQax,iyzw,xyzw->RPQ', Y_KC__bb, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,iQax,iyzx,yz->RPQ', Y_KC__bb, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,iQba,ixby,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQba,ixyb,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iy,xy->RPQ', Y_KC__bb, t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('RPa,iQxa,iyxz,yz->RPQ', Y_KC__bb, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzw,xyzw->RPQ', Y_KC__bb, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,iQxa,iyzx,yz->RPQ', Y_KC__bb, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ia,ixQy,yx->RPQ', Y_KC__bb, t1_ve, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ia,ixyQ,yx->RPQ', Y_KC__bb, t1_ve, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,ijxa,ijQy,xy->RPQ', Y_KC__bb, t1_vxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,jiQy,xy->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,ijxa,ijQy,xy->RPQ', Y_KC__bb, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,jiQy,xy->RPQ', Y_KC__bb, t1_vvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixab,iyQb,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixab,iybQ,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,iQ,yx->RPQ', Y_KC__bb, t1_vaea, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,izQw,yzxw->RPQ', Y_KC__bb, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,izQy,xz->RPQ', Y_KC__bb, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixay,izwQ,yzxw->RPQ', Y_KC__bb, t1_vaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixay,izyQ,xz->RPQ', Y_KC__bb, t1_vaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixba,iyQb,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixba,iybQ,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,iQ,yx->RPQ', Y_KC__bb, t1_vaae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izQw,yzxw->RPQ', Y_KC__bb, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izQy,xz->RPQ', Y_KC__bb, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izwQ,yzwx->RPQ', Y_KC__bb, t1_vaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixya,izyQ,xz->RPQ', Y_KC__bb, t1_vaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyab,zwQb,xyzw->RPQ', Y_KC__bb, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PiQx,xyza,zy->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,PiQx,yxza,zy->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Piab,Qxyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Piab,xQyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Piab,xb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Piab,xyzb,Qzyx->RPQ', Y_KC__bb, t1_xxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Piba,Qxyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,Piba,xQyb,xy->RPQ', Y_KC__bb, t1_xxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Piba,xb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Piba,xyzb,Qzyx->RPQ', Y_KC__bb, t1_xxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,PixQ,xyza,zy->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PixQ,yxza,zy->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,xa,Qy->RPQ', Y_KC__bb, t1_xxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,xyza,Qz->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,xzwa,Qzwy->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,ya,Qx->RPQ', Y_KC__bb, t1_xxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,yxza,Qz->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Pixy,yzQa,xz->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,yzwa,Qzxw->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Pixy,zxQa,yz->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,zxwa,Qzyw->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,zywa,Qzxw->RPQ', Y_KC__bb, t1_xxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,iQ,Pxay,xy->RPQ', Y_KC__bb, t1_xa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__bb, t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iQab,Pxby,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQab,Pxyb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,iQax,Py,xy->RPQ', Y_KC__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iQax,Pyxz,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,iQax,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQax,Pyzx,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQba,Pxby,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,iQba,Pxyb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__bb, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,Pjxy,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,Pjxy,Qy->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ix,Pxay,Qy->RPQ', Y_KC__bb, t1_xa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ix,Pxya,Qy->RPQ', Y_KC__bb, t1_xa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQa,Py,xy->RPQ', Y_KC__bb, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQa,Pyxz,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQa,Pyzx,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__bb, t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQy,Pyaz,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,Pzaw,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQy,Pzax,yz->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,Pzxa,yz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,Pb,Qx->RPQ', Y_KC__bb, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,Pybz,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,Pyzb,Qyzx->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,Px,Qy->RPQ', Y_KC__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,Pxzw,Qyzw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,Py,Qx->RPQ', Y_KC__bb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,Pyzw,Qxzw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,Pzwx,Qzwy->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,Pzwy,Qzwx->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,Pzxw,Qzyw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,Pzyw,Qzxw->RPQ', Y_KC__bb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,Pb,Qx->RPQ', Y_KC__bb, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,Pybz,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,Pyzb,Qyzx->RPQ', Y_KC__bb, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__bb, t1_xaaa, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyQ,Pyaz,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pzaw,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyQ,Pzax,yz->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,Px,Qy->RPQ', Y_KC__bb, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,PxzQ,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,Pxzw,Qyzw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,Py,Qx->RPQ', Y_KC__bb, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,PyzQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,Pyzw,Qxzw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,Pzwx,Qzwy->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,Pzwy,Qzwx->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,PzxQ,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,Pzxw,Qzyw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,PzyQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,Pzyw,Qzxw->RPQ', Y_KC__bb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,Pwax,Qwyz->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,Pwxa,Qwzy->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,PyaQ,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,Pyaw,Qxwz->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,Pywa,Qxwz->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,PzaQ,xy->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,Pzaw,Qxyw->RPQ', Y_KC__bb, t1_xaaa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,Pzwa,Qxwy->RPQ', Y_KC__bb, t1_xaaa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    TY[:, s_c:f_c, s_a:f_a] += temp   
 
    temp =- einsum('Ria,PiQx,xa->RPQ', Y_KC__aa, t1_vxaa, t1_ae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Piab,Qb->RPQ', Y_KC__aa, t1_vxee, t1_ae, optimize = einsum_type)
    temp -= einsum('Ria,Piba,Qb->RPQ', Y_KC__aa, t1_vxee, t1_ae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PixQ,xa->RPQ', Y_KC__aa, t1_vxaa, t1_ae, optimize = einsum_type)
    temp += einsum('Ria,Pixy,xyQa->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,yxQa->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, optimize = einsum_type)
    temp -= einsum('Ria,iQ,Pa->RPQ', Y_KC__aa, t1_xa, t1_ve, optimize = einsum_type)
    temp -= einsum('Ria,iQab,Pb->RPQ', Y_KC__aa, t1_xaee, t1_ve, optimize = einsum_type)
    temp -= einsum('Ria,iQax,Px->RPQ', Y_KC__aa, t1_xaea, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQba,Pb->RPQ', Y_KC__aa, t1_xaee, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQxa,Px->RPQ', Y_KC__aa, t1_xaae, t1_va, optimize = einsum_type)
    temp += 2 * einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_vxae, optimize = einsum_type)
    temp -= einsum('Ria,ijab,jPQb->RPQ', Y_KC__aa, t1_xxee, t1_xvae, optimize = einsum_type)
    temp -= einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,jPQb->RPQ', Y_KC__aa, t1_xxee, t1_xvae, optimize = einsum_type)
    temp -= einsum('Ria,ijxa,PjQx->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, optimize = einsum_type)
    temp += 2 * einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_vvae, optimize = einsum_type)
    temp -= einsum('Ria,ijab,jPQb->RPQ', Y_KC__aa, t1_xvee, t1_vvae, optimize = einsum_type)
    temp -= einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,jPQb->RPQ', Y_KC__aa, t1_xvee, t1_vvae, optimize = einsum_type)
    temp -= einsum('Ria,ijxa,PjQx->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, optimize = einsum_type)
    temp += einsum('Ria,ix,PxQa->RPQ', Y_KC__aa, t1_xa, t1_vaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ix,PxaQ->RPQ', Y_KC__aa, t1_xa, t1_vaea, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQa,Px->RPQ', Y_KC__aa, t1_xaae, t1_va, optimize = einsum_type)
    temp += einsum('Ria,ixaQ,Px->RPQ', Y_KC__aa, t1_xaea, t1_va, optimize = einsum_type)
    temp += 2 * einsum('Ria,jixa,PjQx->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, optimize = einsum_type)
    temp += 2 * einsum('Ria,jixa,PjQx->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, optimize = einsum_type)
    temp -= einsum('Ria,PiQx,xa->RPQ', Y_KC__bb, t1_vxaa, t1_ae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Piab,Qb->RPQ', Y_KC__bb, t1_vxee, t1_ae, optimize = einsum_type)
    temp -= einsum('Ria,Piba,Qb->RPQ', Y_KC__bb, t1_vxee, t1_ae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PixQ,xa->RPQ', Y_KC__bb, t1_vxaa, t1_ae, optimize = einsum_type)
    temp += einsum('Ria,Pixy,xyQa->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,yxQa->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, optimize = einsum_type)
    temp -= einsum('Ria,iQ,Pa->RPQ', Y_KC__bb, t1_xa, t1_ve, optimize = einsum_type)
    temp -= einsum('Ria,iQab,Pb->RPQ', Y_KC__bb, t1_xaee, t1_ve, optimize = einsum_type)
    temp -= einsum('Ria,iQax,Px->RPQ', Y_KC__bb, t1_xaea, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQba,Pb->RPQ', Y_KC__bb, t1_xaee, t1_ve, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQxa,Px->RPQ', Y_KC__bb, t1_xaae, t1_va, optimize = einsum_type)
    temp += 2 * einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_vxae, optimize = einsum_type)
    temp -= einsum('Ria,ijab,jPQb->RPQ', Y_KC__bb, t1_xxee, t1_xvae, optimize = einsum_type)
    temp -= einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,jPQb->RPQ', Y_KC__bb, t1_xxee, t1_xvae, optimize = einsum_type)
    temp -= einsum('Ria,ijxa,PjQx->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, optimize = einsum_type)
    temp += 2 * einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_vvae, optimize = einsum_type)
    temp -= einsum('Ria,ijab,jPQb->RPQ', Y_KC__bb, t1_xvee, t1_vvae, optimize = einsum_type)
    temp -= einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,jPQb->RPQ', Y_KC__bb, t1_xvee, t1_vvae, optimize = einsum_type)
    temp -= einsum('Ria,ijxa,PjQx->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, optimize = einsum_type)
    temp += einsum('Ria,ix,PxQa->RPQ', Y_KC__bb, t1_xa, t1_vaae, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ix,PxaQ->RPQ', Y_KC__bb, t1_xa, t1_vaea, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQa,Px->RPQ', Y_KC__bb, t1_xaae, t1_va, optimize = einsum_type)
    temp += einsum('Ria,ixaQ,Px->RPQ', Y_KC__bb, t1_xaea, t1_va, optimize = einsum_type)
    temp += 2 * einsum('Ria,jixa,PjQx->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, optimize = einsum_type)
    temp += 2 * einsum('Ria,jixa,PjQx->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PiQx,xyza,zy->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,PiQx,yxza,zy->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Piab,Qxyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Piab,xQyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Piab,xb,Qx->RPQ', Y_KC__aa, t1_vxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Piab,xyzb,Qzyx->RPQ', Y_KC__aa, t1_vxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Piba,Qxyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,Piba,xQyb,xy->RPQ', Y_KC__aa, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Piba,xb,Qx->RPQ', Y_KC__aa, t1_vxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Piba,xyzb,Qzyx->RPQ', Y_KC__aa, t1_vxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,PixQ,xyza,zy->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PixQ,yxza,zy->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,xa,Qy->RPQ', Y_KC__aa, t1_vxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,xyza,Qz->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,xzwa,Qzwy->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,ya,Qx->RPQ', Y_KC__aa, t1_vxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,yxza,Qz->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Pixy,yzQa,xz->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,yzwa,Qzxw->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Pixy,zxQa,yz->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,zxwa,Qzyw->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,zywa,Qzxw->RPQ', Y_KC__aa, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,iQ,Pxay,xy->RPQ', Y_KC__aa, t1_xa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__aa, t1_xa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iQab,Pxby,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQab,Pxyb,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,iQax,Py,xy->RPQ', Y_KC__aa, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iQax,Pyxz,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,iQax,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQax,Pyzx,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQba,Pxby,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,iQba,Pxyb,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__aa, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__aa, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,Pjxy,Qy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__aa, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,Pjxy,Qy->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ix,Pxay,Qy->RPQ', Y_KC__aa, t1_xa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ix,Pxya,Qy->RPQ', Y_KC__aa, t1_xa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQa,Py,xy->RPQ', Y_KC__aa, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQa,Pyxz,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQa,Pyzx,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__aa, t1_xaaa, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQy,Pyaz,xz->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,Pzaw,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQy,Pzax,yz->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,Pzxa,yz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__aa, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,Pb,Qx->RPQ', Y_KC__aa, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,Pybz,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,Pyzb,Qyzx->RPQ', Y_KC__aa, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,Px,Qy->RPQ', Y_KC__aa, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,Pxzw,Qyzw->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,Py,Qx->RPQ', Y_KC__aa, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,Pyzw,Qxzw->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,Pzwx,Qzwy->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,Pzwy,Qzwx->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,Pzxw,Qzyw->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,Pzyw,Qzxw->RPQ', Y_KC__aa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,Pb,Qx->RPQ', Y_KC__aa, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,Pybz,Qyxz->RPQ', Y_KC__aa, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,Pyzb,Qyzx->RPQ', Y_KC__aa, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__aa, t1_xaaa, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyQ,Pyaz,xz->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pzaw,ywxz->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyQ,Pzax,yz->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,Px,Qy->RPQ', Y_KC__aa, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,PxzQ,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,Pxzw,Qyzw->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,Py,Qx->RPQ', Y_KC__aa, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,PyzQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,Pyzw,Qxzw->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,Pzwx,Qzwy->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,Pzwy,Qzwx->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,PzxQ,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,Pzxw,Qzyw->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,PzyQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,Pzyw,Qzxw->RPQ', Y_KC__aa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,Pwax,Qwyz->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,Pwxa,Qwzy->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,PyaQ,xz->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,Pyaw,Qxwz->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,Pywa,Qxwz->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,PzaQ,xy->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,Pzaw,Qxyw->RPQ', Y_KC__aa, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,Pzwa,Qxwy->RPQ', Y_KC__aa, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__aa, t1_vxae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PiQx,xyza,zy->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,PiQx,yxza,zy->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Piab,Qxyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Piab,xQyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Piab,xb,Qx->RPQ', Y_KC__bb, t1_vxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Piab,xyzb,Qzyx->RPQ', Y_KC__bb, t1_vxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Piba,Qxyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,Piba,xQyb,xy->RPQ', Y_KC__bb, t1_vxee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Piba,xb,Qx->RPQ', Y_KC__bb, t1_vxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Piba,xyzb,Qzyx->RPQ', Y_KC__bb, t1_vxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,PixQ,xyza,zy->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PixQ,yxza,zy->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,xa,Qy->RPQ', Y_KC__bb, t1_vxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,xyza,Qz->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,xzwa,Qzwy->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,ya,Qx->RPQ', Y_KC__bb, t1_vxaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,yxza,Qz->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Pixy,yzQa,xz->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,yzwa,Qzxw->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Pixy,zxQa,yz->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,Pixy,zxwa,Qzyw->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,zywa,Qzxw->RPQ', Y_KC__bb, t1_vxaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,iQ,Pxay,xy->RPQ', Y_KC__bb, t1_xa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__bb, t1_xa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iQab,Pxby,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQab,Pxyb,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,iQax,Py,xy->RPQ', Y_KC__bb, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iQax,Pyxz,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,iQax,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQax,Pyzx,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQba,Pxby,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,iQba,Pxyb,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Py,xy->RPQ', Y_KC__bb, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQxa,Pyxz,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iQxa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,iQxa,Pyzx,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__bb, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,Pjxy,Qy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ijab,Pjxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijab,jPxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,Pjxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijba,jPxb,Qx->RPQ', Y_KC__bb, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjQy,xy->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,Pjxy,Qy->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,Pjyx,Qy->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ix,Pxay,Qy->RPQ', Y_KC__bb, t1_xa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ix,Pxya,Qy->RPQ', Y_KC__bb, t1_xa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQa,Py,xy->RPQ', Y_KC__bb, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQa,Pyxz,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQa,Pyzx,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__bb, t1_xaaa, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQy,Pyaz,xz->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,Pzaw,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQy,Pzax,yz->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,Pzxa,yz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__bb, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,Pb,Qx->RPQ', Y_KC__bb, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,Pybz,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,Pyzb,Qyzx->RPQ', Y_KC__bb, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,Px,Qy->RPQ', Y_KC__bb, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,Pxzw,Qyzw->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,Py,Qx->RPQ', Y_KC__bb, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,Pyzw,Qxzw->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,Pzwx,Qzwy->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,Pzwy,Qzwx->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,Pzxw,Qzyw->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,Pzyw,Qzxw->RPQ', Y_KC__bb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,Pb,Qx->RPQ', Y_KC__bb, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,Pybz,Qyxz->RPQ', Y_KC__bb, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,Pyzb,Qyzx->RPQ', Y_KC__bb, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__bb, t1_xaaa, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyQ,Pyaz,xz->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pzaw,ywxz->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyQ,Pzax,yz->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,Px,Qy->RPQ', Y_KC__bb, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,PxzQ,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,Pxzw,Qyzw->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,Py,Qx->RPQ', Y_KC__bb, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,PyzQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,Pyzw,Qxzw->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,Pzwx,Qzwy->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,Pzwy,Qzwx->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,PzxQ,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,Pzxw,Qzyw->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,PzyQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,Pzyw,Qzxw->RPQ', Y_KC__bb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,Pwax,Qwyz->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,Pwxa,Qwzy->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,PyaQ,xz->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,Pyaw,Qxwz->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,Pywa,Qxwz->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,PzaQ,xy->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,Pzaw,Qxyw->RPQ', Y_KC__bb, t1_xaaa, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,Pzwa,Qxwy->RPQ', Y_KC__bb, t1_xaaa, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjQy,xy->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,Pjxy,Qy->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jixa,Pjyx,Qy->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,Pjyz,Qxyz->RPQ', Y_KC__bb, t1_vxae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    TY[:, s_v:f_v, s_a:f_a] += temp 
    
    temp =- 1/2 * einsum('RPa,ia,iQ->RPQ', Y_KC__aa, t1_xe, t1_xe, optimize = einsum_type)
    temp -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__aa, t1_xxee, t1_xxee, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__aa, t1_xxee, t1_xxee, optimize = einsum_type)
    temp -= einsum('RPa,ijxa,ijxQ->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,jixQ->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__aa, t1_xvee, t1_xvee, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__aa, t1_xvee, t1_vxee, optimize = einsum_type)
    temp -= einsum('RPa,ijxa,ijxQ->RPQ', Y_KC__aa, t1_xvae, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,jixQ->RPQ', Y_KC__aa, t1_xvae, t1_vxae, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ia,iQ->RPQ', Y_KC__aa, t1_ve, t1_ve, optimize = einsum_type)
    temp -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__aa, t1_vxee, t1_vxee, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__aa, t1_vxee, t1_xvee, optimize = einsum_type)
    temp -= einsum('RPa,ijxa,ijxQ->RPQ', Y_KC__aa, t1_vxae, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,jixQ->RPQ', Y_KC__aa, t1_vxae, t1_xvae, optimize = einsum_type)
    temp -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__aa, t1_vvee, t1_vvee, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__aa, t1_vvee, t1_vvee, optimize = einsum_type)
    temp -= einsum('RPa,ijxa,ijxQ->RPQ', Y_KC__aa, t1_vvae, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,jixQ->RPQ', Y_KC__aa, t1_vvae, t1_vvae, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,xa,xQ->RPQ', Y_KC__aa, t1_ae, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,Pa->RPQ', Y_KC__aa, t1_xe, t1_xe, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,Pjab->RPQ', Y_KC__aa, t1_xxee, t1_xxee, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KC__aa, t1_xxee, t1_xxee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KC__aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KC__aa, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,Pjab->RPQ', Y_KC__aa, t1_xvee, t1_xvee, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KC__aa, t1_xvee, t1_xvee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KC__aa, t1_xvae, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__aa, t1_xvae, t1_vxae, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KC__aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KC__aa, t1_xvaa, t1_xvaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ix,Px->RPQ', Y_KC__aa, t1_xa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KC__aa, t1_vxae, t1_xvae, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__aa, t1_vxae, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PixQ,xa->RPQ', Y_KC__aa, t1_xxae, t1_ae, optimize = einsum_type)
    temp += einsum('Ria,Pixa,xQ->RPQ', Y_KC__aa, t1_xxae, t1_ae, optimize = einsum_type)
    temp += einsum('Ria,Pixy,xyQa->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,yxQa->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, optimize = einsum_type)
    temp -= einsum('Ria,iPxQ,xa->RPQ', Y_KC__aa, t1_xxae, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iPxa,xQ->RPQ', Y_KC__aa, t1_xxae, t1_ae, optimize = einsum_type)
    temp -= einsum('Ria,iQ,Pa->RPQ', Y_KC__aa, t1_xe, t1_xe, optimize = einsum_type)
    temp += 2 * einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_xxee, optimize = einsum_type)
    temp -= einsum('Ria,ijab,PjbQ->RPQ', Y_KC__aa, t1_xxee, t1_xxee, optimize = einsum_type)
    temp -= einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_xxee, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,PjbQ->RPQ', Y_KC__aa, t1_xxee, t1_xxee, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 2 * einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_xvee, optimize = einsum_type)
    temp -= einsum('Ria,ijab,PjbQ->RPQ', Y_KC__aa, t1_xvee, t1_xvee, optimize = einsum_type)
    temp -= einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_xvee, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,PjbQ->RPQ', Y_KC__aa, t1_xvee, t1_xvee, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__aa, t1_xvae, t1_xvae, optimize = einsum_type)
    temp -= einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__aa, t1_xvae, t1_vxae, optimize = einsum_type)
    temp += einsum('Ria,ix,PxQa->RPQ', Y_KC__aa, t1_xa, t1_xaee, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ix,PxaQ->RPQ', Y_KC__aa, t1_xa, t1_xaee, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQa,Px->RPQ', Y_KC__aa, t1_xaee, t1_xa, optimize = einsum_type)
    temp += einsum('Ria,ixaQ,Px->RPQ', Y_KC__aa, t1_xaee, t1_xa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 2 * einsum('Ria,jixa,jPxQ->RPQ', Y_KC__aa, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_vxae, t1_xvae, optimize = einsum_type)
    temp += 2 * einsum('Ria,jixa,jPxQ->RPQ', Y_KC__aa, t1_vxae, t1_vxae, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ia,iQ->RPQ', Y_KC__bb, t1_xe, t1_xe, optimize = einsum_type)
    temp -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__bb, t1_xxee, t1_xxee, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__bb, t1_xxee, t1_xxee, optimize = einsum_type)
    temp -= einsum('RPa,ijxa,ijxQ->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,jixQ->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__bb, t1_xvee, t1_xvee, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__bb, t1_xvee, t1_vxee, optimize = einsum_type)
    temp -= einsum('RPa,ijxa,ijxQ->RPQ', Y_KC__bb, t1_xvae, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,jixQ->RPQ', Y_KC__bb, t1_xvae, t1_vxae, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ia,iQ->RPQ', Y_KC__bb, t1_ve, t1_ve, optimize = einsum_type)
    temp -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__bb, t1_vxee, t1_vxee, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__bb, t1_vxee, t1_xvee, optimize = einsum_type)
    temp -= einsum('RPa,ijxa,ijxQ->RPQ', Y_KC__bb, t1_vxae, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,jixQ->RPQ', Y_KC__bb, t1_vxae, t1_xvae, optimize = einsum_type)
    temp -= einsum('RPa,ijab,ijQb->RPQ', Y_KC__bb, t1_vvee, t1_vvee, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijab,jiQb->RPQ', Y_KC__bb, t1_vvee, t1_vvee, optimize = einsum_type)
    temp -= einsum('RPa,ijxa,ijxQ->RPQ', Y_KC__bb, t1_vvae, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,jixQ->RPQ', Y_KC__bb, t1_vvae, t1_vvae, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,xa,xQ->RPQ', Y_KC__bb, t1_ae, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,Pa->RPQ', Y_KC__bb, t1_xe, t1_xe, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,Pjab->RPQ', Y_KC__bb, t1_xxee, t1_xxee, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KC__bb, t1_xxee, t1_xxee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KC__bb, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KC__bb, t1_xxaa, t1_xxaa, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,Pjab->RPQ', Y_KC__bb, t1_xvee, t1_xvee, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KC__bb, t1_xvee, t1_xvee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KC__bb, t1_xvae, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__bb, t1_xvae, t1_vxae, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KC__bb, t1_xvaa, t1_xvaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KC__bb, t1_xvaa, t1_xvaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ix,Px->RPQ', Y_KC__bb, t1_xa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KC__bb, t1_vxae, t1_xvae, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__bb, t1_vxae, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PixQ,xa->RPQ', Y_KC__bb, t1_xxae, t1_ae, optimize = einsum_type)
    temp += einsum('Ria,Pixa,xQ->RPQ', Y_KC__bb, t1_xxae, t1_ae, optimize = einsum_type)
    temp += einsum('Ria,Pixy,xyQa->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,yxQa->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, optimize = einsum_type)
    temp -= einsum('Ria,iPxQ,xa->RPQ', Y_KC__bb, t1_xxae, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iPxa,xQ->RPQ', Y_KC__bb, t1_xxae, t1_ae, optimize = einsum_type)
    temp -= einsum('Ria,iQ,Pa->RPQ', Y_KC__bb, t1_xe, t1_xe, optimize = einsum_type)
    temp += 2 * einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_xxee, optimize = einsum_type)
    temp -= einsum('Ria,ijab,PjbQ->RPQ', Y_KC__bb, t1_xxee, t1_xxee, optimize = einsum_type)
    temp -= einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_xxee, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,PjbQ->RPQ', Y_KC__bb, t1_xxee, t1_xxee, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 2 * einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_xvee, optimize = einsum_type)
    temp -= einsum('Ria,ijab,PjbQ->RPQ', Y_KC__bb, t1_xvee, t1_xvee, optimize = einsum_type)
    temp -= einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_xvee, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,PjbQ->RPQ', Y_KC__bb, t1_xvee, t1_xvee, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__bb, t1_xvae, t1_xvae, optimize = einsum_type)
    temp -= einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__bb, t1_xvae, t1_vxae, optimize = einsum_type)
    temp += einsum('Ria,ix,PxQa->RPQ', Y_KC__bb, t1_xa, t1_xaee, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ix,PxaQ->RPQ', Y_KC__bb, t1_xa, t1_xaee, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQa,Px->RPQ', Y_KC__bb, t1_xaee, t1_xa, optimize = einsum_type)
    temp += einsum('Ria,ixaQ,Px->RPQ', Y_KC__bb, t1_xaee, t1_xa, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp += 2 * einsum('Ria,jixa,jPxQ->RPQ', Y_KC__bb, t1_xxae, t1_xxae, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_vxae, t1_xvae, optimize = einsum_type)
    temp += 2 * einsum('Ria,jixa,jPxQ->RPQ', Y_KC__bb, t1_vxae, t1_vxae, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ia,ixQy,yx->RPQ', Y_KC__aa, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ia,ixyQ,yx->RPQ', Y_KC__aa, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,ijyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,ijxa,jiyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,ijyQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,ijxa,jiyQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixab,iyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixab,iybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,iQ,yx->RPQ', Y_KC__aa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,izQw,yzxw->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,izQy,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixay,izwQ,yzxw->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixay,izyQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixba,iyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixba,iybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,iQ,yx->RPQ', Y_KC__aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izQw,yzxw->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izQy,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izwQ,yzwx->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixya,izyQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ia,ixQy,yx->RPQ', Y_KC__aa, t1_ve, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ia,ixyQ,yx->RPQ', Y_KC__aa, t1_ve, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,ijyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,ijxa,jiyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,ijyQ,xy->RPQ', Y_KC__aa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,ijxa,jiyQ,xy->RPQ', Y_KC__aa, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixab,iyQb,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixab,iybQ,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,iQ,yx->RPQ', Y_KC__aa, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,izQw,yzxw->RPQ', Y_KC__aa, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,izQy,xz->RPQ', Y_KC__aa, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixay,izwQ,yzxw->RPQ', Y_KC__aa, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixay,izyQ,xz->RPQ', Y_KC__aa, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixba,iyQb,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixba,iybQ,xy->RPQ', Y_KC__aa, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,iQ,yx->RPQ', Y_KC__aa, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izQw,yzxw->RPQ', Y_KC__aa, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izQy,xz->RPQ', Y_KC__aa, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izwQ,yzwx->RPQ', Y_KC__aa, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixya,izyQ,xz->RPQ', Y_KC__aa, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,xa,xyzQ,zy->RPQ', Y_KC__aa, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,xa,yxzQ,zy->RPQ', Y_KC__aa, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyab,zwQb,xyzw->RPQ', Y_KC__aa, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,wuzQ,yxuw->RPQ', Y_KC__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,xyza,wxuQ,zwyu->RPQ', Y_KC__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,xyza,wyuQ,zwxu->RPQ', Y_KC__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,xyza,xQ,zy->RPQ', Y_KC__aa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,xyza,xwuQ,zwuy->RPQ', Y_KC__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,xyza,xywQ,zw->RPQ', Y_KC__aa, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,xyza,yQ,zx->RPQ', Y_KC__aa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,xyza,ywuQ,zwxu->RPQ', Y_KC__aa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,xyza,yxwQ,zw->RPQ', Y_KC__aa, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,Pxay,xy->RPQ', Y_KC__aa, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ia,Pxya,xy->RPQ', Y_KC__aa, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KC__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KC__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KC__aa, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KC__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KC__aa, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KC__aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KC__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KC__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KC__aa, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KC__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KC__aa, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ix,Pyxz,yz->RPQ', Y_KC__aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ix,Pyzx,yz->RPQ', Y_KC__aa, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixab,Pyab,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixab,Pyba,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pa,xy->RPQ', Y_KC__aa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pzaw,xwyz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pzay,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzwa,xwyz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzya,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pa,xy->RPQ', Y_KC__aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzaw,xwyz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzay,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzwa,xwzy->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixya,Pzya,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwuy,xuzw->RPQ', Y_KC__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwuz,xuwy->RPQ', Y_KC__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Pwyu,xuzw->RPQ', Y_KC__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Pwyz,xw->RPQ', Y_KC__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwzu,xuyw->RPQ', Y_KC__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwzy,xw->RPQ', Y_KC__aa, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixyz,Pxwu,yzwu->RPQ', Y_KC__aa, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Py,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pz,xy->RPQ', Y_KC__aa, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KC__aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,PixQ,xyza,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PixQ,yxza,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixa,xyzQ,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,Pixa,yQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Pixa,yxzQ,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,Pixa,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Pixy,yzQa,xz->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Pixy,zxQa,yz->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__aa, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iPxQ,xyza,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iPxQ,yxza,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,iPxa,xyzQ,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iPxa,yQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iPxa,yxzQ,zy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iPxa,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,iQ,Pxay,xy->RPQ', Y_KC__aa, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__aa, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQa,Py,xy->RPQ', Y_KC__aa, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQa,Pyxz,yz->RPQ', Y_KC__aa, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQa,Pyzx,yz->RPQ', Y_KC__aa, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__aa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQy,Pyaz,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,Pzaw,ywxz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQy,Pzax,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,Pzxa,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__aa, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__aa, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__aa, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__aa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyQ,Pyaz,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pzaw,ywxz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyQ,Pzax,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,PxzQ,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,PyzQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,PzxQ,yz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,PzyQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,PyaQ,xz->RPQ', Y_KC__aa, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__aa, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,PzaQ,xy->RPQ', Y_KC__aa, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ia,ixQy,yx->RPQ', Y_KC__bb, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ia,ixyQ,yx->RPQ', Y_KC__bb, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,ijyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,ijxa,jiyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,ijyQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,ijxa,jiyQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixab,iyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixab,iybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,iQ,yx->RPQ', Y_KC__bb, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,izQw,yzxw->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,izQy,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixay,izwQ,yzxw->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixay,izyQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixba,iyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixba,iybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,iQ,yx->RPQ', Y_KC__bb, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izQw,yzxw->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izQy,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izwQ,yzwx->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixya,izyQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ia,ixQy,yx->RPQ', Y_KC__bb, t1_ve, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ia,ixyQ,yx->RPQ', Y_KC__bb, t1_ve, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,ijyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,ijxa,jiyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RPa,ijxa,ijyQ,xy->RPQ', Y_KC__bb, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,ijxa,jiyQ,xy->RPQ', Y_KC__bb, t1_vvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixab,iyQb,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixab,iybQ,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,iQ,yx->RPQ', Y_KC__bb, t1_vaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,izQw,yzxw->RPQ', Y_KC__bb, t1_vaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixay,izQy,xz->RPQ', Y_KC__bb, t1_vaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixay,izwQ,yzxw->RPQ', Y_KC__bb, t1_vaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixay,izyQ,xz->RPQ', Y_KC__bb, t1_vaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixba,iyQb,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixba,iybQ,xy->RPQ', Y_KC__bb, t1_vaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,iQ,yx->RPQ', Y_KC__bb, t1_vaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izQw,yzxw->RPQ', Y_KC__bb, t1_vaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izQy,xz->RPQ', Y_KC__bb, t1_vaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,ixya,izwQ,yzwx->RPQ', Y_KC__bb, t1_vaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,ixya,izyQ,xz->RPQ', Y_KC__bb, t1_vaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,xa,xyzQ,zy->RPQ', Y_KC__bb, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,xa,yxzQ,zy->RPQ', Y_KC__bb, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyab,zwQb,xyzw->RPQ', Y_KC__bb, t1_aaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPa,xyza,wuzQ,yxuw->RPQ', Y_KC__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,xyza,wxuQ,zwyu->RPQ', Y_KC__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,xyza,wyuQ,zwxu->RPQ', Y_KC__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,xyza,xQ,zy->RPQ', Y_KC__bb, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,xyza,xwuQ,zwuy->RPQ', Y_KC__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,xyza,xywQ,zw->RPQ', Y_KC__bb, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RPa,xyza,yQ,zx->RPQ', Y_KC__bb, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,xyza,ywuQ,zwxu->RPQ', Y_KC__bb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPa,xyza,yxwQ,zw->RPQ', Y_KC__bb, t1_aaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,Pxay,xy->RPQ', Y_KC__bb, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ia,Pxya,xy->RPQ', Y_KC__bb, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KC__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KC__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KC__bb, t1_xxaa, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KC__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KC__bb, t1_xxaa, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KC__bb, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__bb, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KC__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KC__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KC__bb, t1_xvaa, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KC__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KC__bb, t1_xvaa, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ix,Pyxz,yz->RPQ', Y_KC__bb, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ix,Pyzx,yz->RPQ', Y_KC__bb, t1_xa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixab,Pyab,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixab,Pyba,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pa,xy->RPQ', Y_KC__bb, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pzaw,xwyz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pzay,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzwa,xwyz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzya,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pa,xy->RPQ', Y_KC__bb, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzaw,xwyz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzay,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzwa,xwzy->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixya,Pzya,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwuy,xuzw->RPQ', Y_KC__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwuz,xuwy->RPQ', Y_KC__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Pwyu,xuzw->RPQ', Y_KC__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Pwyz,xw->RPQ', Y_KC__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwzu,xuyw->RPQ', Y_KC__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwzy,xw->RPQ', Y_KC__bb, t1_xaaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixyz,Pxwu,yzwu->RPQ', Y_KC__bb, t1_xaaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Py,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pz,xy->RPQ', Y_KC__bb, t1_xaaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KC__bb, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__bb, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,PixQ,xyza,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PixQ,yxza,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixa,xyzQ,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,Pixa,yQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Pixa,yxzQ,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,Pixa,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Pixy,yzQa,xz->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Pixy,zxQa,yz->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__bb, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iPxQ,xyza,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iPxQ,yxza,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,iPxa,xyzQ,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iPxa,yQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iPxa,yxzQ,zy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iPxa,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,iQ,Pxay,xy->RPQ', Y_KC__bb, t1_xe, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__bb, t1_xe, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQa,Py,xy->RPQ', Y_KC__bb, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQa,Pyxz,yz->RPQ', Y_KC__bb, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQa,Pyzx,yz->RPQ', Y_KC__bb, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__bb, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQy,Pyaz,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,Pzaw,ywxz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQy,Pzax,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,Pzxa,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__bb, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__bb, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__bb, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__bb, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyQ,Pyaz,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pzaw,ywxz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyQ,Pzax,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,PxzQ,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,PyzQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,PzxQ,yz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,PzyQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,PyaQ,xz->RPQ', Y_KC__bb, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__bb, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,PzaQ,xy->RPQ', Y_KC__bb, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_vxae, rdm_ca, optimize = einsum_type)
    TY[:, s_c:f_c, s_e:f_e] += temp   
 
    temp =- 1/2 * einsum('RiQ,ia,Pa->RPQ', Y_KC__aa, t1_xe, t1_ve, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,Pjab->RPQ', Y_KC__aa, t1_xxee, t1_vxee, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KC__aa, t1_xxee, t1_vxee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KC__aa, t1_xxae, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__aa, t1_xxae, t1_xvae, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KC__aa, t1_xxaa, t1_vxaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KC__aa, t1_xxaa, t1_vxaa, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,Pjab->RPQ', Y_KC__aa, t1_xvee, t1_vvee, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KC__aa, t1_xvee, t1_vvee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KC__aa, t1_xvae, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__aa, t1_xvae, t1_vvae, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KC__aa, t1_xvaa, t1_vvaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KC__aa, t1_xvaa, t1_vvaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ix,Px->RPQ', Y_KC__aa, t1_xa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KC__aa, t1_xxae, t1_vxae, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__aa, t1_xxae, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KC__aa, t1_vxae, t1_vvae, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__aa, t1_vxae, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PixQ,xa->RPQ', Y_KC__aa, t1_vxae, t1_ae, optimize = einsum_type)
    temp += einsum('Ria,Pixa,xQ->RPQ', Y_KC__aa, t1_vxae, t1_ae, optimize = einsum_type)
    temp += einsum('Ria,Pixy,xyQa->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,yxQa->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, optimize = einsum_type)
    temp -= einsum('Ria,iPxQ,xa->RPQ', Y_KC__aa, t1_xvae, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iPxa,xQ->RPQ', Y_KC__aa, t1_xvae, t1_ae, optimize = einsum_type)
    temp -= einsum('Ria,iQ,Pa->RPQ', Y_KC__aa, t1_xe, t1_ve, optimize = einsum_type)
    temp += 2 * einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_vxee, optimize = einsum_type)
    temp -= einsum('Ria,ijab,PjbQ->RPQ', Y_KC__aa, t1_xxee, t1_vxee, optimize = einsum_type)
    temp -= einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xxee, t1_vxee, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,PjbQ->RPQ', Y_KC__aa, t1_xxee, t1_vxee, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_vxae, optimize = einsum_type)
    temp -= einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__aa, t1_xxae, t1_xvae, optimize = einsum_type)
    temp += 2 * einsum('Ria,ijab,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_vvee, optimize = einsum_type)
    temp -= einsum('Ria,ijab,PjbQ->RPQ', Y_KC__aa, t1_xvee, t1_vvee, optimize = einsum_type)
    temp -= einsum('Ria,ijba,PjQb->RPQ', Y_KC__aa, t1_xvee, t1_vvee, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,PjbQ->RPQ', Y_KC__aa, t1_xvee, t1_vvee, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__aa, t1_xvae, t1_vvae, optimize = einsum_type)
    temp -= einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__aa, t1_xvae, t1_vvae, optimize = einsum_type)
    temp += einsum('Ria,ix,PxQa->RPQ', Y_KC__aa, t1_xa, t1_vaee, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ix,PxaQ->RPQ', Y_KC__aa, t1_xa, t1_vaee, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQa,Px->RPQ', Y_KC__aa, t1_xaee, t1_va, optimize = einsum_type)
    temp += einsum('Ria,ixaQ,Px->RPQ', Y_KC__aa, t1_xaee, t1_va, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_xxae, t1_vxae, optimize = einsum_type)
    temp += 2 * einsum('Ria,jixa,jPxQ->RPQ', Y_KC__aa, t1_xxae, t1_xvae, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjxQ->RPQ', Y_KC__aa, t1_vxae, t1_vvae, optimize = einsum_type)
    temp += 2 * einsum('Ria,jixa,jPxQ->RPQ', Y_KC__aa, t1_vxae, t1_vvae, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,Pa->RPQ', Y_KC__bb, t1_xe, t1_ve, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,Pjab->RPQ', Y_KC__bb, t1_xxee, t1_vxee, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KC__bb, t1_xxee, t1_vxee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KC__bb, t1_xxae, t1_vxae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__bb, t1_xxae, t1_xvae, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KC__bb, t1_xxaa, t1_vxaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KC__bb, t1_xxaa, t1_vxaa, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,Pjab->RPQ', Y_KC__bb, t1_xvee, t1_vvee, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,Pjba->RPQ', Y_KC__bb, t1_xvee, t1_vvee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,Pjxa->RPQ', Y_KC__bb, t1_xvae, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__bb, t1_xvae, t1_vvae, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,Pjxy->RPQ', Y_KC__bb, t1_xvaa, t1_vvaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjyx->RPQ', Y_KC__bb, t1_xvaa, t1_vvaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ix,Px->RPQ', Y_KC__bb, t1_xa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KC__bb, t1_xxae, t1_vxae, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__bb, t1_xxae, t1_xvae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,Pjxa->RPQ', Y_KC__bb, t1_vxae, t1_vvae, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__bb, t1_vxae, t1_vvae, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PixQ,xa->RPQ', Y_KC__bb, t1_vxae, t1_ae, optimize = einsum_type)
    temp += einsum('Ria,Pixa,xQ->RPQ', Y_KC__bb, t1_vxae, t1_ae, optimize = einsum_type)
    temp += einsum('Ria,Pixy,xyQa->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,yxQa->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, optimize = einsum_type)
    temp -= einsum('Ria,iPxQ,xa->RPQ', Y_KC__bb, t1_xvae, t1_ae, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iPxa,xQ->RPQ', Y_KC__bb, t1_xvae, t1_ae, optimize = einsum_type)
    temp -= einsum('Ria,iQ,Pa->RPQ', Y_KC__bb, t1_xe, t1_ve, optimize = einsum_type)
    temp += 2 * einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_vxee, optimize = einsum_type)
    temp -= einsum('Ria,ijab,PjbQ->RPQ', Y_KC__bb, t1_xxee, t1_vxee, optimize = einsum_type)
    temp -= einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xxee, t1_vxee, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,PjbQ->RPQ', Y_KC__bb, t1_xxee, t1_vxee, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_vxae, optimize = einsum_type)
    temp -= einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__bb, t1_xxae, t1_xvae, optimize = einsum_type)
    temp += 2 * einsum('Ria,ijab,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_vvee, optimize = einsum_type)
    temp -= einsum('Ria,ijab,PjbQ->RPQ', Y_KC__bb, t1_xvee, t1_vvee, optimize = einsum_type)
    temp -= einsum('Ria,ijba,PjQb->RPQ', Y_KC__bb, t1_xvee, t1_vvee, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijba,PjbQ->RPQ', Y_KC__bb, t1_xvee, t1_vvee, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,PjxQ->RPQ', Y_KC__bb, t1_xvae, t1_vvae, optimize = einsum_type)
    temp -= einsum('Ria,ijxa,jPxQ->RPQ', Y_KC__bb, t1_xvae, t1_vvae, optimize = einsum_type)
    temp += einsum('Ria,ix,PxQa->RPQ', Y_KC__bb, t1_xa, t1_vaee, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ix,PxaQ->RPQ', Y_KC__bb, t1_xa, t1_vaee, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQa,Px->RPQ', Y_KC__bb, t1_xaee, t1_va, optimize = einsum_type)
    temp += einsum('Ria,ixaQ,Px->RPQ', Y_KC__bb, t1_xaee, t1_va, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_xxae, t1_vxae, optimize = einsum_type)
    temp += 2 * einsum('Ria,jixa,jPxQ->RPQ', Y_KC__bb, t1_xxae, t1_xvae, optimize = einsum_type)
    temp -= einsum('Ria,jixa,PjxQ->RPQ', Y_KC__bb, t1_vxae, t1_vvae, optimize = einsum_type)
    temp += 2 * einsum('Ria,jixa,jPxQ->RPQ', Y_KC__bb, t1_vxae, t1_vvae, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,Pxay,xy->RPQ', Y_KC__aa, t1_xe, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ia,Pxya,xy->RPQ', Y_KC__aa, t1_xe, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__aa, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KC__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KC__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KC__aa, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KC__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KC__aa, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KC__aa, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__aa, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KC__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KC__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KC__aa, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KC__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KC__aa, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ix,Pyxz,yz->RPQ', Y_KC__aa, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ix,Pyzx,yz->RPQ', Y_KC__aa, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixab,Pyab,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixab,Pyba,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pa,xy->RPQ', Y_KC__aa, t1_xaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pzaw,xwyz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pzay,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzwa,xwyz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzya,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pa,xy->RPQ', Y_KC__aa, t1_xaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzaw,xwyz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzay,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzwa,xwzy->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixya,Pzya,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwuy,xuzw->RPQ', Y_KC__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwuz,xuwy->RPQ', Y_KC__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Pwyu,xuzw->RPQ', Y_KC__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Pwyz,xw->RPQ', Y_KC__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwzu,xuyw->RPQ', Y_KC__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwzy,xw->RPQ', Y_KC__aa, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixyz,Pxwu,yzwu->RPQ', Y_KC__aa, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Py,xz->RPQ', Y_KC__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pz,xy->RPQ', Y_KC__aa, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__aa, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KC__aa, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__aa, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,PixQ,xyza,zy->RPQ', Y_KC__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PixQ,yxza,zy->RPQ', Y_KC__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixa,xyzQ,zy->RPQ', Y_KC__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,Pixa,yQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Pixa,yxzQ,zy->RPQ', Y_KC__aa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,Pixa,yzwQ,xwzy->RPQ', Y_KC__aa, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Pixy,yzQa,xz->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Pixy,zxQa,yz->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__aa, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iPxQ,xyza,zy->RPQ', Y_KC__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iPxQ,yxza,zy->RPQ', Y_KC__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,iPxa,xyzQ,zy->RPQ', Y_KC__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iPxa,yQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iPxa,yxzQ,zy->RPQ', Y_KC__aa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iPxa,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,iQ,Pxay,xy->RPQ', Y_KC__aa, t1_xe, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__aa, t1_xe, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__aa, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQa,Py,xy->RPQ', Y_KC__aa, t1_xaee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQa,Pyxz,yz->RPQ', Y_KC__aa, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQa,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQa,Pyzx,yz->RPQ', Y_KC__aa, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__aa, t1_xaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQy,Pyaz,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,Pzaw,ywxz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQy,Pzax,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,Pzxa,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__aa, t1_xaee, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__aa, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__aa, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__aa, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__aa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,PybQ,xy->RPQ', Y_KC__aa, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__aa, t1_xaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyQ,Pyaz,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pzaw,ywxz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyQ,Pzax,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,PxzQ,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,PyzQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,PzxQ,yz->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,PzyQ,xz->RPQ', Y_KC__aa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__aa, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,PyaQ,xz->RPQ', Y_KC__aa, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__aa, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,PzaQ,xy->RPQ', Y_KC__aa, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__aa, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__aa, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,Pxay,xy->RPQ', Y_KC__bb, t1_xe, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ia,Pxya,xy->RPQ', Y_KC__bb, t1_xe, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__bb, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KC__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KC__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KC__bb, t1_xxaa, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KC__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KC__bb, t1_xxaa, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,Pjya,xy->RPQ', Y_KC__bb, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__bb, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjxz,yz->RPQ', Y_KC__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjyz,xz->RPQ', Y_KC__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzw,xyzw->RPQ', Y_KC__bb, t1_xvaa, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,Pjzx,yz->RPQ', Y_KC__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,Pjzy,xz->RPQ', Y_KC__bb, t1_xvaa, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ix,Pyxz,yz->RPQ', Y_KC__bb, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ix,Pyzx,yz->RPQ', Y_KC__bb, t1_xa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixab,Pyab,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixab,Pyba,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pa,xy->RPQ', Y_KC__bb, t1_xaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pzaw,xwyz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pzay,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzwa,xwyz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzya,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pa,xy->RPQ', Y_KC__bb, t1_xaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzaw,xwyz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzay,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzwa,xwzy->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixya,Pzya,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwuy,xuzw->RPQ', Y_KC__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwuz,xuwy->RPQ', Y_KC__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Pwyu,xuzw->RPQ', Y_KC__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Pwyz,xw->RPQ', Y_KC__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwzu,xuyw->RPQ', Y_KC__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pwzy,xw->RPQ', Y_KC__bb, t1_xaaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixyz,Pxwu,yzwu->RPQ', Y_KC__bb, t1_xaaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixyz,Py,xz->RPQ', Y_KC__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixyz,Pz,xy->RPQ', Y_KC__bb, t1_xaaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__bb, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,Pjya,xy->RPQ', Y_KC__bb, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__bb, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,PixQ,xyza,zy->RPQ', Y_KC__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,PixQ,yxza,zy->RPQ', Y_KC__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixa,xyzQ,zy->RPQ', Y_KC__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,Pixa,yQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,Pixa,yxzQ,zy->RPQ', Y_KC__bb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,Pixa,yzwQ,xwzy->RPQ', Y_KC__bb, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,xzQa,yz->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Pixy,yzQa,xz->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,Pixy,zwQa,xyzw->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,Pixy,zxQa,yz->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,Pixy,zyQa,xz->RPQ', Y_KC__bb, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iPxQ,xyza,zy->RPQ', Y_KC__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iPxQ,yxza,zy->RPQ', Y_KC__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,iPxa,xyzQ,zy->RPQ', Y_KC__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iPxa,yQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,iPxa,yxzQ,zy->RPQ', Y_KC__bb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iPxa,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,iQ,Pxay,xy->RPQ', Y_KC__bb, t1_xe, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__bb, t1_xe, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ijxa,PjyQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijxa,jPyQ,xy->RPQ', Y_KC__bb, t1_xvae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQa,Py,xy->RPQ', Y_KC__bb, t1_xaee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQa,Pyxz,yz->RPQ', Y_KC__bb, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQa,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQa,Pyzx,yz->RPQ', Y_KC__bb, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__bb, t1_xaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQy,Pyaz,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,Pzaw,ywxz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixQy,Pzax,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,Pzxa,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixaQ,Py,xy->RPQ', Y_KC__bb, t1_xaee, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixaQ,Pyxz,yz->RPQ', Y_KC__bb, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixaQ,Pyzw,xyzw->RPQ', Y_KC__bb, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixaQ,Pyzx,yz->RPQ', Y_KC__bb, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixab,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixab,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixay,PxQz,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,PxzQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixay,PyQz,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,PyzQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixay,PzQx,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixay,PzQy,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,PzxQ,yz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,PzyQ,xz->RPQ', Y_KC__bb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixba,PyQb,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixba,PybQ,xy->RPQ', Y_KC__bb, t1_xaee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__bb, t1_xaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyQ,Pyaz,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pzaw,ywxz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyQ,Pzax,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,Pzxa,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixya,PxQz,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,PxzQ,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixya,PyQz,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,PyzQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixya,PzQx,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixya,PzQy,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,PzxQ,yz->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,PzyQ,xz->RPQ', Y_KC__bb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixyz,PyQa,xz->RPQ', Y_KC__bb, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,PyaQ,xz->RPQ', Y_KC__bb, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyz,PzQa,xy->RPQ', Y_KC__bb, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyz,PzaQ,xy->RPQ', Y_KC__bb, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__bb, t1_xxae, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,jixa,PjyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jixa,jPyQ,xy->RPQ', Y_KC__bb, t1_vxae, t1_vvae, rdm_ca, optimize = einsum_type)
    TY[:, s_v:f_v, s_e:f_e] += temp   
 
    temp  = einsum('RiQ,iP->RPQ', Y_KC__aa, t2_xa, optimize = einsum_type)
    temp += einsum('RiQ,iP->RPQ', Y_KC__bb, t2_xa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,Pa->RPQ', Y_KC__aa, t1_xe, t1_ae, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,ja->RPQ', Y_KC__aa, t1_xxae, t1_xe, optimize = einsum_type)
    temp += einsum('RiQ,ijPx,jx->RPQ', Y_KC__aa, t1_xxaa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,jPab->RPQ', Y_KC__aa, t1_xxee, t1_xaee, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,jPba->RPQ', Y_KC__aa, t1_xxee, t1_xaee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,jPax->RPQ', Y_KC__aa, t1_xxae, t1_xaea, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__aa, t1_xxae, t1_xaae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPxy->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,jPyx->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,ja->RPQ', Y_KC__aa, t1_xvae, t1_ve, optimize = einsum_type)
    temp += einsum('RiQ,ijPx,jx->RPQ', Y_KC__aa, t1_xvaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,jPab->RPQ', Y_KC__aa, t1_xvee, t1_vaee, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,jPba->RPQ', Y_KC__aa, t1_xvee, t1_vaee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,jPax->RPQ', Y_KC__aa, t1_xvae, t1_vaea, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__aa, t1_xvae, t1_vaae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPxy->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,jPyx->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KC__aa, t1_xxae, t1_xe, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPx,jx->RPQ', Y_KC__aa, t1_xxaa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPax->RPQ', Y_KC__aa, t1_xxae, t1_xaea, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__aa, t1_xxae, t1_xaae, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KC__aa, t1_vxae, t1_ve, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPx,jx->RPQ', Y_KC__aa, t1_vxaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPax->RPQ', Y_KC__aa, t1_vxae, t1_vaea, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__aa, t1_vxae, t1_vaae, optimize = einsum_type)
    temp -= einsum('Ria,iQ,Pa->RPQ', Y_KC__aa, t1_xe, t1_ae, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__aa, t1_xxae, t1_xe, optimize = einsum_type)
    temp -= einsum('Ria,ijQa,jP->RPQ', Y_KC__aa, t1_xxee, t1_xa, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__aa, t1_xvae, t1_ve, optimize = einsum_type)
    temp -= einsum('Ria,ijQa,jP->RPQ', Y_KC__aa, t1_xvee, t1_va, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jQ->RPQ', Y_KC__aa, t1_xxae, t1_xe, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiQa,jP->RPQ', Y_KC__aa, t1_xxee, t1_xa, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jQ->RPQ', Y_KC__aa, t1_vxae, t1_ve, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiQa,jP->RPQ', Y_KC__aa, t1_vxee, t1_va, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,Pa->RPQ', Y_KC__bb, t1_xe, t1_ae, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,ja->RPQ', Y_KC__bb, t1_xxae, t1_xe, optimize = einsum_type)
    temp += einsum('RiQ,ijPx,jx->RPQ', Y_KC__bb, t1_xxaa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,jPab->RPQ', Y_KC__bb, t1_xxee, t1_xaee, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,jPba->RPQ', Y_KC__bb, t1_xxee, t1_xaee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,jPax->RPQ', Y_KC__bb, t1_xxae, t1_xaea, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__bb, t1_xxae, t1_xaae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPxy->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,jPyx->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,ja->RPQ', Y_KC__bb, t1_xvae, t1_ve, optimize = einsum_type)
    temp += einsum('RiQ,ijPx,jx->RPQ', Y_KC__bb, t1_xvaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijab,jPab->RPQ', Y_KC__bb, t1_xvee, t1_vaee, optimize = einsum_type)
    temp -= einsum('RiQ,ijab,jPba->RPQ', Y_KC__bb, t1_xvee, t1_vaee, optimize = einsum_type)
    temp -= einsum('RiQ,ijxa,jPax->RPQ', Y_KC__bb, t1_xvae, t1_vaea, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPxa->RPQ', Y_KC__bb, t1_xvae, t1_vaae, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPxy->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, optimize = einsum_type)
    temp -= einsum('RiQ,ijxy,jPyx->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KC__bb, t1_xxae, t1_xe, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPx,jx->RPQ', Y_KC__bb, t1_xxaa, t1_xa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPax->RPQ', Y_KC__bb, t1_xxae, t1_xaea, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__bb, t1_xxae, t1_xaae, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,ja->RPQ', Y_KC__bb, t1_vxae, t1_ve, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPx,jx->RPQ', Y_KC__bb, t1_vxaa, t1_va, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPax->RPQ', Y_KC__bb, t1_vxae, t1_vaea, optimize = einsum_type)
    temp -= einsum('RiQ,jixa,jPxa->RPQ', Y_KC__bb, t1_vxae, t1_vaae, optimize = einsum_type)
    temp -= einsum('Ria,iQ,Pa->RPQ', Y_KC__bb, t1_xe, t1_ae, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__bb, t1_xxae, t1_xe, optimize = einsum_type)
    temp -= einsum('Ria,ijQa,jP->RPQ', Y_KC__bb, t1_xxee, t1_xa, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jQ->RPQ', Y_KC__bb, t1_xvae, t1_ve, optimize = einsum_type)
    temp -= einsum('Ria,ijQa,jP->RPQ', Y_KC__bb, t1_xvee, t1_va, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jQ->RPQ', Y_KC__bb, t1_xxae, t1_xe, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiQa,jP->RPQ', Y_KC__bb, t1_xxee, t1_xa, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jQ->RPQ', Y_KC__bb, t1_vxae, t1_ve, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiQa,jP->RPQ', Y_KC__bb, t1_vxee, t1_va, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ia,Pxya,xy->RPQ', Y_KC__aa, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,xPya,xy->RPQ', Y_KC__aa, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jy,xy->RPQ', Y_KC__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,ijPx,jyxz,zy->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jyzw,xyzw->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jyzx,zy->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPay,xy->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPxz,yz->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPyz,xz->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPzw,xywz->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPzx,yz->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPzy,xz->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KC__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KC__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jy,xy->RPQ', Y_KC__aa, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,ijPx,jyxz,zy->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jyzw,xyzw->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jyzx,zy->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPay,xy->RPQ', Y_KC__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPxz,yz->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPyz,xz->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPzw,xywz->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPzx,yz->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPzy,xz->RPQ', Y_KC__aa, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ixPa,ya,xy->RPQ', Y_KC__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ixPa,yzwa,xwzy->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixaP,ya,xy->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixaP,yzwa,xwzy->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixab,Pyab,xy->RPQ', Y_KC__aa, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixab,Pyba,xy->RPQ', Y_KC__aa, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pa,xy->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzwa,xwyz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzya,xz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,zPwa,xwyz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,zPya,xz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pa,xy->RPQ', Y_KC__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzwa,xwzy->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixya,Pzya,xz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,zPwa,xwyz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,zPya,xz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jy,xy->RPQ', Y_KC__aa, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPx,jyxz,zy->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jyzw,xyzw->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jyzx,zy->RPQ', Y_KC__aa, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,jPay,xy->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KC__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KC__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jy,xy->RPQ', Y_KC__aa, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPx,jyxz,zy->RPQ', Y_KC__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jyzw,xyzw->RPQ', Y_KC__aa, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jyzx,zy->RPQ', Y_KC__aa, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,jPay,xy->RPQ', Y_KC__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iPax,yQ,xy->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iPax,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iPxa,yQ,xy->RPQ', Y_KC__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iPxa,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iPxy,zwQa,yxzw->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__aa, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iQ,xPya,xy->RPQ', Y_KC__aa, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijQa,jx,Px->RPQ', Y_KC__aa, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ijQa,jxPy,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijQa,jxyP,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijQa,jxyz,Pxyz->RPQ', Y_KC__aa, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijba,jxQb,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__aa, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jQ,Px->RPQ', Y_KC__aa, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyQx,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijQa,jx,Px->RPQ', Y_KC__aa, t1_xvee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ijQa,jxPy,yx->RPQ', Y_KC__aa, t1_xvee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijQa,jxyP,yx->RPQ', Y_KC__aa, t1_xvee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijQa,jxyz,Pxyz->RPQ', Y_KC__aa, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijba,jxQb,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__aa, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jQ,Px->RPQ', Y_KC__aa, t1_xvae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyQx,Py->RPQ', Y_KC__aa, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_xvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__aa, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ix,xyQa,Py->RPQ', Y_KC__aa, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ix,yxQa,Py->RPQ', Y_KC__aa, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixPa,yQ,xy->RPQ', Y_KC__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixPa,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,yPza,xz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,ya,Px->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,yzwa,Pwzx->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,zPwa,ywxz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixQy,zwxa,Pywz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,zywa,Pwxz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,ixaP,yQ,xy->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixaP,yzwQ,xwzy->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixab,yzQb,Pxyz->RPQ', Y_KC__aa, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,xQ,Py->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,xzwQ,Pwzy->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,yQ,Px->RPQ', Y_KC__aa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,yzwQ,Pwzx->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,zwxQ,Pywz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,zwyQ,Pxwz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,zxwQ,Pwyz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,zywQ,Pwxz->RPQ', Y_KC__aa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixba,yzQb,Pxyz->RPQ', Y_KC__aa, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,yPza,xz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,ya,Px->RPQ', Y_KC__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyQ,yzwa,Pwxz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,zPwa,ywxz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyQ,zwxa,Pyzw->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,zywa,Pwxz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,xQ,Py->RPQ', Y_KC__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,xzwQ,Pwzy->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,yQ,Px->RPQ', Y_KC__aa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,yzwQ,Pwzx->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,zwxQ,Pywz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,zwyQ,Pxwz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,zxwQ,Pwyz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,zywQ,Pwxz->RPQ', Y_KC__aa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyz,wyQa,Pzwx->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,wzQa,Pywx->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,ywQa,Pzwx->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,yzQa,Px->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,zwQa,Pyxw->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyz,zyQa,Px->RPQ', Y_KC__aa, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jiQa,jx,Px->RPQ', Y_KC__aa, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiQa,jxPy,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jiQa,jxyP,yx->RPQ', Y_KC__aa, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jiQa,jxyz,Pxyz->RPQ', Y_KC__aa, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__aa, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jiQa,jx,Px->RPQ', Y_KC__aa, t1_vxee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiQa,jxPy,yx->RPQ', Y_KC__aa, t1_vxee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jiQa,jxyP,yx->RPQ', Y_KC__aa, t1_vxee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jiQa,jxyz,Pxyz->RPQ', Y_KC__aa, t1_vxee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__aa, t1_vxae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__aa, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__aa, t1_vxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__aa, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__aa, t1_vxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ia,Pxya,xy->RPQ', Y_KC__bb, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ia,xPya,xy->RPQ', Y_KC__bb, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jy,xy->RPQ', Y_KC__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,ijPx,jyxz,zy->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jyzw,xyzw->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jyzx,zy->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPay,xy->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPxz,yz->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPyz,xz->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPzw,xywz->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPzx,yz->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPzy,xz->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,ijPa,jxay,yx->RPQ', Y_KC__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPa,jxya,yx->RPQ', Y_KC__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jy,xy->RPQ', Y_KC__bb, t1_xvaa, t1_va, rdm_ca, optimize = einsum_type)
    temp += einsum('RiQ,ijPx,jyxz,zy->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jyzw,xyzw->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ijPx,jyzx,zy->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxa,jPay,xy->RPQ', Y_KC__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxa,jPya,xy->RPQ', Y_KC__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPxz,yz->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPyz,xz->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPzw,xywz->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ijxy,jPzx,yz->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ijxy,jPzy,xz->RPQ', Y_KC__bb, t1_xvaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ixPa,ya,xy->RPQ', Y_KC__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,ixPa,yzwa,xwzy->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixaP,ya,xy->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,ixaP,yzwa,xwzy->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixab,Pyab,xy->RPQ', Y_KC__bb, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixab,Pyba,xy->RPQ', Y_KC__bb, t1_xaee, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,Pa,xy->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzwa,xwyz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixay,Pzya,xz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,zPwa,xwyz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixay,zPya,xz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pa,xy->RPQ', Y_KC__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,Pzwa,xwzy->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,ixya,Pzya,xz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,zPwa,xwyz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,ixya,zPya,xz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jy,xy->RPQ', Y_KC__bb, t1_xxaa, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPx,jyxz,zy->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jyzw,xyzw->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jyzx,zy->RPQ', Y_KC__bb, t1_xxaa, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,jPay,xy->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPa,jxay,yx->RPQ', Y_KC__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPa,jxya,yx->RPQ', Y_KC__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jy,xy->RPQ', Y_KC__bb, t1_vxaa, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RiQ,jiPx,jyxz,zy->RPQ', Y_KC__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jyzw,xyzw->RPQ', Y_KC__bb, t1_vxaa, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RiQ,jiPx,jyzx,zy->RPQ', Y_KC__bb, t1_vxaa, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RiQ,jixa,jPay,xy->RPQ', Y_KC__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RiQ,jixa,jPya,xy->RPQ', Y_KC__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iPax,yQ,xy->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iPax,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iPxa,yQ,xy->RPQ', Y_KC__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iPxa,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iPxy,zwQa,yxzw->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,iQ,Pxya,xy->RPQ', Y_KC__bb, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,iQ,xPya,xy->RPQ', Y_KC__bb, t1_xe, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijQa,jx,Px->RPQ', Y_KC__bb, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ijQa,jxPy,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijQa,jxyP,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijQa,jxyz,Pxyz->RPQ', Y_KC__bb, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijba,jxQb,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__bb, t1_xxee, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jQ,Px->RPQ', Y_KC__bb, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyQx,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ijPa,jxQy,yx->RPQ', Y_KC__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijQa,jx,Px->RPQ', Y_KC__bb, t1_xvee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ijQa,jxPy,yx->RPQ', Y_KC__bb, t1_xvee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ijQa,jxyP,yx->RPQ', Y_KC__bb, t1_xvee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijQa,jxyz,Pxyz->RPQ', Y_KC__bb, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijab,jxQb,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ijab,jxbQ,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijba,jxQb,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijba,jxbQ,Px->RPQ', Y_KC__bb, t1_xvee, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jQ,Px->RPQ', Y_KC__bb, t1_xvae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyQx,Py->RPQ', Y_KC__bb, t1_xvae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_xvae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ijxa,jyxQ,Py->RPQ', Y_KC__bb, t1_xvae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ijxa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_xvae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ix,xyQa,Py->RPQ', Y_KC__bb, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ix,yxQa,Py->RPQ', Y_KC__bb, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixPa,yQ,xy->RPQ', Y_KC__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixPa,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,Pa,yx->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQy,Pyza,xz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixQy,Pzwa,ywxz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,yPza,xz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,ya,Px->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,yzwa,Pwzx->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= einsum('Ria,ixQy,zPwa,ywxz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixQy,zwxa,Pywz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixQy,zywa,Pwxz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,ixaP,yQ,xy->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += einsum('Ria,ixaP,yzwQ,xwzy->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixab,yzQb,Pxyz->RPQ', Y_KC__bb, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,xQ,Py->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,xzwQ,Pwzy->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,yQ,Px->RPQ', Y_KC__bb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,yzwQ,Pwzx->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,zwxQ,Pywz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,zwyQ,Pxwz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixay,zxwQ,Pwyz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixay,zywQ,Pwxz->RPQ', Y_KC__bb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixba,yzQb,Pxyz->RPQ', Y_KC__bb, t1_xaee, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pa,yx->RPQ', Y_KC__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,ixyQ,Pyza,xz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,Pzwa,ywzx->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,yPza,xz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,ya,Px->RPQ', Y_KC__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixyQ,yzwa,Pwxz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyQ,zPwa,ywxz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyQ,zwxa,Pyzw->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,ixyQ,zywa,Pwxz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,xQ,Py->RPQ', Y_KC__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,xzwQ,Pwzy->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,yQ,Px->RPQ', Y_KC__bb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,yzwQ,Pwzx->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,zwxQ,Pywz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,zwyQ,Pxwz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Ria,ixya,zxwQ,Pwyz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixya,zywQ,Pwxz->RPQ', Y_KC__bb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyz,wyQa,Pzwx->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,wzQa,Pywx->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,ywQa,Pzwx->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,yzQa,Px->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Ria,ixyz,zwQa,Pyxw->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Ria,ixyz,zyQa,Px->RPQ', Y_KC__bb, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jiQa,jx,Px->RPQ', Y_KC__bb, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiQa,jxPy,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jiQa,jxyP,yx->RPQ', Y_KC__bb, t1_xxee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jiQa,jxyz,Pxyz->RPQ', Y_KC__bb, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__bb, t1_xxae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_xxae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_xxae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiPa,jxQy,yx->RPQ', Y_KC__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jiPa,jxyQ,yx->RPQ', Y_KC__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jiQa,jx,Px->RPQ', Y_KC__bb, t1_vxee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 2 * einsum('Ria,jiQa,jxPy,yx->RPQ', Y_KC__bb, t1_vxee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= einsum('Ria,jiQa,jxyP,yx->RPQ', Y_KC__bb, t1_vxee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jiQa,jxyz,Pxyz->RPQ', Y_KC__bb, t1_vxee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jQ,Px->RPQ', Y_KC__bb, t1_vxae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyQx,Py->RPQ', Y_KC__bb, t1_vxae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyQz,Pzxy->RPQ', Y_KC__bb, t1_vxae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += einsum('Ria,jixa,jyxQ,Py->RPQ', Y_KC__bb, t1_vxae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Ria,jixa,jyzQ,Pzyx->RPQ', Y_KC__bb, t1_vxae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    TY[:, s_a:f_a, s_e:f_e] += temp

    mr_adc.log.timer_debug("computing T q2-h0 CE", *cput1)

