##Q2 TRANSITION MOMENTS
from . import logger

def compute_TY__q2_h1__CAEE(mr_adc, Y_KWCD__aaaa, Y_KWCD__abab, Y_KWCD__baba, Y_KWCD__bbbb, TY):

    cput1 = (logger.process_clock(), logger.perf_counter())

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    # Dimensions
    s_c = 0
    f_c = s_c + mr_adc.ncvs
    s_v = f_c
    f_v = s_v + mr_adc.nval
    s_a = f_v
    f_a = s_a + mr_adc.ncas
    s_e = f_a
    f_e = s_e + mr_adc.nextern
 
    ## Amplitudes
    t1_xa = mr_adc.t1.xa
    t1_xe = mr_adc.t1.xe
    t1_va = mr_adc.t1.va
    t1_ve = mr_adc.t1.ve
    t1_ae = mr_adc.t1.ae

    t1_xxaa = mr_adc.t1.xxaa
    t1_xxae = mr_adc.t1.xxae
    t1_xxee = mr_adc.t1.xxee
 
    t1_xvaa = mr_adc.t1.xvaa
    t1_xvae = mr_adc.t1.xvae
    t1_xvee = mr_adc.t1.xvee

    t1_xaaa = mr_adc.t1.xaaa
    t1_xaae = mr_adc.t1.xaae
    t1_xaea = mr_adc.t1.xaea
    t1_xaee = mr_adc.t1.xaee

    t1_vxaa = mr_adc.t1.vxaa
    t1_vxae = mr_adc.t1.vxae
    t1_vxee = mr_adc.t1.vxee

    t1_vaaa = mr_adc.t1.vaaa
    t1_vaae = mr_adc.t1.vaae
    t1_vaea = mr_adc.t1.vaea
    t1_vaee = mr_adc.t1.vaee
    
    t1_vvaa = mr_adc.t1.vvaa
    t1_vvae = mr_adc.t1.vvae
    t1_vvee = mr_adc.t1.vvee

    t1_aaae = mr_adc.t1.aaae
    t1_aaee = mr_adc.t1.aaee

    ## Reduced density matrices
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa

    temp  = 1/4 * einsum('RPxab,Qiab,iy,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iy,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyaz,wuyb,xzuw->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,wzub,xuyw->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,zb,xy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,zwub,xuwy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,Qyza,wuyb,xzuw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,Qyza,wuyb,xzwu->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyza,wzub,xuyw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyza,zb,xy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,Qyza,zwub,xuwy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,Qyza,zwub,xuyw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,yzab,Qwuy,xuwz->RPQ', Y_KWCD__aaaa, t1_aaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzab,Qwuy,xuzw->RPQ', Y_KWCD__aaaa, t1_aaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qwyu,xuzw->RPQ', Y_KWCD__aaaa, t1_aaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qwyz,xw->RPQ', Y_KWCD__aaaa, t1_aaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qy,xz->RPQ', Y_KWCD__aaaa, t1_aaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Qiab,Py,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Qiab,Pyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iy,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iyzw,xyzw->RPQ', Y_KWCD__abab, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iy,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iyzw,xyzw->RPQ', Y_KWCD__abab, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyaz,wuyb,xzuw->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,wzub,xuyw->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,zb,xy->RPQ', Y_KWCD__abab, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,zwub,xuwy->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,Qyza,wuyb,xzuw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,Qyza,wuyb,xzwu->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,Qyza,zwub,xuwy->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,Qyza,zwub,xuyw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ya,Qzyb,xz->RPQ', Y_KWCD__abab, t1_ae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzab,Qwuy,xuwz->RPQ', Y_KWCD__abab, t1_aaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,yzab,Qwuy,xuzw->RPQ', Y_KWCD__abab, t1_aaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,yzab,Qwuz,xuwy->RPQ', Y_KWCD__abab, t1_aaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzab,Qwuz,xuyw->RPQ', Y_KWCD__abab, t1_aaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qwyu,xuzw->RPQ', Y_KWCD__abab, t1_aaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qwyz,xw->RPQ', Y_KWCD__abab, t1_aaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qy,xz->RPQ', Y_KWCD__abab, t1_aaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,yzwa,Quyb,xwuz->RPQ', Y_KWCD__abab, t1_aaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzwa,Quyb,xwzu->RPQ', Y_KWCD__abab, t1_aaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzwa,Quzb,xwuy->RPQ', Y_KWCD__abab, t1_aaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,yzwa,Qwub,xuyz->RPQ', Y_KWCD__abab, t1_aaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,yzwa,Qwub,xuzy->RPQ', Y_KWCD__abab, t1_aaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Qiba,Py,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Qiba,Pyzw,xyzw->RPQ', Y_KWCD__abab, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iy,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iyzw,xyzw->RPQ', Y_KWCD__baba, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iy,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iyzw,xyzw->RPQ', Y_KWCD__baba, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyaz,wuyb,xzuw->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,wzub,xuyw->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,zb,xy->RPQ', Y_KWCD__baba, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,zwub,xuwy->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,Qyza,wuyb,xzuw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,Qyza,wuyb,xzwu->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,Qyza,zwub,xuwy->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,Qyza,zwub,xuyw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ya,Qzyb,xz->RPQ', Y_KWCD__baba, t1_ae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzab,Qwuy,xuwz->RPQ', Y_KWCD__baba, t1_aaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,yzab,Qwuy,xuzw->RPQ', Y_KWCD__baba, t1_aaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,yzab,Qwuz,xuwy->RPQ', Y_KWCD__baba, t1_aaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzab,Qwuz,xuyw->RPQ', Y_KWCD__baba, t1_aaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qwyu,xuzw->RPQ', Y_KWCD__baba, t1_aaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qwyz,xw->RPQ', Y_KWCD__baba, t1_aaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qy,xz->RPQ', Y_KWCD__baba, t1_aaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,yzwa,Quyb,xwuz->RPQ', Y_KWCD__baba, t1_aaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzwa,Quyb,xwzu->RPQ', Y_KWCD__baba, t1_aaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzwa,Quzb,xwuy->RPQ', Y_KWCD__baba, t1_aaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,yzwa,Qwub,xuyz->RPQ', Y_KWCD__baba, t1_aaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,yzwa,Qwub,xuzy->RPQ', Y_KWCD__baba, t1_aaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Qiba,Py,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Qiba,Pyzw,xyzw->RPQ', Y_KWCD__baba, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iy,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iy,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyaz,wuyb,xzuw->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,wzub,xuyw->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,zb,xy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,zwub,xuwy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,Qyza,wuyb,xzuw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,Qyza,wuyb,xzwu->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyza,wzub,xuyw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyza,zb,xy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,Qyza,zwub,xuwy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,Qyza,zwub,xuyw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,yzab,Qwuy,xuwz->RPQ', Y_KWCD__bbbb, t1_aaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzab,Qwuy,xuzw->RPQ', Y_KWCD__bbbb, t1_aaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qwyu,xuzw->RPQ', Y_KWCD__bbbb, t1_aaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qwyz,xw->RPQ', Y_KWCD__bbbb, t1_aaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qy,xz->RPQ', Y_KWCD__bbbb, t1_aaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Qiab,Py,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Qiab,Pyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    TY[:, s_c:f_c, s_c:f_c] += temp   
 
    temp =- 1/2 * einsum('Rixab,Qiab,Py,xy->RPQ', Y_KWCD__aaaa, t1_vxee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Qiab,Pyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_vxee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Qiba,Py,xy->RPQ', Y_KWCD__abab, t1_vxee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Qiba,Pyzw,xyzw->RPQ', Y_KWCD__abab, t1_vxee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Qiba,Py,xy->RPQ', Y_KWCD__baba, t1_vxee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Qiba,Pyzw,xyzw->RPQ', Y_KWCD__baba, t1_vxee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Qiab,Py,xy->RPQ', Y_KWCD__bbbb, t1_vxee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Qiab,Pyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_vxee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    TY[:, s_v:f_v, s_v:f_v] += temp   
 
    temp =- 1/2 * einsum('Rixab,iP,Qyab,xy->RPQ', Y_KWCD__aaaa, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQay,yb,Px->RPQ', Y_KWCD__aaaa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQay,yzwb,Pzwx->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQay,zwPb,xywz->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQay,zywb,Pzxw->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iQya,yb,Px->RPQ', Y_KWCD__aaaa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iQya,yzwb,Pzwx->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iQya,yzwb,Pzxw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iQya,zwPb,xywz->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iQya,zwPb,xyzw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iQya,zywb,Pzxw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQyz,ywab,Pwzx->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iQyz,zwab,Pwxy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iQyz,zwab,Pwyx->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iQyz,zyab,Px->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,jPyz,Qxzy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jQ,Px->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyQz,Pzxy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyzQ,Pzyx->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,jPyz,Qxzy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jQ,Px->RPQ', Y_KWCD__aaaa, t1_xvee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyQz,Pzxy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyzQ,Pzyx->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iy,Qyab,Px->RPQ', Y_KWCD__aaaa, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyPa,Qb,xy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyPa,Qzwb,xwyz->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyPa,Qzwb,xwzy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyPa,zQwb,xwyz->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyPa,zwyb,Qxwz->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyPa,zwyb,Qxzw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyPz,Qwab,xzwy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyPz,Qzab,xy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyPz,zwab,Qxwy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyPz,zwab,Qxyw->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaP,Qb,xy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaP,Qzwb,xwzy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaP,zQwb,xwyz->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaP,zwyb,Qxzw->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Qwyb,Pwzx->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Qzwb,Pywx->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,wQyb,Pwxz->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,wzPb,Qxwy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,zQwb,Pyxw->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,zwPb,Qxyw->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzP,Qwab,xzwy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzP,Qwab,xzyw->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyzP,Qzab,xy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzP,zwab,Qxyw->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,Qwyb,Pwxz->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Qwyb,Pwzx->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyza,Qzwb,Pywx->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,wQyb,Pwxz->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,wQyb,Pwzx->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyza,wzPb,Qxwy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,zQwb,Pywx->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,zQwb,Pyxw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,zwPb,Qxwy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,zwPb,Qxyw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzw,Qwab,Pyxz->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzw,Qwab,Pyzx->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyzw,Qzab,Pyxw->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iP,Qyab,xy->RPQ', Y_KWCD__abab, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQay,yb,Px->RPQ', Y_KWCD__abab, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQay,yzwb,Pzwx->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQay,zwPb,xywz->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQay,zywb,Pzxw->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iQya,yzwb,Pzwx->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iQya,yzwb,Pzxw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iQya,zwPb,xywz->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iQya,zwPb,xyzw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQyb,ya,Px->RPQ', Y_KWCD__abab, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iQyb,yzwa,Pzwx->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iQyb,yzwa,Pzxw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iQyb,zwPa,xywz->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iQyb,zwPa,xyzw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQyb,zywa,Pzxw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iQyz,wzab,Pwxy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iQyz,wzab,Pwyx->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQyz,ywab,Pwzx->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQyz,yzab,Px->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iQyz,zwab,Pwxy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iQyz,zwab,Pwyx->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,jPyz,Qxzy->RPQ', Y_KWCD__abab, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jQ,Px->RPQ', Y_KWCD__abab, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyQz,Pzxy->RPQ', Y_KWCD__abab, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyzQ,Pzyx->RPQ', Y_KWCD__abab, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,jPyz,Qxzy->RPQ', Y_KWCD__abab, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jQ,Px->RPQ', Y_KWCD__abab, t1_xvee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyQz,Pzxy->RPQ', Y_KWCD__abab, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyzQ,Pzyx->RPQ', Y_KWCD__abab, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iy,Qyba,Px->RPQ', Y_KWCD__abab, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyPa,Qzwb,xwyz->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyPa,Qzwb,xwzy->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyPa,zwyb,Qxwz->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyPa,zwyb,Qxzw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyPb,Qa,xy->RPQ', Y_KWCD__abab, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyPb,Qzwa,xwyz->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyPb,Qzwa,xwzy->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyPb,zQwa,xwyz->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyPb,zwya,Qxwz->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyPb,zwya,Qxzw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyPz,Qwab,xzwy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyPz,Qzab,xy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyPz,wzab,Qxwy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyPz,wzab,Qxyw->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyPz,zwab,Qxwy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyPz,zwab,Qxyw->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaP,Qb,xy->RPQ', Y_KWCD__abab, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaP,Qzwb,xwzy->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaP,zQwb,xwyz->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaP,zwyb,Qxzw->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Qwyb,Pwzx->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Qzwb,Pywx->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,wQyb,Pwxz->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,wzPb,Qxwy->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,zQwb,Pyxw->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,zwPb,Qxyw->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzP,Qwab,xzwy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzP,Qwab,xzyw->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzP,Qwba,xzwy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzP,Qwba,xzyw->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyzP,Qzba,xy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzP,zwab,Qxyw->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Qwyb,Pwxz->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyza,Qwyb,Pwzx->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyza,wQyb,Pwxz->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,wQyb,Pwzx->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,zQwb,Pywx->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyza,zQwb,Pyxw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,zwPb,Qxwy->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyza,zwPb,Qxyw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzb,Qwya,Pwxz->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzb,Qwya,Pwzx->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzb,Qzwa,Pywx->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzb,wQya,Pwxz->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzb,wQya,Pwzx->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyzb,wzPa,Qxwy->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzb,zQwa,Pywx->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzb,zQwa,Pyxw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzb,zwPa,Qxwy->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzb,zwPa,Qxyw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzw,Qwab,Pyxz->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzw,Qwab,Pyzx->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzw,Qwba,Pyxz->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzw,Qwba,Pyzx->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzw,Qzba,Pyxw->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iP,Qyab,xy->RPQ', Y_KWCD__baba, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQay,yb,Px->RPQ', Y_KWCD__baba, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQay,yzwb,Pzwx->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQay,zwPb,xywz->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQay,zywb,Pzxw->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iQya,yzwb,Pzwx->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iQya,yzwb,Pzxw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iQya,zwPb,xywz->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iQya,zwPb,xyzw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQyb,ya,Px->RPQ', Y_KWCD__baba, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iQyb,yzwa,Pzwx->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iQyb,yzwa,Pzxw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iQyb,zwPa,xywz->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iQyb,zwPa,xyzw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQyb,zywa,Pzxw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iQyz,wzab,Pwxy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iQyz,wzab,Pwyx->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQyz,ywab,Pwzx->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQyz,yzab,Px->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iQyz,zwab,Pwxy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iQyz,zwab,Pwyx->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,jPyz,Qxzy->RPQ', Y_KWCD__baba, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jQ,Px->RPQ', Y_KWCD__baba, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyQz,Pzxy->RPQ', Y_KWCD__baba, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyzQ,Pzyx->RPQ', Y_KWCD__baba, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,jPyz,Qxzy->RPQ', Y_KWCD__baba, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jQ,Px->RPQ', Y_KWCD__baba, t1_xvee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyQz,Pzxy->RPQ', Y_KWCD__baba, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyzQ,Pzyx->RPQ', Y_KWCD__baba, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iy,Qyba,Px->RPQ', Y_KWCD__baba, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyPa,Qzwb,xwyz->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyPa,Qzwb,xwzy->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyPa,zwyb,Qxwz->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyPa,zwyb,Qxzw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyPb,Qa,xy->RPQ', Y_KWCD__baba, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyPb,Qzwa,xwyz->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyPb,Qzwa,xwzy->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyPb,zQwa,xwyz->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyPb,zwya,Qxwz->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyPb,zwya,Qxzw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyPz,Qwab,xzwy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyPz,Qzab,xy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyPz,wzab,Qxwy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyPz,wzab,Qxyw->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyPz,zwab,Qxwy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyPz,zwab,Qxyw->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaP,Qb,xy->RPQ', Y_KWCD__baba, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaP,Qzwb,xwzy->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaP,zQwb,xwyz->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaP,zwyb,Qxzw->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Qwyb,Pwzx->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Qzwb,Pywx->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,wQyb,Pwxz->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,wzPb,Qxwy->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,zQwb,Pyxw->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,zwPb,Qxyw->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzP,Qwab,xzwy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzP,Qwab,xzyw->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzP,Qwba,xzwy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzP,Qwba,xzyw->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyzP,Qzba,xy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzP,zwab,Qxyw->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Qwyb,Pwxz->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyza,Qwyb,Pwzx->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyza,wQyb,Pwxz->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,wQyb,Pwzx->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,zQwb,Pywx->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyza,zQwb,Pyxw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,zwPb,Qxwy->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyza,zwPb,Qxyw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzb,Qwya,Pwxz->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzb,Qwya,Pwzx->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzb,Qzwa,Pywx->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzb,wQya,Pwxz->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzb,wQya,Pwzx->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyzb,wzPa,Qxwy->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzb,zQwa,Pywx->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzb,zQwa,Pyxw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzb,zwPa,Qxwy->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzb,zwPa,Qxyw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzw,Qwab,Pyxz->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzw,Qwab,Pyzx->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzw,Qwba,Pyxz->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzw,Qwba,Pyzx->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzw,Qzba,Pyxw->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iP,Qyab,xy->RPQ', Y_KWCD__bbbb, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQay,yb,Px->RPQ', Y_KWCD__bbbb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQay,yzwb,Pzwx->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQay,zwPb,xywz->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQay,zywb,Pzxw->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iQya,yb,Px->RPQ', Y_KWCD__bbbb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iQya,yzwb,Pzwx->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iQya,yzwb,Pzxw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iQya,zwPb,xywz->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iQya,zwPb,xyzw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iQya,zywb,Pzxw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iQyz,ywab,Pwzx->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iQyz,zwab,Pwxy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iQyz,zwab,Pwyx->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iQyz,zyab,Px->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,jPyz,Qxzy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jQ,Px->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyQz,Pzxy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyzQ,Pzyx->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,jPyz,Qxzy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jQ,Px->RPQ', Y_KWCD__bbbb, t1_xvee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyQz,Pzxy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyzQ,Pzyx->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iy,Qyab,Px->RPQ', Y_KWCD__bbbb, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyPa,Qb,xy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyPa,Qzwb,xwyz->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyPa,Qzwb,xwzy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyPa,zQwb,xwyz->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyPa,zwyb,Qxwz->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyPa,zwyb,Qxzw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyPz,Qwab,xzwy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyPz,Qzab,xy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyPz,zwab,Qxwy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyPz,zwab,Qxyw->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaP,Qb,xy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaP,Qzwb,xwzy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaP,zQwb,xwyz->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaP,zwyb,Qxzw->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Qwyb,Pwzx->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Qzwb,Pywx->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,wQyb,Pwxz->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,wzPb,Qxwy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,zQwb,Pyxw->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,zwPb,Qxyw->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzP,Qwab,xzwy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzP,Qwab,xzyw->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyzP,Qzab,xy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzP,zwab,Qxyw->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,Qwyb,Pwxz->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Qwyb,Pwzx->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyza,Qzwb,Pywx->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,wQyb,Pwxz->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,wQyb,Pwzx->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyza,wzPb,Qxwy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,zQwb,Pywx->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,zQwb,Pyxw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,zwPb,Qxwy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,zwPb,Qxyw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzw,Qwab,Pyxz->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzw,Qwab,Pyzx->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyzw,Qzab,Pyxw->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    TY[:, s_a:f_a, s_a:f_a] += temp   
 
    temp =- 1/4 * einsum('RixQa,ijPa,jy,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jy,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iy,yzPa,xz->RPQ', Y_KWCD__aaaa, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iy,zyPa,xz->RPQ', Y_KWCD__aaaa, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyPz,wuya,xzuw->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,wzua,xuyw->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,za,xy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,zwua,xuwy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyaz,wuyP,xzuw->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyaz,wzuP,xuyw->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyaz,zP,xy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyaz,zwuP,xuwy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzP,wuya,xzuw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzP,wuya,xzwu->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzP,wzua,xuyw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzP,za,xy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzP,zwua,xuwy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzP,zwua,xuyw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyza,wuyP,xzuw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyza,wuyP,xzwu->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyza,wzuP,xuyw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyza,zP,xy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyza,zwuP,xuwy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyza,zwuP,xuyw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzw,uwPa,xzuy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzw,uwPa,xzyu->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyzw,uzPa,xwuy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzw,wuPa,xzuy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzw,wuPa,xzyu->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyzw,wzPa,xy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzw,zuPa,xwuy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzw,zwPa,xy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,jiPa,jy,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,jiPa,jyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,jiPa,jy,xy->RPQ', Y_KWCD__aaaa, t1_vxee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,jiPa,jyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_vxee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jy,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jyzw,xyzw->RPQ', Y_KWCD__abab, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jy,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jyzw,xyzw->RPQ', Y_KWCD__abab, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iy,yzPa,xz->RPQ', Y_KWCD__abab, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyPz,wuya,xzuw->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,wzua,xuyw->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,za,xy->RPQ', Y_KWCD__abab, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,zwua,xuwy->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,iyzP,wuya,xzuw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzP,wuya,xzwu->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixQa,iyzP,zwua,xuwy->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzP,zwua,xuyw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyza,wuyP,xzuw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixQa,iyza,wuyP,xzwu->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyza,wzuP,xuyw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyza,zP,xy->RPQ', Y_KWCD__abab, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyza,zwuP,xuwy->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,iyza,zwuP,xuyw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzw,uwPa,xzuy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,iyzw,uwPa,xzyu->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,iyzw,wuPa,xzuy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzw,wuPa,xzyu->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzw,zuPa,xwuy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzw,zwPa,xy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iy,zyPa,xz->RPQ', Y_KWCD__abab, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyaz,wuyP,xzuw->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iyaz,wzuP,xuyw->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iyaz,zP,xy->RPQ', Y_KWCD__abab, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iyaz,zwuP,xuwy->RPQ', Y_KWCD__abab, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,iyzP,wuya,xzuw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,iyzP,wuya,xzwu->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyzP,wzua,xuyw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyzP,za,xy->RPQ', Y_KWCD__abab, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/12 * einsum('RixaQ,iyzP,zwua,xuwy->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixaQ,iyzP,zwua,xuyw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixaQ,iyza,wuyP,xzuw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixaQ,iyza,wuyP,xzwu->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,iyza,zwuP,xuwy->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,iyza,zwuP,xuyw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,iyzw,uwPa,xzuy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,iyzw,uwPa,xzyu->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iyzw,uzPa,xwuy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,iyzw,wuPa,xzuy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,iyzw,wuPa,xzyu->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iyzw,wzPa,xy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,jiPa,jy,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,jiPa,jyzw,xyzw->RPQ', Y_KWCD__abab, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,jiPa,jy,xy->RPQ', Y_KWCD__abab, t1_vxee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,jiPa,jyzw,xyzw->RPQ', Y_KWCD__abab, t1_vxee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jy,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jyzw,xyzw->RPQ', Y_KWCD__baba, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jy,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jyzw,xyzw->RPQ', Y_KWCD__baba, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iy,yzPa,xz->RPQ', Y_KWCD__baba, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyPz,wuya,xzuw->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,wzua,xuyw->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,za,xy->RPQ', Y_KWCD__baba, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,zwua,xuwy->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,iyzP,wuya,xzuw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzP,wuya,xzwu->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixQa,iyzP,zwua,xuwy->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzP,zwua,xuyw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyza,wuyP,xzuw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixQa,iyza,wuyP,xzwu->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyza,wzuP,xuyw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyza,zP,xy->RPQ', Y_KWCD__baba, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyza,zwuP,xuwy->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,iyza,zwuP,xuyw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzw,uwPa,xzuy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,iyzw,uwPa,xzyu->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,iyzw,wuPa,xzuy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzw,wuPa,xzyu->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzw,zuPa,xwuy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzw,zwPa,xy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iy,zyPa,xz->RPQ', Y_KWCD__baba, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyaz,wuyP,xzuw->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iyaz,wzuP,xuyw->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iyaz,zP,xy->RPQ', Y_KWCD__baba, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iyaz,zwuP,xuwy->RPQ', Y_KWCD__baba, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,iyzP,wuya,xzuw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,iyzP,wuya,xzwu->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyzP,wzua,xuyw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyzP,za,xy->RPQ', Y_KWCD__baba, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/12 * einsum('RixaQ,iyzP,zwua,xuwy->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixaQ,iyzP,zwua,xuyw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixaQ,iyza,wuyP,xzuw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixaQ,iyza,wuyP,xzwu->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,iyza,zwuP,xuwy->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,iyza,zwuP,xuyw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,iyzw,uwPa,xzuy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,iyzw,uwPa,xzyu->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iyzw,uzPa,xwuy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,iyzw,wuPa,xzuy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,iyzw,wuPa,xzyu->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iyzw,wzPa,xy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,jiPa,jy,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,jiPa,jyzw,xyzw->RPQ', Y_KWCD__baba, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,jiPa,jy,xy->RPQ', Y_KWCD__baba, t1_vxee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,jiPa,jyzw,xyzw->RPQ', Y_KWCD__baba, t1_vxee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jy,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jy,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iy,yzPa,xz->RPQ', Y_KWCD__bbbb, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iy,zyPa,xz->RPQ', Y_KWCD__bbbb, t1_xa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyPz,wuya,xzuw->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,wzua,xuyw->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,za,xy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,zwua,xuwy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyaz,wuyP,xzuw->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyaz,wzuP,xuyw->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyaz,zP,xy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyaz,zwuP,xuwy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzP,wuya,xzuw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzP,wuya,xzwu->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzP,wzua,xuyw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzP,za,xy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzP,zwua,xuwy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzP,zwua,xuyw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyza,wuyP,xzuw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyza,wuyP,xzwu->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyza,wzuP,xuyw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyza,zP,xy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyza,zwuP,xuwy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyza,zwuP,xuyw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzw,uwPa,xzuy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzw,uwPa,xzyu->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyzw,uzPa,xwuy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzw,wuPa,xzuy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzw,wuPa,xzyu->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyzw,wzPa,xy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzw,zuPa,xwuy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzw,zwPa,xy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,jiPa,jy,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,jiPa,jyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,jiPa,jy,xy->RPQ', Y_KWCD__bbbb, t1_vxee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,jiPa,jyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_vxee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    TY[:, s_e:f_e, s_e:f_e] += temp    

    temp  = 1/4 * einsum('RPxab,Qiab,iy,xy->RPQ', Y_KWCD__aaaa, t1_vxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_vxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iy,xy->RPQ', Y_KWCD__aaaa, t1_vvee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_vvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyaz,wuyb,xzuw->RPQ', Y_KWCD__aaaa, t1_vaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,wzub,xuyw->RPQ', Y_KWCD__aaaa, t1_vaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,zb,xy->RPQ', Y_KWCD__aaaa, t1_vaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,zwub,xuwy->RPQ', Y_KWCD__aaaa, t1_vaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,Qyza,wuyb,xzuw->RPQ', Y_KWCD__aaaa, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,Qyza,wuyb,xzwu->RPQ', Y_KWCD__aaaa, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyza,wzub,xuyw->RPQ', Y_KWCD__aaaa, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyza,zb,xy->RPQ', Y_KWCD__aaaa, t1_vaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,Qyza,zwub,xuwy->RPQ', Y_KWCD__aaaa, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,Qyza,zwub,xuyw->RPQ', Y_KWCD__aaaa, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,yzab,Qwuy,xuwz->RPQ', Y_KWCD__aaaa, t1_aaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzab,Qwuy,xuzw->RPQ', Y_KWCD__aaaa, t1_aaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qwyu,xuzw->RPQ', Y_KWCD__aaaa, t1_aaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qwyz,xw->RPQ', Y_KWCD__aaaa, t1_aaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qy,xz->RPQ', Y_KWCD__aaaa, t1_aaee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piab,Qy,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piab,Qyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xxee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Qiab,Py,xy->RPQ', Y_KWCD__aaaa, t1_vxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Qiab,Pyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_vxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iy,xy->RPQ', Y_KWCD__abab, t1_vxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iyzw,xyzw->RPQ', Y_KWCD__abab, t1_vxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iy,xy->RPQ', Y_KWCD__abab, t1_vvee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iyzw,xyzw->RPQ', Y_KWCD__abab, t1_vvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyaz,wuyb,xzuw->RPQ', Y_KWCD__abab, t1_vaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,wzub,xuyw->RPQ', Y_KWCD__abab, t1_vaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,zb,xy->RPQ', Y_KWCD__abab, t1_vaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,zwub,xuwy->RPQ', Y_KWCD__abab, t1_vaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,Qyza,wuyb,xzuw->RPQ', Y_KWCD__abab, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,Qyza,wuyb,xzwu->RPQ', Y_KWCD__abab, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,Qyza,zwub,xuwy->RPQ', Y_KWCD__abab, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,Qyza,zwub,xuyw->RPQ', Y_KWCD__abab, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ya,Qzyb,xz->RPQ', Y_KWCD__abab, t1_ae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzab,Qwuy,xuwz->RPQ', Y_KWCD__abab, t1_aaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,yzab,Qwuy,xuzw->RPQ', Y_KWCD__abab, t1_aaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,yzab,Qwuz,xuwy->RPQ', Y_KWCD__abab, t1_aaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzab,Qwuz,xuyw->RPQ', Y_KWCD__abab, t1_aaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qwyu,xuzw->RPQ', Y_KWCD__abab, t1_aaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qwyz,xw->RPQ', Y_KWCD__abab, t1_aaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qy,xz->RPQ', Y_KWCD__abab, t1_aaee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,yzwa,Quyb,xwuz->RPQ', Y_KWCD__abab, t1_aaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzwa,Quyb,xwzu->RPQ', Y_KWCD__abab, t1_aaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzwa,Quzb,xwuy->RPQ', Y_KWCD__abab, t1_aaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,yzwa,Qwub,xuyz->RPQ', Y_KWCD__abab, t1_aaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,yzwa,Qwub,xuzy->RPQ', Y_KWCD__abab, t1_aaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piba,Qy,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piba,Qyzw,xyzw->RPQ', Y_KWCD__abab, t1_xxee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Qiba,Py,xy->RPQ', Y_KWCD__abab, t1_vxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Qiba,Pyzw,xyzw->RPQ', Y_KWCD__abab, t1_vxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iy,xy->RPQ', Y_KWCD__baba, t1_vxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iyzw,xyzw->RPQ', Y_KWCD__baba, t1_vxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iy,xy->RPQ', Y_KWCD__baba, t1_vvee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iyzw,xyzw->RPQ', Y_KWCD__baba, t1_vvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyaz,wuyb,xzuw->RPQ', Y_KWCD__baba, t1_vaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,wzub,xuyw->RPQ', Y_KWCD__baba, t1_vaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,zb,xy->RPQ', Y_KWCD__baba, t1_vaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,zwub,xuwy->RPQ', Y_KWCD__baba, t1_vaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,Qyza,wuyb,xzuw->RPQ', Y_KWCD__baba, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,Qyza,wuyb,xzwu->RPQ', Y_KWCD__baba, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,Qyza,zwub,xuwy->RPQ', Y_KWCD__baba, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,Qyza,zwub,xuyw->RPQ', Y_KWCD__baba, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ya,Qzyb,xz->RPQ', Y_KWCD__baba, t1_ae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzab,Qwuy,xuwz->RPQ', Y_KWCD__baba, t1_aaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,yzab,Qwuy,xuzw->RPQ', Y_KWCD__baba, t1_aaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,yzab,Qwuz,xuwy->RPQ', Y_KWCD__baba, t1_aaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzab,Qwuz,xuyw->RPQ', Y_KWCD__baba, t1_aaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qwyu,xuzw->RPQ', Y_KWCD__baba, t1_aaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qwyz,xw->RPQ', Y_KWCD__baba, t1_aaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qy,xz->RPQ', Y_KWCD__baba, t1_aaee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,yzwa,Quyb,xwuz->RPQ', Y_KWCD__baba, t1_aaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzwa,Quyb,xwzu->RPQ', Y_KWCD__baba, t1_aaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzwa,Quzb,xwuy->RPQ', Y_KWCD__baba, t1_aaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,yzwa,Qwub,xuyz->RPQ', Y_KWCD__baba, t1_aaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,yzwa,Qwub,xuzy->RPQ', Y_KWCD__baba, t1_aaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piba,Qy,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piba,Qyzw,xyzw->RPQ', Y_KWCD__baba, t1_xxee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Qiba,Py,xy->RPQ', Y_KWCD__baba, t1_vxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Qiba,Pyzw,xyzw->RPQ', Y_KWCD__baba, t1_vxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iy,xy->RPQ', Y_KWCD__bbbb, t1_vxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_vxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iy,xy->RPQ', Y_KWCD__bbbb, t1_vvee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qiab,iyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_vvee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyaz,wuyb,xzuw->RPQ', Y_KWCD__bbbb, t1_vaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,wzub,xuyw->RPQ', Y_KWCD__bbbb, t1_vaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,zb,xy->RPQ', Y_KWCD__bbbb, t1_vaea, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,Qyaz,zwub,xuwy->RPQ', Y_KWCD__bbbb, t1_vaea, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,Qyza,wuyb,xzuw->RPQ', Y_KWCD__bbbb, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,Qyza,wuyb,xzwu->RPQ', Y_KWCD__bbbb, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyza,wzub,xuyw->RPQ', Y_KWCD__bbbb, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyza,zb,xy->RPQ', Y_KWCD__bbbb, t1_vaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,Qyza,zwub,xuwy->RPQ', Y_KWCD__bbbb, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,Qyza,zwub,xuyw->RPQ', Y_KWCD__bbbb, t1_vaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,yzab,Qwuy,xuwz->RPQ', Y_KWCD__bbbb, t1_aaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzab,Qwuy,xuzw->RPQ', Y_KWCD__bbbb, t1_aaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qwyu,xuzw->RPQ', Y_KWCD__bbbb, t1_aaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qwyz,xw->RPQ', Y_KWCD__bbbb, t1_aaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzab,Qy,xz->RPQ', Y_KWCD__bbbb, t1_aaee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piab,Qy,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piab,Qyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xxee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Qiab,Py,xy->RPQ', Y_KWCD__bbbb, t1_vxee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Qiab,Pyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_vxee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    TY[:, s_c:f_c, s_v:f_v] += temp   
 
    temp  = 1/12 * einsum('RPxab,Qyza,wuyb,xzuw->RPQ', Y_KWCD__aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,Qyza,wuyb,xzwu->RPQ', Y_KWCD__aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyza,wzub,xuyw->RPQ', Y_KWCD__aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyza,zb,xy->RPQ', Y_KWCD__aaaa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,Qyza,zwub,xuwy->RPQ', Y_KWCD__aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,Qyza,zwub,xuyw->RPQ', Y_KWCD__aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,iQba,iy,xy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,iQba,iyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,ijQy,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,ijQy,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,iQ,xy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,izQw,xzyw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,iyab,izwQ,xzwy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyab,izwQ,xzyw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,iQba,iy,xy->RPQ', Y_KWCD__aaaa, t1_vaee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,iQba,iyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,ijQy,xy->RPQ', Y_KWCD__aaaa, t1_vxee, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,ijQy,xy->RPQ', Y_KWCD__aaaa, t1_vvee, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,iQ,xy->RPQ', Y_KWCD__aaaa, t1_vaee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,izQw,xzyw->RPQ', Y_KWCD__aaaa, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,iyab,izwQ,xzwy->RPQ', Y_KWCD__aaaa, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyab,izwQ,xzyw->RPQ', Y_KWCD__aaaa, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,yQza,wuyb,xzuw->RPQ', Y_KWCD__aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yQza,wzub,xuyw->RPQ', Y_KWCD__aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yQza,zb,xy->RPQ', Y_KWCD__aaaa, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yQza,zwub,xuwy->RPQ', Y_KWCD__aaaa, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,PiQy,yzab,xz->RPQ', Y_KWCD__aaaa, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,PiyQ,yzab,xz->RPQ', Y_KWCD__aaaa, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,yb,Qx->RPQ', Y_KWCD__aaaa, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piya,yzQb,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,yzwb,Qzwx->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piya,zwQb,xywz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piya,zyQb,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,zywb,Qzxw->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,Piyz,ywab,Qwxz->RPQ', Y_KWCD__aaaa, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,Piyz,ywab,Qwzx->RPQ', Y_KWCD__aaaa, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piyz,yzab,Qx->RPQ', Y_KWCD__aaaa, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piyz,zwab,Qwyx->RPQ', Y_KWCD__aaaa, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yb,Qx->RPQ', Y_KWCD__aaaa, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yzQb,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iPya,yzwb,Qzwx->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iPya,yzwb,Qzxw->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iPya,zyQb,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,zywb,Qzxw->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__aaaa, t1_xa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQba,Py,xy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQba,Pyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,PjQy,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,Pjyz,Qxyz->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,PjQy,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,Pjyz,Qxyz->RPQ', Y_KWCD__aaaa, t1_xvee, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iy,Pyab,Qx->RPQ', Y_KWCD__aaaa, t1_xa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,Pb,xy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,Pzbw,xwyz->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyQa,Pzby,xz->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQa,Pzyb,xz->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzbw,xwyz->RPQ', Y_KWCD__aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaQ,Pzby,xz->RPQ', Y_KWCD__aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaQ,Pzyb,xz->RPQ', Y_KWCD__aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Py,Qx->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PyQz,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PyzQ,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pyzw,Qxzw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PzQy,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pzwy,Qzwx->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PzyQ,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pzyw,Qzxw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Pwby,Qwxz->RPQ', Y_KWCD__aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Pwyb,Qwzx->RPQ', Y_KWCD__aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaz,PzQb,xy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,PzbQ,xy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Pzbw,Qyxw->RPQ', Y_KWCD__aaaa, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Pzwb,Qywx->RPQ', Y_KWCD__aaaa, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyzQ,Pzab,xy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pwby,Qwxz->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,Pwby,Qwzx->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,Pwyb,Qwxz->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pwyb,Qwzx->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyza,PzQb,xy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyza,PzbQ,xy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pzbw,Qywx->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,Pzbw,Qyxw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyza,Pzwb,Qywx->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzw,Pwab,Qyxz->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzw,Pwab,Qyzx->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyzw,Pzab,Qyxw->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,Qyza,wuyb,xzuw->RPQ', Y_KWCD__abab, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,Qyza,wuyb,xzwu->RPQ', Y_KWCD__abab, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,Qyza,zwub,xuwy->RPQ', Y_KWCD__abab, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,Qyza,zwub,xuyw->RPQ', Y_KWCD__abab, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,iQba,iy,xy->RPQ', Y_KWCD__abab, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,iQba,iyzw,xyzw->RPQ', Y_KWCD__abab, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,ijQy,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,ijQy,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,iQ,xy->RPQ', Y_KWCD__abab, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,izQw,xzyw->RPQ', Y_KWCD__abab, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyab,izwQ,xzwy->RPQ', Y_KWCD__abab, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,iyab,izwQ,xzyw->RPQ', Y_KWCD__abab, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,iyba,izwQ,xzwy->RPQ', Y_KWCD__abab, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyba,izwQ,xzyw->RPQ', Y_KWCD__abab, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,iQba,iy,xy->RPQ', Y_KWCD__abab, t1_vaee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,iQba,iyzw,xyzw->RPQ', Y_KWCD__abab, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,ijQy,xy->RPQ', Y_KWCD__abab, t1_vxee, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,ijQy,xy->RPQ', Y_KWCD__abab, t1_vvee, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,iQ,xy->RPQ', Y_KWCD__abab, t1_vaee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,izQw,xzyw->RPQ', Y_KWCD__abab, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyab,izwQ,xzwy->RPQ', Y_KWCD__abab, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,iyab,izwQ,xzyw->RPQ', Y_KWCD__abab, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,iyba,izwQ,xzwy->RPQ', Y_KWCD__abab, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyba,izwQ,xzyw->RPQ', Y_KWCD__abab, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,yQza,wuyb,xzuw->RPQ', Y_KWCD__abab, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yQza,wzub,xuyw->RPQ', Y_KWCD__abab, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yQza,zb,xy->RPQ', Y_KWCD__abab, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yQza,zwub,xuwy->RPQ', Y_KWCD__abab, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ya,Qzyb,xz->RPQ', Y_KWCD__abab, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,yzwa,Quyb,xwuz->RPQ', Y_KWCD__abab, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzwa,Quyb,xwzu->RPQ', Y_KWCD__abab, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzwa,Quzb,xwuy->RPQ', Y_KWCD__abab, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,yzwa,Qwub,xuyz->RPQ', Y_KWCD__abab, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,yzwa,Qwub,xuzy->RPQ', Y_KWCD__abab, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,PiQy,yzab,xz->RPQ', Y_KWCD__abab, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,PiyQ,yzab,xz->RPQ', Y_KWCD__abab, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,yb,Qx->RPQ', Y_KWCD__abab, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piya,yzQb,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,yzwb,Qzwx->RPQ', Y_KWCD__abab, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piya,zwQb,xywz->RPQ', Y_KWCD__abab, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piya,zyQb,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,zywb,Qzxw->RPQ', Y_KWCD__abab, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,Piyz,wyab,Qwxz->RPQ', Y_KWCD__abab, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,Piyz,wyab,Qwzx->RPQ', Y_KWCD__abab, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,Piyz,ywab,Qwxz->RPQ', Y_KWCD__abab, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,Piyz,ywab,Qwzx->RPQ', Y_KWCD__abab, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piyz,zwab,Qwyx->RPQ', Y_KWCD__abab, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piyz,zyab,Qx->RPQ', Y_KWCD__abab, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yzQb,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iPya,yzwb,Qzwx->RPQ', Y_KWCD__abab, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iPya,yzwb,Qzxw->RPQ', Y_KWCD__abab, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__abab, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__abab, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iPyb,ya,Qx->RPQ', Y_KWCD__abab, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iPyb,yzwa,Qzwx->RPQ', Y_KWCD__abab, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iPyb,yzwa,Qzxw->RPQ', Y_KWCD__abab, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPyb,zwQa,xywz->RPQ', Y_KWCD__abab, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPyb,zwQa,xyzw->RPQ', Y_KWCD__abab, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPyb,zyQa,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iPyb,zywa,Qzxw->RPQ', Y_KWCD__abab, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__abab, t1_xa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iQab,Py,xy->RPQ', Y_KWCD__abab, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iQab,Pyzw,xyzw->RPQ', Y_KWCD__abab, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,PjQy,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,Pjyz,Qxyz->RPQ', Y_KWCD__abab, t1_xxee, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,PjQy,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,Pjyz,Qxyz->RPQ', Y_KWCD__abab, t1_xvee, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iy,Pyba,Qx->RPQ', Y_KWCD__abab, t1_xa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__abab, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__abab, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQa,Pzyb,xz->RPQ', Y_KWCD__abab, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,Pa,xy->RPQ', Y_KWCD__abab, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,Pzaw,xwyz->RPQ', Y_KWCD__abab, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQb,Pzay,xz->RPQ', Y_KWCD__abab, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQb,Pzwa,xwyz->RPQ', Y_KWCD__abab, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQb,Pzwa,xwzy->RPQ', Y_KWCD__abab, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__abab, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__abab, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__abab, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzbw,xwyz->RPQ', Y_KWCD__abab, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaQ,Pzby,xz->RPQ', Y_KWCD__abab, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__abab, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaQ,Pzyb,xz->RPQ', Y_KWCD__abab, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Py,Qx->RPQ', Y_KWCD__abab, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PyQz,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PyzQ,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pyzw,Qxzw->RPQ', Y_KWCD__abab, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PzQy,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pzwy,Qzwx->RPQ', Y_KWCD__abab, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PzyQ,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pzyw,Qzxw->RPQ', Y_KWCD__abab, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Pwby,Qwxz->RPQ', Y_KWCD__abab, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Pwyb,Qwzx->RPQ', Y_KWCD__abab, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaz,PzQb,xy->RPQ', Y_KWCD__abab, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,PzbQ,xy->RPQ', Y_KWCD__abab, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Pzbw,Qyxw->RPQ', Y_KWCD__abab, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Pzwb,Qywx->RPQ', Y_KWCD__abab, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__abab, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__abab, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwba,xzwy->RPQ', Y_KWCD__abab, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwba,xzyw->RPQ', Y_KWCD__abab, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzQ,Pzba,xy->RPQ', Y_KWCD__abab, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyza,Pwby,Qwxz->RPQ', Y_KWCD__abab, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pwby,Qwzx->RPQ', Y_KWCD__abab, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pwyb,Qwxz->RPQ', Y_KWCD__abab, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyza,Pwyb,Qwzx->RPQ', Y_KWCD__abab, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,Pzbw,Qywx->RPQ', Y_KWCD__abab, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyza,Pzbw,Qyxw->RPQ', Y_KWCD__abab, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzb,Pway,Qwxz->RPQ', Y_KWCD__abab, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzb,Pway,Qwzx->RPQ', Y_KWCD__abab, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzb,Pwya,Qwxz->RPQ', Y_KWCD__abab, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzb,Pwya,Qwzx->RPQ', Y_KWCD__abab, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyzb,PzQa,xy->RPQ', Y_KWCD__abab, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzb,PzaQ,xy->RPQ', Y_KWCD__abab, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzb,Pzaw,Qywx->RPQ', Y_KWCD__abab, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzb,Pzaw,Qyxw->RPQ', Y_KWCD__abab, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzb,Pzwa,Qywx->RPQ', Y_KWCD__abab, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzw,Pwab,Qyxz->RPQ', Y_KWCD__abab, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzw,Pwab,Qyzx->RPQ', Y_KWCD__abab, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzw,Pwba,Qyxz->RPQ', Y_KWCD__abab, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzw,Pwba,Qyzx->RPQ', Y_KWCD__abab, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzw,Pzba,Qyxw->RPQ', Y_KWCD__abab, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,Qyza,wuyb,xzuw->RPQ', Y_KWCD__baba, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,Qyza,wuyb,xzwu->RPQ', Y_KWCD__baba, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,Qyza,zwub,xuwy->RPQ', Y_KWCD__baba, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,Qyza,zwub,xuyw->RPQ', Y_KWCD__baba, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,iQba,iy,xy->RPQ', Y_KWCD__baba, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,iQba,iyzw,xyzw->RPQ', Y_KWCD__baba, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,ijQy,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,ijQy,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,iQ,xy->RPQ', Y_KWCD__baba, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,izQw,xzyw->RPQ', Y_KWCD__baba, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyab,izwQ,xzwy->RPQ', Y_KWCD__baba, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,iyab,izwQ,xzyw->RPQ', Y_KWCD__baba, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,iyba,izwQ,xzwy->RPQ', Y_KWCD__baba, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyba,izwQ,xzyw->RPQ', Y_KWCD__baba, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,iQba,iy,xy->RPQ', Y_KWCD__baba, t1_vaee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,iQba,iyzw,xyzw->RPQ', Y_KWCD__baba, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,ijQy,xy->RPQ', Y_KWCD__baba, t1_vxee, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,ijQy,xy->RPQ', Y_KWCD__baba, t1_vvee, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,iQ,xy->RPQ', Y_KWCD__baba, t1_vaee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,izQw,xzyw->RPQ', Y_KWCD__baba, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyab,izwQ,xzwy->RPQ', Y_KWCD__baba, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,iyab,izwQ,xzyw->RPQ', Y_KWCD__baba, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,iyba,izwQ,xzwy->RPQ', Y_KWCD__baba, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyba,izwQ,xzyw->RPQ', Y_KWCD__baba, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,yQza,wuyb,xzuw->RPQ', Y_KWCD__baba, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yQza,wzub,xuyw->RPQ', Y_KWCD__baba, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yQza,zb,xy->RPQ', Y_KWCD__baba, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yQza,zwub,xuwy->RPQ', Y_KWCD__baba, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ya,Qzyb,xz->RPQ', Y_KWCD__baba, t1_ae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('RPxab,yzwa,Quyb,xwuz->RPQ', Y_KWCD__baba, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzwa,Quyb,xwzu->RPQ', Y_KWCD__baba, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yzwa,Quzb,xwuy->RPQ', Y_KWCD__baba, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,yzwa,Qwub,xuyz->RPQ', Y_KWCD__baba, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,yzwa,Qwub,xuzy->RPQ', Y_KWCD__baba, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,PiQy,yzab,xz->RPQ', Y_KWCD__baba, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,PiyQ,yzab,xz->RPQ', Y_KWCD__baba, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,yb,Qx->RPQ', Y_KWCD__baba, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piya,yzQb,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,yzwb,Qzwx->RPQ', Y_KWCD__baba, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piya,zwQb,xywz->RPQ', Y_KWCD__baba, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piya,zyQb,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,zywb,Qzxw->RPQ', Y_KWCD__baba, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,Piyz,wyab,Qwxz->RPQ', Y_KWCD__baba, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,Piyz,wyab,Qwzx->RPQ', Y_KWCD__baba, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,Piyz,ywab,Qwxz->RPQ', Y_KWCD__baba, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,Piyz,ywab,Qwzx->RPQ', Y_KWCD__baba, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piyz,zwab,Qwyx->RPQ', Y_KWCD__baba, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piyz,zyab,Qx->RPQ', Y_KWCD__baba, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yzQb,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iPya,yzwb,Qzwx->RPQ', Y_KWCD__baba, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iPya,yzwb,Qzxw->RPQ', Y_KWCD__baba, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__baba, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__baba, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iPyb,ya,Qx->RPQ', Y_KWCD__baba, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iPyb,yzwa,Qzwx->RPQ', Y_KWCD__baba, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iPyb,yzwa,Qzxw->RPQ', Y_KWCD__baba, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPyb,zwQa,xywz->RPQ', Y_KWCD__baba, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPyb,zwQa,xyzw->RPQ', Y_KWCD__baba, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPyb,zyQa,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iPyb,zywa,Qzxw->RPQ', Y_KWCD__baba, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__baba, t1_xa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iQab,Py,xy->RPQ', Y_KWCD__baba, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iQab,Pyzw,xyzw->RPQ', Y_KWCD__baba, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,PjQy,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,Pjyz,Qxyz->RPQ', Y_KWCD__baba, t1_xxee, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,PjQy,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,Pjyz,Qxyz->RPQ', Y_KWCD__baba, t1_xvee, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iy,Pyba,Qx->RPQ', Y_KWCD__baba, t1_xa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__baba, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__baba, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQa,Pzyb,xz->RPQ', Y_KWCD__baba, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,Pa,xy->RPQ', Y_KWCD__baba, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,Pzaw,xwyz->RPQ', Y_KWCD__baba, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQb,Pzay,xz->RPQ', Y_KWCD__baba, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQb,Pzwa,xwyz->RPQ', Y_KWCD__baba, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQb,Pzwa,xwzy->RPQ', Y_KWCD__baba, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__baba, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__baba, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__baba, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzbw,xwyz->RPQ', Y_KWCD__baba, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaQ,Pzby,xz->RPQ', Y_KWCD__baba, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__baba, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaQ,Pzyb,xz->RPQ', Y_KWCD__baba, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Py,Qx->RPQ', Y_KWCD__baba, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PyQz,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PyzQ,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pyzw,Qxzw->RPQ', Y_KWCD__baba, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PzQy,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pzwy,Qzwx->RPQ', Y_KWCD__baba, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PzyQ,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pzyw,Qzxw->RPQ', Y_KWCD__baba, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Pwby,Qwxz->RPQ', Y_KWCD__baba, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Pwyb,Qwzx->RPQ', Y_KWCD__baba, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaz,PzQb,xy->RPQ', Y_KWCD__baba, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,PzbQ,xy->RPQ', Y_KWCD__baba, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Pzbw,Qyxw->RPQ', Y_KWCD__baba, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Pzwb,Qywx->RPQ', Y_KWCD__baba, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__baba, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__baba, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwba,xzwy->RPQ', Y_KWCD__baba, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwba,xzyw->RPQ', Y_KWCD__baba, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzQ,Pzba,xy->RPQ', Y_KWCD__baba, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyza,Pwby,Qwxz->RPQ', Y_KWCD__baba, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pwby,Qwzx->RPQ', Y_KWCD__baba, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pwyb,Qwxz->RPQ', Y_KWCD__baba, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyza,Pwyb,Qwzx->RPQ', Y_KWCD__baba, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,Pzbw,Qywx->RPQ', Y_KWCD__baba, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyza,Pzbw,Qyxw->RPQ', Y_KWCD__baba, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzb,Pway,Qwxz->RPQ', Y_KWCD__baba, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzb,Pway,Qwzx->RPQ', Y_KWCD__baba, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzb,Pwya,Qwxz->RPQ', Y_KWCD__baba, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzb,Pwya,Qwzx->RPQ', Y_KWCD__baba, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyzb,PzQa,xy->RPQ', Y_KWCD__baba, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzb,PzaQ,xy->RPQ', Y_KWCD__baba, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzb,Pzaw,Qywx->RPQ', Y_KWCD__baba, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzb,Pzaw,Qyxw->RPQ', Y_KWCD__baba, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzb,Pzwa,Qywx->RPQ', Y_KWCD__baba, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzw,Pwab,Qyxz->RPQ', Y_KWCD__baba, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzw,Pwab,Qyzx->RPQ', Y_KWCD__baba, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzw,Pwba,Qyxz->RPQ', Y_KWCD__baba, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzw,Pwba,Qyzx->RPQ', Y_KWCD__baba, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzw,Pzba,Qyxw->RPQ', Y_KWCD__baba, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,Qyza,wuyb,xzuw->RPQ', Y_KWCD__bbbb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,Qyza,wuyb,xzwu->RPQ', Y_KWCD__bbbb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyza,wzub,xuyw->RPQ', Y_KWCD__bbbb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,Qyza,zb,xy->RPQ', Y_KWCD__bbbb, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,Qyza,zwub,xuwy->RPQ', Y_KWCD__bbbb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,Qyza,zwub,xuyw->RPQ', Y_KWCD__bbbb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,iQba,iy,xy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,iQba,iyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,ijQy,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,ijQy,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,iQ,xy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,izQw,xzyw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,iyab,izwQ,xzwy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyab,izwQ,xzyw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,iQba,iy,xy->RPQ', Y_KWCD__bbbb, t1_vaee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,iQba,iyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,ijQy,xy->RPQ', Y_KWCD__bbbb, t1_vxee, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,ijQy,xy->RPQ', Y_KWCD__bbbb, t1_vvee, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,iQ,xy->RPQ', Y_KWCD__bbbb, t1_vaee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,izQw,xzyw->RPQ', Y_KWCD__bbbb, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,iyab,izwQ,xzwy->RPQ', Y_KWCD__bbbb, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyab,izwQ,xzyw->RPQ', Y_KWCD__bbbb, t1_vaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,yQza,wuyb,xzuw->RPQ', Y_KWCD__bbbb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yQza,wzub,xuyw->RPQ', Y_KWCD__bbbb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yQza,zb,xy->RPQ', Y_KWCD__bbbb, t1_aaae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,yQza,zwub,xuwy->RPQ', Y_KWCD__bbbb, t1_aaae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,PiQy,yzab,xz->RPQ', Y_KWCD__bbbb, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,PiyQ,yzab,xz->RPQ', Y_KWCD__bbbb, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,yb,Qx->RPQ', Y_KWCD__bbbb, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piya,yzQb,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,yzwb,Qzwx->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piya,zwQb,xywz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piya,zyQb,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,zywb,Qzxw->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,Piyz,ywab,Qwxz->RPQ', Y_KWCD__bbbb, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,Piyz,ywab,Qwzx->RPQ', Y_KWCD__bbbb, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piyz,yzab,Qx->RPQ', Y_KWCD__bbbb, t1_xxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piyz,zwab,Qwyx->RPQ', Y_KWCD__bbbb, t1_xxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yb,Qx->RPQ', Y_KWCD__bbbb, t1_xxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yzQb,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iPya,yzwb,Qzwx->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iPya,yzwb,Qzxw->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iPya,zyQb,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,zywb,Qzxw->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__bbbb, t1_xa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQba,Py,xy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQba,Pyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,PjQy,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,Pjyz,Qxyz->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,PjQy,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,Pjyz,Qxyz->RPQ', Y_KWCD__bbbb, t1_xvee, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iy,Pyab,Qx->RPQ', Y_KWCD__bbbb, t1_xa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,Pb,xy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,Pzbw,xwyz->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyQa,Pzby,xz->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQa,Pzyb,xz->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzbw,xwyz->RPQ', Y_KWCD__bbbb, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaQ,Pzby,xz->RPQ', Y_KWCD__bbbb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaQ,Pzyb,xz->RPQ', Y_KWCD__bbbb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Py,Qx->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PyQz,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PyzQ,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pyzw,Qxzw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PzQy,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pzwy,Qzwx->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PzyQ,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pzyw,Qzxw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Pwby,Qwxz->RPQ', Y_KWCD__bbbb, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Pwyb,Qwzx->RPQ', Y_KWCD__bbbb, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaz,PzQb,xy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,PzbQ,xy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Pzbw,Qyxw->RPQ', Y_KWCD__bbbb, t1_xaea, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Pzwb,Qywx->RPQ', Y_KWCD__bbbb, t1_xaea, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyzQ,Pzab,xy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pwby,Qwxz->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,Pwby,Qwzx->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,Pwyb,Qwxz->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pwyb,Qwzx->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyza,PzQb,xy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyza,PzbQ,xy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pzbw,Qywx->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,Pzbw,Qyxw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyza,Pzwb,Qywx->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzw,Pwab,Qyxz->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzw,Pwab,Qyzx->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyzw,Pzab,Qyxw->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_xaee, rdm_ccaa, optimize = einsum_type)
    TY[:, s_c:f_c, s_a:f_a] += temp   
 
    temp =- 1/2 * einsum('Rixab,PiQy,yzab,xz->RPQ', Y_KWCD__aaaa, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,PiyQ,yzab,xz->RPQ', Y_KWCD__aaaa, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,yb,Qx->RPQ', Y_KWCD__aaaa, t1_vxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piya,yzQb,xz->RPQ', Y_KWCD__aaaa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,yzwb,Qzwx->RPQ', Y_KWCD__aaaa, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piya,zwQb,xywz->RPQ', Y_KWCD__aaaa, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piya,zyQb,xz->RPQ', Y_KWCD__aaaa, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,zywb,Qzxw->RPQ', Y_KWCD__aaaa, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,Piyz,ywab,Qwxz->RPQ', Y_KWCD__aaaa, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,Piyz,ywab,Qwzx->RPQ', Y_KWCD__aaaa, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piyz,yzab,Qx->RPQ', Y_KWCD__aaaa, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piyz,zwab,Qwyx->RPQ', Y_KWCD__aaaa, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yb,Qx->RPQ', Y_KWCD__aaaa, t1_xvae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yzQb,xz->RPQ', Y_KWCD__aaaa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iPya,yzwb,Qzwx->RPQ', Y_KWCD__aaaa, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iPya,yzwb,Qzxw->RPQ', Y_KWCD__aaaa, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__aaaa, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__aaaa, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iPya,zyQb,xz->RPQ', Y_KWCD__aaaa, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,zywb,Qzxw->RPQ', Y_KWCD__aaaa, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__aaaa, t1_xa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQba,Py,xy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQba,Pyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,PjQy,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,Pjyz,Qxyz->RPQ', Y_KWCD__aaaa, t1_xxee, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,PjQy,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,Pjyz,Qxyz->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iy,Pyab,Qx->RPQ', Y_KWCD__aaaa, t1_xa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,Pb,xy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,Pzbw,xwyz->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyQa,Pzby,xz->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQa,Pzyb,xz->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzbw,xwyz->RPQ', Y_KWCD__aaaa, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaQ,Pzby,xz->RPQ', Y_KWCD__aaaa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaQ,Pzyb,xz->RPQ', Y_KWCD__aaaa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Py,Qx->RPQ', Y_KWCD__aaaa, t1_xaee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PyQz,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PyzQ,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pyzw,Qxzw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PzQy,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pzwy,Qzwx->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PzyQ,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pzyw,Qzxw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Pwby,Qwxz->RPQ', Y_KWCD__aaaa, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Pwyb,Qwzx->RPQ', Y_KWCD__aaaa, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaz,PzQb,xy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,PzbQ,xy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Pzbw,Qyxw->RPQ', Y_KWCD__aaaa, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Pzwb,Qywx->RPQ', Y_KWCD__aaaa, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyzQ,Pzab,xy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pwby,Qwxz->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,Pwby,Qwzx->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,Pwyb,Qwxz->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pwyb,Qwzx->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyza,PzQb,xy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyza,PzbQ,xy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pzbw,Qywx->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,Pzbw,Qyxw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyza,Pzwb,Qywx->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzw,Pwab,Qyxz->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzw,Pwab,Qyzx->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyzw,Pzab,Qyxw->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,PiQy,yzab,xz->RPQ', Y_KWCD__abab, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,PiyQ,yzab,xz->RPQ', Y_KWCD__abab, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,yb,Qx->RPQ', Y_KWCD__abab, t1_vxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piya,yzQb,xz->RPQ', Y_KWCD__abab, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,yzwb,Qzwx->RPQ', Y_KWCD__abab, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piya,zwQb,xywz->RPQ', Y_KWCD__abab, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piya,zyQb,xz->RPQ', Y_KWCD__abab, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,zywb,Qzxw->RPQ', Y_KWCD__abab, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,Piyz,wyab,Qwxz->RPQ', Y_KWCD__abab, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,Piyz,wyab,Qwzx->RPQ', Y_KWCD__abab, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,Piyz,ywab,Qwxz->RPQ', Y_KWCD__abab, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,Piyz,ywab,Qwzx->RPQ', Y_KWCD__abab, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piyz,zwab,Qwyx->RPQ', Y_KWCD__abab, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piyz,zyab,Qx->RPQ', Y_KWCD__abab, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yzQb,xz->RPQ', Y_KWCD__abab, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iPya,yzwb,Qzwx->RPQ', Y_KWCD__abab, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iPya,yzwb,Qzxw->RPQ', Y_KWCD__abab, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__abab, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__abab, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iPyb,ya,Qx->RPQ', Y_KWCD__abab, t1_xvae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iPyb,yzwa,Qzwx->RPQ', Y_KWCD__abab, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iPyb,yzwa,Qzxw->RPQ', Y_KWCD__abab, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPyb,zwQa,xywz->RPQ', Y_KWCD__abab, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPyb,zwQa,xyzw->RPQ', Y_KWCD__abab, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPyb,zyQa,xz->RPQ', Y_KWCD__abab, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iPyb,zywa,Qzxw->RPQ', Y_KWCD__abab, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__abab, t1_xa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iQab,Py,xy->RPQ', Y_KWCD__abab, t1_xaee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iQab,Pyzw,xyzw->RPQ', Y_KWCD__abab, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,PjQy,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,Pjyz,Qxyz->RPQ', Y_KWCD__abab, t1_xxee, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,PjQy,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,Pjyz,Qxyz->RPQ', Y_KWCD__abab, t1_xvee, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iy,Pyba,Qx->RPQ', Y_KWCD__abab, t1_xa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__abab, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__abab, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQa,Pzyb,xz->RPQ', Y_KWCD__abab, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,Pa,xy->RPQ', Y_KWCD__abab, t1_xaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,Pzaw,xwyz->RPQ', Y_KWCD__abab, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQb,Pzay,xz->RPQ', Y_KWCD__abab, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQb,Pzwa,xwyz->RPQ', Y_KWCD__abab, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQb,Pzwa,xwzy->RPQ', Y_KWCD__abab, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__abab, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__abab, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__abab, t1_xaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzbw,xwyz->RPQ', Y_KWCD__abab, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaQ,Pzby,xz->RPQ', Y_KWCD__abab, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__abab, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaQ,Pzyb,xz->RPQ', Y_KWCD__abab, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Py,Qx->RPQ', Y_KWCD__abab, t1_xaee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PyQz,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PyzQ,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pyzw,Qxzw->RPQ', Y_KWCD__abab, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PzQy,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pzwy,Qzwx->RPQ', Y_KWCD__abab, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PzyQ,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pzyw,Qzxw->RPQ', Y_KWCD__abab, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Pwby,Qwxz->RPQ', Y_KWCD__abab, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Pwyb,Qwzx->RPQ', Y_KWCD__abab, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaz,PzQb,xy->RPQ', Y_KWCD__abab, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,PzbQ,xy->RPQ', Y_KWCD__abab, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Pzbw,Qyxw->RPQ', Y_KWCD__abab, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Pzwb,Qywx->RPQ', Y_KWCD__abab, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__abab, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__abab, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwba,xzwy->RPQ', Y_KWCD__abab, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwba,xzyw->RPQ', Y_KWCD__abab, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzQ,Pzba,xy->RPQ', Y_KWCD__abab, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyza,Pwby,Qwxz->RPQ', Y_KWCD__abab, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pwby,Qwzx->RPQ', Y_KWCD__abab, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pwyb,Qwxz->RPQ', Y_KWCD__abab, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyza,Pwyb,Qwzx->RPQ', Y_KWCD__abab, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,Pzbw,Qywx->RPQ', Y_KWCD__abab, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyza,Pzbw,Qyxw->RPQ', Y_KWCD__abab, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzb,Pway,Qwxz->RPQ', Y_KWCD__abab, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzb,Pway,Qwzx->RPQ', Y_KWCD__abab, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzb,Pwya,Qwxz->RPQ', Y_KWCD__abab, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzb,Pwya,Qwzx->RPQ', Y_KWCD__abab, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyzb,PzQa,xy->RPQ', Y_KWCD__abab, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzb,PzaQ,xy->RPQ', Y_KWCD__abab, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzb,Pzaw,Qywx->RPQ', Y_KWCD__abab, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzb,Pzaw,Qyxw->RPQ', Y_KWCD__abab, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzb,Pzwa,Qywx->RPQ', Y_KWCD__abab, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzw,Pwab,Qyxz->RPQ', Y_KWCD__abab, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzw,Pwab,Qyzx->RPQ', Y_KWCD__abab, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzw,Pwba,Qyxz->RPQ', Y_KWCD__abab, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzw,Pwba,Qyzx->RPQ', Y_KWCD__abab, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzw,Pzba,Qyxw->RPQ', Y_KWCD__abab, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,PiQy,yzab,xz->RPQ', Y_KWCD__baba, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,PiyQ,yzab,xz->RPQ', Y_KWCD__baba, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,yb,Qx->RPQ', Y_KWCD__baba, t1_vxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piya,yzQb,xz->RPQ', Y_KWCD__baba, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,yzwb,Qzwx->RPQ', Y_KWCD__baba, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piya,zwQb,xywz->RPQ', Y_KWCD__baba, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piya,zyQb,xz->RPQ', Y_KWCD__baba, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,zywb,Qzxw->RPQ', Y_KWCD__baba, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,Piyz,wyab,Qwxz->RPQ', Y_KWCD__baba, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,Piyz,wyab,Qwzx->RPQ', Y_KWCD__baba, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,Piyz,ywab,Qwxz->RPQ', Y_KWCD__baba, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,Piyz,ywab,Qwzx->RPQ', Y_KWCD__baba, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piyz,zwab,Qwyx->RPQ', Y_KWCD__baba, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piyz,zyab,Qx->RPQ', Y_KWCD__baba, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yzQb,xz->RPQ', Y_KWCD__baba, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iPya,yzwb,Qzwx->RPQ', Y_KWCD__baba, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iPya,yzwb,Qzxw->RPQ', Y_KWCD__baba, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__baba, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__baba, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iPyb,ya,Qx->RPQ', Y_KWCD__baba, t1_xvae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iPyb,yzwa,Qzwx->RPQ', Y_KWCD__baba, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iPyb,yzwa,Qzxw->RPQ', Y_KWCD__baba, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPyb,zwQa,xywz->RPQ', Y_KWCD__baba, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPyb,zwQa,xyzw->RPQ', Y_KWCD__baba, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPyb,zyQa,xz->RPQ', Y_KWCD__baba, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iPyb,zywa,Qzxw->RPQ', Y_KWCD__baba, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__baba, t1_xa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iQab,Py,xy->RPQ', Y_KWCD__baba, t1_xaee, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iQab,Pyzw,xyzw->RPQ', Y_KWCD__baba, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,PjQy,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,Pjyz,Qxyz->RPQ', Y_KWCD__baba, t1_xxee, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,PjQy,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,Pjyz,Qxyz->RPQ', Y_KWCD__baba, t1_xvee, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iy,Pyba,Qx->RPQ', Y_KWCD__baba, t1_xa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__baba, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__baba, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQa,Pzyb,xz->RPQ', Y_KWCD__baba, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,Pa,xy->RPQ', Y_KWCD__baba, t1_xaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,Pzaw,xwyz->RPQ', Y_KWCD__baba, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQb,Pzay,xz->RPQ', Y_KWCD__baba, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQb,Pzwa,xwyz->RPQ', Y_KWCD__baba, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQb,Pzwa,xwzy->RPQ', Y_KWCD__baba, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__baba, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__baba, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__baba, t1_xaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzbw,xwyz->RPQ', Y_KWCD__baba, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaQ,Pzby,xz->RPQ', Y_KWCD__baba, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__baba, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaQ,Pzyb,xz->RPQ', Y_KWCD__baba, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Py,Qx->RPQ', Y_KWCD__baba, t1_xaee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PyQz,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PyzQ,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pyzw,Qxzw->RPQ', Y_KWCD__baba, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PzQy,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pzwy,Qzwx->RPQ', Y_KWCD__baba, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PzyQ,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pzyw,Qzxw->RPQ', Y_KWCD__baba, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Pwby,Qwxz->RPQ', Y_KWCD__baba, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Pwyb,Qwzx->RPQ', Y_KWCD__baba, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaz,PzQb,xy->RPQ', Y_KWCD__baba, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,PzbQ,xy->RPQ', Y_KWCD__baba, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Pzbw,Qyxw->RPQ', Y_KWCD__baba, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Pzwb,Qywx->RPQ', Y_KWCD__baba, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__baba, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__baba, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwba,xzwy->RPQ', Y_KWCD__baba, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwba,xzyw->RPQ', Y_KWCD__baba, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzQ,Pzba,xy->RPQ', Y_KWCD__baba, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyza,Pwby,Qwxz->RPQ', Y_KWCD__baba, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pwby,Qwzx->RPQ', Y_KWCD__baba, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pwyb,Qwxz->RPQ', Y_KWCD__baba, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyza,Pwyb,Qwzx->RPQ', Y_KWCD__baba, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,Pzbw,Qywx->RPQ', Y_KWCD__baba, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyza,Pzbw,Qyxw->RPQ', Y_KWCD__baba, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzb,Pway,Qwxz->RPQ', Y_KWCD__baba, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzb,Pway,Qwzx->RPQ', Y_KWCD__baba, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzb,Pwya,Qwxz->RPQ', Y_KWCD__baba, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzb,Pwya,Qwzx->RPQ', Y_KWCD__baba, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyzb,PzQa,xy->RPQ', Y_KWCD__baba, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzb,PzaQ,xy->RPQ', Y_KWCD__baba, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzb,Pzaw,Qywx->RPQ', Y_KWCD__baba, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzb,Pzaw,Qyxw->RPQ', Y_KWCD__baba, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzb,Pzwa,Qywx->RPQ', Y_KWCD__baba, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzw,Pwab,Qyxz->RPQ', Y_KWCD__baba, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzw,Pwab,Qyzx->RPQ', Y_KWCD__baba, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzw,Pwba,Qyxz->RPQ', Y_KWCD__baba, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzw,Pwba,Qyzx->RPQ', Y_KWCD__baba, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzw,Pzba,Qyxw->RPQ', Y_KWCD__baba, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,PiQy,yzab,xz->RPQ', Y_KWCD__bbbb, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,PiyQ,yzab,xz->RPQ', Y_KWCD__bbbb, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,yb,Qx->RPQ', Y_KWCD__bbbb, t1_vxae, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piya,yzQb,xz->RPQ', Y_KWCD__bbbb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,yzwb,Qzwx->RPQ', Y_KWCD__bbbb, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piya,zwQb,xywz->RPQ', Y_KWCD__bbbb, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piya,zyQb,xz->RPQ', Y_KWCD__bbbb, t1_vxae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piya,zywb,Qzxw->RPQ', Y_KWCD__bbbb, t1_vxae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,Piyz,ywab,Qwxz->RPQ', Y_KWCD__bbbb, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,Piyz,ywab,Qwzx->RPQ', Y_KWCD__bbbb, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piyz,yzab,Qx->RPQ', Y_KWCD__bbbb, t1_vxaa, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,Piyz,zwab,Qwyx->RPQ', Y_KWCD__bbbb, t1_vxaa, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yb,Qx->RPQ', Y_KWCD__bbbb, t1_xvae, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yzQb,xz->RPQ', Y_KWCD__bbbb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iPya,yzwb,Qzwx->RPQ', Y_KWCD__bbbb, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iPya,yzwb,Qzxw->RPQ', Y_KWCD__bbbb, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__bbbb, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__bbbb, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iPya,zyQb,xz->RPQ', Y_KWCD__bbbb, t1_xvae, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,zywb,Qzxw->RPQ', Y_KWCD__bbbb, t1_xvae, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__bbbb, t1_xa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQba,Py,xy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQba,Pyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,PjQy,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,Pjyz,Qxyz->RPQ', Y_KWCD__bbbb, t1_xxee, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,PjQy,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,Pjyz,Qxyz->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iy,Pyab,Qx->RPQ', Y_KWCD__bbbb, t1_xa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,Pb,xy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,Pzbw,xwyz->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyQa,Pzby,xz->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQa,Pzyb,xz->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzbw,xwyz->RPQ', Y_KWCD__bbbb, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaQ,Pzby,xz->RPQ', Y_KWCD__bbbb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaQ,Pzyb,xz->RPQ', Y_KWCD__bbbb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Py,Qx->RPQ', Y_KWCD__bbbb, t1_xaee, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PyQz,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PyzQ,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pyzw,Qxzw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PzQy,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pzwy,Qzwx->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PzyQ,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,Pzyw,Qzxw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Pwby,Qwxz->RPQ', Y_KWCD__bbbb, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,Pwyb,Qwzx->RPQ', Y_KWCD__bbbb, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaz,PzQb,xy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,PzbQ,xy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Pzbw,Qyxw->RPQ', Y_KWCD__bbbb, t1_xaea, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,Pzwb,Qywx->RPQ', Y_KWCD__bbbb, t1_xaea, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyzQ,Pzab,xy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pwby,Qwxz->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,Pwby,Qwzx->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,Pwyb,Qwxz->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pwyb,Qwzx->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyza,PzQb,xy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyza,PzbQ,xy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,Pzbw,Qywx->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,Pzbw,Qyxw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyza,Pzwb,Qywx->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzw,Pwab,Qyxz->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyzw,Pwab,Qyzx->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyzw,Pzab,Qyxw->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_vaee, rdm_ccaa, optimize = einsum_type)
    TY[:, s_v:f_v, s_a:f_a] += temp    
 
    temp  = 1/4 * einsum('RPxab,ijab,jiyQ,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,jiyQ,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,iQ,xy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,izQw,xzyw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,iyab,izwQ,xzwy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyab,izwQ,xzyw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,jiyQ,xy->RPQ', Y_KWCD__aaaa, t1_vxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,jiyQ,xy->RPQ', Y_KWCD__aaaa, t1_vvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,iQ,xy->RPQ', Y_KWCD__aaaa, t1_vaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,izQw,xzyw->RPQ', Y_KWCD__aaaa, t1_vaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,iyab,izwQ,xzwy->RPQ', Y_KWCD__aaaa, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyab,izwQ,xzyw->RPQ', Y_KWCD__aaaa, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,yzab,wyuQ,xwzu->RPQ', Y_KWCD__aaaa, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,yzab,yQ,xz->RPQ', Y_KWCD__aaaa, t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzab,ywuQ,xwuz->RPQ', Y_KWCD__aaaa, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,yzab,ywuQ,xwzu->RPQ', Y_KWCD__aaaa, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,yzab,zywQ,xw->RPQ', Y_KWCD__aaaa, t1_aaee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,ijab,Pjyb,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijab,jPyb,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijba,Pjyb,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,Pjyz,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,Pjzw,xywz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,ijya,Pjzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijya,Pjzy,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,ijab,Pjyb,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijab,jPyb,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijba,Pjyb,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,Pjyz,xz->RPQ', Y_KWCD__aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,Pjzw,xywz->RPQ', Y_KWCD__aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,ijya,Pjzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijya,Pjzy,xz->RPQ', Y_KWCD__aaaa, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyab,Pb,xy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyab,Pzbw,xzyw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyab,Pzwb,xzwy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyaz,Pwuz,xwuy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyaz,Pwzu,xwyu->RPQ', Y_KWCD__aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyaz,Pywu,xzwu->RPQ', Y_KWCD__aaaa, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyaz,Pz,xy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pb,xy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pzbw,xzyw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyba,Pzwb,xzwy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyba,Pzwb,xzyw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyza,Pwuz,xwuy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyza,Pwuz,xwyu->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyza,Pwzu,xwyu->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyza,Pywu,xzuw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyza,Pywu,xzwu->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyza,Pz,xy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,Pjyz,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,Pjzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,jiya,Pjzy,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,Pjyz,xz->RPQ', Y_KWCD__aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,Pjzw,xyzw->RPQ', Y_KWCD__aaaa, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,jiya,Pjzy,xz->RPQ', Y_KWCD__aaaa, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piab,yQ,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piab,yzwQ,xwzy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,PiyQ,yzab,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piya,yzQb,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piya,zwQb,xywz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piya,zyQb,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iPyQ,yzab,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yzQb,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iPya,zyQb,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__aaaa, t1_xe, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,jPyQ,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,jPyQ,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,Pb,xy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,Pzbw,xwyz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyQa,Pzby,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQa,Pzyb,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzbw,xwyz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaQ,Pzby,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaQ,Pzyb,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PyQz,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PyzQ,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PzQy,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PzyQ,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaz,PzQb,xy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,PzbQ,xy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyzQ,Pzab,xy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyza,PzQb,xy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyza,PzbQ,xy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,jiyQ,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,jiyQ,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,iQ,xy->RPQ', Y_KWCD__abab, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,izQw,xzyw->RPQ', Y_KWCD__abab, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyab,izwQ,xzwy->RPQ', Y_KWCD__abab, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,iyab,izwQ,xzyw->RPQ', Y_KWCD__abab, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,iyba,izwQ,xzwy->RPQ', Y_KWCD__abab, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyba,izwQ,xzyw->RPQ', Y_KWCD__abab, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,jiyQ,xy->RPQ', Y_KWCD__abab, t1_vxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,jiyQ,xy->RPQ', Y_KWCD__abab, t1_vvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,iQ,xy->RPQ', Y_KWCD__abab, t1_vaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,izQw,xzyw->RPQ', Y_KWCD__abab, t1_vaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyab,izwQ,xzwy->RPQ', Y_KWCD__abab, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,iyab,izwQ,xzyw->RPQ', Y_KWCD__abab, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,iyba,izwQ,xzwy->RPQ', Y_KWCD__abab, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyba,izwQ,xzyw->RPQ', Y_KWCD__abab, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,yzab,wyuQ,xwzu->RPQ', Y_KWCD__abab, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,yzab,yQ,xz->RPQ', Y_KWCD__abab, t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,yzab,ywuQ,xwuz->RPQ', Y_KWCD__abab, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,yzab,ywuQ,xwzu->RPQ', Y_KWCD__abab, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,yzab,zwuQ,xwuy->RPQ', Y_KWCD__abab, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,yzab,zwuQ,xwyu->RPQ', Y_KWCD__abab, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,yzab,zywQ,xw->RPQ', Y_KWCD__abab, t1_aaee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,Pjyz,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,ijya,Pjzw,xywz->RPQ', Y_KWCD__abab, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,Pjzw,xyzw->RPQ', Y_KWCD__abab, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,Pjyz,xz->RPQ', Y_KWCD__abab, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,ijya,Pjzw,xywz->RPQ', Y_KWCD__abab, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,Pjzw,xyzw->RPQ', Y_KWCD__abab, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pb,xy->RPQ', Y_KWCD__abab, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pzbw,xzyw->RPQ', Y_KWCD__abab, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyba,Pzwb,xzwy->RPQ', Y_KWCD__abab, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixQa,iyba,Pzwb,xzyw->RPQ', Y_KWCD__abab, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyza,Pwuz,xwuy->RPQ', Y_KWCD__abab, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixQa,iyza,Pwuz,xwyu->RPQ', Y_KWCD__abab, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyza,Pwzu,xwyu->RPQ', Y_KWCD__abab, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,iyza,Pywu,xzuw->RPQ', Y_KWCD__abab, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyza,Pywu,xzwu->RPQ', Y_KWCD__abab, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyza,Pz,xy->RPQ', Y_KWCD__abab, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,ijab,Pjyb,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijab,jPyb,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijba,Pjyb,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,ijya,Pjzw,xywz->RPQ', Y_KWCD__abab, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,ijya,Pjzw,xyzw->RPQ', Y_KWCD__abab, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijya,Pjzy,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,ijab,Pjyb,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijab,jPyb,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijba,Pjyb,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,ijya,Pjzw,xywz->RPQ', Y_KWCD__abab, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,ijya,Pjzw,xyzw->RPQ', Y_KWCD__abab, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijya,Pjzy,xz->RPQ', Y_KWCD__abab, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyab,Pb,xy->RPQ', Y_KWCD__abab, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyab,Pzbw,xzyw->RPQ', Y_KWCD__abab, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyab,Pzwb,xzwy->RPQ', Y_KWCD__abab, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyaz,Pwuz,xwuy->RPQ', Y_KWCD__abab, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyaz,Pwzu,xwyu->RPQ', Y_KWCD__abab, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iyaz,Pywu,xzwu->RPQ', Y_KWCD__abab, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyaz,Pz,xy->RPQ', Y_KWCD__abab, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('RixaQ,iyba,Pzwb,xzwy->RPQ', Y_KWCD__abab, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixaQ,iyba,Pzwb,xzyw->RPQ', Y_KWCD__abab, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixaQ,iyza,Pwuz,xwuy->RPQ', Y_KWCD__abab, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixaQ,iyza,Pwuz,xwyu->RPQ', Y_KWCD__abab, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,iyza,Pywu,xzuw->RPQ', Y_KWCD__abab, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,iyza,Pywu,xzwu->RPQ', Y_KWCD__abab, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,Pjyz,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,Pjzw,xyzw->RPQ', Y_KWCD__abab, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,jiya,Pjzy,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,Pjyz,xz->RPQ', Y_KWCD__abab, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,Pjzw,xyzw->RPQ', Y_KWCD__abab, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,jiya,Pjzy,xz->RPQ', Y_KWCD__abab, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piba,yQ,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piba,yzwQ,xwzy->RPQ', Y_KWCD__abab, t1_xxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,PiyQ,yzab,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piya,yzQb,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piya,zwQb,xywz->RPQ', Y_KWCD__abab, t1_xxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piya,zyQb,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iPyQ,yzab,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yzQb,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__abab, t1_xxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__abab, t1_xxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPyb,zwQa,xywz->RPQ', Y_KWCD__abab, t1_xxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPyb,zwQa,xyzw->RPQ', Y_KWCD__abab, t1_xxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPyb,zyQa,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__abab, t1_xe, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,jPyQ,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,jPyQ,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__abab, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__abab, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQa,Pzyb,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,Pa,xy->RPQ', Y_KWCD__abab, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,Pzaw,xwyz->RPQ', Y_KWCD__abab, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQb,Pzay,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQb,Pzwa,xwyz->RPQ', Y_KWCD__abab, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQb,Pzwa,xwzy->RPQ', Y_KWCD__abab, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__abab, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__abab, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__abab, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzbw,xwyz->RPQ', Y_KWCD__abab, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaQ,Pzby,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__abab, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaQ,Pzyb,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PyQz,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PyzQ,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PzQy,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PzyQ,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaz,PzQb,xy->RPQ', Y_KWCD__abab, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,PzbQ,xy->RPQ', Y_KWCD__abab, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__abab, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__abab, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwba,xzwy->RPQ', Y_KWCD__abab, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwba,xzyw->RPQ', Y_KWCD__abab, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzQ,Pzba,xy->RPQ', Y_KWCD__abab, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyzb,PzQa,xy->RPQ', Y_KWCD__abab, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzb,PzaQ,xy->RPQ', Y_KWCD__abab, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,jiyQ,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,jiyQ,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,iQ,xy->RPQ', Y_KWCD__baba, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,izQw,xzyw->RPQ', Y_KWCD__baba, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyab,izwQ,xzwy->RPQ', Y_KWCD__baba, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,iyab,izwQ,xzyw->RPQ', Y_KWCD__baba, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,iyba,izwQ,xzwy->RPQ', Y_KWCD__baba, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyba,izwQ,xzyw->RPQ', Y_KWCD__baba, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,jiyQ,xy->RPQ', Y_KWCD__baba, t1_vxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,jiyQ,xy->RPQ', Y_KWCD__baba, t1_vvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,iQ,xy->RPQ', Y_KWCD__baba, t1_vaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,izQw,xzyw->RPQ', Y_KWCD__baba, t1_vaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyab,izwQ,xzwy->RPQ', Y_KWCD__baba, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,iyab,izwQ,xzyw->RPQ', Y_KWCD__baba, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,iyba,izwQ,xzwy->RPQ', Y_KWCD__baba, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyba,izwQ,xzyw->RPQ', Y_KWCD__baba, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,yzab,wyuQ,xwzu->RPQ', Y_KWCD__baba, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,yzab,yQ,xz->RPQ', Y_KWCD__baba, t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,yzab,ywuQ,xwuz->RPQ', Y_KWCD__baba, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,yzab,ywuQ,xwzu->RPQ', Y_KWCD__baba, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RPxab,yzab,zwuQ,xwuy->RPQ', Y_KWCD__baba, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,yzab,zwuQ,xwyu->RPQ', Y_KWCD__baba, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,yzab,zywQ,xw->RPQ', Y_KWCD__baba, t1_aaee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,Pjyz,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,ijya,Pjzw,xywz->RPQ', Y_KWCD__baba, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,Pjzw,xyzw->RPQ', Y_KWCD__baba, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,Pjyz,xz->RPQ', Y_KWCD__baba, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,ijya,Pjzw,xywz->RPQ', Y_KWCD__baba, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,Pjzw,xyzw->RPQ', Y_KWCD__baba, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pb,xy->RPQ', Y_KWCD__baba, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pzbw,xzyw->RPQ', Y_KWCD__baba, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyba,Pzwb,xzwy->RPQ', Y_KWCD__baba, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixQa,iyba,Pzwb,xzyw->RPQ', Y_KWCD__baba, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyza,Pwuz,xwuy->RPQ', Y_KWCD__baba, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixQa,iyza,Pwuz,xwyu->RPQ', Y_KWCD__baba, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyza,Pwzu,xwyu->RPQ', Y_KWCD__baba, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,iyza,Pywu,xzuw->RPQ', Y_KWCD__baba, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyza,Pywu,xzwu->RPQ', Y_KWCD__baba, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyza,Pz,xy->RPQ', Y_KWCD__baba, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,ijab,Pjyb,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijab,jPyb,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijba,Pjyb,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,ijya,Pjzw,xywz->RPQ', Y_KWCD__baba, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,ijya,Pjzw,xyzw->RPQ', Y_KWCD__baba, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijya,Pjzy,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,ijab,Pjyb,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijab,jPyb,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijba,Pjyb,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,ijya,Pjzw,xywz->RPQ', Y_KWCD__baba, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,ijya,Pjzw,xyzw->RPQ', Y_KWCD__baba, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijya,Pjzy,xz->RPQ', Y_KWCD__baba, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyab,Pb,xy->RPQ', Y_KWCD__baba, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyab,Pzbw,xzyw->RPQ', Y_KWCD__baba, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyab,Pzwb,xzwy->RPQ', Y_KWCD__baba, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyaz,Pwuz,xwuy->RPQ', Y_KWCD__baba, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyaz,Pwzu,xwyu->RPQ', Y_KWCD__baba, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iyaz,Pywu,xzwu->RPQ', Y_KWCD__baba, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyaz,Pz,xy->RPQ', Y_KWCD__baba, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('RixaQ,iyba,Pzwb,xzwy->RPQ', Y_KWCD__baba, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixaQ,iyba,Pzwb,xzyw->RPQ', Y_KWCD__baba, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixaQ,iyza,Pwuz,xwuy->RPQ', Y_KWCD__baba, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixaQ,iyza,Pwuz,xwyu->RPQ', Y_KWCD__baba, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,iyza,Pywu,xzuw->RPQ', Y_KWCD__baba, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,iyza,Pywu,xzwu->RPQ', Y_KWCD__baba, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,Pjyz,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,Pjzw,xyzw->RPQ', Y_KWCD__baba, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,jiya,Pjzy,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,Pjyz,xz->RPQ', Y_KWCD__baba, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,Pjzw,xyzw->RPQ', Y_KWCD__baba, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,jiya,Pjzy,xz->RPQ', Y_KWCD__baba, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piba,yQ,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piba,yzwQ,xwzy->RPQ', Y_KWCD__baba, t1_xxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,PiyQ,yzab,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piya,yzQb,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piya,zwQb,xywz->RPQ', Y_KWCD__baba, t1_xxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piya,zyQb,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iPyQ,yzab,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yzQb,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__baba, t1_xxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__baba, t1_xxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPyb,zwQa,xywz->RPQ', Y_KWCD__baba, t1_xxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPyb,zwQa,xyzw->RPQ', Y_KWCD__baba, t1_xxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPyb,zyQa,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__baba, t1_xe, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,jPyQ,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,jPyQ,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__baba, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__baba, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQa,Pzyb,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,Pa,xy->RPQ', Y_KWCD__baba, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,Pzaw,xwyz->RPQ', Y_KWCD__baba, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQb,Pzay,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQb,Pzwa,xwyz->RPQ', Y_KWCD__baba, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQb,Pzwa,xwzy->RPQ', Y_KWCD__baba, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__baba, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__baba, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__baba, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzbw,xwyz->RPQ', Y_KWCD__baba, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaQ,Pzby,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__baba, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaQ,Pzyb,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PyQz,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PyzQ,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PzQy,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PzyQ,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaz,PzQb,xy->RPQ', Y_KWCD__baba, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,PzbQ,xy->RPQ', Y_KWCD__baba, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__baba, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__baba, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwba,xzwy->RPQ', Y_KWCD__baba, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwba,xzyw->RPQ', Y_KWCD__baba, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzQ,Pzba,xy->RPQ', Y_KWCD__baba, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyzb,PzQa,xy->RPQ', Y_KWCD__baba, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzb,PzaQ,xy->RPQ', Y_KWCD__baba, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,jiyQ,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,jiyQ,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,iQ,xy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,izQw,xzyw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,iyab,izwQ,xzwy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyab,izwQ,xzyw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,jiyQ,xy->RPQ', Y_KWCD__bbbb, t1_vxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RPxab,ijab,jiyQ,xy->RPQ', Y_KWCD__bbbb, t1_vvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,iQ,xy->RPQ', Y_KWCD__bbbb, t1_vaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,iyab,izQw,xzyw->RPQ', Y_KWCD__bbbb, t1_vaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,iyab,izwQ,xzwy->RPQ', Y_KWCD__bbbb, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,iyab,izwQ,xzyw->RPQ', Y_KWCD__bbbb, t1_vaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,yzab,wyuQ,xwzu->RPQ', Y_KWCD__bbbb, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,yzab,yQ,xz->RPQ', Y_KWCD__bbbb, t1_aaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RPxab,yzab,ywuQ,xwuz->RPQ', Y_KWCD__bbbb, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RPxab,yzab,ywuQ,xwzu->RPQ', Y_KWCD__bbbb, t1_aaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RPxab,yzab,zywQ,xw->RPQ', Y_KWCD__bbbb, t1_aaee, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,ijab,Pjyb,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijab,jPyb,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijba,Pjyb,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,Pjyz,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,Pjzw,xywz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,ijya,Pjzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijya,Pjzy,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,ijab,Pjyb,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijab,jPyb,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijba,Pjyb,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,Pjyz,xz->RPQ', Y_KWCD__bbbb, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,Pjzw,xywz->RPQ', Y_KWCD__bbbb, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,ijya,Pjzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xvae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijya,Pjzy,xz->RPQ', Y_KWCD__bbbb, t1_xvae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyab,Pb,xy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyab,Pzbw,xzyw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyab,Pzwb,xzwy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyaz,Pwuz,xwuy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyaz,Pwzu,xwyu->RPQ', Y_KWCD__bbbb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyaz,Pywu,xzwu->RPQ', Y_KWCD__bbbb, t1_xaea, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyaz,Pz,xy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pb,xy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pzbw,xzyw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyba,Pzwb,xzwy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyba,Pzwb,xzyw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyza,Pwuz,xwuy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyza,Pwuz,xwyu->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyza,Pwzu,xwyu->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyza,Pywu,xzuw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyza,Pywu,xzwu->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyza,Pz,xy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,Pjyz,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,Pjzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xxae, t1_xxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,jiya,Pjzy,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_xxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,Pjyz,xz->RPQ', Y_KWCD__bbbb, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,Pjzw,xyzw->RPQ', Y_KWCD__bbbb, t1_vxae, t1_xvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,jiya,Pjzy,xz->RPQ', Y_KWCD__bbbb, t1_vxae, t1_xvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piab,yQ,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piab,yzwQ,xwzy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,PiyQ,yzab,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piya,yzQb,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piya,zwQb,xywz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piya,zyQb,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iPyQ,yzab,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yzQb,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iPya,zyQb,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__bbbb, t1_xe, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,jPyQ,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,jPyQ,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,Pb,xy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,Pzbw,xwyz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyQa,Pzby,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQa,Pzyb,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzbw,xwyz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaQ,Pzby,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaQ,Pzyb,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PyQz,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PyzQ,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PzQy,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PzyQ,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaz,PzQb,xy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,PzbQ,xy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyzQ,Pzab,xy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyza,PzQb,xy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyza,PzbQ,xy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_xaee, rdm_ca, optimize = einsum_type)
    TY[:, s_c:f_c, s_e:f_e] += temp   
 
    temp  = 1/2 * einsum('RixQa,ijab,Pjyb,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijab,jPyb,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijba,Pjyb,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,Pjyz,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,Pjzw,xywz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,ijya,Pjzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijya,Pjzy,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,ijab,Pjyb,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijab,jPyb,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijba,Pjyb,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,Pjyz,xz->RPQ', Y_KWCD__aaaa, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,Pjzw,xywz->RPQ', Y_KWCD__aaaa, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,ijya,Pjzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijya,Pjzy,xz->RPQ', Y_KWCD__aaaa, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyab,Pb,xy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyab,Pzbw,xzyw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyab,Pzwb,xzwy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyaz,Pwuz,xwuy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyaz,Pwzu,xwyu->RPQ', Y_KWCD__aaaa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyaz,Pywu,xzwu->RPQ', Y_KWCD__aaaa, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyaz,Pz,xy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pb,xy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pzbw,xzyw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyba,Pzwb,xzwy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyba,Pzwb,xzyw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyza,Pwuz,xwuy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyza,Pwuz,xwyu->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyza,Pwzu,xwyu->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyza,Pywu,xzuw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyza,Pywu,xzwu->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyza,Pz,xy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,Pjyz,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,Pjzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,jiya,Pjzy,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,Pjyz,xz->RPQ', Y_KWCD__aaaa, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,Pjzw,xyzw->RPQ', Y_KWCD__aaaa, t1_vxae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,jiya,Pjzy,xz->RPQ', Y_KWCD__aaaa, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piab,yQ,xy->RPQ', Y_KWCD__aaaa, t1_vxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piab,yzwQ,xwzy->RPQ', Y_KWCD__aaaa, t1_vxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,PiyQ,yzab,xz->RPQ', Y_KWCD__aaaa, t1_vxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piya,yzQb,xz->RPQ', Y_KWCD__aaaa, t1_vxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piya,zwQb,xywz->RPQ', Y_KWCD__aaaa, t1_vxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piya,zyQb,xz->RPQ', Y_KWCD__aaaa, t1_vxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iPyQ,yzab,xz->RPQ', Y_KWCD__aaaa, t1_xvae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yzQb,xz->RPQ', Y_KWCD__aaaa, t1_xvae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__aaaa, t1_xvae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__aaaa, t1_xvae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iPya,zyQb,xz->RPQ', Y_KWCD__aaaa, t1_xvae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__aaaa, t1_xe, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,jPyQ,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,jPyQ,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,Pb,xy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,Pzbw,xwyz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyQa,Pzby,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQa,Pzyb,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzbw,xwyz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaQ,Pzby,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaQ,Pzyb,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PyQz,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PyzQ,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PzQy,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PzyQ,xz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaz,PzQb,xy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,PzbQ,xy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyzQ,Pzab,xy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyza,PzQb,xy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyza,PzbQ,xy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,Pjyz,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,ijya,Pjzw,xywz->RPQ', Y_KWCD__abab, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,Pjzw,xyzw->RPQ', Y_KWCD__abab, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,Pjyz,xz->RPQ', Y_KWCD__abab, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,ijya,Pjzw,xywz->RPQ', Y_KWCD__abab, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,Pjzw,xyzw->RPQ', Y_KWCD__abab, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pb,xy->RPQ', Y_KWCD__abab, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pzbw,xzyw->RPQ', Y_KWCD__abab, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyba,Pzwb,xzwy->RPQ', Y_KWCD__abab, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixQa,iyba,Pzwb,xzyw->RPQ', Y_KWCD__abab, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyza,Pwuz,xwuy->RPQ', Y_KWCD__abab, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixQa,iyza,Pwuz,xwyu->RPQ', Y_KWCD__abab, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyza,Pwzu,xwyu->RPQ', Y_KWCD__abab, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,iyza,Pywu,xzuw->RPQ', Y_KWCD__abab, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyza,Pywu,xzwu->RPQ', Y_KWCD__abab, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyza,Pz,xy->RPQ', Y_KWCD__abab, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,ijab,Pjyb,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijab,jPyb,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijba,Pjyb,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,ijya,Pjzw,xywz->RPQ', Y_KWCD__abab, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,ijya,Pjzw,xyzw->RPQ', Y_KWCD__abab, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijya,Pjzy,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,ijab,Pjyb,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijab,jPyb,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijba,Pjyb,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,ijya,Pjzw,xywz->RPQ', Y_KWCD__abab, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,ijya,Pjzw,xyzw->RPQ', Y_KWCD__abab, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijya,Pjzy,xz->RPQ', Y_KWCD__abab, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyab,Pb,xy->RPQ', Y_KWCD__abab, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyab,Pzbw,xzyw->RPQ', Y_KWCD__abab, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyab,Pzwb,xzwy->RPQ', Y_KWCD__abab, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyaz,Pwuz,xwuy->RPQ', Y_KWCD__abab, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyaz,Pwzu,xwyu->RPQ', Y_KWCD__abab, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iyaz,Pywu,xzwu->RPQ', Y_KWCD__abab, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyaz,Pz,xy->RPQ', Y_KWCD__abab, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('RixaQ,iyba,Pzwb,xzwy->RPQ', Y_KWCD__abab, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixaQ,iyba,Pzwb,xzyw->RPQ', Y_KWCD__abab, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixaQ,iyza,Pwuz,xwuy->RPQ', Y_KWCD__abab, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixaQ,iyza,Pwuz,xwyu->RPQ', Y_KWCD__abab, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,iyza,Pywu,xzuw->RPQ', Y_KWCD__abab, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,iyza,Pywu,xzwu->RPQ', Y_KWCD__abab, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,Pjyz,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,Pjzw,xyzw->RPQ', Y_KWCD__abab, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,jiya,Pjzy,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,Pjyz,xz->RPQ', Y_KWCD__abab, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,Pjzw,xyzw->RPQ', Y_KWCD__abab, t1_vxae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,jiya,Pjzy,xz->RPQ', Y_KWCD__abab, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piba,yQ,xy->RPQ', Y_KWCD__abab, t1_vxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piba,yzwQ,xwzy->RPQ', Y_KWCD__abab, t1_vxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,PiyQ,yzab,xz->RPQ', Y_KWCD__abab, t1_vxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piya,yzQb,xz->RPQ', Y_KWCD__abab, t1_vxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piya,zwQb,xywz->RPQ', Y_KWCD__abab, t1_vxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piya,zyQb,xz->RPQ', Y_KWCD__abab, t1_vxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iPyQ,yzab,xz->RPQ', Y_KWCD__abab, t1_xvae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yzQb,xz->RPQ', Y_KWCD__abab, t1_xvae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__abab, t1_xvae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__abab, t1_xvae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPyb,zwQa,xywz->RPQ', Y_KWCD__abab, t1_xvae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPyb,zwQa,xyzw->RPQ', Y_KWCD__abab, t1_xvae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPyb,zyQa,xz->RPQ', Y_KWCD__abab, t1_xvae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__abab, t1_xe, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,jPyQ,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,jPyQ,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__abab, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__abab, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQa,Pzyb,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,Pa,xy->RPQ', Y_KWCD__abab, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,Pzaw,xwyz->RPQ', Y_KWCD__abab, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQb,Pzay,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQb,Pzwa,xwyz->RPQ', Y_KWCD__abab, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQb,Pzwa,xwzy->RPQ', Y_KWCD__abab, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__abab, t1_xaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__abab, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__abab, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzbw,xwyz->RPQ', Y_KWCD__abab, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaQ,Pzby,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__abab, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaQ,Pzyb,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PyQz,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PyzQ,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PzQy,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PzyQ,xz->RPQ', Y_KWCD__abab, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaz,PzQb,xy->RPQ', Y_KWCD__abab, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,PzbQ,xy->RPQ', Y_KWCD__abab, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__abab, t1_xaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__abab, t1_xaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwba,xzwy->RPQ', Y_KWCD__abab, t1_xaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwba,xzyw->RPQ', Y_KWCD__abab, t1_xaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzQ,Pzba,xy->RPQ', Y_KWCD__abab, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyzb,PzQa,xy->RPQ', Y_KWCD__abab, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzb,PzaQ,xy->RPQ', Y_KWCD__abab, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,Pjyz,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,ijya,Pjzw,xywz->RPQ', Y_KWCD__baba, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,Pjzw,xyzw->RPQ', Y_KWCD__baba, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,Pjyz,xz->RPQ', Y_KWCD__baba, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,ijya,Pjzw,xywz->RPQ', Y_KWCD__baba, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,Pjzw,xyzw->RPQ', Y_KWCD__baba, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pb,xy->RPQ', Y_KWCD__baba, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pzbw,xzyw->RPQ', Y_KWCD__baba, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyba,Pzwb,xzwy->RPQ', Y_KWCD__baba, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixQa,iyba,Pzwb,xzyw->RPQ', Y_KWCD__baba, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyza,Pwuz,xwuy->RPQ', Y_KWCD__baba, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixQa,iyza,Pwuz,xwyu->RPQ', Y_KWCD__baba, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyza,Pwzu,xwyu->RPQ', Y_KWCD__baba, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,iyza,Pywu,xzuw->RPQ', Y_KWCD__baba, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyza,Pywu,xzwu->RPQ', Y_KWCD__baba, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyza,Pz,xy->RPQ', Y_KWCD__baba, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,ijab,Pjyb,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijab,jPyb,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijba,Pjyb,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,ijya,Pjzw,xywz->RPQ', Y_KWCD__baba, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,ijya,Pjzw,xyzw->RPQ', Y_KWCD__baba, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijya,Pjzy,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,ijab,Pjyb,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijab,jPyb,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijba,Pjyb,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,ijya,Pjzw,xywz->RPQ', Y_KWCD__baba, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,ijya,Pjzw,xyzw->RPQ', Y_KWCD__baba, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijya,Pjzy,xz->RPQ', Y_KWCD__baba, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyab,Pb,xy->RPQ', Y_KWCD__baba, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyab,Pzbw,xzyw->RPQ', Y_KWCD__baba, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyab,Pzwb,xzwy->RPQ', Y_KWCD__baba, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyaz,Pwuz,xwuy->RPQ', Y_KWCD__baba, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyaz,Pwzu,xwyu->RPQ', Y_KWCD__baba, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iyaz,Pywu,xzwu->RPQ', Y_KWCD__baba, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyaz,Pz,xy->RPQ', Y_KWCD__baba, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('RixaQ,iyba,Pzwb,xzwy->RPQ', Y_KWCD__baba, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixaQ,iyba,Pzwb,xzyw->RPQ', Y_KWCD__baba, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixaQ,iyza,Pwuz,xwuy->RPQ', Y_KWCD__baba, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixaQ,iyza,Pwuz,xwyu->RPQ', Y_KWCD__baba, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,iyza,Pywu,xzuw->RPQ', Y_KWCD__baba, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,iyza,Pywu,xzwu->RPQ', Y_KWCD__baba, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,Pjyz,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,Pjzw,xyzw->RPQ', Y_KWCD__baba, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,jiya,Pjzy,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,Pjyz,xz->RPQ', Y_KWCD__baba, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,Pjzw,xyzw->RPQ', Y_KWCD__baba, t1_vxae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,jiya,Pjzy,xz->RPQ', Y_KWCD__baba, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piba,yQ,xy->RPQ', Y_KWCD__baba, t1_vxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piba,yzwQ,xwzy->RPQ', Y_KWCD__baba, t1_vxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,PiyQ,yzab,xz->RPQ', Y_KWCD__baba, t1_vxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piya,yzQb,xz->RPQ', Y_KWCD__baba, t1_vxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piya,zwQb,xywz->RPQ', Y_KWCD__baba, t1_vxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piya,zyQb,xz->RPQ', Y_KWCD__baba, t1_vxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iPyQ,yzab,xz->RPQ', Y_KWCD__baba, t1_xvae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yzQb,xz->RPQ', Y_KWCD__baba, t1_xvae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__baba, t1_xvae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__baba, t1_xvae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPyb,zwQa,xywz->RPQ', Y_KWCD__baba, t1_xvae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPyb,zwQa,xyzw->RPQ', Y_KWCD__baba, t1_xvae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPyb,zyQa,xz->RPQ', Y_KWCD__baba, t1_xvae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__baba, t1_xe, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,jPyQ,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,jPyQ,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__baba, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__baba, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQa,Pzyb,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,Pa,xy->RPQ', Y_KWCD__baba, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,Pzaw,xwyz->RPQ', Y_KWCD__baba, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQb,Pzay,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQb,Pzwa,xwyz->RPQ', Y_KWCD__baba, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQb,Pzwa,xwzy->RPQ', Y_KWCD__baba, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__baba, t1_xaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__baba, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__baba, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzbw,xwyz->RPQ', Y_KWCD__baba, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaQ,Pzby,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__baba, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaQ,Pzyb,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PyQz,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PyzQ,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PzQy,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PzyQ,xz->RPQ', Y_KWCD__baba, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaz,PzQb,xy->RPQ', Y_KWCD__baba, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,PzbQ,xy->RPQ', Y_KWCD__baba, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__baba, t1_xaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__baba, t1_xaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwba,xzwy->RPQ', Y_KWCD__baba, t1_xaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwba,xzyw->RPQ', Y_KWCD__baba, t1_xaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzQ,Pzba,xy->RPQ', Y_KWCD__baba, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyzb,PzQa,xy->RPQ', Y_KWCD__baba, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzb,PzaQ,xy->RPQ', Y_KWCD__baba, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,ijab,Pjyb,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijab,jPyb,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijba,Pjyb,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,Pjyz,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,Pjzw,xywz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,ijya,Pjzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijya,Pjzy,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,ijab,Pjyb,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijab,jPyb,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijba,Pjyb,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,Pjyz,xz->RPQ', Y_KWCD__bbbb, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,Pjzw,xywz->RPQ', Y_KWCD__bbbb, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,ijya,Pjzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xvae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijya,Pjzy,xz->RPQ', Y_KWCD__bbbb, t1_xvae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyab,Pb,xy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyab,Pzbw,xzyw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyab,Pzwb,xzwy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyaz,Pwuz,xwuy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyaz,Pwzu,xwyu->RPQ', Y_KWCD__bbbb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyaz,Pywu,xzwu->RPQ', Y_KWCD__bbbb, t1_xaea, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyaz,Pz,xy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pb,xy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pzbw,xzyw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyba,Pzwb,xzwy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyba,Pzwb,xzyw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyza,Pwuz,xwuy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyza,Pwuz,xwyu->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyza,Pwzu,xwyu->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyza,Pywu,xzuw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyza,Pywu,xzwu->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyza,Pz,xy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,Pjyz,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,Pjzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xxae, t1_vxaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,jiya,Pjzy,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_vxaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,Pjyz,xz->RPQ', Y_KWCD__bbbb, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,Pjzw,xyzw->RPQ', Y_KWCD__bbbb, t1_vxae, t1_vvaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,jiya,Pjzy,xz->RPQ', Y_KWCD__bbbb, t1_vxae, t1_vvaa, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piab,yQ,xy->RPQ', Y_KWCD__bbbb, t1_vxee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piab,yzwQ,xwzy->RPQ', Y_KWCD__bbbb, t1_vxee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,PiyQ,yzab,xz->RPQ', Y_KWCD__bbbb, t1_vxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,Piya,yzQb,xz->RPQ', Y_KWCD__bbbb, t1_vxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,Piya,zwQb,xywz->RPQ', Y_KWCD__bbbb, t1_vxae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,Piya,zyQb,xz->RPQ', Y_KWCD__bbbb, t1_vxae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iPyQ,yzab,xz->RPQ', Y_KWCD__bbbb, t1_xvae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iPya,yzQb,xz->RPQ', Y_KWCD__bbbb, t1_xvae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__bbbb, t1_xvae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__bbbb, t1_xvae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iPya,zyQb,xz->RPQ', Y_KWCD__bbbb, t1_xvae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__bbbb, t1_xe, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_vxae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,jPyQ,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xvae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,ijab,PjyQ,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,ijab,jPyQ,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vvae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,Pb,xy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,Pzbw,xwyz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyQa,Pzby,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQa,Pzyb,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzbw,xwyz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaQ,Pzby,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaQ,Pzyb,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PyQz,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PyzQ,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyab,PzQy,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyab,PzyQ,xz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyaz,PzQb,xy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyaz,PzbQ,xy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyzQ,Pzab,xy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyza,PzQb,xy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyza,PzbQ,xy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_vaee, rdm_ca, optimize = einsum_type)
    TY[:, s_v:f_v, s_e:f_e] += temp   
 
    temp =- 1/4 * einsum('RixQa,ijPa,jy,xy->RPQ', Y_KWCD__aaaa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,ijab,jPby,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijab,jPyb,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijba,jPby,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijya,jPyz,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,ijya,jPzw,xywz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,jPzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,jPzy,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jy,xy->RPQ', Y_KWCD__aaaa, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,ijab,jPby,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijab,jPyb,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijba,jPby,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijya,jPyz,xz->RPQ', Y_KWCD__aaaa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,ijya,jPzw,xywz->RPQ', Y_KWCD__aaaa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,jPzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,jPzy,xz->RPQ', Y_KWCD__aaaa, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iy,yzPa,xz->RPQ', Y_KWCD__aaaa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iy,zyPa,xz->RPQ', Y_KWCD__aaaa, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyPz,wuya,xzuw->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,wzua,xuyw->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,za,xy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,zwua,xuwy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyab,Pb,xy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyab,Pzwb,xzwy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyab,zPwb,xzyw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pb,xy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyba,Pzwb,xzwy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyba,Pzwb,xzyw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,zPwb,xzyw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzP,wuya,xzuw->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzP,wuya,xzwu->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzP,wzua,xuyw->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzP,za,xy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzP,zwua,xuwy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzP,zwua,xuyw->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzw,uwPa,xzuy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzw,uwPa,xzyu->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyzw,uzPa,xwuy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzw,wuPa,xzuy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzw,wuPa,xzyu->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyzw,wzPa,xy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzw,zuPa,xwuy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzw,zwPa,xy->RPQ', Y_KWCD__aaaa, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,jiPa,jy,xy->RPQ', Y_KWCD__aaaa, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,jiPa,jyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,jiya,jPyz,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,jPzw,xywz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,jPzy,xz->RPQ', Y_KWCD__aaaa, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,jiPa,jy,xy->RPQ', Y_KWCD__aaaa, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,jiPa,jyzw,xyzw->RPQ', Y_KWCD__aaaa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,jiya,jPyz,xz->RPQ', Y_KWCD__aaaa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,jPzw,xywz->RPQ', Y_KWCD__aaaa, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,jPzy,xz->RPQ', Y_KWCD__aaaa, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iPay,zwQb,xywz->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iPba,yQ,xy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iPba,yzwQ,xwzy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__aaaa, t1_xe, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jQ,Px->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyQz,Pzxy->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyzQ,Pzyx->RPQ', Y_KWCD__aaaa, t1_xxee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jQ,Px->RPQ', Y_KWCD__aaaa, t1_xvee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyQz,Pzxy->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyzQ,Pzyx->RPQ', Y_KWCD__aaaa, t1_xvee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,Pb,xy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,zPwb,xwyz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyQa,zwyb,Pxwz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyQa,zwyb,Pxzw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyQz,zwab,Pxwy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyQz,zwab,Pxyw->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__aaaa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,zPwb,xwyz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaQ,zwyb,Pxzw->RPQ', Y_KWCD__aaaa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyab,yQ,Px->RPQ', Y_KWCD__aaaa, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyab,yzwQ,Pwzx->RPQ', Y_KWCD__aaaa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyab,zwyQ,Pxwz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyab,zywQ,Pwxz->RPQ', Y_KWCD__aaaa, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,wzQb,Pxwy->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,zwQb,Pxyw->RPQ', Y_KWCD__aaaa, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyzQ,Pzab,xy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzQ,zwab,Pxyw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyza,wzQb,Pxwy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,zwQb,Pxwy->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,zwQb,Pxyw->RPQ', Y_KWCD__aaaa, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jy,xy->RPQ', Y_KWCD__abab, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jyzw,xyzw->RPQ', Y_KWCD__abab, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,jPzw,xywz->RPQ', Y_KWCD__abab, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,ijya,jPzw,xyzw->RPQ', Y_KWCD__abab, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,jPzy,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jy,xy->RPQ', Y_KWCD__abab, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jyzw,xyzw->RPQ', Y_KWCD__abab, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,jPzw,xywz->RPQ', Y_KWCD__abab, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,ijya,jPzw,xyzw->RPQ', Y_KWCD__abab, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,jPzy,xz->RPQ', Y_KWCD__abab, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iy,yzPa,xz->RPQ', Y_KWCD__abab, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyPz,wuya,xzuw->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,wzua,xuyw->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,za,xy->RPQ', Y_KWCD__abab, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,zwua,xuwy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pb,xy->RPQ', Y_KWCD__abab, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyba,Pzwb,xzwy->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixQa,iyba,Pzwb,xzyw->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,zPwb,xzyw->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,iyzP,wuya,xzuw->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzP,wuya,xzwu->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixQa,iyzP,zwua,xuwy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzP,zwua,xuyw->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzw,uwPa,xzuy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,iyzw,uwPa,xzyu->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,iyzw,wuPa,xzuy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzw,wuPa,xzyu->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzw,zuPa,xwuy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzw,zwPa,xy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,ijab,jPby,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijab,jPyb,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijba,jPby,xy->RPQ', Y_KWCD__abab, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijya,jPyz,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,ijya,jPzw,xywz->RPQ', Y_KWCD__abab, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,ijya,jPzw,xyzw->RPQ', Y_KWCD__abab, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,ijab,jPby,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijab,jPyb,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijba,jPby,xy->RPQ', Y_KWCD__abab, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijya,jPyz,xz->RPQ', Y_KWCD__abab, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,ijya,jPzw,xywz->RPQ', Y_KWCD__abab, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,ijya,jPzw,xyzw->RPQ', Y_KWCD__abab, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iy,zyPa,xz->RPQ', Y_KWCD__abab, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyab,Pb,xy->RPQ', Y_KWCD__abab, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyab,Pzwb,xzwy->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyab,zPwb,xzyw->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixaQ,iyba,Pzwb,xzwy->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixaQ,iyba,Pzwb,xzyw->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,iyzP,wuya,xzuw->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,iyzP,wuya,xzwu->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyzP,wzua,xuyw->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyzP,za,xy->RPQ', Y_KWCD__abab, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/12 * einsum('RixaQ,iyzP,zwua,xuwy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixaQ,iyzP,zwua,xuyw->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,iyzw,uwPa,xzuy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,iyzw,uwPa,xzyu->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iyzw,uzPa,xwuy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,iyzw,wuPa,xzuy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,iyzw,wuPa,xzyu->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iyzw,wzPa,xy->RPQ', Y_KWCD__abab, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,jiPa,jy,xy->RPQ', Y_KWCD__abab, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,jiPa,jyzw,xyzw->RPQ', Y_KWCD__abab, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,jiya,jPyz,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,jPzw,xywz->RPQ', Y_KWCD__abab, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,jPzy,xz->RPQ', Y_KWCD__abab, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,jiPa,jy,xy->RPQ', Y_KWCD__abab, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,jiPa,jyzw,xyzw->RPQ', Y_KWCD__abab, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,jiya,jPyz,xz->RPQ', Y_KWCD__abab, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,jPzw,xywz->RPQ', Y_KWCD__abab, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,jPzy,xz->RPQ', Y_KWCD__abab, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iPab,yQ,xy->RPQ', Y_KWCD__abab, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iPab,yzwQ,xwzy->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iPay,zwQb,xywz->RPQ', Y_KWCD__abab, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__abab, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPyb,zwQa,xywz->RPQ', Y_KWCD__abab, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPyb,zwQa,xyzw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__abab, t1_xe, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jQ,Px->RPQ', Y_KWCD__abab, t1_xxee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyQz,Pzxy->RPQ', Y_KWCD__abab, t1_xxee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyzQ,Pzyx->RPQ', Y_KWCD__abab, t1_xxee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jQ,Px->RPQ', Y_KWCD__abab, t1_xvee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyQz,Pzxy->RPQ', Y_KWCD__abab, t1_xvee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyzQ,Pzyx->RPQ', Y_KWCD__abab, t1_xvee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyQa,zwyb,Pxwz->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyQa,zwyb,Pxzw->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,Pa,xy->RPQ', Y_KWCD__abab, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQb,Pzwa,xwyz->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQb,Pzwa,xwzy->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,zPwa,xwyz->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyQb,zwya,Pxwz->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyQb,zwya,Pxzw->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__abab, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__abab, t1_xaea, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQz,wzab,Pxwy->RPQ', Y_KWCD__abab, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyQz,wzab,Pxyw->RPQ', Y_KWCD__abab, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyQz,zwab,Pxwy->RPQ', Y_KWCD__abab, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQz,zwab,Pxyw->RPQ', Y_KWCD__abab, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__abab, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,zPwb,xwyz->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaQ,zwyb,Pxzw->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyab,yQ,Px->RPQ', Y_KWCD__abab, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyab,yzwQ,Pwzx->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyab,zwyQ,Pxwz->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyab,zywQ,Pwxz->RPQ', Y_KWCD__abab, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,wzQb,Pxwy->RPQ', Y_KWCD__abab, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,zwQb,Pxyw->RPQ', Y_KWCD__abab, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__abab, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwba,xzwy->RPQ', Y_KWCD__abab, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwba,xzyw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyzQ,Pzba,xy->RPQ', Y_KWCD__abab, t1_xaae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzQ,zwab,Pxyw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,zwQb,Pxwy->RPQ', Y_KWCD__abab, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyza,zwQb,Pxyw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyzb,wzQa,Pxwy->RPQ', Y_KWCD__abab, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzb,zwQa,Pxwy->RPQ', Y_KWCD__abab, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzb,zwQa,Pxyw->RPQ', Y_KWCD__abab, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jy,xy->RPQ', Y_KWCD__baba, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jyzw,xyzw->RPQ', Y_KWCD__baba, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,jPzw,xywz->RPQ', Y_KWCD__baba, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,ijya,jPzw,xyzw->RPQ', Y_KWCD__baba, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,jPzy,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jy,xy->RPQ', Y_KWCD__baba, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jyzw,xyzw->RPQ', Y_KWCD__baba, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,jPzw,xywz->RPQ', Y_KWCD__baba, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,ijya,jPzw,xyzw->RPQ', Y_KWCD__baba, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,jPzy,xz->RPQ', Y_KWCD__baba, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iy,yzPa,xz->RPQ', Y_KWCD__baba, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyPz,wuya,xzuw->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,wzua,xuyw->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,za,xy->RPQ', Y_KWCD__baba, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,zwua,xuwy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pb,xy->RPQ', Y_KWCD__baba, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyba,Pzwb,xzwy->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixQa,iyba,Pzwb,xzyw->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,zPwb,xzyw->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,iyzP,wuya,xzuw->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzP,wuya,xzwu->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixQa,iyzP,zwua,xuwy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzP,zwua,xuyw->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzw,uwPa,xzuy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,iyzw,uwPa,xzyu->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixQa,iyzw,wuPa,xzuy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzw,wuPa,xzyu->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzw,zuPa,xwuy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzw,zwPa,xy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,ijab,jPby,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijab,jPyb,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijba,jPby,xy->RPQ', Y_KWCD__baba, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijya,jPyz,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,ijya,jPzw,xywz->RPQ', Y_KWCD__baba, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,ijya,jPzw,xyzw->RPQ', Y_KWCD__baba, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,ijab,jPby,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijab,jPyb,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijba,jPby,xy->RPQ', Y_KWCD__baba, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,ijya,jPyz,xz->RPQ', Y_KWCD__baba, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,ijya,jPzw,xywz->RPQ', Y_KWCD__baba, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,ijya,jPzw,xyzw->RPQ', Y_KWCD__baba, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iy,zyPa,xz->RPQ', Y_KWCD__baba, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyab,Pb,xy->RPQ', Y_KWCD__baba, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyab,Pzwb,xzwy->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyab,zPwb,xzyw->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixaQ,iyba,Pzwb,xzwy->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixaQ,iyba,Pzwb,xzyw->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,iyzP,wuya,xzuw->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,iyzP,wuya,xzwu->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyzP,wzua,xuyw->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,iyzP,za,xy->RPQ', Y_KWCD__baba, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/12 * einsum('RixaQ,iyzP,zwua,xuwy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('RixaQ,iyzP,zwua,xuyw->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,iyzw,uwPa,xzuy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,iyzw,uwPa,xzyu->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iyzw,uzPa,xwuy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixaQ,iyzw,wuPa,xzuy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('RixaQ,iyzw,wuPa,xzyu->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,iyzw,wzPa,xy->RPQ', Y_KWCD__baba, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,jiPa,jy,xy->RPQ', Y_KWCD__baba, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,jiPa,jyzw,xyzw->RPQ', Y_KWCD__baba, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,jiya,jPyz,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,jPzw,xywz->RPQ', Y_KWCD__baba, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,jPzy,xz->RPQ', Y_KWCD__baba, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,jiPa,jy,xy->RPQ', Y_KWCD__baba, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixaQ,jiPa,jyzw,xyzw->RPQ', Y_KWCD__baba, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('RixaQ,jiya,jPyz,xz->RPQ', Y_KWCD__baba, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,jPzw,xywz->RPQ', Y_KWCD__baba, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixaQ,jiya,jPzy,xz->RPQ', Y_KWCD__baba, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iPab,yQ,xy->RPQ', Y_KWCD__baba, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iPab,yzwQ,xwzy->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iPay,zwQb,xywz->RPQ', Y_KWCD__baba, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__baba, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPyb,zwQa,xywz->RPQ', Y_KWCD__baba, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iPyb,zwQa,xyzw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__baba, t1_xe, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jQ,Px->RPQ', Y_KWCD__baba, t1_xxee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyQz,Pzxy->RPQ', Y_KWCD__baba, t1_xxee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyzQ,Pzyx->RPQ', Y_KWCD__baba, t1_xxee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jQ,Px->RPQ', Y_KWCD__baba, t1_xvee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyQz,Pzxy->RPQ', Y_KWCD__baba, t1_xvee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyzQ,Pzyx->RPQ', Y_KWCD__baba, t1_xvee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyQa,zwyb,Pxwz->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyQa,zwyb,Pxzw->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,Pa,xy->RPQ', Y_KWCD__baba, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyQb,Pzwa,xwyz->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQb,Pzwa,xwzy->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQb,zPwa,xwyz->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyQb,zwya,Pxwz->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyQb,zwya,Pxzw->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__baba, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__baba, t1_xaea, t1_aaee, rdm_ca, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQz,wzab,Pxwy->RPQ', Y_KWCD__baba, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyQz,wzab,Pxyw->RPQ', Y_KWCD__baba, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyQz,zwab,Pxwy->RPQ', Y_KWCD__baba, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQz,zwab,Pxyw->RPQ', Y_KWCD__baba, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__baba, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,zPwb,xwyz->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaQ,zwyb,Pxzw->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyab,yQ,Px->RPQ', Y_KWCD__baba, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyab,yzwQ,Pwzx->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyab,zwyQ,Pxwz->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyab,zywQ,Pwxz->RPQ', Y_KWCD__baba, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,wzQb,Pxwy->RPQ', Y_KWCD__baba, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,zwQb,Pxyw->RPQ', Y_KWCD__baba, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__baba, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwba,xzwy->RPQ', Y_KWCD__baba, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/3 * einsum('Rixab,iyzQ,Pwba,xzyw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyzQ,Pzba,xy->RPQ', Y_KWCD__baba, t1_xaae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzQ,zwab,Pxyw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,zwQb,Pxwy->RPQ', Y_KWCD__baba, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyza,zwQb,Pxyw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyzb,wzQa,Pxwy->RPQ', Y_KWCD__baba, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzb,zwQa,Pxwy->RPQ', Y_KWCD__baba, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyzb,zwQa,Pxyw->RPQ', Y_KWCD__baba, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jy,xy->RPQ', Y_KWCD__bbbb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,ijab,jPby,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijab,jPyb,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijba,jPby,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijya,jPyz,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,ijya,jPzw,xywz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,jPzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,jPzy,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jy,xy->RPQ', Y_KWCD__bbbb, t1_xvae, t1_va, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijPa,jyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,ijab,jPby,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijab,jPyb,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijba,jPby,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vaea, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijba,jPyb,xy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,ijya,jPyz,xz->RPQ', Y_KWCD__bbbb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,ijya,jPzw,xywz->RPQ', Y_KWCD__bbbb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,ijya,jPzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xvae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,ijya,jPzy,xz->RPQ', Y_KWCD__bbbb, t1_xvae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iy,yzPa,xz->RPQ', Y_KWCD__bbbb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iy,zyPa,xz->RPQ', Y_KWCD__bbbb, t1_xa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyPz,wuya,xzuw->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,wzua,xuyw->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,za,xy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyPz,zwua,xuwy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyab,Pb,xy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyab,Pzwb,xzwy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyab,zPwb,xzyw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,Pb,xy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyba,Pzwb,xzwy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyba,Pzwb,xzyw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyba,zPwb,xzyw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzP,wuya,xzuw->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzP,wuya,xzwu->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzP,wzua,xuyw->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzP,za,xy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzP,zwua,xuwy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzP,zwua,xuyw->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzw,uwPa,xzuy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzw,uwPa,xzyu->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyzw,uzPa,xwuy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('RixQa,iyzw,wuPa,xzuy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('RixQa,iyzw,wuPa,xzyu->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,iyzw,wzPa,xy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzw,zuPa,xwuy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,iyzw,zwPa,xy->RPQ', Y_KWCD__bbbb, t1_xaaa, t1_aaae, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,jiPa,jy,xy->RPQ', Y_KWCD__bbbb, t1_xxae, t1_xa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,jiPa,jyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,jiya,jPyz,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,jPzw,xywz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,jPzy,xz->RPQ', Y_KWCD__bbbb, t1_xxae, t1_xaaa, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,jiPa,jy,xy->RPQ', Y_KWCD__bbbb, t1_vxae, t1_va, rdm_ca, optimize = einsum_type)
    temp += 1/4 * einsum('RixQa,jiPa,jyzw,xyzw->RPQ', Y_KWCD__bbbb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('RixQa,jiya,jPyz,xz->RPQ', Y_KWCD__bbbb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,jPzw,xywz->RPQ', Y_KWCD__bbbb, t1_vxae, t1_vaaa, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('RixQa,jiya,jPzy,xz->RPQ', Y_KWCD__bbbb, t1_vxae, t1_vaaa, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iPay,zwQb,xywz->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iPba,yQ,xy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iPba,yzwQ,xwzy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iPya,zwQb,xywz->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iPya,zwQb,xyzw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iQ,Pyab,xy->RPQ', Y_KWCD__bbbb, t1_xe, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jQ,Px->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xe, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyQz,Pzxy->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyzQ,Pzyx->RPQ', Y_KWCD__bbbb, t1_xxee, t1_xaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jQ,Px->RPQ', Y_KWCD__bbbb, t1_xvee, t1_ve, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyQz,Pzxy->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vaea, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,ijab,jyzQ,Pzyx->RPQ', Y_KWCD__bbbb, t1_xvee, t1_vaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,Pb,xy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyQa,Pzwb,xwyz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyQa,Pzwb,xwzy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyQa,zPwb,xwyz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyQa,zwyb,Pxwz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyQa,zwyb,Pxzw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pwab,xzwy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyQz,Pzab,xy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyQz,zwab,Pxwy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyQz,zwab,Pxyw->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pb,xy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,Pzwb,xwzy->RPQ', Y_KWCD__bbbb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/2 * einsum('Rixab,iyaQ,zPwb,xwyz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaQ,zwyb,Pxzw->RPQ', Y_KWCD__bbbb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyab,yQ,Px->RPQ', Y_KWCD__bbbb, t1_xaee, t1_ae, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyab,yzwQ,Pwzx->RPQ', Y_KWCD__bbbb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyab,zwyQ,Pxwz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyab,zywQ,Pwxz->RPQ', Y_KWCD__bbbb, t1_xaee, t1_aaae, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,wzQb,Pxwy->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/4 * einsum('Rixab,iyaz,zwQb,Pxyw->RPQ', Y_KWCD__bbbb, t1_xaea, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/6 * einsum('Rixab,iyzQ,Pwab,xzwy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/6 * einsum('Rixab,iyzQ,Pwab,xzyw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/2 * einsum('Rixab,iyzQ,Pzab,xy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaee, rdm_ca, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyzQ,zwab,Pxyw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/4 * einsum('Rixab,iyza,wzQb,Pxwy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp += 1/12 * einsum('Rixab,iyza,zwQb,Pxwy->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    temp -= 1/12 * einsum('Rixab,iyza,zwQb,Pxyw->RPQ', Y_KWCD__bbbb, t1_xaae, t1_aaee, rdm_ccaa, optimize = einsum_type)
    TY[:, s_a:f_a, s_e:f_e] += temp

    mr_adc.log.timer_debug("computing T q2-h1 CAEE", *cput1)

