## h1 <- h1 coupling contributions
from . import logger, tools, ascontiguousarray

# CCAA <- CCEA
def compute_sigma_vector__H1__h1_h1__CCAA_CCEA(mr_adc, X_aaaa, X_abab, X_abba, X_bbbb, sigma):
    cput1 = (logger.process_clock(), logger.perf_counter())

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    #Excitation Manifold
    ccaa__aaaa = mr_adc.h1.ccaa__aaaa
    ccaa__abab = mr_adc.h1.ccaa__abab
    ccaa__bbbb = mr_adc.h1.ccaa__bbbb 

    ## Indices
    cc_tril_ind = mr_adc.h1.cc_tril_ind 
    aa_tril_ind = mr_adc.h1.aa_tril_ind 

    ## Molecular Orbitals Energies
    e_extern = mr_adc.mo_energy.e
    
    ## One-electron integrals
    h_aa = mr_adc.h1eff.aa
    h_ae = mr_adc.h1eff.ae

    ## Two-electron integrals
    v_xxae = mr_adc.v2e.xxae
    v_xaex = mr_adc.v2e.xaex
    v_aaaa = mr_adc.v2e.aaaa
    v_aaae = mr_adc.v2e.aaae

    ## Amplitudes
    t1_ae = mr_adc.t1.ae
    t1_aaae = mr_adc.t1.aaae

    # Reduced Density Matrices
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa
    rdm_cccaaa = mr_adc.rdm.cccaaa

    sigma_KLWU_aaaa  = einsum('KLaU,Wa->KLWU', X_aaaa, h_ae, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLaW,Ua->KLWU', X_aaaa, h_ae, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLax,UxWa->KLWU', X_aaaa, v_aaae, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLax,WxUa->KLWU', X_aaaa, v_aaae, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KiaU,LWai->KLWU', X_aaaa, v_xaex, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KiaU,iLWa->KLWU', X_aaaa, v_xxae, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KiaW,LUai->KLWU', X_aaaa, v_xaex, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KiaW,iLUa->KLWU', X_aaaa, v_xxae, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('LiaU,KWai->KLWU', X_aaaa, v_xaex, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('LiaU,iKWa->KLWU', X_aaaa, v_xxae, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('LiaW,KUai->KLWU', X_aaaa, v_xaex, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('LiaW,iKUa->KLWU', X_aaaa, v_xxae, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KiaU,LWai->KLWU', X_abba, v_xaex, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KiaW,LUai->KLWU', X_abba, v_xaex, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('LiaU,KWai->KLWU', X_abba, v_xaex, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('LiaW,KUai->KLWU', X_abba, v_xaex, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLaU,a,Wa->KLWU', X_aaaa, e_extern, t1_ae, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLaW,a,Ua->KLWU', X_aaaa, e_extern, t1_ae, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLax,a,UWxa->KLWU', X_aaaa, e_extern, t1_aaae, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLax,a,WUxa->KLWU', X_aaaa, e_extern, t1_aaae, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,Ua,Wx->KLWU', X_aaaa, h_ae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,Wa,Ux->KLWU', X_aaaa, h_ae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLaU,Wx,xa->KLWU', X_aaaa, h_aa, t1_ae, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLaW,Ux,xa->KLWU', X_aaaa, h_aa, t1_ae, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLax,Uy,Wyxa->KLWU', X_aaaa, h_aa, t1_aaae, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLax,Uy,yWxa->KLWU', X_aaaa, h_aa, t1_aaae, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLax,Wy,Uyxa->KLWU', X_aaaa, h_aa, t1_aaae, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLax,Wy,yUxa->KLWU', X_aaaa, h_aa, t1_aaae, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLax,xy,UWya->KLWU', X_aaaa, h_aa, t1_aaae, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLax,xy,WUya->KLWU', X_aaaa, h_aa, t1_aaae, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLax,ya,UxWy->KLWU', X_aaaa, t1_ae, v_aaaa, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLax,ya,UyWx->KLWU', X_aaaa, t1_ae, v_aaaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLax,yzxa,UyWz->KLWU', X_aaaa, t1_aaae, v_aaaa, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLax,yzxa,UzWy->KLWU', X_aaaa, t1_aaae, v_aaaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLaU,Wxya,yx->KLWU', X_aaaa, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLaU,xyWa,xy->KLWU', X_aaaa, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLaW,Uxya,yx->KLWU', X_aaaa, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLaW,xyUa,xy->KLWU', X_aaaa, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,Uxya,Wy->KLWU', X_aaaa, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,UyWa,xy->KLWU', X_aaaa, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,Uyza,Wyxz->KLWU', X_aaaa, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,Uyza,Wyzx->KLWU', X_aaaa, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,Wxya,Uy->KLWU', X_aaaa, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,WyUa,xy->KLWU', X_aaaa, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,Wyza,Uyxz->KLWU', X_aaaa, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,Wyza,Uyzx->KLWU', X_aaaa, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yxUa,Wy->KLWU', X_aaaa, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yxWa,Uy->KLWU', X_aaaa, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yzUa,Wzxy->KLWU', X_aaaa, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yzWa,Uzxy->KLWU', X_aaaa, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KiaU,Lxai,Wx->KLWU', X_aaaa, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KiaU,iLxa,Wx->KLWU', X_aaaa, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KiaW,Lxai,Ux->KLWU', X_aaaa, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KiaW,iLxa,Ux->KLWU', X_aaaa, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('Kiax,LUai,Wx->KLWU', X_aaaa, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('Kiax,LWai,Ux->KLWU', X_aaaa, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('Kiax,Lyai,UWxy->KLWU', X_aaaa, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('Kiax,Lyai,UWyx->KLWU', X_aaaa, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('Kiax,iLUa,Wx->KLWU', X_aaaa, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('Kiax,iLWa,Ux->KLWU', X_aaaa, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('Kiax,iLya,UWxy->KLWU', X_aaaa, v_xxae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('Kiax,iLya,UWyx->KLWU', X_aaaa, v_xxae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('LiaU,Kxai,Wx->KLWU', X_aaaa, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('LiaU,iKxa,Wx->KLWU', X_aaaa, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('LiaW,Kxai,Ux->KLWU', X_aaaa, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('LiaW,iKxa,Ux->KLWU', X_aaaa, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('Liax,KUai,Wx->KLWU', X_aaaa, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('Liax,KWai,Ux->KLWU', X_aaaa, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('Liax,Kyai,UWxy->KLWU', X_aaaa, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('Liax,Kyai,UWyx->KLWU', X_aaaa, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('Liax,iKUa,Wx->KLWU', X_aaaa, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('Liax,iKWa,Ux->KLWU', X_aaaa, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('Liax,iKya,UWxy->KLWU', X_aaaa, v_xxae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('Liax,iKya,UWyx->KLWU', X_aaaa, v_xxae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KiaU,Lxai,Wx->KLWU', X_abba, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KiaW,Lxai,Ux->KLWU', X_abba, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('Kiax,LUai,Wx->KLWU', X_abba, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('Kiax,LWai,Ux->KLWU', X_abba, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('Kiax,Lyai,UWxy->KLWU', X_abba, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('Kiax,Lyai,UWyx->KLWU', X_abba, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('LiaU,Kxai,Wx->KLWU', X_abba, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('LiaW,Kxai,Ux->KLWU', X_abba, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('Liax,KUai,Wx->KLWU', X_abba, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('Liax,KWai,Ux->KLWU', X_abba, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('Liax,Kyai,UWxy->KLWU', X_abba, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('Liax,Kyai,UWyx->KLWU', X_abba, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLaU,a,Wxya,xy->KLWU', X_aaaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLaU,a,xWya,xy->KLWU', X_aaaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLaW,a,Uxya,xy->KLWU', X_aaaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLaW,a,xUya,xy->KLWU', X_aaaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,a,UWya,xy->KLWU', X_aaaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,a,Ua,Wx->KLWU', X_aaaa, e_extern, t1_ae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,a,Uyxa,Wy->KLWU', X_aaaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,a,Uyza,Wzxy->KLWU', X_aaaa, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,a,Uyza,Wzyx->KLWU', X_aaaa, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,a,WUya,xy->KLWU', X_aaaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,a,Wa,Ux->KLWU', X_aaaa, e_extern, t1_ae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,a,Wyxa,Uy->KLWU', X_aaaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,a,Wyza,Uzxy->KLWU', X_aaaa, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,a,Wyza,Uzyx->KLWU', X_aaaa, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,a,yUxa,Wy->KLWU', X_aaaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,a,yUza,Wzxy->KLWU', X_aaaa, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,a,yWxa,Uy->KLWU', X_aaaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,a,yWza,Uzxy->KLWU', X_aaaa, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLaU,Wx,xyza,zy->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLaU,Wx,yxza,zy->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLaU,xy,Wxza,yz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLaU,xy,Wzxa,yz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLaU,xy,xWza,yz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLaU,xy,zWxa,yz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLaW,Ux,xyza,zy->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLaW,Ux,yxza,zy->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLaW,xy,Uxza,yz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLaW,xy,Uzxa,yz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLaW,xy,xUza,yz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLaW,xy,zUxa,yz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,Uy,Wyza,xz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,Uy,yWza,xz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,Uy,ya,Wx->KLWU', X_aaaa, h_aa, t1_ae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,Uy,yzwa,Wwxz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,Uy,yzwa,Wwzx->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,Uy,yzxa,Wz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,Uy,zywa,Wwxz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,Uy,zyxa,Wz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,Wy,Uyza,xz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,Wy,yUza,xz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,Wy,ya,Ux->KLWU', X_aaaa, h_aa, t1_ae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,Wy,yzwa,Uwxz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,Wy,yzwa,Uwzx->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,Wy,yzxa,Uz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,Wy,zywa,Uwxz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,Wy,zyxa,Uz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,xy,Uzya,Wz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,xy,Wzya,Uz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,xy,zUya,Wz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,xy,zWya,Uz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yz,UWya,xz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yz,Uwya,Wzwx->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yz,Uwya,Wzxw->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yz,Uywa,Wwxz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yz,Uywa,Wwzx->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yz,Uyxa,Wz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yz,WUya,xz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yz,Wwya,Uzwx->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yz,Wwya,Uzxw->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yz,Wywa,Uwxz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yz,Wywa,Uwzx->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yz,Wyxa,Uz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yz,wUya,Wzxw->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yz,wWya,Uzxw->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yz,yUwa,Wwxz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yz,yUxa,Wz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yz,yWwa,Uwxz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yz,yWxa,Uz->KLWU', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLaU,Wxya,xzwu,ywzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLaU,Wxya,yzwu,xwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLaU,xWya,xzwu,ywzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLaU,xWya,yzwu,xwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLaU,xa,Wxyz,yz->KLWU', X_aaaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLaU,xa,Wyzx,zy->KLWU', X_aaaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLaU,xyza,Wwux,zwuy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLaU,xyza,Wwuy,zwxu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLaU,xyza,Wwzu,yxwu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLaU,xyza,Wxwu,zuyw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLaU,xyza,Wxwy,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLaU,xyza,Wywu,zuxw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLaU,xyza,Wywx,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLaW,Uxya,xzwu,ywzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLaW,Uxya,yzwu,xwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLaW,xUya,xzwu,ywzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLaW,xUya,yzwu,xwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLaW,xa,Uxyz,yz->KLWU', X_aaaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLaW,xa,Uyzx,zy->KLWU', X_aaaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLaW,xyza,Uwux,zwuy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLaW,xyza,Uwuy,zwxu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLaW,xyza,Uwzu,yxwu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLaW,xyza,Uxwu,zuyw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLaW,xyza,Uxwy,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLaW,xyza,Uywu,zuxw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLaW,xyza,Uywx,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLax,UWya,xyzw,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,UWya,xzwy,wz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,UWya,yzwu,xwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLax,Uyxa,Wyzw,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,Uyxa,Wzwy,wz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,Uyxa,yzwu,Wwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,Uyza,Wwuy,xuwz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,Uyza,Wwuy,xuzw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,Uyza,Wwzu,xyuw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,Uyza,Wwzu,xywu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,Uyza,Wwzx,yw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,Uyza,Wxwy,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,Uyza,Wxzw,yw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,Uyza,Wywu,xwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,Uyza,Wywx,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,Uyza,xwuz,Wuwy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,Uyza,xwuz,Wuyw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,Uyza,xwyu,Wzuw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,Uyza,xwyu,Wzwu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,Uyza,xzwu,Wwyu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,Uyza,ywuv,Wzuwxv->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,Uyza,ywuv,Wzuxwv->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,Uyza,zwuv,Wwvxyu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,Uyza,zwuv,Wwvyxu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLax,WUya,xyzw,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,WUya,xzwy,wz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,WUya,yzwu,xwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLax,Wyxa,Uyzw,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,Wyxa,Uzwy,wz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,Wyxa,yzwu,Uwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,Wyza,Uwuy,xuwz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,Wyza,Uwuy,xuzw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,Wyza,Uwzu,xyuw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,Wyza,Uwzu,xywu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,Wyza,Uwzx,yw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,Wyza,Uxwy,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,Wyza,Uxzw,yw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,Wyza,Uywu,xwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,Wyza,Uywx,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,Wyza,xwuz,Uuwy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,Wyza,xwuz,Uuyw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,Wyza,xwyu,Uzuw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,Wyza,xwyu,Uzwu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,Wyza,xzwu,Uwyu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,Wyza,ywuv,Uzuwxv->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,Wyza,ywuv,Uzuxwv->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,Wyza,zwuv,Uwvxyu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,Wyza,zwuv,Uwvyxu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLax,yUxa,Wyzw,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yUxa,Wzwy,wz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yUxa,yzwu,Wwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yUza,Wwuy,xuwz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yUza,Wwzu,xywu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yUza,Wwzx,yw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLax,yUza,Wxwy,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLax,yUza,Wxzw,yw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yUza,Wywu,xwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yUza,Wywx,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yUza,xwuz,Wuwy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yUza,xwyu,Wzwu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yUza,xzwu,Wwyu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yUza,ywuv,Wzuxwv->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yUza,zwuv,Wwvxyu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLax,yWxa,Uyzw,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yWxa,Uzwy,wz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yWxa,yzwu,Uwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yWza,Uwuy,xuwz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yWza,Uwzu,xywu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yWza,Uwzx,yw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLax,yWza,Uxwy,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLax,yWza,Uxzw,yw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yWza,Uywu,xwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yWza,Uywx,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yWza,xwuz,Uuwy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yWza,xwyu,Uzwu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yWza,xzwu,Uwyu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yWza,ywuv,Uzuxwv->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yWza,zwuv,Uwvxyu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,ya,Uxzy,Wz->KLWU', X_aaaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,ya,UyWz,xz->KLWU', X_aaaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,ya,Uyzw,Wwxz->KLWU', X_aaaa, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,ya,Uyzx,Wz->KLWU', X_aaaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,ya,UzWy,xz->KLWU', X_aaaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,ya,Uzwy,Wzwx->KLWU', X_aaaa, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,ya,Uzwy,Wzxw->KLWU', X_aaaa, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,ya,Wxzy,Uz->KLWU', X_aaaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,ya,Wyzw,Uwxz->KLWU', X_aaaa, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,ya,Wyzx,Uz->KLWU', X_aaaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,ya,Wzwy,Uzwx->KLWU', X_aaaa, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,ya,Wzwy,Uzxw->KLWU', X_aaaa, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzwa,UuWy,xzuw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzwa,UuWy,xzwu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yzwa,UuWz,xyuw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzwa,Uuvy,Wwuxvz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzwa,Uuvy,Wwuzvx->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzwa,Uuvz,Wwuvyx->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzwa,Uuvz,Wwuxyv->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzwa,Uuwv,Wuvxzy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzwa,Uuwv,Wuvzxy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzwa,Uuwx,Wuyz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzwa,Uuwx,Wuzy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yzwa,UxWy,wz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KLax,yzwa,UxWz,wy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yzwa,Uxuy,Wwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yzwa,Uxuz,Wwuy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yzwa,Uxwu,Wuzy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzwa,UyWu,xzuw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzwa,UyWu,xzwu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yzwa,UyWx,wz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yzwa,UyWz,xw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzwa,Uyuv,Wwvxzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzwa,Uyuv,Wwvzxu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzwa,Uyux,Wwuz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzwa,Uyux,Wwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzwa,Uyuz,Wwux->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzwa,Uyuz,Wwxu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yzwa,UzWu,xyuw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KLax,yzwa,UzWx,wy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yzwa,UzWy,xw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yzwa,Uzuv,Wwvxyu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yzwa,Uzux,Wwuy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yzwa,Uzuy,Wwxu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzwa,Wuvy,Uwuxvz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzwa,Wuvy,Uwuzvx->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzwa,Wuvz,Uwuvyx->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzwa,Wuvz,Uwuxyv->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzwa,Wuwv,Uuvxzy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzwa,Wuwv,Uuvzxy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzwa,Wuwx,Uuyz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzwa,Wuwx,Uuzy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yzwa,Wxuy,Uwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yzwa,Wxuz,Uwuy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yzwa,Wxwu,Uuzy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzwa,Wyuv,Uwvxzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzwa,Wyuv,Uwvzxu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzwa,Wyux,Uwuz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzwa,Wyux,Uwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzwa,Wyuz,Uwux->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzwa,Wyuz,Uwxu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yzwa,Wzuv,Uwvxyu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yzwa,Wzux,Uwuy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yzwa,Wzuy,Uwxu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yzxa,UwWy,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yzxa,UwWz,yw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzxa,Uwuy,Wwuz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzxa,Uwuy,Wwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzxa,Uwuz,Wwuy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzxa,Uwuz,Wwyu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yzxa,UyWw,zw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yzxa,Uywu,Wuzw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yzxa,Uywz,Ww->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yzxa,UzWw,yw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yzxa,Uzwu,Wuyw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yzxa,Uzwy,Ww->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzxa,Wwuy,Uwuz->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzxa,Wwuy,Uwzu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('KLax,yzxa,Wwuz,Uwuy->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('KLax,yzxa,Wwuz,Uwyu->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yzxa,Wywu,Uuzw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KLax,yzxa,Wywz,Uw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yzxa,Wzwu,Uuyw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KLax,yzxa,Wzwy,Uw->KLWU', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa = sigma_KLWU_aaaa[:, :, aa_tril_ind[0], aa_tril_ind[1]]
    sigma[ccaa__aaaa] += ascontiguousarray(sigma_KLWU_aaaa[cc_tril_ind[0], cc_tril_ind[1]]).reshape(-1)

    sigma_KLWU_abab =- einsum('KiaW,LUai->KLWU', X_aaaa, v_xaex, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLaU,Wa->KLWU', X_abab, h_ae, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLax,UxWa->KLWU', X_abab, v_aaae, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KiaU,iLWa->KLWU', X_abab, v_xxae, optimize = einsum_type)
    sigma_KLWU_abab += einsum('iLaU,KWai->KLWU', X_abab, v_xaex, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('iLaU,iKWa->KLWU', X_abab, v_xxae, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLaW,Ua->KLWU', X_abba, h_ae, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLax,WxUa->KLWU', X_abba, v_aaae, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KiaW,LUai->KLWU', X_abba, v_xaex, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KiaW,iLUa->KLWU', X_abba, v_xxae, optimize = einsum_type)
    sigma_KLWU_abab += einsum('iLaW,iKUa->KLWU', X_abba, v_xxae, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('LiaU,KWai->KLWU', X_bbbb, v_xaex, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KiaW,Lxai,Ux->KLWU', X_aaaa, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('Kiax,LUai,Wx->KLWU', X_aaaa, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('Kiax,Lyai,UWxy->KLWU', X_aaaa, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('Kiax,Lyai,UWyx->KLWU', X_aaaa, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLaU,a,Wa->KLWU', X_abab, e_extern, t1_ae, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLax,a,UWxa->KLWU', X_abab, e_extern, t1_aaae, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,Wa,Ux->KLWU', X_abab, h_ae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLaU,Wx,xa->KLWU', X_abab, h_aa, t1_ae, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLax,Uy,yWxa->KLWU', X_abab, h_aa, t1_aaae, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLax,Wy,Uyxa->KLWU', X_abab, h_aa, t1_aaae, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLax,xy,UWya->KLWU', X_abab, h_aa, t1_aaae, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLax,ya,UxWy->KLWU', X_abab, t1_ae, v_aaaa, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLax,yzxa,UyWz->KLWU', X_abab, t1_aaae, v_aaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLaU,Wxya,yx->KLWU', X_abab, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLaU,xyWa,xy->KLWU', X_abab, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,Uxya,Wy->KLWU', X_abab, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,UyWa,xy->KLWU', X_abab, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Uyza,Wyxz->KLWU', X_abab, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,Uyza,Wyzx->KLWU', X_abab, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,Wyza,Uyxz->KLWU', X_abab, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Wyza,Uyzx->KLWU', X_abab, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yxWa,Uy->KLWU', X_abab, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yzWa,Uzxy->KLWU', X_abab, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KiaU,iLxa,Wx->KLWU', X_abab, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('Kiax,iLWa,Ux->KLWU', X_abab, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('Kiax,iLya,UWxy->KLWU', X_abab, v_xxae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('Kiax,iLya,UWyx->KLWU', X_abab, v_xxae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('iLaU,Kxai,Wx->KLWU', X_abab, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('iLaU,iKxa,Wx->KLWU', X_abab, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('iLax,KWai,Ux->KLWU', X_abab, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('iLax,Kyai,UWxy->KLWU', X_abab, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('iLax,Kyai,UWyx->KLWU', X_abab, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('iLax,iKWa,Ux->KLWU', X_abab, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('iLax,iKya,UWxy->KLWU', X_abab, v_xxae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('iLax,iKya,UWyx->KLWU', X_abab, v_xxae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLaW,a,Ua->KLWU', X_abba, e_extern, t1_ae, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLax,a,WUxa->KLWU', X_abba, e_extern, t1_aaae, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,Ua,Wx->KLWU', X_abba, h_ae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLaW,Ux,xa->KLWU', X_abba, h_aa, t1_ae, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLax,Uy,Wyxa->KLWU', X_abba, h_aa, t1_aaae, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLax,Wy,yUxa->KLWU', X_abba, h_aa, t1_aaae, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLax,xy,WUya->KLWU', X_abba, h_aa, t1_aaae, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLax,ya,UyWx->KLWU', X_abba, t1_ae, v_aaaa, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLax,yzxa,UzWy->KLWU', X_abba, t1_aaae, v_aaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLaW,Uxya,yx->KLWU', X_abba, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLaW,xyUa,xy->KLWU', X_abba, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,Uyza,Wyxz->KLWU', X_abba, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Uyza,Wyzx->KLWU', X_abba, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,Wxya,Uy->KLWU', X_abba, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,WyUa,xy->KLWU', X_abba, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Wyza,Uyxz->KLWU', X_abba, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,Wyza,Uyzx->KLWU', X_abba, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yxUa,Wy->KLWU', X_abba, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yzUa,Wzxy->KLWU', X_abba, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KiaW,Lxai,Ux->KLWU', X_abba, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KiaW,iLxa,Ux->KLWU', X_abba, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('Kiax,LUai,Wx->KLWU', X_abba, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('Kiax,Lyai,UWxy->KLWU', X_abba, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('Kiax,Lyai,UWyx->KLWU', X_abba, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('Kiax,iLUa,Wx->KLWU', X_abba, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('Kiax,iLya,UWxy->KLWU', X_abba, v_xxae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('Kiax,iLya,UWyx->KLWU', X_abba, v_xxae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('iLaW,iKxa,Ux->KLWU', X_abba, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('iLax,iKUa,Wx->KLWU', X_abba, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('iLax,iKya,UWxy->KLWU', X_abba, v_xxae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('iLax,iKya,UWyx->KLWU', X_abba, v_xxae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('LiaU,Kxai,Wx->KLWU', X_bbbb, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('Liax,KWai,Ux->KLWU', X_bbbb, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('Liax,Kyai,UWxy->KLWU', X_bbbb, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('Liax,Kyai,UWyx->KLWU', X_bbbb, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLaU,a,Wxya,xy->KLWU', X_abab, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLaU,a,xWya,xy->KLWU', X_abab, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,a,UWya,xy->KLWU', X_abab, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,a,Uyxa,Wy->KLWU', X_abab, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,a,Uyza,Wzxy->KLWU', X_abab, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,a,Uyza,Wzyx->KLWU', X_abab, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,a,Wa,Ux->KLWU', X_abab, e_extern, t1_ae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,a,Wyza,Uzxy->KLWU', X_abab, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,a,Wyza,Uzyx->KLWU', X_abab, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,a,yWxa,Uy->KLWU', X_abab, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,a,yWza,Uzxy->KLWU', X_abab, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLaU,Wx,xyza,zy->KLWU', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLaU,Wx,yxza,zy->KLWU', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLaU,xy,Wxza,yz->KLWU', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLaU,xy,Wzxa,yz->KLWU', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLaU,xy,xWza,yz->KLWU', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLaU,xy,zWxa,yz->KLWU', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,Uy,yWza,xz->KLWU', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Uy,yzwa,Wwxz->KLWU', X_abab, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,Uy,yzwa,Wwzx->KLWU', X_abab, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,Uy,yzxa,Wz->KLWU', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,Wy,Uyza,xz->KLWU', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,Wy,ya,Ux->KLWU', X_abab, h_aa, t1_ae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,Wy,yzwa,Uwxz->KLWU', X_abab, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Wy,yzwa,Uwzx->KLWU', X_abab, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,Wy,zywa,Uwxz->KLWU', X_abab, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,Wy,zyxa,Uz->KLWU', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,xy,Uzya,Wz->KLWU', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,xy,zWya,Uz->KLWU', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yz,UWya,xz->KLWU', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yz,Uwya,Wzwx->KLWU', X_abab, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yz,Uwya,Wzxw->KLWU', X_abab, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yz,Uywa,Wwxz->KLWU', X_abab, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yz,Uywa,Wwzx->KLWU', X_abab, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yz,Uyxa,Wz->KLWU', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yz,Wwya,Uzwx->KLWU', X_abab, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yz,Wwya,Uzxw->KLWU', X_abab, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yz,Wywa,Uwxz->KLWU', X_abab, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yz,Wywa,Uwzx->KLWU', X_abab, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yz,wWya,Uzxw->KLWU', X_abab, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yz,yWwa,Uwxz->KLWU', X_abab, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yz,yWxa,Uz->KLWU', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLaU,Wxya,xzwu,ywzu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLaU,Wxya,yzwu,xwzu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLaU,xWya,xzwu,ywzu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLaU,xWya,yzwu,xwzu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLaU,xa,Wxyz,yz->KLWU', X_abab, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLaU,xa,Wyzx,zy->KLWU', X_abab, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLaU,xyza,Wwux,zwuy->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLaU,xyza,Wwuy,zwxu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLaU,xyza,Wwzu,yxwu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLaU,xyza,Wxwu,zuyw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLaU,xyza,Wxwy,zw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLaU,xyza,Wywu,zuxw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLaU,xyza,Wywx,zw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLax,UWya,xyzw,zw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,UWya,xzwy,wz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,UWya,yzwu,xwzu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLax,Uyxa,Wyzw,zw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,Uyxa,Wzwy,wz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,Uyxa,yzwu,Wwzu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Uyza,Wwuy,xuwz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,Uyza,Wwuy,xuzw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,Uyza,Wwzu,xyuw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Uyza,Wwzu,xywu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,Uyza,Wwzx,yw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,Uyza,Wywu,xwzu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,Uyza,Wywx,zw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Uyza,xwuz,Wuwy->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,Uyza,xwuz,Wuyw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,Uyza,xwyu,Wzuw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Uyza,xwyu,Wzwu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,Uyza,xzwu,Wwyu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Uyza,ywuv,Wzuvwx->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Uyza,ywuv,Wzuvxw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Uyza,ywuv,Wzuwvx->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Uyza,ywuv,Wzuwxv->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Uyza,ywuv,Wzuxvw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Uyza,zwuv,Wwvuxy->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Uyza,zwuv,Wwvuyx->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Uyza,zwuv,Wwvxuy->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Uyza,zwuv,Wwvyux->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Uyza,zwuv,Wwvyxu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,Wyza,Uwuy,xuwz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Wyza,Uwuy,xuzw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Wyza,Uwzu,xyuw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,Wyza,Uwzu,xywu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,Wyza,Uxwy,zw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,Wyza,Uxzw,yw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,Wyza,xwuz,Uuwy->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Wyza,xwuz,Uuyw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Wyza,xwyu,Uzuw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,Wyza,xwyu,Uzwu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Wyza,ywuv,Uzuwxv->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,Wyza,ywuv,Uzuxwv->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,Wyza,zwuv,Uwvxyu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Wyza,zwuv,Uwvyxu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLax,yWxa,Uyzw,zw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yWxa,Uzwy,wz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yWxa,yzwu,Uwzu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yWza,Uwuy,xuwz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yWza,Uwzu,xywu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yWza,Uwzx,yw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLax,yWza,Uxwy,zw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLax,yWza,Uxzw,yw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yWza,Uywu,xwzu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yWza,Uywx,zw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yWza,xwuz,Uuwy->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yWza,xwyu,Uzwu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yWza,xzwu,Uwyu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yWza,ywuv,Uzuxwv->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yWza,zwuv,Uwvxyu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,ya,Uxzy,Wz->KLWU', X_abab, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,ya,UzWy,xz->KLWU', X_abab, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,ya,Uzwy,Wzwx->KLWU', X_abab, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,ya,Uzwy,Wzxw->KLWU', X_abab, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,ya,Wyzw,Uwxz->KLWU', X_abab, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,ya,Wyzx,Uz->KLWU', X_abab, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,ya,Wzwy,Uzwx->KLWU', X_abab, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,ya,Wzwy,Uzxw->KLWU', X_abab, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yzwa,UuWy,xzuw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,UuWy,xzwu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yzwa,UuWz,xyuw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Uuvy,Wwuxvz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yzwa,Uuvy,Wwuzvx->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Uuvz,Wwuvxy->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Uuvz,Wwuvyx->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Uuvz,Wwuxvy->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Uuvz,Wwuyvx->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Uuvz,Wwuyxv->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Uuwv,Wuvxyz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Uuwv,Wuvyxz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Uuwv,Wuvyzx->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Uuwv,Wuvzxy->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Uuwv,Wuvzyx->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Uuwx,Wuyz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yzwa,Uuwx,Wuzy->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yzwa,UxWy,wz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLax,yzwa,UxWz,wy->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yzwa,Uxuy,Wwzu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yzwa,Uxuz,Wwuy->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yzwa,Uxwu,Wuzy->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,UyWu,xzuw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yzwa,UyWu,xzwu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yzwa,UyWz,xw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Uyuv,Wwvuxz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Uyuv,Wwvuzx->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Uyuv,Wwvxuz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Uyuv,Wwvzux->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Uyuv,Wwvzxu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Uyux,Wwuz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yzwa,Uyux,Wwzu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yzwa,Uyuz,Wwux->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Uyuz,Wwxu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Wuvy,Uwuvxz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Wuvy,Uwuvzx->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Wuvy,Uwuxvz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Wuvy,Uwuxzv->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Wuvy,Uwuzxv->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Wuvz,Uwuvyx->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yzwa,Wuvz,Uwuxyv->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yzwa,Wuwv,Uuvxzy->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Wuwv,Uuvzxy->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yzwa,Wuwx,Uuyz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Wuwx,Uuzy->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yzwa,Wyuv,Uwvxzu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Wyuv,Uwvzxu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yzwa,Wyux,Uwuz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Wyux,Uwzu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Wyuz,Uwux->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yzwa,Wyuz,Uwxu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yzwa,Wzuv,Uwvxyu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yzwa,Wzux,Uwuy->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yzwa,Wzuy,Uwxu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yzxa,UwWz,yw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzxa,Uwuy,Wwuz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yzxa,Uwuy,Wwzu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yzxa,Uwuz,Wwuy->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzxa,Uwuz,Wwyu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yzxa,UyWw,zw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yzxa,Uywu,Wuzw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yzxa,Uywz,Ww->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yzxa,Wwuy,Uwuz->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzxa,Wwuy,Uwzu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzxa,Wwuz,Uwuy->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yzxa,Wwuz,Uwyu->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yzxa,Wzwu,Uuyw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yzxa,Wzwy,Uw->KLWU', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLaW,a,Uxya,xy->KLWU', X_abba, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLaW,a,xUya,xy->KLWU', X_abba, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,a,Ua,Wx->KLWU', X_abba, e_extern, t1_ae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,a,Uyza,Wzxy->KLWU', X_abba, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,a,Uyza,Wzyx->KLWU', X_abba, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,a,WUya,xy->KLWU', X_abba, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,a,Wyxa,Uy->KLWU', X_abba, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,a,Wyza,Uzxy->KLWU', X_abba, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,a,Wyza,Uzyx->KLWU', X_abba, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,a,yUxa,Wy->KLWU', X_abba, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,a,yUza,Wzxy->KLWU', X_abba, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLaW,Ux,xyza,zy->KLWU', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLaW,Ux,yxza,zy->KLWU', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLaW,xy,Uxza,yz->KLWU', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLaW,xy,Uzxa,yz->KLWU', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLaW,xy,xUza,yz->KLWU', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLaW,xy,zUxa,yz->KLWU', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,Uy,Wyza,xz->KLWU', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,Uy,ya,Wx->KLWU', X_abba, h_aa, t1_ae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,Uy,yzwa,Wwxz->KLWU', X_abba, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Uy,yzwa,Wwzx->KLWU', X_abba, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,Uy,zywa,Wwxz->KLWU', X_abba, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,Uy,zyxa,Wz->KLWU', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,Wy,yUza,xz->KLWU', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Wy,yzwa,Uwxz->KLWU', X_abba, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,Wy,yzwa,Uwzx->KLWU', X_abba, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,Wy,yzxa,Uz->KLWU', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,xy,Wzya,Uz->KLWU', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,xy,zUya,Wz->KLWU', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yz,Uwya,Wzwx->KLWU', X_abba, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yz,Uwya,Wzxw->KLWU', X_abba, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yz,Uywa,Wwxz->KLWU', X_abba, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yz,Uywa,Wwzx->KLWU', X_abba, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yz,WUya,xz->KLWU', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yz,Wwya,Uzwx->KLWU', X_abba, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yz,Wwya,Uzxw->KLWU', X_abba, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yz,Wywa,Uwxz->KLWU', X_abba, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yz,Wywa,Uwzx->KLWU', X_abba, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yz,Wyxa,Uz->KLWU', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yz,wUya,Wzxw->KLWU', X_abba, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yz,yUwa,Wwxz->KLWU', X_abba, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yz,yUxa,Wz->KLWU', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLaW,Uxya,xzwu,ywzu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLaW,Uxya,yzwu,xwzu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLaW,xUya,xzwu,ywzu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLaW,xUya,yzwu,xwzu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLaW,xa,Uxyz,yz->KLWU', X_abba, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLaW,xa,Uyzx,zy->KLWU', X_abba, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLaW,xyza,Uwux,zwuy->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLaW,xyza,Uwuy,zwxu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLaW,xyza,Uwzu,yxwu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLaW,xyza,Uxwu,zuyw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLaW,xyza,Uxwy,zw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLaW,xyza,Uywu,zuxw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLaW,xyza,Uywx,zw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,Uyza,Wwuy,xuwz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Uyza,Wwuy,xuzw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Uyza,Wwzu,xyuw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,Uyza,Wwzu,xywu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,Uyza,Wxwy,zw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,Uyza,Wxzw,yw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,Uyza,xwuz,Wuwy->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Uyza,xwuz,Wuyw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Uyza,xwyu,Wzuw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,Uyza,xwyu,Wzwu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Uyza,ywuv,Wzuwxv->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,Uyza,ywuv,Wzuxwv->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,Uyza,zwuv,Wwvxyu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Uyza,zwuv,Wwvyxu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLax,WUya,xyzw,zw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,WUya,xzwy,wz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,WUya,yzwu,xwzu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLax,Wyxa,Uyzw,zw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,Wyxa,Uzwy,wz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,Wyxa,yzwu,Uwzu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Wyza,Uwuy,xuwz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,Wyza,Uwuy,xuzw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,Wyza,Uwzu,xyuw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Wyza,Uwzu,xywu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,Wyza,Uwzx,yw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,Wyza,Uywu,xwzu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,Wyza,Uywx,zw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Wyza,xwuz,Uuwy->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,Wyza,xwuz,Uuyw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,Wyza,xwyu,Uzuw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Wyza,xwyu,Uzwu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,Wyza,xzwu,Uwyu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Wyza,ywuv,Uzuvwx->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Wyza,ywuv,Uzuvxw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Wyza,ywuv,Uzuwvx->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Wyza,ywuv,Uzuwxv->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Wyza,ywuv,Uzuxvw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Wyza,zwuv,Uwvuxy->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Wyza,zwuv,Uwvuyx->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Wyza,zwuv,Uwvxuy->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,Wyza,zwuv,Uwvyux->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,Wyza,zwuv,Uwvyxu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLax,yUxa,Wyzw,zw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yUxa,Wzwy,wz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yUxa,yzwu,Wwzu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yUza,Wwuy,xuwz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yUza,Wwzu,xywu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yUza,Wwzx,yw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLax,yUza,Wxwy,zw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KLax,yUza,Wxzw,yw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yUza,Wywu,xwzu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yUza,Wywx,zw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yUza,xwuz,Wuwy->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yUza,xwyu,Wzwu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yUza,xzwu,Wwyu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yUza,ywuv,Wzuxwv->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yUza,zwuv,Wwvxyu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,ya,UyWz,xz->KLWU', X_abba, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,ya,Uyzw,Wwxz->KLWU', X_abba, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,ya,Uyzx,Wz->KLWU', X_abba, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,ya,Uzwy,Wzwx->KLWU', X_abba, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,ya,Uzwy,Wzxw->KLWU', X_abba, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,ya,Wxzy,Uz->KLWU', X_abba, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,ya,Wzwy,Uzwx->KLWU', X_abba, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,ya,Wzwy,Uzxw->KLWU', X_abba, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,UuWy,xzuw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yzwa,UuWy,xzwu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Uuvy,Wwuvxz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Uuvy,Wwuvzx->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Uuvy,Wwuxvz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Uuvy,Wwuxzv->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Uuvy,Wwuzxv->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Uuvz,Wwuvyx->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yzwa,Uuvz,Wwuxyv->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yzwa,Uuwv,Wuvxzy->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Uuwv,Wuvzxy->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yzwa,Uuwx,Wuyz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Uuwx,Wuzy->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yzwa,UyWu,xzuw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,UyWu,xzwu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yzwa,UyWx,wz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yzwa,Uyuv,Wwvxzu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Uyuv,Wwvzxu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yzwa,Uyux,Wwuz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Uyux,Wwzu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Uyuz,Wwux->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yzwa,Uyuz,Wwxu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yzwa,UzWu,xyuw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KLax,yzwa,UzWx,wy->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yzwa,UzWy,xw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yzwa,Uzuv,Wwvxyu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yzwa,Uzux,Wwuy->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yzwa,Uzuy,Wwxu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Wuvy,Uwuxvz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yzwa,Wuvy,Uwuzvx->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Wuvz,Uwuvxy->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Wuvz,Uwuvyx->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Wuvz,Uwuxvy->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Wuvz,Uwuyvx->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Wuvz,Uwuyxv->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Wuwv,Uuvxyz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Wuwv,Uuvyxz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Wuwv,Uuvyzx->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Wuwv,Uuvzxy->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Wuwv,Uuvzyx->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Wuwx,Uuyz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('KLax,yzwa,Wuwx,Uuzy->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yzwa,Wxuy,Uwzu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yzwa,Wxuz,Uwuy->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KLax,yzwa,Wxwu,Uuzy->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Wyuv,Uwvuxz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Wyuv,Uwvuzx->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Wyuv,Uwvxuz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('KLax,yzwa,Wyuv,Uwvzux->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Wyuv,Uwvzxu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Wyux,Uwuz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yzwa,Wyux,Uwzu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yzwa,Wyuz,Uwux->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzwa,Wyuz,Uwxu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yzxa,UwWy,zw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yzxa,Uwuy,Wwuz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzxa,Uwuy,Wwzu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzxa,Uwuz,Wwuy->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yzxa,Uwuz,Wwyu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yzxa,UzWw,yw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yzxa,Uzwu,Wuyw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yzxa,Uzwy,Ww->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzxa,Wwuy,Uwuz->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yzxa,Wwuy,Uwzu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('KLax,yzxa,Wwuz,Uwuy->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('KLax,yzxa,Wwuz,Uwyu->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yzxa,Wywu,Uuzw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KLax,yzxa,Wywz,Uw->KLWU', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma[ccaa__abab] += ascontiguousarray(sigma_KLWU_abab).reshape(-1)

    sigma_KLWU_bbbb =- einsum('iKaU,LWai->KLWU', X_abab, v_xaex, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('iKaW,LUai->KLWU', X_abab, v_xaex, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('iLaU,KWai->KLWU', X_abab, v_xaex, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('iLaW,KUai->KLWU', X_abab, v_xaex, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLaU,Wa->KLWU', X_bbbb, h_ae, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLaW,Ua->KLWU', X_bbbb, h_ae, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLax,UxWa->KLWU', X_bbbb, v_aaae, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLax,WxUa->KLWU', X_bbbb, v_aaae, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KiaU,LWai->KLWU', X_bbbb, v_xaex, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KiaU,iLWa->KLWU', X_bbbb, v_xxae, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KiaW,LUai->KLWU', X_bbbb, v_xaex, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KiaW,iLUa->KLWU', X_bbbb, v_xxae, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('LiaU,KWai->KLWU', X_bbbb, v_xaex, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('LiaU,iKWa->KLWU', X_bbbb, v_xxae, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('LiaW,KUai->KLWU', X_bbbb, v_xaex, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('LiaW,iKUa->KLWU', X_bbbb, v_xxae, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('iKaU,Lxai,Wx->KLWU', X_abab, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('iKaW,Lxai,Ux->KLWU', X_abab, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('iKax,LUai,Wx->KLWU', X_abab, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('iKax,LWai,Ux->KLWU', X_abab, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('iKax,Lyai,UWxy->KLWU', X_abab, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('iKax,Lyai,UWyx->KLWU', X_abab, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('iLaU,Kxai,Wx->KLWU', X_abab, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('iLaW,Kxai,Ux->KLWU', X_abab, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('iLax,KUai,Wx->KLWU', X_abab, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('iLax,KWai,Ux->KLWU', X_abab, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('iLax,Kyai,UWxy->KLWU', X_abab, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('iLax,Kyai,UWyx->KLWU', X_abab, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLaU,a,Wa->KLWU', X_bbbb, e_extern, t1_ae, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLaW,a,Ua->KLWU', X_bbbb, e_extern, t1_ae, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLax,a,UWxa->KLWU', X_bbbb, e_extern, t1_aaae, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLax,a,WUxa->KLWU', X_bbbb, e_extern, t1_aaae, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,Ua,Wx->KLWU', X_bbbb, h_ae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,Wa,Ux->KLWU', X_bbbb, h_ae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLaU,Wx,xa->KLWU', X_bbbb, h_aa, t1_ae, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLaW,Ux,xa->KLWU', X_bbbb, h_aa, t1_ae, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLax,Uy,Wyxa->KLWU', X_bbbb, h_aa, t1_aaae, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLax,Uy,yWxa->KLWU', X_bbbb, h_aa, t1_aaae, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLax,Wy,Uyxa->KLWU', X_bbbb, h_aa, t1_aaae, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLax,Wy,yUxa->KLWU', X_bbbb, h_aa, t1_aaae, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLax,xy,UWya->KLWU', X_bbbb, h_aa, t1_aaae, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLax,xy,WUya->KLWU', X_bbbb, h_aa, t1_aaae, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLax,ya,UxWy->KLWU', X_bbbb, t1_ae, v_aaaa, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLax,ya,UyWx->KLWU', X_bbbb, t1_ae, v_aaaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLax,yzxa,UyWz->KLWU', X_bbbb, t1_aaae, v_aaaa, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLax,yzxa,UzWy->KLWU', X_bbbb, t1_aaae, v_aaaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLaU,Wxya,yx->KLWU', X_bbbb, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLaU,xyWa,xy->KLWU', X_bbbb, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLaW,Uxya,yx->KLWU', X_bbbb, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLaW,xyUa,xy->KLWU', X_bbbb, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,Uxya,Wy->KLWU', X_bbbb, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,UyWa,xy->KLWU', X_bbbb, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,Uyza,Wyxz->KLWU', X_bbbb, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,Uyza,Wyzx->KLWU', X_bbbb, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,Wxya,Uy->KLWU', X_bbbb, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,WyUa,xy->KLWU', X_bbbb, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,Wyza,Uyxz->KLWU', X_bbbb, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,Wyza,Uyzx->KLWU', X_bbbb, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yxUa,Wy->KLWU', X_bbbb, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yxWa,Uy->KLWU', X_bbbb, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yzUa,Wzxy->KLWU', X_bbbb, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yzWa,Uzxy->KLWU', X_bbbb, v_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KiaU,Lxai,Wx->KLWU', X_bbbb, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KiaU,iLxa,Wx->KLWU', X_bbbb, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KiaW,Lxai,Ux->KLWU', X_bbbb, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KiaW,iLxa,Ux->KLWU', X_bbbb, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('Kiax,LUai,Wx->KLWU', X_bbbb, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('Kiax,LWai,Ux->KLWU', X_bbbb, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('Kiax,Lyai,UWxy->KLWU', X_bbbb, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('Kiax,Lyai,UWyx->KLWU', X_bbbb, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('Kiax,iLUa,Wx->KLWU', X_bbbb, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('Kiax,iLWa,Ux->KLWU', X_bbbb, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('Kiax,iLya,UWxy->KLWU', X_bbbb, v_xxae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('Kiax,iLya,UWyx->KLWU', X_bbbb, v_xxae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('LiaU,Kxai,Wx->KLWU', X_bbbb, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('LiaU,iKxa,Wx->KLWU', X_bbbb, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('LiaW,Kxai,Ux->KLWU', X_bbbb, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('LiaW,iKxa,Ux->KLWU', X_bbbb, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('Liax,KUai,Wx->KLWU', X_bbbb, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('Liax,KWai,Ux->KLWU', X_bbbb, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('Liax,Kyai,UWxy->KLWU', X_bbbb, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('Liax,Kyai,UWyx->KLWU', X_bbbb, v_xaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('Liax,iKUa,Wx->KLWU', X_bbbb, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('Liax,iKWa,Ux->KLWU', X_bbbb, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('Liax,iKya,UWxy->KLWU', X_bbbb, v_xxae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('Liax,iKya,UWyx->KLWU', X_bbbb, v_xxae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLaU,a,Wxya,xy->KLWU', X_bbbb, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLaU,a,xWya,xy->KLWU', X_bbbb, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLaW,a,Uxya,xy->KLWU', X_bbbb, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLaW,a,xUya,xy->KLWU', X_bbbb, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,a,UWya,xy->KLWU', X_bbbb, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,a,Ua,Wx->KLWU', X_bbbb, e_extern, t1_ae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,a,Uyxa,Wy->KLWU', X_bbbb, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,a,Uyza,Wzxy->KLWU', X_bbbb, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,a,Uyza,Wzyx->KLWU', X_bbbb, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,a,WUya,xy->KLWU', X_bbbb, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,a,Wa,Ux->KLWU', X_bbbb, e_extern, t1_ae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,a,Wyxa,Uy->KLWU', X_bbbb, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,a,Wyza,Uzxy->KLWU', X_bbbb, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,a,Wyza,Uzyx->KLWU', X_bbbb, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,a,yUxa,Wy->KLWU', X_bbbb, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,a,yUza,Wzxy->KLWU', X_bbbb, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,a,yWxa,Uy->KLWU', X_bbbb, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,a,yWza,Uzxy->KLWU', X_bbbb, e_extern, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLaU,Wx,xyza,zy->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLaU,Wx,yxza,zy->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLaU,xy,Wxza,yz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLaU,xy,Wzxa,yz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLaU,xy,xWza,yz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLaU,xy,zWxa,yz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLaW,Ux,xyza,zy->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLaW,Ux,yxza,zy->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLaW,xy,Uxza,yz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLaW,xy,Uzxa,yz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLaW,xy,xUza,yz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLaW,xy,zUxa,yz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,Uy,Wyza,xz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,Uy,yWza,xz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,Uy,ya,Wx->KLWU', X_bbbb, h_aa, t1_ae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,Uy,yzwa,Wwxz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,Uy,yzwa,Wwzx->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,Uy,yzxa,Wz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,Uy,zywa,Wwxz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,Uy,zyxa,Wz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,Wy,Uyza,xz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,Wy,yUza,xz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,Wy,ya,Ux->KLWU', X_bbbb, h_aa, t1_ae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,Wy,yzwa,Uwxz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,Wy,yzwa,Uwzx->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,Wy,yzxa,Uz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,Wy,zywa,Uwxz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,Wy,zyxa,Uz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,xy,Uzya,Wz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,xy,Wzya,Uz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,xy,zUya,Wz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,xy,zWya,Uz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yz,UWya,xz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yz,Uwya,Wzwx->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yz,Uwya,Wzxw->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yz,Uywa,Wwxz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yz,Uywa,Wwzx->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yz,Uyxa,Wz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yz,WUya,xz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yz,Wwya,Uzwx->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yz,Wwya,Uzxw->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yz,Wywa,Uwxz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yz,Wywa,Uwzx->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yz,Wyxa,Uz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yz,wUya,Wzxw->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yz,wWya,Uzxw->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yz,yUwa,Wwxz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yz,yUxa,Wz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yz,yWwa,Uwxz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yz,yWxa,Uz->KLWU', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLaU,Wxya,xzwu,ywzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLaU,Wxya,yzwu,xwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLaU,xWya,xzwu,ywzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLaU,xWya,yzwu,xwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLaU,xa,Wxyz,yz->KLWU', X_bbbb, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLaU,xa,Wyzx,zy->KLWU', X_bbbb, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLaU,xyza,Wwux,zwuy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLaU,xyza,Wwuy,zwxu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLaU,xyza,Wwzu,yxwu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLaU,xyza,Wxwu,zuyw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLaU,xyza,Wxwy,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLaU,xyza,Wywu,zuxw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLaU,xyza,Wywx,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLaW,Uxya,xzwu,ywzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLaW,Uxya,yzwu,xwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLaW,xUya,xzwu,ywzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLaW,xUya,yzwu,xwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLaW,xa,Uxyz,yz->KLWU', X_bbbb, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLaW,xa,Uyzx,zy->KLWU', X_bbbb, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLaW,xyza,Uwux,zwuy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLaW,xyza,Uwuy,zwxu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLaW,xyza,Uwzu,yxwu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLaW,xyza,Uxwu,zuyw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLaW,xyza,Uxwy,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLaW,xyza,Uywu,zuxw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLaW,xyza,Uywx,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLax,UWya,xyzw,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,UWya,xzwy,wz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,UWya,yzwu,xwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLax,Uyxa,Wyzw,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,Uyxa,Wzwy,wz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,Uyxa,yzwu,Wwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,Uyza,Wwuy,xuwz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,Uyza,Wwuy,xuzw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,Uyza,Wwzu,xyuw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,Uyza,Wwzu,xywu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,Uyza,Wwzx,yw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,Uyza,Wxwy,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,Uyza,Wxzw,yw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,Uyza,Wywu,xwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,Uyza,Wywx,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,Uyza,xwuz,Wuwy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,Uyza,xwuz,Wuyw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,Uyza,xwyu,Wzuw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,Uyza,xwyu,Wzwu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,Uyza,xzwu,Wwyu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,Uyza,ywuv,Wzuwxv->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,Uyza,ywuv,Wzuxwv->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,Uyza,zwuv,Wwvxyu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,Uyza,zwuv,Wwvyxu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLax,WUya,xyzw,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,WUya,xzwy,wz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,WUya,yzwu,xwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLax,Wyxa,Uyzw,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,Wyxa,Uzwy,wz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,Wyxa,yzwu,Uwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,Wyza,Uwuy,xuwz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,Wyza,Uwuy,xuzw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,Wyza,Uwzu,xyuw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,Wyza,Uwzu,xywu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,Wyza,Uwzx,yw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,Wyza,Uxwy,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,Wyza,Uxzw,yw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,Wyza,Uywu,xwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,Wyza,Uywx,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,Wyza,xwuz,Uuwy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,Wyza,xwuz,Uuyw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,Wyza,xwyu,Uzuw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,Wyza,xwyu,Uzwu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,Wyza,xzwu,Uwyu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,Wyza,ywuv,Uzuwxv->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,Wyza,ywuv,Uzuxwv->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,Wyza,zwuv,Uwvxyu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,Wyza,zwuv,Uwvyxu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLax,yUxa,Wyzw,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yUxa,Wzwy,wz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yUxa,yzwu,Wwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yUza,Wwuy,xuwz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yUza,Wwzu,xywu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yUza,Wwzx,yw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLax,yUza,Wxwy,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLax,yUza,Wxzw,yw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yUza,Wywu,xwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yUza,Wywx,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yUza,xwuz,Wuwy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yUza,xwyu,Wzwu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yUza,xzwu,Wwyu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yUza,ywuv,Wzuxwv->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yUza,zwuv,Wwvxyu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLax,yWxa,Uyzw,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yWxa,Uzwy,wz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yWxa,yzwu,Uwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yWza,Uwuy,xuwz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yWza,Uwzu,xywu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yWza,Uwzx,yw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLax,yWza,Uxwy,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLax,yWza,Uxzw,yw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yWza,Uywu,xwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yWza,Uywx,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yWza,xwuz,Uuwy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yWza,xwyu,Uzwu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yWza,xzwu,Uwyu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yWza,ywuv,Uzuxwv->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yWza,zwuv,Uwvxyu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,ya,Uxzy,Wz->KLWU', X_bbbb, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,ya,UyWz,xz->KLWU', X_bbbb, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,ya,Uyzw,Wwxz->KLWU', X_bbbb, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,ya,Uyzx,Wz->KLWU', X_bbbb, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,ya,UzWy,xz->KLWU', X_bbbb, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,ya,Uzwy,Wzwx->KLWU', X_bbbb, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,ya,Uzwy,Wzxw->KLWU', X_bbbb, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,ya,Wxzy,Uz->KLWU', X_bbbb, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,ya,Wyzw,Uwxz->KLWU', X_bbbb, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,ya,Wyzx,Uz->KLWU', X_bbbb, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,ya,Wzwy,Uzwx->KLWU', X_bbbb, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,ya,Wzwy,Uzxw->KLWU', X_bbbb, t1_ae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzwa,UuWy,xzuw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzwa,UuWy,xzwu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yzwa,UuWz,xyuw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzwa,Uuvy,Wwuxvz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzwa,Uuvy,Wwuzvx->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzwa,Uuvz,Wwuvyx->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzwa,Uuvz,Wwuxyv->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzwa,Uuwv,Wuvxzy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzwa,Uuwv,Wuvzxy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzwa,Uuwx,Wuyz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzwa,Uuwx,Wuzy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yzwa,UxWy,wz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KLax,yzwa,UxWz,wy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yzwa,Uxuy,Wwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yzwa,Uxuz,Wwuy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yzwa,Uxwu,Wuzy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzwa,UyWu,xzuw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzwa,UyWu,xzwu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yzwa,UyWx,wz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yzwa,UyWz,xw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzwa,Uyuv,Wwvxzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzwa,Uyuv,Wwvzxu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzwa,Uyux,Wwuz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzwa,Uyux,Wwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzwa,Uyuz,Wwux->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzwa,Uyuz,Wwxu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yzwa,UzWu,xyuw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KLax,yzwa,UzWx,wy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yzwa,UzWy,xw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yzwa,Uzuv,Wwvxyu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yzwa,Uzux,Wwuy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yzwa,Uzuy,Wwxu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzwa,Wuvy,Uwuxvz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzwa,Wuvy,Uwuzvx->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzwa,Wuvz,Uwuvyx->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzwa,Wuvz,Uwuxyv->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzwa,Wuwv,Uuvxzy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzwa,Wuwv,Uuvzxy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzwa,Wuwx,Uuyz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzwa,Wuwx,Uuzy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yzwa,Wxuy,Uwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yzwa,Wxuz,Uwuy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yzwa,Wxwu,Uuzy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzwa,Wyuv,Uwvxzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzwa,Wyuv,Uwvzxu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzwa,Wyux,Uwuz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzwa,Wyux,Uwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzwa,Wyuz,Uwux->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzwa,Wyuz,Uwxu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yzwa,Wzuv,Uwvxyu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yzwa,Wzux,Uwuy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yzwa,Wzuy,Uwxu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yzxa,UwWy,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yzxa,UwWz,yw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzxa,Uwuy,Wwuz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzxa,Uwuy,Wwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzxa,Uwuz,Wwuy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzxa,Uwuz,Wwyu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yzxa,UyWw,zw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yzxa,Uywu,Wuzw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yzxa,Uywz,Ww->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yzxa,UzWw,yw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yzxa,Uzwu,Wuyw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yzxa,Uzwy,Ww->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzxa,Wwuy,Uwuz->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzxa,Wwuy,Uwzu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('KLax,yzxa,Wwuz,Uwuy->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('KLax,yzxa,Wwuz,Uwyu->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yzxa,Wywu,Uuzw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KLax,yzxa,Wywz,Uw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yzxa,Wzwu,Uuyw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KLax,yzxa,Wzwy,Uw->KLWU', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb = sigma_KLWU_bbbb[:, :, aa_tril_ind[0], aa_tril_ind[1]]
    sigma[ccaa__bbbb] += ascontiguousarray(sigma_KLWU_bbbb[cc_tril_ind[0], cc_tril_ind[1]]).reshape(-1)

    mr_adc.log.timer_debug("computing sigma H1 h1-h1 CCAA-CCEA", *cput1)

# CCEA <- CCEA
def compute_sigma_vector__H1__h1_h1__CCEA_CCEA(mr_adc, X_aaaa, X_abab, X_abba, X_bbbb, sigma):
    cput1 = (logger.process_clock(), logger.perf_counter())

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    #Excitation Manifold
    ccea__aaaa = mr_adc.h1.ccea__aaaa
    ccea__abab = mr_adc.h1.ccea__abab
    ccea__abba = mr_adc.h1.ccea__abba
    ccea__bbbb = mr_adc.h1.ccea__bbbb 

    ## Indices
    cc_tril_ind = mr_adc.h1.cc_tril_ind 

    ## Two-electron integrals
    v_xxxx = mr_adc.v2e.xxxx
    v_xxaa = mr_adc.v2e.xxaa
    v_xaax = mr_adc.v2e.xaax
    v_xxee = mr_adc.v2e.xxee
    v_xeex = mr_adc.v2e.xeex
    v_aaee = mr_adc.v2e.aaee
    v_aeea = mr_adc.v2e.aeea

    # Reduced Density Matrices
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa

    sigma_KLCW_aaaa  = einsum('KLax,WxCa->KLCW', X_aaaa, v_aaee, optimize = einsum_type)
    sigma_KLCW_aaaa -= einsum('KLax,xCaW->KLCW', X_aaaa, v_aeea, optimize = einsum_type)
    sigma_KLCW_aaaa += einsum('KiCx,LWxi->KLCW', X_aaaa, v_xaax, optimize = einsum_type)
    sigma_KLCW_aaaa -= einsum('KiCx,LixW->KLCW', X_aaaa, v_xxaa, optimize = einsum_type)
    sigma_KLCW_aaaa += einsum('KiaW,LCai->KLCW', X_aaaa, v_xeex, optimize = einsum_type)
    sigma_KLCW_aaaa -= einsum('KiaW,iLCa->KLCW', X_aaaa, v_xxee, optimize = einsum_type)
    sigma_KLCW_aaaa -= einsum('LiCx,KWxi->KLCW', X_aaaa, v_xaax, optimize = einsum_type)
    sigma_KLCW_aaaa += einsum('LiCx,KixW->KLCW', X_aaaa, v_xxaa, optimize = einsum_type)
    sigma_KLCW_aaaa -= einsum('LiaW,KCai->KLCW', X_aaaa, v_xeex, optimize = einsum_type)
    sigma_KLCW_aaaa += einsum('LiaW,iKCa->KLCW', X_aaaa, v_xxee, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('ijCW,KiLj->KLCW', X_aaaa, v_xxxx, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('ijCW,KjLi->KLCW', X_aaaa, v_xxxx, optimize = einsum_type)
    sigma_KLCW_aaaa += einsum('KiCx,LWxi->KLCW', X_abab, v_xaax, optimize = einsum_type)
    sigma_KLCW_aaaa -= einsum('LiCx,KWxi->KLCW', X_abab, v_xaax, optimize = einsum_type)
    sigma_KLCW_aaaa += einsum('KiaW,LCai->KLCW', X_abba, v_xeex, optimize = einsum_type)
    sigma_KLCW_aaaa -= einsum('LiaW,KCai->KLCW', X_abba, v_xeex, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('KLax,WyCa,xy->KLCW', X_aaaa, v_aaee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('KLax,xCay,Wy->KLCW', X_aaaa, v_aeea, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('KLax,yCaW,xy->KLCW', X_aaaa, v_aeea, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/6 * einsum('KLax,yCaz,Wyxz->KLCW', X_aaaa, v_aeea, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/6 * einsum('KLax,yCaz,Wyzx->KLCW', X_aaaa, v_aeea, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('KLax,yxCa,Wy->KLCW', X_aaaa, v_aaee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('KLax,yzCa,Wzxy->KLCW', X_aaaa, v_aaee, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('KiCx,LWyi,xy->KLCW', X_aaaa, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('KiCx,Lixy,Wy->KLCW', X_aaaa, v_xxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('KiCx,LiyW,xy->KLCW', X_aaaa, v_xxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('KiCx,Liyz,Wyxz->KLCW', X_aaaa, v_xxaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('KiCx,Lyxi,Wy->KLCW', X_aaaa, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/6 * einsum('KiCx,Lyzi,Wzxy->KLCW', X_aaaa, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/6 * einsum('KiCx,Lyzi,Wzyx->KLCW', X_aaaa, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('Kiax,LCai,Wx->KLCW', X_aaaa, v_xeex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('Kiax,iLCa,Wx->KLCW', X_aaaa, v_xxee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('LiCx,KWyi,xy->KLCW', X_aaaa, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('LiCx,Kixy,Wy->KLCW', X_aaaa, v_xxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('LiCx,KiyW,xy->KLCW', X_aaaa, v_xxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('LiCx,Kiyz,Wyxz->KLCW', X_aaaa, v_xxaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('LiCx,Kyxi,Wy->KLCW', X_aaaa, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/6 * einsum('LiCx,Kyzi,Wzxy->KLCW', X_aaaa, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/6 * einsum('LiCx,Kyzi,Wzyx->KLCW', X_aaaa, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('Liax,KCai,Wx->KLCW', X_aaaa, v_xeex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('Liax,iKCa,Wx->KLCW', X_aaaa, v_xxee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/4 * einsum('ijCx,KiLj,Wx->KLCW', X_aaaa, v_xxxx, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/4 * einsum('ijCx,KjLi,Wx->KLCW', X_aaaa, v_xxxx, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('KiCx,LWyi,xy->KLCW', X_abab, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('KiCx,Lyxi,Wy->KLCW', X_abab, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/6 * einsum('KiCx,Lyzi,Wzxy->KLCW', X_abab, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/3 * einsum('KiCx,Lyzi,Wzyx->KLCW', X_abab, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('LiCx,KWyi,xy->KLCW', X_abab, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('LiCx,Kyxi,Wy->KLCW', X_abab, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/6 * einsum('LiCx,Kyzi,Wzxy->KLCW', X_abab, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/3 * einsum('LiCx,Kyzi,Wzyx->KLCW', X_abab, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('Kiax,LCai,Wx->KLCW', X_abba, v_xeex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('Liax,KCai,Wx->KLCW', X_abba, v_xeex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/4 * einsum('KLax,yCaz,zy,Wx->KLCW', X_aaaa, v_aeea, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('KLax,yzCa,yz,Wx->KLCW', X_aaaa, v_aaee, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('KiCx,Liyz,yz,Wx->KLCW', X_aaaa, v_xxaa, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/4 * einsum('KiCx,Lyzi,zy,Wx->KLCW', X_aaaa, v_xaax, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('LiCx,Kiyz,yz,Wx->KLCW', X_aaaa, v_xxaa, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/4 * einsum('LiCx,Kyzi,zy,Wx->KLCW', X_aaaa, v_xaax, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma[ccea__aaaa] += ascontiguousarray(sigma_KLCW_aaaa[cc_tril_ind[0], cc_tril_ind[1]]).reshape(-1)

    sigma_KLCW_abab  = einsum('KiCx,LWxi->KLCW', X_aaaa, v_xaax, optimize = einsum_type)
    sigma_KLCW_abab += einsum('KLax,WxCa->KLCW', X_abab, v_aaee, optimize = einsum_type)
    sigma_KLCW_abab += einsum('KiCx,LWxi->KLCW', X_abab, v_xaax, optimize = einsum_type)
    sigma_KLCW_abab -= einsum('KiCx,LixW->KLCW', X_abab, v_xxaa, optimize = einsum_type)
    sigma_KLCW_abab -= einsum('KiaW,iLCa->KLCW', X_abab, v_xxee, optimize = einsum_type)
    sigma_KLCW_abab -= einsum('iLCx,KixW->KLCW', X_abab, v_xxaa, optimize = einsum_type)
    sigma_KLCW_abab += einsum('iLaW,KCai->KLCW', X_abab, v_xeex, optimize = einsum_type)
    sigma_KLCW_abab -= einsum('iLaW,iKCa->KLCW', X_abab, v_xxee, optimize = einsum_type)
    sigma_KLCW_abab += einsum('ijCW,KiLj->KLCW', X_abab, v_xxxx, optimize = einsum_type)
    sigma_KLCW_abab -= einsum('KLax,xCaW->KLCW', X_abba, v_aeea, optimize = einsum_type)
    sigma_KLCW_abab -= einsum('LiaW,KCai->KLCW', X_bbbb, v_xeex, optimize = einsum_type)
    sigma_KLCW_abab -= 1/2 * einsum('KiCx,LWyi,xy->KLCW', X_aaaa, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab -= 1/2 * einsum('KiCx,Lyxi,Wy->KLCW', X_aaaa, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab += 1/6 * einsum('KiCx,Lyzi,Wzxy->KLCW', X_aaaa, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abab += 1/3 * einsum('KiCx,Lyzi,Wzyx->KLCW', X_aaaa, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abab -= 1/2 * einsum('KLax,WyCa,xy->KLCW', X_abab, v_aaee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab += 1/3 * einsum('KLax,yCaz,Wyxz->KLCW', X_abab, v_aeea, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abab += 1/6 * einsum('KLax,yCaz,Wyzx->KLCW', X_abab, v_aeea, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abab -= 1/2 * einsum('KLax,yxCa,Wy->KLCW', X_abab, v_aaee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab -= 1/2 * einsum('KLax,yzCa,Wzxy->KLCW', X_abab, v_aaee, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abab -= 1/2 * einsum('KiCx,LWyi,xy->KLCW', X_abab, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab += 1/2 * einsum('KiCx,Lixy,Wy->KLCW', X_abab, v_xxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab += 1/2 * einsum('KiCx,LiyW,xy->KLCW', X_abab, v_xxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab += 1/2 * einsum('KiCx,Liyz,Wyxz->KLCW', X_abab, v_xxaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abab -= 1/2 * einsum('KiCx,Lyxi,Wy->KLCW', X_abab, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab -= 1/6 * einsum('KiCx,Lyzi,Wzxy->KLCW', X_abab, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abab += 1/6 * einsum('KiCx,Lyzi,Wzyx->KLCW', X_abab, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abab += 1/2 * einsum('Kiax,iLCa,Wx->KLCW', X_abab, v_xxee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab += 1/2 * einsum('iLCx,Kixy,Wy->KLCW', X_abab, v_xxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab += 1/2 * einsum('iLCx,KiyW,xy->KLCW', X_abab, v_xxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab += 1/2 * einsum('iLCx,Kiyz,Wyxz->KLCW', X_abab, v_xxaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abab -= 1/3 * einsum('iLCx,Kyzi,Wzxy->KLCW', X_abab, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abab -= 1/6 * einsum('iLCx,Kyzi,Wzyx->KLCW', X_abab, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abab -= 1/2 * einsum('iLax,KCai,Wx->KLCW', X_abab, v_xeex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab += 1/2 * einsum('iLax,iKCa,Wx->KLCW', X_abab, v_xxee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab -= 1/2 * einsum('ijCx,KiLj,Wx->KLCW', X_abab, v_xxxx, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab += 1/2 * einsum('KLax,xCay,Wy->KLCW', X_abba, v_aeea, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab += 1/2 * einsum('KLax,yCaW,xy->KLCW', X_abba, v_aeea, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab -= 1/6 * einsum('KLax,yCaz,Wyxz->KLCW', X_abba, v_aeea, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abab -= 1/3 * einsum('KLax,yCaz,Wyzx->KLCW', X_abba, v_aeea, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abab += 1/2 * einsum('Liax,KCai,Wx->KLCW', X_bbbb, v_xeex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab -= 1/4 * einsum('KLax,yCaz,zy,Wx->KLCW', X_abab, v_aeea, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab += 1/2 * einsum('KLax,yzCa,yz,Wx->KLCW', X_abab, v_aaee, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab -= 1/2 * einsum('KiCx,Liyz,yz,Wx->KLCW', X_abab, v_xxaa, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab += 1/4 * einsum('KiCx,Lyzi,zy,Wx->KLCW', X_abab, v_xaax, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab -= 1/2 * einsum('iLCx,Kiyz,yz,Wx->KLCW', X_abab, v_xxaa, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab += 1/4 * einsum('iLCx,Kyzi,zy,Wx->KLCW', X_abab, v_xaax, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma[ccea__abab] += ascontiguousarray(sigma_KLCW_abab).reshape(-1)

    sigma_KLCW_abba  = einsum('KiaW,LCai->KLCW', X_aaaa, v_xeex, optimize = einsum_type)
    sigma_KLCW_abba -= einsum('KLax,xCaW->KLCW', X_abab, v_aeea, optimize = einsum_type)
    sigma_KLCW_abba += einsum('KLax,WxCa->KLCW', X_abba, v_aaee, optimize = einsum_type)
    sigma_KLCW_abba -= einsum('KiCx,LixW->KLCW', X_abba, v_xxaa, optimize = einsum_type)
    sigma_KLCW_abba += einsum('KiaW,LCai->KLCW', X_abba, v_xeex, optimize = einsum_type)
    sigma_KLCW_abba -= einsum('KiaW,iLCa->KLCW', X_abba, v_xxee, optimize = einsum_type)
    sigma_KLCW_abba += einsum('iLCx,KWxi->KLCW', X_abba, v_xaax, optimize = einsum_type)
    sigma_KLCW_abba -= einsum('iLCx,KixW->KLCW', X_abba, v_xxaa, optimize = einsum_type)
    sigma_KLCW_abba -= einsum('iLaW,iKCa->KLCW', X_abba, v_xxee, optimize = einsum_type)
    sigma_KLCW_abba += einsum('ijCW,KiLj->KLCW', X_abba, v_xxxx, optimize = einsum_type)
    sigma_KLCW_abba -= einsum('LiCx,KWxi->KLCW', X_bbbb, v_xaax, optimize = einsum_type)
    sigma_KLCW_abba -= 1/2 * einsum('Kiax,LCai,Wx->KLCW', X_aaaa, v_xeex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba += 1/2 * einsum('KLax,xCay,Wy->KLCW', X_abab, v_aeea, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba += 1/2 * einsum('KLax,yCaW,xy->KLCW', X_abab, v_aeea, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba -= 1/6 * einsum('KLax,yCaz,Wyxz->KLCW', X_abab, v_aeea, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abba -= 1/3 * einsum('KLax,yCaz,Wyzx->KLCW', X_abab, v_aeea, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abba -= 1/2 * einsum('KLax,WyCa,xy->KLCW', X_abba, v_aaee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba += 1/3 * einsum('KLax,yCaz,Wyxz->KLCW', X_abba, v_aeea, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abba += 1/6 * einsum('KLax,yCaz,Wyzx->KLCW', X_abba, v_aeea, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abba -= 1/2 * einsum('KLax,yxCa,Wy->KLCW', X_abba, v_aaee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba -= 1/2 * einsum('KLax,yzCa,Wzxy->KLCW', X_abba, v_aaee, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abba += 1/2 * einsum('KiCx,Lixy,Wy->KLCW', X_abba, v_xxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba += 1/2 * einsum('KiCx,LiyW,xy->KLCW', X_abba, v_xxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba += 1/2 * einsum('KiCx,Liyz,Wyxz->KLCW', X_abba, v_xxaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abba -= 1/3 * einsum('KiCx,Lyzi,Wzxy->KLCW', X_abba, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abba -= 1/6 * einsum('KiCx,Lyzi,Wzyx->KLCW', X_abba, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abba -= 1/2 * einsum('Kiax,LCai,Wx->KLCW', X_abba, v_xeex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba += 1/2 * einsum('Kiax,iLCa,Wx->KLCW', X_abba, v_xxee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba -= 1/2 * einsum('iLCx,KWyi,xy->KLCW', X_abba, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba += 1/2 * einsum('iLCx,Kixy,Wy->KLCW', X_abba, v_xxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba += 1/2 * einsum('iLCx,KiyW,xy->KLCW', X_abba, v_xxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba += 1/2 * einsum('iLCx,Kiyz,Wyxz->KLCW', X_abba, v_xxaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abba -= 1/2 * einsum('iLCx,Kyxi,Wy->KLCW', X_abba, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba -= 1/6 * einsum('iLCx,Kyzi,Wzxy->KLCW', X_abba, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abba += 1/6 * einsum('iLCx,Kyzi,Wzyx->KLCW', X_abba, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abba += 1/2 * einsum('iLax,iKCa,Wx->KLCW', X_abba, v_xxee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba -= 1/2 * einsum('ijCx,KiLj,Wx->KLCW', X_abba, v_xxxx, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba += 1/2 * einsum('LiCx,KWyi,xy->KLCW', X_bbbb, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba += 1/2 * einsum('LiCx,Kyxi,Wy->KLCW', X_bbbb, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba -= 1/6 * einsum('LiCx,Kyzi,Wzxy->KLCW', X_bbbb, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abba -= 1/3 * einsum('LiCx,Kyzi,Wzyx->KLCW', X_bbbb, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abba -= 1/4 * einsum('KLax,yCaz,zy,Wx->KLCW', X_abba, v_aeea, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba += 1/2 * einsum('KLax,yzCa,yz,Wx->KLCW', X_abba, v_aaee, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba -= 1/2 * einsum('KiCx,Liyz,yz,Wx->KLCW', X_abba, v_xxaa, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba += 1/4 * einsum('KiCx,Lyzi,zy,Wx->KLCW', X_abba, v_xaax, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba -= 1/2 * einsum('iLCx,Kiyz,yz,Wx->KLCW', X_abba, v_xxaa, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba += 1/4 * einsum('iLCx,Kyzi,zy,Wx->KLCW', X_abba, v_xaax, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma[ccea__abba] += ascontiguousarray(sigma_KLCW_abba).reshape(-1)

    sigma_KLCW_bbbb =- einsum('iKaW,LCai->KLCW', X_abab, v_xeex, optimize = einsum_type)
    sigma_KLCW_bbbb += einsum('iLaW,KCai->KLCW', X_abab, v_xeex, optimize = einsum_type)
    sigma_KLCW_bbbb -= einsum('iKCx,LWxi->KLCW', X_abba, v_xaax, optimize = einsum_type)
    sigma_KLCW_bbbb += einsum('iLCx,KWxi->KLCW', X_abba, v_xaax, optimize = einsum_type)
    sigma_KLCW_bbbb += einsum('KLax,WxCa->KLCW', X_bbbb, v_aaee, optimize = einsum_type)
    sigma_KLCW_bbbb -= einsum('KLax,xCaW->KLCW', X_bbbb, v_aeea, optimize = einsum_type)
    sigma_KLCW_bbbb += einsum('KiCx,LWxi->KLCW', X_bbbb, v_xaax, optimize = einsum_type)
    sigma_KLCW_bbbb -= einsum('KiCx,LixW->KLCW', X_bbbb, v_xxaa, optimize = einsum_type)
    sigma_KLCW_bbbb += einsum('KiaW,LCai->KLCW', X_bbbb, v_xeex, optimize = einsum_type)
    sigma_KLCW_bbbb -= einsum('KiaW,iLCa->KLCW', X_bbbb, v_xxee, optimize = einsum_type)
    sigma_KLCW_bbbb -= einsum('LiCx,KWxi->KLCW', X_bbbb, v_xaax, optimize = einsum_type)
    sigma_KLCW_bbbb += einsum('LiCx,KixW->KLCW', X_bbbb, v_xxaa, optimize = einsum_type)
    sigma_KLCW_bbbb -= einsum('LiaW,KCai->KLCW', X_bbbb, v_xeex, optimize = einsum_type)
    sigma_KLCW_bbbb += einsum('LiaW,iKCa->KLCW', X_bbbb, v_xxee, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('ijCW,KiLj->KLCW', X_bbbb, v_xxxx, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('ijCW,KjLi->KLCW', X_bbbb, v_xxxx, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('iKax,LCai,Wx->KLCW', X_abab, v_xeex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('iLax,KCai,Wx->KLCW', X_abab, v_xeex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('iKCx,LWyi,xy->KLCW', X_abba, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('iKCx,Lyxi,Wy->KLCW', X_abba, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/6 * einsum('iKCx,Lyzi,Wzxy->KLCW', X_abba, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/3 * einsum('iKCx,Lyzi,Wzyx->KLCW', X_abba, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('iLCx,KWyi,xy->KLCW', X_abba, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('iLCx,Kyxi,Wy->KLCW', X_abba, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/6 * einsum('iLCx,Kyzi,Wzxy->KLCW', X_abba, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/3 * einsum('iLCx,Kyzi,Wzyx->KLCW', X_abba, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('KLax,WyCa,xy->KLCW', X_bbbb, v_aaee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('KLax,xCay,Wy->KLCW', X_bbbb, v_aeea, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('KLax,yCaW,xy->KLCW', X_bbbb, v_aeea, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/6 * einsum('KLax,yCaz,Wyxz->KLCW', X_bbbb, v_aeea, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/6 * einsum('KLax,yCaz,Wyzx->KLCW', X_bbbb, v_aeea, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('KLax,yxCa,Wy->KLCW', X_bbbb, v_aaee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('KLax,yzCa,Wzxy->KLCW', X_bbbb, v_aaee, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('KiCx,LWyi,xy->KLCW', X_bbbb, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('KiCx,Lixy,Wy->KLCW', X_bbbb, v_xxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('KiCx,LiyW,xy->KLCW', X_bbbb, v_xxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('KiCx,Liyz,Wyxz->KLCW', X_bbbb, v_xxaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('KiCx,Lyxi,Wy->KLCW', X_bbbb, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/6 * einsum('KiCx,Lyzi,Wzxy->KLCW', X_bbbb, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/6 * einsum('KiCx,Lyzi,Wzyx->KLCW', X_bbbb, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('Kiax,LCai,Wx->KLCW', X_bbbb, v_xeex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('Kiax,iLCa,Wx->KLCW', X_bbbb, v_xxee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('LiCx,KWyi,xy->KLCW', X_bbbb, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('LiCx,Kixy,Wy->KLCW', X_bbbb, v_xxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('LiCx,KiyW,xy->KLCW', X_bbbb, v_xxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('LiCx,Kiyz,Wyxz->KLCW', X_bbbb, v_xxaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('LiCx,Kyxi,Wy->KLCW', X_bbbb, v_xaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/6 * einsum('LiCx,Kyzi,Wzxy->KLCW', X_bbbb, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/6 * einsum('LiCx,Kyzi,Wzyx->KLCW', X_bbbb, v_xaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('Liax,KCai,Wx->KLCW', X_bbbb, v_xeex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('Liax,iKCa,Wx->KLCW', X_bbbb, v_xxee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/4 * einsum('ijCx,KiLj,Wx->KLCW', X_bbbb, v_xxxx, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/4 * einsum('ijCx,KjLi,Wx->KLCW', X_bbbb, v_xxxx, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/4 * einsum('KLax,yCaz,zy,Wx->KLCW', X_bbbb, v_aeea, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('KLax,yzCa,yz,Wx->KLCW', X_bbbb, v_aaee, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('KiCx,Liyz,yz,Wx->KLCW', X_bbbb, v_xxaa, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/4 * einsum('KiCx,Lyzi,zy,Wx->KLCW', X_bbbb, v_xaax, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('LiCx,Kiyz,yz,Wx->KLCW', X_bbbb, v_xxaa, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/4 * einsum('LiCx,Kyzi,zy,Wx->KLCW', X_bbbb, v_xaax, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma[ccea__bbbb] += ascontiguousarray(sigma_KLCW_bbbb[cc_tril_ind[0], cc_tril_ind[1]]).reshape(-1)

    mr_adc.log.timer_debug("computing sigma H1 h1-h1 CCEA-CCEA", *cput1)

# CCEE <- CCEA
def compute_sigma_vector__H1__h1_h1__CCEE_CCEA(mr_adc, X_aaaa, X_abab, X_abba, X_bbbb, sigma):
    cput1 = (logger.process_clock(), logger.perf_counter())

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    #Excitation Manifold
    ccee__aaaa = mr_adc.h1.ccee__aaaa
    ccee__abab = mr_adc.h1.ccee__abab
    ccee__bbbb = mr_adc.h1.ccee__bbbb 

    ## Indices
    cc_tril_ind = mr_adc.h1.cc_tril_ind 
    ee_tril_ind = mr_adc.h1.ee_tril_ind 

    ## Molecular Orbitals Energies
    e_extern = mr_adc.mo_energy.e

    ## One-electron integrals
    h_aa = mr_adc.h1eff.aa
    h_ae = mr_adc.h1eff.ae

    ## Two-electron integrals
    v_xxae = mr_adc.v2e.xxae
    v_xaex = mr_adc.v2e.xaex
    v_aaaa = mr_adc.v2e.aaaa
    v_aaae = mr_adc.v2e.aaae
    v_aeee = mr_adc.v2e.aeee

    ## Amplitudes
    t1_ae = mr_adc.t1.ae
    t1_aaae = mr_adc.t1.aaae

    # Reduced Density Matrices
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa

    sigma_KLCD_aaaa  = einsum('KLCx,xD->KLCD', X_aaaa, h_ae, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('KLDx,xC->KLCD', X_aaaa, h_ae, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('KLax,xCaD->KLCD', X_aaaa, v_aeee, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('KLax,xDaC->KLCD', X_aaaa, v_aeee, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('KiCx,LixD->KLCD', X_aaaa, v_xxae, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('KiCx,ixDL->KLCD', X_aaaa, v_xaex, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('KiDx,LixC->KLCD', X_aaaa, v_xxae, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('KiDx,ixCL->KLCD', X_aaaa, v_xaex, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('LiCx,KixD->KLCD', X_aaaa, v_xxae, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('LiCx,ixDK->KLCD', X_aaaa, v_xaex, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('LiDx,KixC->KLCD', X_aaaa, v_xxae, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('LiDx,ixCK->KLCD', X_aaaa, v_xaex, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('KiCx,ixDL->KLCD', X_abab, v_xaex, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('KiDx,ixCL->KLCD', X_abab, v_xaex, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('LiCx,ixDK->KLCD', X_abab, v_xaex, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('LiDx,ixCK->KLCD', X_abab, v_xaex, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('KLCx,D,xD->KLCD', X_aaaa, e_extern, t1_ae, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('KLDx,C,xC->KLCD', X_aaaa, e_extern, t1_ae, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('KLCx,xy,yD->KLCD', X_aaaa, h_aa, t1_ae, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('KLDx,xy,yC->KLCD', X_aaaa, h_aa, t1_ae, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KLCx,xyzD,yz->KLCD', X_aaaa, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('KLCx,yzxD,zy->KLCD', X_aaaa, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KLDx,xyzC,yz->KLCD', X_aaaa, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('KLDx,yzxC,zy->KLCD', X_aaaa, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KLax,yCaD,xy->KLCD', X_aaaa, v_aeee, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KLax,yDaC,xy->KLCD', X_aaaa, v_aeee, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KiCx,LiyD,xy->KLCD', X_aaaa, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KiCx,iyDL,xy->KLCD', X_aaaa, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KiDx,LiyC,xy->KLCD', X_aaaa, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KiDx,iyCL,xy->KLCD', X_aaaa, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('LiCx,KiyD,xy->KLCD', X_aaaa, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('LiCx,iyDK,xy->KLCD', X_aaaa, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('LiDx,KiyC,xy->KLCD', X_aaaa, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('LiDx,iyCK,xy->KLCD', X_aaaa, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KiCx,iyDL,xy->KLCD', X_abab, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KiDx,iyCL,xy->KLCD', X_abab, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('LiCx,iyDK,xy->KLCD', X_abab, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('LiDx,iyCK,xy->KLCD', X_abab, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KLCx,D,xyzD,zy->KLCD', X_aaaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('KLCx,D,yxzD,zy->KLCD', X_aaaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KLDx,C,xyzC,zy->KLCD', X_aaaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('KLDx,C,yxzC,zy->KLCD', X_aaaa, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KLCx,xy,yzwD,wz->KLCD', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('KLCx,xy,zywD,wz->KLCD', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('KLCx,yz,wxyD,zw->KLCD', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KLCx,yz,xwyD,zw->KLCD', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KLCx,yz,xywD,zw->KLCD', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('KLCx,yz,yxwD,zw->KLCD', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KLDx,xy,yzwC,wz->KLCD', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('KLDx,xy,zywC,wz->KLCD', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('KLDx,yz,wxyC,zw->KLCD', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KLDx,yz,xwyC,zw->KLCD', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KLDx,yz,xywC,zw->KLCD', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('KLDx,yz,yxwC,zw->KLCD', X_aaaa, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KLCx,xyzD,ywuv,zuwv->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KLCx,xyzD,zwuv,yuwv->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('KLCx,yD,xyzw,zw->KLCD', X_aaaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KLCx,yD,xzwy,wz->KLCD', X_aaaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('KLCx,yxzD,ywuv,zuwv->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('KLCx,yxzD,zwuv,yuwv->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KLCx,yzwD,xuvy,wuvz->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KLCx,yzwD,xuvz,wuyv->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KLCx,yzwD,xuwv,zyuv->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KLCx,yzwD,xyuv,wvzu->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KLCx,yzwD,xyuz,wu->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('KLCx,yzwD,xzuv,wvyu->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('KLCx,yzwD,xzuy,wu->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KLDx,xyzC,ywuv,zuwv->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KLDx,xyzC,zwuv,yuwv->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('KLDx,yC,xyzw,zw->KLCD', X_aaaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KLDx,yC,xzwy,wz->KLCD', X_aaaa, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('KLDx,yxzC,ywuv,zuwv->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('KLDx,yxzC,zwuv,yuwv->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KLDx,yzwC,xuvy,wuvz->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KLDx,yzwC,xuvz,wuyv->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KLDx,yzwC,xuwv,zyuv->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KLDx,yzwC,xyuv,wvzu->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KLDx,yzwC,xyuz,wu->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('KLDx,yzwC,xzuv,wvyu->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('KLDx,yzwC,xzuy,wu->KLCD', X_aaaa, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa = sigma_KLCD_aaaa[:, :, ee_tril_ind[0], ee_tril_ind[1]]
    sigma[ccee__aaaa] += ascontiguousarray(sigma_KLCD_aaaa[cc_tril_ind[0], cc_tril_ind[1]]).reshape(-1)

    sigma_KLCD_abab  = einsum('KiCx,ixDL->KLCD', X_aaaa, v_xaex, optimize = einsum_type)
    sigma_KLCD_abab += einsum('KLCx,xD->KLCD', X_abab, h_ae, optimize = einsum_type)
    sigma_KLCD_abab += einsum('KLax,xDaC->KLCD', X_abab, v_aeee, optimize = einsum_type)
    sigma_KLCD_abab -= einsum('KiCx,LixD->KLCD', X_abab, v_xxae, optimize = einsum_type)
    sigma_KLCD_abab += einsum('KiCx,ixDL->KLCD', X_abab, v_xaex, optimize = einsum_type)
    sigma_KLCD_abab -= einsum('iLCx,KixD->KLCD', X_abab, v_xxae, optimize = einsum_type)
    sigma_KLCD_abab -= einsum('KLDx,xC->KLCD', X_abba, h_ae, optimize = einsum_type)
    sigma_KLCD_abab -= einsum('KLax,xCaD->KLCD', X_abba, v_aeee, optimize = einsum_type)
    sigma_KLCD_abab += einsum('KiDx,LixC->KLCD', X_abba, v_xxae, optimize = einsum_type)
    sigma_KLCD_abab += einsum('iLDx,KixC->KLCD', X_abba, v_xxae, optimize = einsum_type)
    sigma_KLCD_abab -= einsum('iLDx,ixCK->KLCD', X_abba, v_xaex, optimize = einsum_type)
    sigma_KLCD_abab += einsum('LiDx,ixCK->KLCD', X_bbbb, v_xaex, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KiCx,iyDL,xy->KLCD', X_aaaa, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab += einsum('KLCx,D,xD->KLCD', X_abab, e_extern, t1_ae, optimize = einsum_type)
    sigma_KLCD_abab -= einsum('KLCx,xy,yD->KLCD', X_abab, h_aa, t1_ae, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KLCx,xyzD,yz->KLCD', X_abab, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab += einsum('KLCx,yzxD,zy->KLCD', X_abab, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KLax,yDaC,xy->KLCD', X_abab, v_aeee, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab += 1/2 * einsum('KiCx,LiyD,xy->KLCD', X_abab, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KiCx,iyDL,xy->KLCD', X_abab, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab += 1/2 * einsum('iLCx,KiyD,xy->KLCD', X_abab, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= einsum('KLDx,C,xC->KLCD', X_abba, e_extern, t1_ae, optimize = einsum_type)
    sigma_KLCD_abab += einsum('KLDx,xy,yC->KLCD', X_abba, h_aa, t1_ae, optimize = einsum_type)
    sigma_KLCD_abab += 1/2 * einsum('KLDx,xyzC,yz->KLCD', X_abba, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= einsum('KLDx,yzxC,zy->KLCD', X_abba, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab += 1/2 * einsum('KLax,yCaD,xy->KLCD', X_abba, v_aeee, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KiDx,LiyC,xy->KLCD', X_abba, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('iLDx,KiyC,xy->KLCD', X_abba, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab += 1/2 * einsum('iLDx,iyCK,xy->KLCD', X_abba, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('LiDx,iyCK,xy->KLCD', X_bbbb, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KLCx,D,xyzD,zy->KLCD', X_abab, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab += einsum('KLCx,D,yxzD,zy->KLCD', X_abab, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab += 1/2 * einsum('KLCx,xy,yzwD,wz->KLCD', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= einsum('KLCx,xy,zywD,wz->KLCD', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab += einsum('KLCx,yz,wxyD,zw->KLCD', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KLCx,yz,xwyD,zw->KLCD', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab += 1/2 * einsum('KLCx,yz,xywD,zw->KLCD', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= einsum('KLCx,yz,yxwD,zw->KLCD', X_abab, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab += 1/2 * einsum('KLCx,xyzD,ywuv,zuwv->KLCD', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KLCx,xyzD,zwuv,yuwv->KLCD', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_abab -= einsum('KLCx,yD,xyzw,zw->KLCD', X_abab, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab += 1/2 * einsum('KLCx,yD,xzwy,wz->KLCD', X_abab, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= einsum('KLCx,yxzD,ywuv,zuwv->KLCD', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_abab += einsum('KLCx,yxzD,zwuv,yuwv->KLCD', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_abab += 1/2 * einsum('KLCx,yzwD,xuvy,wuvz->KLCD', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_abab += 1/2 * einsum('KLCx,yzwD,xuvz,wuyv->KLCD', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KLCx,yzwD,xuwv,zyuv->KLCD', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_abab += 1/2 * einsum('KLCx,yzwD,xyuv,wvzu->KLCD', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_abab += 1/2 * einsum('KLCx,yzwD,xyuz,wu->KLCD', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= einsum('KLCx,yzwD,xzuv,wvyu->KLCD', X_abab, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_abab -= einsum('KLCx,yzwD,xzuy,wu->KLCD', X_abab, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab += 1/2 * einsum('KLDx,C,xyzC,zy->KLCD', X_abba, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= einsum('KLDx,C,yxzC,zy->KLCD', X_abba, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KLDx,xy,yzwC,wz->KLCD', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab += einsum('KLDx,xy,zywC,wz->KLCD', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= einsum('KLDx,yz,wxyC,zw->KLCD', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab += 1/2 * einsum('KLDx,yz,xwyC,zw->KLCD', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KLDx,yz,xywC,zw->KLCD', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab += einsum('KLDx,yz,yxwC,zw->KLCD', X_abba, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KLDx,xyzC,ywuv,zuwv->KLCD', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_abab += 1/2 * einsum('KLDx,xyzC,zwuv,yuwv->KLCD', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_abab += einsum('KLDx,yC,xyzw,zw->KLCD', X_abba, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KLDx,yC,xzwy,wz->KLCD', X_abba, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab += einsum('KLDx,yxzC,ywuv,zuwv->KLCD', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_abab -= einsum('KLDx,yxzC,zwuv,yuwv->KLCD', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KLDx,yzwC,xuvy,wuvz->KLCD', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KLDx,yzwC,xuvz,wuyv->KLCD', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_abab += 1/2 * einsum('KLDx,yzwC,xuwv,zyuv->KLCD', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KLDx,yzwC,xyuv,wvzu->KLCD', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KLDx,yzwC,xyuz,wu->KLCD', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab += einsum('KLDx,yzwC,xzuv,wvyu->KLCD', X_abba, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_abab += einsum('KLDx,yzwC,xzuy,wu->KLCD', X_abba, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma[ccee__abab] += ascontiguousarray(sigma_KLCD_abab).reshape(-1)

    sigma_KLCD_bbbb =- einsum('iKCx,ixDL->KLCD', X_abba, v_xaex, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('iKDx,ixCL->KLCD', X_abba, v_xaex, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('iLCx,ixDK->KLCD', X_abba, v_xaex, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('iLDx,ixCK->KLCD', X_abba, v_xaex, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('KLCx,xD->KLCD', X_bbbb, h_ae, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('KLDx,xC->KLCD', X_bbbb, h_ae, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('KLax,xCaD->KLCD', X_bbbb, v_aeee, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('KLax,xDaC->KLCD', X_bbbb, v_aeee, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('KiCx,LixD->KLCD', X_bbbb, v_xxae, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('KiCx,ixDL->KLCD', X_bbbb, v_xaex, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('KiDx,LixC->KLCD', X_bbbb, v_xxae, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('KiDx,ixCL->KLCD', X_bbbb, v_xaex, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('LiCx,KixD->KLCD', X_bbbb, v_xxae, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('LiCx,ixDK->KLCD', X_bbbb, v_xaex, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('LiDx,KixC->KLCD', X_bbbb, v_xxae, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('LiDx,ixCK->KLCD', X_bbbb, v_xaex, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('iKCx,iyDL,xy->KLCD', X_abba, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('iKDx,iyCL,xy->KLCD', X_abba, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('iLCx,iyDK,xy->KLCD', X_abba, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('iLDx,iyCK,xy->KLCD', X_abba, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('KLCx,D,xD->KLCD', X_bbbb, e_extern, t1_ae, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('KLDx,C,xC->KLCD', X_bbbb, e_extern, t1_ae, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('KLCx,xy,yD->KLCD', X_bbbb, h_aa, t1_ae, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('KLDx,xy,yC->KLCD', X_bbbb, h_aa, t1_ae, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('KLCx,xyzD,yz->KLCD', X_bbbb, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('KLCx,yzxD,zy->KLCD', X_bbbb, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('KLDx,xyzC,yz->KLCD', X_bbbb, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('KLDx,yzxC,zy->KLCD', X_bbbb, v_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('KLax,yCaD,xy->KLCD', X_bbbb, v_aeee, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('KLax,yDaC,xy->KLCD', X_bbbb, v_aeee, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('KiCx,LiyD,xy->KLCD', X_bbbb, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('KiCx,iyDL,xy->KLCD', X_bbbb, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('KiDx,LiyC,xy->KLCD', X_bbbb, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('KiDx,iyCL,xy->KLCD', X_bbbb, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('LiCx,KiyD,xy->KLCD', X_bbbb, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('LiCx,iyDK,xy->KLCD', X_bbbb, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('LiDx,KiyC,xy->KLCD', X_bbbb, v_xxae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('LiDx,iyCK,xy->KLCD', X_bbbb, v_xaex, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('KLCx,D,xyzD,zy->KLCD', X_bbbb, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('KLCx,D,yxzD,zy->KLCD', X_bbbb, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('KLDx,C,xyzC,zy->KLCD', X_bbbb, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('KLDx,C,yxzC,zy->KLCD', X_bbbb, e_extern, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('KLCx,xy,yzwD,wz->KLCD', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('KLCx,xy,zywD,wz->KLCD', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('KLCx,yz,wxyD,zw->KLCD', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('KLCx,yz,xwyD,zw->KLCD', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('KLCx,yz,xywD,zw->KLCD', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('KLCx,yz,yxwD,zw->KLCD', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('KLDx,xy,yzwC,wz->KLCD', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('KLDx,xy,zywC,wz->KLCD', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('KLDx,yz,wxyC,zw->KLCD', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('KLDx,yz,xwyC,zw->KLCD', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('KLDx,yz,xywC,zw->KLCD', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('KLDx,yz,yxwC,zw->KLCD', X_bbbb, h_aa, t1_aaae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('KLCx,xyzD,ywuv,zuwv->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('KLCx,xyzD,zwuv,yuwv->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('KLCx,yD,xyzw,zw->KLCD', X_bbbb, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('KLCx,yD,xzwy,wz->KLCD', X_bbbb, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('KLCx,yxzD,ywuv,zuwv->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('KLCx,yxzD,zwuv,yuwv->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('KLCx,yzwD,xuvy,wuvz->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('KLCx,yzwD,xuvz,wuyv->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('KLCx,yzwD,xuwv,zyuv->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('KLCx,yzwD,xyuv,wvzu->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('KLCx,yzwD,xyuz,wu->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('KLCx,yzwD,xzuv,wvyu->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('KLCx,yzwD,xzuy,wu->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('KLDx,xyzC,ywuv,zuwv->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('KLDx,xyzC,zwuv,yuwv->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('KLDx,yC,xyzw,zw->KLCD', X_bbbb, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('KLDx,yC,xzwy,wz->KLCD', X_bbbb, t1_ae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('KLDx,yxzC,ywuv,zuwv->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('KLDx,yxzC,zwuv,yuwv->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('KLDx,yzwC,xuvy,wuvz->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('KLDx,yzwC,xuvz,wuyv->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('KLDx,yzwC,xuwv,zyuv->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('KLDx,yzwC,xyuv,wvzu->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('KLDx,yzwC,xyuz,wu->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('KLDx,yzwC,xzuv,wvyu->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('KLDx,yzwC,xzuy,wu->KLCD', X_bbbb, t1_aaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb = sigma_KLCD_bbbb[:, :, ee_tril_ind[0], ee_tril_ind[1]]
    sigma[ccee__bbbb] += ascontiguousarray(sigma_KLCD_bbbb[cc_tril_ind[0], cc_tril_ind[1]]).reshape(-1)

    mr_adc.log.timer_debug("computing sigma H1 h1-h1 CCEE-CCEA", *cput1)

# CAEE <- CCEA
def compute_sigma_vector__H1__h1_h1__CAEE_CCEA(mr_adc, X_aaaa, X_abab, X_abba, X_bbbb, sigma):
    cput1 = (logger.process_clock(), logger.perf_counter())

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    #Excitation Manifold
    caee__aaaa = mr_adc.h1.caee__aaaa
    caee__abab = mr_adc.h1.caee__abab
    caee__baba = mr_adc.h1.caee__baba
    caee__bbbb = mr_adc.h1.caee__bbbb 

    ## Indices
    ee_tril_ind = mr_adc.h1.ee_tril_ind 

    ## Two-electron integrals
    v_xaea = mr_adc.v2e.xaea

    # Reduced Density Matrices
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa

    sigma_KWCD_aaaa  = 1/2 * einsum('KiCx,ixDy,Wy->KWCD', X_aaaa, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_aaaa -= 1/2 * einsum('KiCx,iyDx,Wy->KWCD', X_aaaa, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_aaaa += 1/6 * einsum('KiCx,iyDz,Wxyz->KWCD', X_aaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_aaaa -= 1/6 * einsum('KiCx,iyDz,Wxzy->KWCD', X_aaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_aaaa -= 1/2 * einsum('KiDx,ixCy,Wy->KWCD', X_aaaa, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_aaaa += 1/2 * einsum('KiDx,iyCx,Wy->KWCD', X_aaaa, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_aaaa -= 1/6 * einsum('KiDx,iyCz,Wxyz->KWCD', X_aaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_aaaa += 1/6 * einsum('KiDx,iyCz,Wxzy->KWCD', X_aaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_aaaa += 1/2 * einsum('KiCx,ixDy,Wy->KWCD', X_abab, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_aaaa -= 1/6 * einsum('KiCx,iyDz,Wxyz->KWCD', X_abab, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_aaaa -= 1/3 * einsum('KiCx,iyDz,Wxzy->KWCD', X_abab, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_aaaa -= 1/2 * einsum('KiDx,ixCy,Wy->KWCD', X_abab, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_aaaa += 1/6 * einsum('KiDx,iyCz,Wxyz->KWCD', X_abab, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_aaaa += 1/3 * einsum('KiDx,iyCz,Wxzy->KWCD', X_abab, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma[caee__aaaa] += ascontiguousarray(sigma_KWCD_aaaa[:, :, ee_tril_ind[0], ee_tril_ind[1]]).reshape(-1)
    
    sigma_KWCD_abab  = 1/2 * einsum('KiCx,ixDy,Wy->KWCD', X_aaaa, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_abab -= 1/6 * einsum('KiCx,iyDz,Wxyz->KWCD', X_aaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_abab -= 1/3 * einsum('KiCx,iyDz,Wxzy->KWCD', X_aaaa, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_abab += 1/2 * einsum('KiCx,ixDy,Wy->KWCD', X_abab, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_abab -= 1/2 * einsum('KiCx,iyDx,Wy->KWCD', X_abab, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_abab += 1/6 * einsum('KiCx,iyDz,Wxyz->KWCD', X_abab, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_abab -= 1/6 * einsum('KiCx,iyDz,Wxzy->KWCD', X_abab, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_abab += 1/2 * einsum('KiDx,iyCx,Wy->KWCD', X_abba, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_abab -= 1/3 * einsum('KiDx,iyCz,Wxyz->KWCD', X_abba, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_abab -= 1/6 * einsum('KiDx,iyCz,Wxzy->KWCD', X_abba, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma[caee__abab] += ascontiguousarray(sigma_KWCD_abab).reshape(-1)

    sigma_KWCD_baba =- 1/2 * einsum('iKDx,iyCx,Wy->KWCD', X_abab, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_baba += 1/3 * einsum('iKDx,iyCz,Wxyz->KWCD', X_abab, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_baba += 1/6 * einsum('iKDx,iyCz,Wxzy->KWCD', X_abab, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_baba -= 1/2 * einsum('iKCx,ixDy,Wy->KWCD', X_abba, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_baba += 1/2 * einsum('iKCx,iyDx,Wy->KWCD', X_abba, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_baba -= 1/6 * einsum('iKCx,iyDz,Wxyz->KWCD', X_abba, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_baba += 1/6 * einsum('iKCx,iyDz,Wxzy->KWCD', X_abba, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_baba += 1/2 * einsum('KiCx,ixDy,Wy->KWCD', X_bbbb, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_baba -= 1/6 * einsum('KiCx,iyDz,Wxyz->KWCD', X_bbbb, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_baba -= 1/3 * einsum('KiCx,iyDz,Wxzy->KWCD', X_bbbb, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma[caee__baba] += ascontiguousarray(sigma_KWCD_baba).reshape(-1)
    
    sigma_KWCD_bbbb =- 1/2 * einsum('iKCx,ixDy,Wy->KWCD', X_abba, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_bbbb += 1/6 * einsum('iKCx,iyDz,Wxyz->KWCD', X_abba, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_bbbb += 1/3 * einsum('iKCx,iyDz,Wxzy->KWCD', X_abba, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_bbbb += 1/2 * einsum('iKDx,ixCy,Wy->KWCD', X_abba, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_bbbb -= 1/6 * einsum('iKDx,iyCz,Wxyz->KWCD', X_abba, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_bbbb -= 1/3 * einsum('iKDx,iyCz,Wxzy->KWCD', X_abba, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_bbbb += 1/2 * einsum('KiCx,ixDy,Wy->KWCD', X_bbbb, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_bbbb -= 1/2 * einsum('KiCx,iyDx,Wy->KWCD', X_bbbb, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_bbbb += 1/6 * einsum('KiCx,iyDz,Wxyz->KWCD', X_bbbb, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_bbbb -= 1/6 * einsum('KiCx,iyDz,Wxzy->KWCD', X_bbbb, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_bbbb -= 1/2 * einsum('KiDx,ixCy,Wy->KWCD', X_bbbb, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_bbbb += 1/2 * einsum('KiDx,iyCx,Wy->KWCD', X_bbbb, v_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWCD_bbbb -= 1/6 * einsum('KiDx,iyCz,Wxyz->KWCD', X_bbbb, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCD_bbbb += 1/6 * einsum('KiDx,iyCz,Wxzy->KWCD', X_bbbb, v_xaea, rdm_ccaa, optimize = einsum_type)
    sigma[caee__bbbb] += ascontiguousarray(sigma_KWCD_bbbb[:, :, ee_tril_ind[0], ee_tril_ind[1]]).reshape(-1)

    mr_adc.log.timer_debug("computing sigma H1 h1-h1 CAEE-CCEA", *cput1)

# CAAA <- CCEA
def compute_sigma_vector__H1__h1_h1__CAAA_CCEA(mr_adc, X_aaaa, X_abab, X_abba, X_bbbb, sigma):
    cput1 = (logger.process_clock(), logger.perf_counter())

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    #Excitation Manifold
    caaa__aaaa = mr_adc.h1.caaa__aaaa
    caaa__abab = mr_adc.h1.caaa__abab
    caaa__baba = mr_adc.h1.caaa__baba
    caaa__bbbb = mr_adc.h1.caaa__bbbb 

    ## Indices
    aa_tril_ind = mr_adc.h1.aa_tril_ind 

    ## Molecular Orbitals Energies
    e_cvs = mr_adc.mo_energy.x
    e_extern = mr_adc.mo_energy.e
 
    ## One-electron integrals
    h_aa = mr_adc.h1eff.aa
 
    ## Two-electron integrals
    v_xxxe = mr_adc.v2e.xxxe
    v_xaae = mr_adc.v2e.xaae
    v_xeaa = mr_adc.v2e.xeaa
    v_aaaa = mr_adc.v2e.aaaa
  
    ## Amplitudes
    t1_xaae = mr_adc.t1.xaae
    t1_xaea = mr_adc.t1.xaea
  
    # Reduced Density Matrices
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa
    rdm_cccaaa = mr_adc.rdm.cccaaa

    sigma_KWUV_aaaa =- 1/2 * einsum('KiaU,iWxa,Vx->KWUV', X_aaaa, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,iaVx,Wx->KWUV', X_aaaa, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,iaxW,Vx->KWUV', X_aaaa, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,ixVa,Wx->KWUV', X_aaaa, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,iWxa,Ux->KWUV', X_aaaa, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,iaUx,Wx->KWUV', X_aaaa, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,iaxW,Ux->KWUV', X_aaaa, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,ixUa,Wx->KWUV', X_aaaa, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iWya,UVxy->KWUV', X_aaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iWya,UVyx->KWUV', X_aaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iaUx,VW->KWUV', X_aaaa, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iaUy,VyWx->KWUV', X_aaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iaUy,VyxW->KWUV', X_aaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iaVx,UW->KWUV', X_aaaa, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iaVy,UyWx->KWUV', X_aaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iaVy,UyxW->KWUV', X_aaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iayW,UVxy->KWUV', X_aaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iayW,UVyx->KWUV', X_aaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,ixUa,VW->KWUV', X_aaaa, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,ixVa,UW->KWUV', X_aaaa, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyUa,VyWx->KWUV', X_aaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyUa,VyxW->KWUV', X_aaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyVa,UyWx->KWUV', X_aaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyVa,UyxW->KWUV', X_aaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/4 * einsum('ijaU,iKja,VW->KWUV', X_aaaa, v_xxxe, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/4 * einsum('ijaU,jKia,VW->KWUV', X_aaaa, v_xxxe, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/4 * einsum('ijaV,iKja,UW->KWUV', X_aaaa, v_xxxe, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/4 * einsum('ijaV,jKia,UW->KWUV', X_aaaa, v_xxxe, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('ijax,iKja,UVWx->KWUV', X_aaaa, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('ijax,iKja,UVxW->KWUV', X_aaaa, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('ijax,jKia,UVWx->KWUV', X_aaaa, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('ijax,jKia,UVxW->KWUV', X_aaaa, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,ixUa,VW->KWUV', X_abab, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,ixVa,UW->KWUV', X_abab, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/3 * einsum('Kiax,iyUa,VyWx->KWUV', X_abab, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyUa,VyxW->KWUV', X_abab, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/3 * einsum('Kiax,iyVa,UyWx->KWUV', X_abab, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyVa,UyxW->KWUV', X_abab, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,iaVx,Wx->KWUV', X_abba, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,iaxW,Vx->KWUV', X_abba, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,iaUx,Wx->KWUV', X_abba, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,iaxW,Ux->KWUV', X_abba, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iaUx,VW->KWUV', X_abba, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iaUy,VyWx->KWUV', X_abba, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iaUy,VyxW->KWUV', X_abba, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iaVx,UW->KWUV', X_abba, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iaVy,UyWx->KWUV', X_abba, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iaVy,UyxW->KWUV', X_abba, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iayW,UVxy->KWUV', X_abba, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iayW,UVyx->KWUV', X_abba, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('ijaU,iKja,VW->KWUV', X_abba, v_xxxe, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('ijaV,iKja,UW->KWUV', X_abba, v_xxxe, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('ijax,iKja,UVWx->KWUV', X_abba, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('ijax,iKja,UVxW->KWUV', X_abba, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,a,iVax,Wx->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,a,iVxa,Wx->KWUV', X_aaaa, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,a,ixWa,Vx->KWUV', X_aaaa, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,a,ixaW,Vx->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,i,iVax,Wx->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,i,iVxa,Wx->KWUV', X_aaaa, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,i,ixWa,Vx->KWUV', X_aaaa, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,i,ixaW,Vx->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,a,iUax,Wx->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,a,iUxa,Wx->KWUV', X_aaaa, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,a,ixWa,Ux->KWUV', X_aaaa, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,a,ixaW,Ux->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,i,iUax,Wx->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,i,iUxa,Wx->KWUV', X_aaaa, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,i,ixWa,Ux->KWUV', X_aaaa, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,i,ixaW,Ux->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,a,iUax,VW->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,a,iUay,VyWx->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,a,iUay,VyxW->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,a,iUxa,VW->KWUV', X_aaaa, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,a,iUya,VyWx->KWUV', X_aaaa, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,a,iUya,VyxW->KWUV', X_aaaa, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,a,iVax,UW->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,a,iVay,UyWx->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,a,iVay,UyxW->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,a,iVxa,UW->KWUV', X_aaaa, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,a,iVya,UyWx->KWUV', X_aaaa, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,a,iVya,UyxW->KWUV', X_aaaa, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,a,iyWa,UVxy->KWUV', X_aaaa, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,a,iyWa,UVyx->KWUV', X_aaaa, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,a,iyaW,UVxy->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,a,iyaW,UVyx->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,i,iUax,VW->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,i,iUay,VyWx->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,i,iUay,VyxW->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,i,iUxa,VW->KWUV', X_aaaa, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,i,iUya,VyWx->KWUV', X_aaaa, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,i,iUya,VyxW->KWUV', X_aaaa, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,i,iVax,UW->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,i,iVay,UyWx->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,i,iVay,UyxW->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,i,iVxa,UW->KWUV', X_aaaa, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,i,iVya,UyWx->KWUV', X_aaaa, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,i,iVya,UyxW->KWUV', X_aaaa, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,i,iyWa,UVxy->KWUV', X_aaaa, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,i,iyWa,UVyx->KWUV', X_aaaa, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,i,iyaW,UVxy->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,i,iyaW,UVyx->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,Vx,ixay,Wy->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,Vx,ixya,Wy->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,Wx,iyax,Vy->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,Wx,iyxa,Vy->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,xy,iVax,Wy->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,xy,iVxa,Wy->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,xy,ixWa,Vy->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,xy,ixaW,Vy->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,Ux,ixay,Wy->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,Ux,ixya,Wy->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,Wx,iyax,Uy->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,Wx,iyxa,Uy->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,xy,iUax,Wy->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,xy,iUxa,Wy->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,xy,ixWa,Uy->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,xy,ixaW,Uy->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,Uy,iyax,VW->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,Uy,iyaz,VzWx->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,Uy,iyaz,VzxW->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,Uy,iyxa,VW->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,Uy,iyza,VzWx->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,Uy,iyza,VzxW->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,Vy,iyax,UW->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,Vy,iyaz,UzWx->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,Vy,iyaz,UzxW->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,Vy,iyxa,UW->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,Vy,iyza,UzWx->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,Vy,iyza,UzxW->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,Wy,izay,UVxz->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,Wy,izay,UVzx->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,Wy,izya,UVxz->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,Wy,izya,UVzx->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,xy,iUay,VW->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,xy,iUya,VW->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,xy,iVay,UW->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,xy,iVya,UW->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,yz,iUay,VzWx->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,yz,iUay,VzxW->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,yz,iUya,VzWx->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,yz,iUya,VzxW->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,yz,iVay,UzWx->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,yz,iVay,UzxW->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,yz,iVya,UzWx->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,yz,iVya,UzxW->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,yz,iyWa,UVxz->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,yz,iyWa,UVzx->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,yz,iyaW,UVxz->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,yz,iyaW,UVzx->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,iVax,xyzw,Wzyw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,iVxa,xyzw,Wzyw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,ixWa,xyzw,Vzyw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,ixaW,xyzw,Vzyw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,ixay,Vxzw,Wzyw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,ixay,Vzwx,Wwzy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,ixay,Vzyw,Wxzw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,ixay,Wyzw,Vzxw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,ixay,Wzwy,Vwzx->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,ixay,Wzxw,Vyzw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,ixya,Vxzw,Wzyw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('KiaU,ixya,Vzwx,Wwyz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('KiaU,ixya,Vzwx,Wwzy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('KiaU,ixya,Vzyw,Wxwz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('KiaU,ixya,Vzyw,Wxzw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,ixya,Wyzw,Vzxw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('KiaU,ixya,Wzwy,Vwxz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('KiaU,ixya,Wzwy,Vwzx->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('KiaU,ixya,Wzxw,Vywz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('KiaU,ixya,Wzxw,Vyzw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,iUax,xyzw,Wzyw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,iUxa,xyzw,Wzyw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,ixWa,xyzw,Uzyw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,ixaW,xyzw,Uzyw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,ixay,Uxzw,Wzyw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,ixay,Uzwx,Wwzy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,ixay,Uzyw,Wxzw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,ixay,Wyzw,Uzxw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,ixay,Wzwy,Uwzx->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,ixay,Wzxw,Uyzw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,ixya,Uxzw,Wzyw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('KiaV,ixya,Uzwx,Wwyz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('KiaV,ixya,Uzwx,Wwzy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('KiaV,ixya,Uzyw,Wxwz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('KiaV,ixya,Uzyw,Wxzw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,ixya,Wyzw,Uzxw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('KiaV,ixya,Wzwy,Uwxz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('KiaV,ixya,Wzwy,Uwzx->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('KiaV,ixya,Wzxw,Uywz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('KiaV,ixya,Wzxw,Uyzw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iUay,Vxyz,Wz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iUay,Vzyw,Wxwz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iUay,Vzyw,Wxzw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iUay,Vzyx,Wz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iUay,xyzw,VzWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iUay,xzwy,VwWz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iUay,xzwy,VwzW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iUay,yzwu,VzuWxw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iUay,yzwu,VzuxWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iUya,Vxyz,Wz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iUya,Vzyw,Wxwz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iUya,Vzyw,Wxzw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iUya,Vzyx,Wz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iUya,xyzw,VzWw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iUya,xzwy,VwWz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iUya,xzwy,VwzW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iUya,yzwu,VzuWxw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iUya,yzwu,VzuxWw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iVay,Uxyz,Wz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iVay,Uzyw,Wxwz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iVay,Uzyw,Wxzw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iVay,Uzyx,Wz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iVay,xyzw,UzWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iVay,xzwy,UwWz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iVay,xzwy,UwzW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iVay,yzwu,UzuWxw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iVay,yzwu,UzuxWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iVya,Uxyz,Wz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iVya,Uzyw,Wxwz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iVya,Uzyw,Wxzw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iVya,Uzyx,Wz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iVya,xyzw,UzWw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iVya,xzwy,UwWz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iVya,xzwy,UwzW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iVya,yzwu,UzuWxw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iVya,yzwu,UzuxWw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyWa,xzyw,UVwz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyWa,xzyw,UVzw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyWa,yzwu,UVwxzu->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyWa,yzwu,UVwzxu->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaW,xzyw,UVwz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaW,xzyw,UVzw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaW,yzwu,UVwxzu->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaW,yzwu,UVwzxu->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iyax,UyVz,Wz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iyax,Uyzw,VwWz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iyax,UzVy,Wz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyax,Uzwy,VzWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyax,Uzwy,VzwW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iyax,Vyzw,UwWz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyax,Vzwy,UzWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyax,Vzwy,UzwW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyax,Wzyw,UVwz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyax,Wzyw,UVzw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,UwVy,Wxwz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,UwVy,Wxzw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Uwuy,VzwWux->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Uwuy,VzwxuW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Uwzu,VwuWxy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Uwzu,VwuxWy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Uwzx,VwWy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Uwzx,VwyW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iyaz,UxVy,Wz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iyaz,Uxwy,VzWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iyaz,Uxzw,VwWy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,UyVw,Wxwz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,UyVw,Wxzw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iyaz,UyVx,Wz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Uywu,VzuWxw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Uywu,VzuxWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Uywx,VzWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Uywx,VzwW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Vwuy,UzwWux->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Vwuy,UzwxuW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Vwzu,UwuWxy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Vwzu,UwuxWy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Vwzx,UwWy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Vwzx,UwyW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iyaz,Vxwy,UzWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iyaz,Vxzw,UwWy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Vywu,UzuWxw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Vywu,UzuxWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Vywx,UzWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Vywx,UzwW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Wwuz,UVuwxy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Wwuz,UVuxwy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Wwxz,UVwy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Wwxz,UVyw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Wwyu,UVzwxu->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Wwyu,UVzxwu->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Wzwu,UVwxyu->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Wzwu,UVwyxu->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Wzxw,UVwy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Wzxw,UVyw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iyxa,UyVz,Wz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iyxa,Uyzw,VwWz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iyxa,UzVy,Wz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyxa,Uzwy,VzWw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyxa,Uzwy,VzwW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iyxa,Vyzw,UwWz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyxa,Vzwy,UzWw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyxa,Vzwy,UzwW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyxa,Wzyw,UVwz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyxa,Wzyw,UVzw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,UwVy,Wxwz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,UwVy,Wxzw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Uwuy,VzwWux->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Uwuy,VzwuxW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Uwuy,VzwxWu->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Uwzu,VwuWyx->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Uwzu,VwuxWy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Uwzu,VwuyxW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Uwzx,VwWy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Uwzx,VwyW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iyza,UxVy,Wz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Uxwy,VzWw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Uxwy,VzwW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Uxzw,VwWy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Uxzw,VwyW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,UyVw,Wxwz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,UyVw,Wxzw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iyza,UyVx,Wz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Uywu,VzuWxw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Uywu,VzuxWw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Uywx,VzWw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Uywx,VzwW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Vwuy,UzwWux->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Vwuy,UzwuxW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Vwuy,UzwxWu->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Vwzu,UwuWyx->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Vwzu,UwuxWy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Vwzu,UwuyxW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Vwzx,UwWy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Vwzx,UwyW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Vxwy,UzWw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Vxwy,UzwW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Vxzw,UwWy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Vxzw,UwyW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Vywu,UzuWxw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Vywu,UzuxWw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Vywx,UzWw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Vywx,UzwW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Wwuz,UVuwyx->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Wwuz,UVuxwy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Wwuz,UVuyxw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Wwxz,UVwy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Wwxz,UVyw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Wwyu,UVzuwx->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Wwyu,UVzwxu->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Wwyu,UVzxuw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Wzwu,UVwxyu->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Wzwu,UVwyxu->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Wzxw,UVwy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Wzxw,UVyw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,a,iUxa,VW->KWUV', X_abab, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/3 * einsum('Kiax,a,iUya,VyWx->KWUV', X_abab, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,a,iUya,VyxW->KWUV', X_abab, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,a,iVxa,UW->KWUV', X_abab, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/3 * einsum('Kiax,a,iVya,UyWx->KWUV', X_abab, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,a,iVya,UyxW->KWUV', X_abab, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,i,iUxa,VW->KWUV', X_abab, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/3 * einsum('Kiax,i,iUya,VyWx->KWUV', X_abab, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,i,iUya,VyxW->KWUV', X_abab, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,i,iVxa,UW->KWUV', X_abab, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/3 * einsum('Kiax,i,iVya,UyWx->KWUV', X_abab, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,i,iVya,UyxW->KWUV', X_abab, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,Uy,iyxa,VW->KWUV', X_abab, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/3 * einsum('Kiax,Uy,iyza,VzWx->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,Uy,iyza,VzxW->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,Vy,iyxa,UW->KWUV', X_abab, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/3 * einsum('Kiax,Vy,iyza,UzWx->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,Vy,iyza,UzxW->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,xy,iUya,VW->KWUV', X_abab, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,xy,iVya,UW->KWUV', X_abab, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/3 * einsum('Kiax,yz,iUya,VzWx->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,yz,iUya,VzxW->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/3 * einsum('Kiax,yz,iVya,UzWx->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,yz,iVya,UzxW->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iUya,Vzyw,Wxwz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/3 * einsum('Kiax,iUya,Vzyw,Wxzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iUya,Vzyx,Wz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iUya,xyzw,VzWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/3 * einsum('Kiax,iUya,xzwy,VwWz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iUya,xzwy,VwzW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/3 * einsum('Kiax,iUya,yzwu,VzuWxw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iUya,yzwu,VzuxWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iVya,Uzyw,Wxwz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/3 * einsum('Kiax,iVya,Uzyw,Wxzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iVya,Uzyx,Wz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iVya,xyzw,UzWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/3 * einsum('Kiax,iVya,xzwy,UwWz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iVya,xzwy,UwzW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/3 * einsum('Kiax,iVya,yzwu,UzuWxw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iVya,yzwu,UzuxWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iyxa,UyVz,Wz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iyxa,Uyzw,VwWz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iyxa,UzVy,Wz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyxa,Uzwy,VzWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyxa,Uzwy,VzwW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iyxa,Vyzw,UwWz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyxa,Vzwy,UzWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyxa,Vzwy,UzwW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyxa,Wzyw,UVwz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyxa,Wzyw,UVzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/3 * einsum('Kiax,iyza,UwVy,Wxwz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,UwVy,Wxzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Uwuy,VzwWux->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Uwuy,VzwWxu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Uwuy,VzwuxW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Uwuy,VzwxWu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Uwzu,VwuWyx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Uwzu,VwuxWy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Uwzu,VwuyWx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Uwzu,VwuyxW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Uwzx,VwWy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Uwzx,VwyW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/3 * einsum('Kiax,iyza,UyVw,Wxwz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,UyVw,Wxzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/3 * einsum('Kiax,iyza,Uywu,VzuWxw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Uywu,VzuxWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/3 * einsum('Kiax,iyza,Uywx,VzWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Uywx,VzwW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Vwuy,UzwWux->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Vwuy,UzwWxu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Vwuy,UzwuxW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Vwuy,UzwxWu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Vwzu,UwuWyx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Vwzu,UwuxWy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Vwzu,UwuyWx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Vwzu,UwuyxW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Vwzx,UwWy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Vwzx,UwyW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/3 * einsum('Kiax,iyza,Vywu,UzuWxw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Vywu,UzuxWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/3 * einsum('Kiax,iyza,Vywx,UzWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Vywx,UzwW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Wwuz,UVuwyx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Wwuz,UVuxwy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Wwuz,UVuywx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Wwuz,UVuyxw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Wwxz,UVwy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Wwxz,UVyw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Wwyu,UVzuwx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Wwyu,UVzwux->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Wwyu,UVzwxu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Wwyu,UVzxuw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,a,iVax,Wx->KWUV', X_abba, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,a,ixaW,Vx->KWUV', X_abba, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,i,iVax,Wx->KWUV', X_abba, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,i,ixaW,Vx->KWUV', X_abba, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,a,iUax,Wx->KWUV', X_abba, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,a,ixaW,Ux->KWUV', X_abba, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,i,iUax,Wx->KWUV', X_abba, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,i,ixaW,Ux->KWUV', X_abba, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,a,iUax,VW->KWUV', X_abba, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,a,iUay,VyWx->KWUV', X_abba, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,a,iUay,VyxW->KWUV', X_abba, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,a,iVax,UW->KWUV', X_abba, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,a,iVay,UyWx->KWUV', X_abba, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,a,iVay,UyxW->KWUV', X_abba, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,a,iyaW,UVxy->KWUV', X_abba, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,a,iyaW,UVyx->KWUV', X_abba, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,i,iUax,VW->KWUV', X_abba, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,i,iUay,VyWx->KWUV', X_abba, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,i,iUay,VyxW->KWUV', X_abba, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,i,iVax,UW->KWUV', X_abba, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,i,iVay,UyWx->KWUV', X_abba, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,i,iVay,UyxW->KWUV', X_abba, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,i,iyaW,UVxy->KWUV', X_abba, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,i,iyaW,UVyx->KWUV', X_abba, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,Vx,ixay,Wy->KWUV', X_abba, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,Wx,iyax,Vy->KWUV', X_abba, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,xy,iVax,Wy->KWUV', X_abba, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,xy,ixaW,Vy->KWUV', X_abba, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,Ux,ixay,Wy->KWUV', X_abba, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,Wx,iyax,Uy->KWUV', X_abba, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,xy,iUax,Wy->KWUV', X_abba, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,xy,ixaW,Uy->KWUV', X_abba, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,Uy,iyax,VW->KWUV', X_abba, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,Uy,iyaz,VzWx->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,Uy,iyaz,VzxW->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,Vy,iyax,UW->KWUV', X_abba, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,Vy,iyaz,UzWx->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,Vy,iyaz,UzxW->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,Wy,izay,UVxz->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,Wy,izay,UVzx->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,xy,iUay,VW->KWUV', X_abba, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,xy,iVay,UW->KWUV', X_abba, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,yz,iUay,VzWx->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,yz,iUay,VzxW->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,yz,iVay,UzWx->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,yz,iVay,UzxW->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,yz,iyaW,UVxz->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,yz,iyaW,UVzx->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,iVax,xyzw,Wzyw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,ixaW,xyzw,Vzyw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,ixay,Vxzw,Wzyw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,ixay,Vzwx,Wwzy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,ixay,Vzyw,Wxzw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,ixay,Wyzw,Vzxw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaU,ixay,Wzwy,Vwzx->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaU,ixay,Wzxw,Vyzw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('KiaU,ixya,Vzwx,Wwyz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/3 * einsum('KiaU,ixya,Vzwx,Wwzy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('KiaU,ixya,Vzyw,Wxwz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/3 * einsum('KiaU,ixya,Vzyw,Wxzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('KiaU,ixya,Wzwy,Vwxz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/3 * einsum('KiaU,ixya,Wzwy,Vwzx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('KiaU,ixya,Wzxw,Vywz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/3 * einsum('KiaU,ixya,Wzxw,Vyzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,iUax,xyzw,Wzyw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,ixaW,xyzw,Uzyw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,ixay,Uxzw,Wzyw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,ixay,Uzwx,Wwzy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,ixay,Uzyw,Wxzw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,ixay,Wyzw,Uzxw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('KiaV,ixay,Wzwy,Uwzx->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('KiaV,ixay,Wzxw,Uyzw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('KiaV,ixya,Uzwx,Wwyz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/3 * einsum('KiaV,ixya,Uzwx,Wwzy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('KiaV,ixya,Uzyw,Wxwz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/3 * einsum('KiaV,ixya,Uzyw,Wxzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('KiaV,ixya,Wzwy,Uwxz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/3 * einsum('KiaV,ixya,Wzwy,Uwzx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('KiaV,ixya,Wzxw,Uywz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/3 * einsum('KiaV,ixya,Wzxw,Uyzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iUay,Vxyz,Wz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iUay,Vzyw,Wxwz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iUay,Vzyw,Wxzw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iUay,Vzyx,Wz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iUay,xyzw,VzWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iUay,xzwy,VwWz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iUay,xzwy,VwzW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iUay,yzwu,VzuWxw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iUay,yzwu,VzuxWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iVay,Uxyz,Wz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iVay,Uzyw,Wxwz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iVay,Uzyw,Wxzw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iVay,Uzyx,Wz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iVay,xyzw,UzWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iVay,xzwy,UwWz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iVay,xzwy,UwzW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iVay,yzwu,UzuWxw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iVay,yzwu,UzuxWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaW,xzyw,UVwz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaW,xzyw,UVzw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaW,yzwu,UVwxzu->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaW,yzwu,UVwzxu->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iyax,UyVz,Wz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iyax,Uyzw,VwWz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iyax,UzVy,Wz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyax,Uzwy,VzWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyax,Uzwy,VzwW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iyax,Vyzw,UwWz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyax,Vzwy,UzWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyax,Vzwy,UzwW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyax,Wzyw,UVwz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyax,Wzyw,UVzw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,UwVy,Wxwz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,UwVy,Wxzw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Uwuy,VzwWux->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Uwuy,VzwxuW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Uwzu,VwuWxy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Uwzu,VwuxWy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Uwzx,VwWy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Uwzx,VwyW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iyaz,UxVy,Wz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iyaz,Uxwy,VzWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iyaz,Uxzw,VwWy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,UyVw,Wxwz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,UyVw,Wxzw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iyaz,UyVx,Wz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Uywu,VzuWxw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Uywu,VzuxWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Uywx,VzWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Uywx,VzwW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Vwuy,UzwWux->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Vwuy,UzwxuW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Vwzu,UwuWxy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Vwzu,UwuxWy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Vwzx,UwWy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Vwzx,UwyW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/2 * einsum('Kiax,iyaz,Vxwy,UzWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/2 * einsum('Kiax,iyaz,Vxzw,UwWy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Vywu,UzuWxw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Vywu,UzuxWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Vywx,UzWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Vywx,UzwW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Wwuz,UVuwxy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Wwuz,UVuxwy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Wwxz,UVwy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Wwxz,UVyw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Wwyu,UVzwxu->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Wwyu,UVzxwu->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Wzwu,UVwxyu->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Wzwu,UVwyxu->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyaz,Wzxw,UVwy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyaz,Wzxw,UVyw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Uwuy,VzwWux->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Uwuy,VzwuxW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Uwuy,VzwxWu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Uwuy,VzwxuW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Uwzu,VwuWxy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Uwzu,VwuWyx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Uwzu,VwuxWy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Uwzu,VwuyxW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/3 * einsum('Kiax,iyza,Uxwy,VzWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Uxwy,VzwW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/3 * einsum('Kiax,iyza,Uxzw,VwWy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Uxzw,VwyW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Vwuy,UzwWux->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Vwuy,UzwuxW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Vwuy,UzwxWu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Vwuy,UzwxuW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Vwzu,UwuWxy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Vwzu,UwuWyx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Vwzu,UwuxWy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Vwzu,UwuyxW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/3 * einsum('Kiax,iyza,Vxwy,UzWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/6 * einsum('Kiax,iyza,Vxwy,UzwW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/3 * einsum('Kiax,iyza,Vxzw,UwWy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Vxzw,UwyW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Wwuz,UVuwxy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Wwuz,UVuwyx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Wwuz,UVuxwy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Wwuz,UVuyxw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Wwyu,UVzuwx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa += 1/12 * einsum('Kiax,iyza,Wwyu,UVzwxu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/12 * einsum('Kiax,iyza,Wwyu,UVzxuw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_aaaa -= 1/6 * einsum('Kiax,iyza,Wwyu,UVzxwu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma[caaa__aaaa] += ascontiguousarray(sigma_KWUV_aaaa[:, :, aa_tril_ind[0], aa_tril_ind[1]]).reshape(-1)

    sigma_KWUV_abab =- 1/2 * einsum('KiaU,iaVx,Wx->KWUV', X_aaaa, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,iaxW,Vx->KWUV', X_aaaa, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,iaUx,VW->KWUV', X_aaaa, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iaUy,VyWx->KWUV', X_aaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iaUy,VyxW->KWUV', X_aaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iaVy,UyWx->KWUV', X_aaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iaVy,UyxW->KWUV', X_aaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iayW,UVxy->KWUV', X_aaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iayW,UVyx->KWUV', X_aaaa, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,ixUa,VW->KWUV', X_aaaa, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyUa,VyWx->KWUV', X_aaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyUa,VyxW->KWUV', X_aaaa, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/4 * einsum('ijaU,iKja,VW->KWUV', X_aaaa, v_xxxe, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/4 * einsum('ijaU,jKia,VW->KWUV', X_aaaa, v_xxxe, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('ijax,iKja,UVWx->KWUV', X_aaaa, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('ijax,iKja,UVxW->KWUV', X_aaaa, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('ijax,jKia,UVWx->KWUV', X_aaaa, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('ijax,jKia,UVxW->KWUV', X_aaaa, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaV,iWxa,Ux->KWUV', X_abab, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaV,ixUa,Wx->KWUV', X_abab, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iWya,UVxy->KWUV', X_abab, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iWya,UVyx->KWUV', X_abab, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,ixUa,VW->KWUV', X_abab, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyUa,VyWx->KWUV', X_abab, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyUa,VyxW->KWUV', X_abab, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,iWxa,Vx->KWUV', X_abba, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,iaVx,Wx->KWUV', X_abba, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,iaxW,Vx->KWUV', X_abba, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,ixVa,Wx->KWUV', X_abba, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iWya,UVxy->KWUV', X_abba, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iWya,UVyx->KWUV', X_abba, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,iaUx,VW->KWUV', X_abba, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iaUy,VyWx->KWUV', X_abba, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iaUy,VyxW->KWUV', X_abba, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iaVy,UyWx->KWUV', X_abba, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iaVy,UyxW->KWUV', X_abba, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iayW,UVxy->KWUV', X_abba, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iayW,UVyx->KWUV', X_abba, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyVa,UyWx->KWUV', X_abba, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyVa,UyxW->KWUV', X_abba, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('ijaU,iKja,VW->KWUV', X_abba, v_xxxe, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('ijax,iKja,UVWx->KWUV', X_abba, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('ijax,iKja,UVxW->KWUV', X_abba, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,a,iVax,Wx->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,a,ixaW,Vx->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,i,iVax,Wx->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,i,ixaW,Vx->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,a,iUax,VW->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,a,iUay,VyWx->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,a,iUay,VyxW->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,a,iUxa,VW->KWUV', X_aaaa, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,a,iUya,VyWx->KWUV', X_aaaa, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,a,iUya,VyxW->KWUV', X_aaaa, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,a,iVay,UyWx->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,a,iVay,UyxW->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,a,iyaW,UVxy->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,a,iyaW,UVyx->KWUV', X_aaaa, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,i,iUax,VW->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,i,iUay,VyWx->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,i,iUay,VyxW->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,i,iUxa,VW->KWUV', X_aaaa, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,i,iUya,VyWx->KWUV', X_aaaa, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,i,iUya,VyxW->KWUV', X_aaaa, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,i,iVay,UyWx->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,i,iVay,UyxW->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,i,iyaW,UVxy->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,i,iyaW,UVyx->KWUV', X_aaaa, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,Vx,ixay,Wy->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,Wx,iyax,Vy->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,xy,iVax,Wy->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,xy,ixaW,Vy->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,Uy,iyax,VW->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,Uy,iyaz,VzWx->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,Uy,iyaz,VzxW->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,Uy,iyxa,VW->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,Uy,iyza,VzWx->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,Uy,iyza,VzxW->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,Vy,iyaz,UzWx->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,Vy,iyaz,UzxW->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,Wy,izay,UVxz->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,Wy,izay,UVzx->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,xy,iUay,VW->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,xy,iUya,VW->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,yz,iUay,VzWx->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,yz,iUay,VzxW->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,yz,iUya,VzWx->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,yz,iUya,VzxW->KWUV', X_aaaa, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,yz,iVay,UzWx->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,yz,iVay,UzxW->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,yz,iyaW,UVxz->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,yz,iyaW,UVzx->KWUV', X_aaaa, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,iVax,xyzw,Wzyw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,ixaW,xyzw,Vzyw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,ixay,Vxzw,Wzyw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,ixay,Vzwx,Wwzy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,ixay,Vzyw,Wxzw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,ixay,Wyzw,Vzxw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,ixay,Wzwy,Vwzx->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,ixay,Wzxw,Vyzw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('KiaU,ixya,Vzwx,Wwyz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('KiaU,ixya,Vzwx,Wwzy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('KiaU,ixya,Vzyw,Wxwz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('KiaU,ixya,Vzyw,Wxzw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('KiaU,ixya,Wzwy,Vwxz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('KiaU,ixya,Wzwy,Vwzx->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('KiaU,ixya,Wzxw,Vywz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('KiaU,ixya,Wzxw,Vyzw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iUay,Vzyw,Wxwz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iUay,Vzyw,Wxzw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,iUay,Vzyx,Wz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,iUay,xyzw,VzWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iUay,xzwy,VwWz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iUay,xzwy,VwzW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iUay,yzwu,VzuWxw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iUay,yzwu,VzuxWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iUya,Vzyw,Wxwz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iUya,Vzyw,Wxzw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,iUya,Vzyx,Wz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,iUya,xyzw,VzWw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iUya,xzwy,VwWz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iUya,xzwy,VwzW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iUya,yzwu,VzuWxw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iUya,yzwu,VzuxWw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,iVay,Uxyz,Wz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iVay,Uzyw,Wxwz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iVay,Uzyw,Wxzw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iVay,xzwy,UwWz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iVay,xzwy,UwzW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iVay,yzwu,UzuWwx->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iVay,yzwu,UzuwWx->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iVay,yzwu,UzuwxW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iVay,yzwu,UzuxWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iVay,yzwu,UzuxwW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaW,xzyw,UVwz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyaW,xzyw,UVzw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyaW,yzwu,UVwxzu->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaW,yzwu,UVwzxu->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,iyax,UyVz,Wz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,iyax,Uyzw,VwWz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyax,Uzwy,VzWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyax,Uzwy,VzwW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyax,Vzwy,UzWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyax,Vzwy,UzwW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyax,Wzyw,UVwz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyax,Wzyw,UVzw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,UwVy,Wxwz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyaz,UwVy,Wxzw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Uwuy,VzwWux->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Uwuy,VzwWxu->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Uwuy,VzwuWx->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Uwuy,VzwuxW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Uwuy,VzwxWu->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyaz,Uwzu,VwuWxy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Uwzu,VwuxWy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyaz,Uwzx,VwWy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Uwzx,VwyW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,iyaz,UxVy,Wz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,iyaz,Uxwy,VzWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,iyaz,Uxzw,VwWy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyaz,UyVw,Wxwz->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,UyVw,Wxzw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyaz,Uywu,VzuWxw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Uywu,VzuxWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyaz,Uywx,VzWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Uywx,VzwW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Vwuy,UzwWux->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyaz,Vwuy,UzwxuW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Vwzu,UwuWyx->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Vwzu,UwuxWy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Vwzu,UwuxyW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Vwzu,UwuyWx->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Vwzu,UwuyxW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Vwzx,UwWy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyaz,Vwzx,UwyW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Vywu,UzuWwx->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Vywu,UzuwWx->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Vywu,UzuwxW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Vywu,UzuxWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Vywu,UzuxwW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Vywx,UzWw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyaz,Vywx,UzwW->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Wwuz,UVuwyx->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Wwuz,UVuxwy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Wwuz,UVuxyw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Wwuz,UVuywx->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Wwuz,UVuyxw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Wwxz,UVwy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyaz,Wwxz,UVyw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Wwyu,UVzwxu->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyaz,Wwyu,UVzxwu->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyaz,Wzwu,UVwxyu->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Wzwu,UVwyxu->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyaz,Wzxw,UVwy->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Wzxw,UVyw->KWUV', X_aaaa, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,iyxa,UyVz,Wz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,iyxa,Uyzw,VwWz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyxa,Uzwy,VzWw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyxa,Uzwy,VzwW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyxa,Vzwy,UzWw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyxa,Vzwy,UzwW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyxa,Wzyw,UVwz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyxa,Wzyw,UVzw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Uwuy,VzwWux->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Uwuy,VzwWxu->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Uwuy,VzwuxW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Uwuy,VzwxWu->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Uwzu,VwuWxy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Uwzu,VwuWyx->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Uwzu,VwuxWy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Uwzu,VwuyxW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyza,Uwzx,VwWy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Uwzx,VwyW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyza,Uxwy,VzWw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Uxwy,VzwW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyza,Uxzw,VwWy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Uxzw,VwyW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyza,UyVw,Wxwz->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,UyVw,Wxzw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyza,Uywu,VzuWxw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Uywu,VzuxWw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyza,Uywx,VzWw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Uywx,VzwW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Vwuy,UzwWux->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Vwuy,UzwuxW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Vwuy,UzwxWu->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Vwuy,UzwxuW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Vwzu,UwuWyx->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Vwzu,UwuxWy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Vwzu,UwuyWx->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Vwzu,UwuyxW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Vwzx,UwWy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyza,Vwzx,UwyW->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Wwuz,UVuwyx->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Wwuz,UVuxwy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Wwuz,UVuywx->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Wwuz,UVuyxw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Wwxz,UVwy->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyza,Wwxz,UVyw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Wwyu,UVzuwx->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Wwyu,UVzwxu->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Wwyu,UVzxuw->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Wwyu,UVzxwu->KWUV', X_aaaa, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaV,a,iUxa,Wx->KWUV', X_abab, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaV,a,ixWa,Ux->KWUV', X_abab, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaV,i,iUxa,Wx->KWUV', X_abab, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaV,i,ixWa,Ux->KWUV', X_abab, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,a,iUxa,VW->KWUV', X_abab, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,a,iUya,VyWx->KWUV', X_abab, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,a,iUya,VyxW->KWUV', X_abab, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,a,iyWa,UVxy->KWUV', X_abab, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,a,iyWa,UVyx->KWUV', X_abab, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,i,iUxa,VW->KWUV', X_abab, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,i,iUya,VyWx->KWUV', X_abab, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,i,iUya,VyxW->KWUV', X_abab, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,i,iyWa,UVxy->KWUV', X_abab, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,i,iyWa,UVyx->KWUV', X_abab, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaV,Ux,ixya,Wy->KWUV', X_abab, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaV,Wx,iyxa,Uy->KWUV', X_abab, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaV,xy,iUxa,Wy->KWUV', X_abab, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaV,xy,ixWa,Uy->KWUV', X_abab, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,Uy,iyxa,VW->KWUV', X_abab, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,Uy,iyza,VzWx->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,Uy,iyza,VzxW->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,Wy,izya,UVxz->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,Wy,izya,UVzx->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,xy,iUya,VW->KWUV', X_abab, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,yz,iUya,VzWx->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,yz,iUya,VzxW->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,yz,iyWa,UVxz->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,yz,iyWa,UVzx->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaV,iUxa,xyzw,Wzyw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaV,ixWa,xyzw,Uzyw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaV,ixya,Uxzw,Wzyw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('KiaV,ixya,Uzwx,Wwyz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('KiaV,ixya,Uzwx,Wwzy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('KiaV,ixya,Uzyw,Wxwz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('KiaV,ixya,Uzyw,Wxzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaV,ixya,Wyzw,Uzxw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('KiaV,ixya,Wzwy,Uwxz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('KiaV,ixya,Wzwy,Uwzx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('KiaV,ixya,Wzxw,Uywz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('KiaV,ixya,Wzxw,Uyzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,iUya,Vxyz,Wz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iUya,Vzyw,Wxwz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iUya,Vzyw,Wxzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,iUya,Vzyx,Wz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,iUya,xyzw,VzWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iUya,xzwy,VwWz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iUya,xzwy,VwzW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iUya,yzwu,VzuWxw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iUya,yzwu,VzuxWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyWa,xzyw,UVwz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyWa,xzyw,UVzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyWa,yzwu,UVwuxz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyWa,yzwu,UVwuzx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyWa,yzwu,UVwxuz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyWa,yzwu,UVwzux->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyWa,yzwu,UVwzxu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,iyxa,UyVz,Wz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,iyxa,Uyzw,VwWz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyxa,Uzwy,VzWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyxa,Uzwy,VzwW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyxa,Vzwy,UzWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyxa,Vzwy,UzwW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyxa,Wzyw,UVwz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyxa,Wzyw,UVzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Uwuy,VzwWux->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Uwuy,VzwWxu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Uwuy,VzwuxW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Uwuy,VzwxWu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Uwzu,VwuWyx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Uwzu,VwuxWy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Uwzu,VwuxyW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Uwzu,VwuyxW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyza,Uwzx,VwWy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Uwzx,VwyW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,UyVw,Wxwz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,UyVw,Wxzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,iyza,UyVx,Wz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Uywu,VzuWxw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Uywu,VzuxWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Uywx,VzWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Uywx,VzwW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Vwuy,UzwWux->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Vwuy,UzwuWx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Vwuy,UzwuxW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Vwuy,UzwxWu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Vwzu,UwuWyx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Vwzu,UwuxWy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Vwzu,UwuyWx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Vwzu,UwuyxW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Vwzx,UwWy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyza,Vwzx,UwyW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Vxwy,UzWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyza,Vxwy,UzwW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Vxzw,UwWy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyza,Vxzw,UwyW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Wwuz,UVuwyx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Wwuz,UVuxwy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Wwuz,UVuywx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Wwuz,UVuyxw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Wwxz,UVwy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyza,Wwxz,UVyw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Wwyu,UVzuwx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Wwyu,UVzuxw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Wwyu,UVzwxu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Wwyu,UVzxuw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Wzwu,UVwuxy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Wzwu,UVwuyx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Wzwu,UVwxuy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Wzwu,UVwyux->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Wzwu,UVwyxu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Wzxw,UVwy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyza,Wzxw,UVyw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,a,iVax,Wx->KWUV', X_abba, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,a,iVxa,Wx->KWUV', X_abba, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,a,ixWa,Vx->KWUV', X_abba, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,a,ixaW,Vx->KWUV', X_abba, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,i,iVax,Wx->KWUV', X_abba, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,i,iVxa,Wx->KWUV', X_abba, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,i,ixWa,Vx->KWUV', X_abba, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,i,ixaW,Vx->KWUV', X_abba, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,a,iUax,VW->KWUV', X_abba, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,a,iUay,VyWx->KWUV', X_abba, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,a,iUay,VyxW->KWUV', X_abba, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,a,iVay,UyWx->KWUV', X_abba, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,a,iVay,UyxW->KWUV', X_abba, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,a,iVya,UyWx->KWUV', X_abba, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,a,iVya,UyxW->KWUV', X_abba, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,a,iyWa,UVxy->KWUV', X_abba, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,a,iyWa,UVyx->KWUV', X_abba, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,a,iyaW,UVxy->KWUV', X_abba, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,a,iyaW,UVyx->KWUV', X_abba, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,i,iUax,VW->KWUV', X_abba, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,i,iUay,VyWx->KWUV', X_abba, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,i,iUay,VyxW->KWUV', X_abba, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,i,iVay,UyWx->KWUV', X_abba, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,i,iVay,UyxW->KWUV', X_abba, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,i,iVya,UyWx->KWUV', X_abba, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,i,iVya,UyxW->KWUV', X_abba, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,i,iyWa,UVxy->KWUV', X_abba, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,i,iyWa,UVyx->KWUV', X_abba, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,i,iyaW,UVxy->KWUV', X_abba, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,i,iyaW,UVyx->KWUV', X_abba, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,Vx,ixay,Wy->KWUV', X_abba, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,Vx,ixya,Wy->KWUV', X_abba, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,Wx,iyax,Vy->KWUV', X_abba, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,Wx,iyxa,Vy->KWUV', X_abba, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,xy,iVax,Wy->KWUV', X_abba, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,xy,iVxa,Wy->KWUV', X_abba, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,xy,ixWa,Vy->KWUV', X_abba, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,xy,ixaW,Vy->KWUV', X_abba, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,Uy,iyax,VW->KWUV', X_abba, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,Uy,iyaz,VzWx->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,Uy,iyaz,VzxW->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,Vy,iyaz,UzWx->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,Vy,iyaz,UzxW->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,Vy,iyza,UzWx->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,Vy,iyza,UzxW->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,Wy,izay,UVxz->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,Wy,izay,UVzx->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,Wy,izya,UVxz->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,Wy,izya,UVzx->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,xy,iUay,VW->KWUV', X_abba, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,yz,iUay,VzWx->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,yz,iUay,VzxW->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,yz,iVay,UzWx->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,yz,iVay,UzxW->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,yz,iVya,UzWx->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,yz,iVya,UzxW->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,yz,iyWa,UVxz->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,yz,iyWa,UVzx->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,yz,iyaW,UVxz->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,yz,iyaW,UVzx->KWUV', X_abba, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,iVax,xyzw,Wzyw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,iVxa,xyzw,Wzyw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,ixWa,xyzw,Vzyw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,ixaW,xyzw,Vzyw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,ixay,Vxzw,Wzyw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,ixay,Vzwx,Wwzy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,ixay,Vzyw,Wxzw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,ixay,Wyzw,Vzxw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('KiaU,ixay,Wzwy,Vwzx->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,ixay,Wzxw,Vyzw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,ixya,Vxzw,Wzyw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('KiaU,ixya,Vzwx,Wwyz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('KiaU,ixya,Vzwx,Wwzy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('KiaU,ixya,Vzyw,Wxwz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('KiaU,ixya,Vzyw,Wxzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('KiaU,ixya,Wyzw,Vzxw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('KiaU,ixya,Wzwy,Vwxz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('KiaU,ixya,Wzwy,Vwzx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('KiaU,ixya,Wzxw,Vywz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('KiaU,ixya,Wzxw,Vyzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iUay,Vzyw,Wxwz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iUay,Vzyw,Wxzw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,iUay,Vzyx,Wz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,iUay,xyzw,VzWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iUay,xzwy,VwWz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iUay,xzwy,VwzW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iUay,yzwu,VzuWxw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iUay,yzwu,VzuxWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,iVay,Uxyz,Wz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iVay,Uzyw,Wxwz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iVay,Uzyw,Wxzw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iVay,xzwy,UwWz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iVay,xzwy,UwzW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iVay,yzwu,UzuWwx->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iVay,yzwu,UzuwWx->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iVay,yzwu,UzuwxW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iVay,yzwu,UzuxWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iVay,yzwu,UzuxwW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,iVya,Uxyz,Wz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iVya,Uzyw,Wxwz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iVya,Uzyw,Wxzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iVya,xzwy,UwWz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iVya,xzwy,UwzW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iVya,yzwu,UzuWwx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iVya,yzwu,UzuwWx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iVya,yzwu,UzuwxW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iVya,yzwu,UzuxWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iVya,yzwu,UzuxwW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyWa,xzyw,UVwz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyWa,xzyw,UVzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyWa,yzwu,UVwxzu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyWa,yzwu,UVwzxu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaW,xzyw,UVwz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyaW,xzyw,UVzw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyaW,yzwu,UVwxzu->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaW,yzwu,UVwzxu->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,iyax,UyVz,Wz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,iyax,Uyzw,VwWz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyax,Uzwy,VzWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyax,Uzwy,VzwW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyax,Vzwy,UzWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyax,Vzwy,UzwW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyax,Wzyw,UVwz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyax,Wzyw,UVzw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,UwVy,Wxwz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyaz,UwVy,Wxzw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Uwuy,VzwWux->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Uwuy,VzwWxu->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Uwuy,VzwuWx->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Uwuy,VzwuxW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Uwuy,VzwxWu->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyaz,Uwzu,VwuWxy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Uwzu,VwuxWy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyaz,Uwzx,VwWy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Uwzx,VwyW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,iyaz,UxVy,Wz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab += 1/2 * einsum('Kiax,iyaz,Uxwy,VzWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,iyaz,Uxzw,VwWy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyaz,UyVw,Wxwz->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,UyVw,Wxzw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyaz,Uywu,VzuWxw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Uywu,VzuxWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyaz,Uywx,VzWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Uywx,VzwW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Vwuy,UzwWux->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyaz,Vwuy,UzwxuW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Vwzu,UwuWyx->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Vwzu,UwuxWy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Vwzu,UwuxyW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Vwzu,UwuyWx->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Vwzu,UwuyxW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Vwzx,UwWy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyaz,Vwzx,UwyW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Vywu,UzuWwx->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Vywu,UzuwWx->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Vywu,UzuwxW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Vywu,UzuxWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Vywu,UzuxwW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Vywx,UzWw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyaz,Vywx,UzwW->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Wwuz,UVuwyx->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Wwuz,UVuxwy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Wwuz,UVuxyw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Wwuz,UVuywx->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Wwuz,UVuyxw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Wwxz,UVwy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyaz,Wwxz,UVyw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyaz,Wwyu,UVzwxu->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyaz,Wwyu,UVzxwu->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyaz,Wzwu,UVwxyu->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Wzwu,UVwyxu->KWUV', X_abba, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/3 * einsum('Kiax,iyaz,Wzxw,UVwy->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyaz,Wzxw,UVyw->KWUV', X_abba, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,UwVy,Wxwz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyza,UwVy,Wxzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Uwuy,VzwWux->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Uwuy,VzwuWx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Uwuy,VzwuxW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Uwuy,VzwxWu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Uwzu,VwuWxy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Uwzu,VwuWyx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Uwzu,VwuxWy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Uwzu,VwuyxW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/2 * einsum('Kiax,iyza,UxVy,Wz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Uxwy,VzWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Uxwy,VzwW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Uxzw,VwWy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Uxzw,VwyW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Vwuy,UzwWux->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Vwuy,UzwuxW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Vwuy,UzwxWu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Vwuy,UzwxuW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Vwzu,UwuWyx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Vwzu,UwuxWy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Vwzu,UwuxyW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Vwzu,UwuyxW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Vywu,UzuWwx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Vywu,UzuwWx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Vywu,UzuwxW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Vywu,UzuxWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Vywu,UzuxwW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Vywx,UzWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyza,Vywx,UzwW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Wwuz,UVuwyx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Wwuz,UVuxwy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Wwuz,UVuxyw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Wwuz,UVuyxw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Wwyu,UVzuwx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/12 * einsum('Kiax,iyza,Wwyu,UVzwxu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/12 * einsum('Kiax,iyza,Wwyu,UVzxuw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab -= 1/6 * einsum('Kiax,iyza,Wwyu,UVzxwu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyza,Wzwu,UVwxyu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Wzwu,UVwyxu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/3 * einsum('Kiax,iyza,Wzxw,UVwy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_abab += 1/6 * einsum('Kiax,iyza,Wzxw,UVyw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma[caaa__abab] += ascontiguousarray(sigma_KWUV_abab).reshape(-1)

    sigma_KWUV_baba  = 1/2 * einsum('iKaU,iWxa,Vx->KWUV', X_abab, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaU,iaVx,Wx->KWUV', X_abab, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaU,iaxW,Vx->KWUV', X_abab, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaU,ixVa,Wx->KWUV', X_abab, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iWya,UVxy->KWUV', X_abab, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iWya,UVyx->KWUV', X_abab, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKax,iaUx,VW->KWUV', X_abab, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iaUy,VyWx->KWUV', X_abab, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iaUy,VyxW->KWUV', X_abab, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iaVy,UyWx->KWUV', X_abab, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iaVy,UyxW->KWUV', X_abab, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iayW,UVxy->KWUV', X_abab, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iayW,UVyx->KWUV', X_abab, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyVa,UyWx->KWUV', X_abab, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iyVa,UyxW->KWUV', X_abab, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('ijaU,jKia,VW->KWUV', X_abab, v_xxxe, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('ijax,jKia,UVWx->KWUV', X_abab, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('ijax,jKia,UVxW->KWUV', X_abab, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaV,iWxa,Ux->KWUV', X_abba, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaV,ixUa,Wx->KWUV', X_abba, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iWya,UVxy->KWUV', X_abba, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iWya,UVyx->KWUV', X_abba, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKax,ixUa,VW->KWUV', X_abba, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyUa,VyWx->KWUV', X_abba, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyUa,VyxW->KWUV', X_abba, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('KiaU,iaVx,Wx->KWUV', X_bbbb, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('KiaU,iaxW,Vx->KWUV', X_bbbb, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('Kiax,iaUx,VW->KWUV', X_bbbb, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iaUy,VyWx->KWUV', X_bbbb, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iaUy,VyxW->KWUV', X_bbbb, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iaVy,UyWx->KWUV', X_bbbb, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iaVy,UyxW->KWUV', X_bbbb, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iayW,UVxy->KWUV', X_bbbb, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iayW,UVyx->KWUV', X_bbbb, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('Kiax,ixUa,VW->KWUV', X_bbbb, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iyUa,VyWx->KWUV', X_bbbb, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyUa,VyxW->KWUV', X_bbbb, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/4 * einsum('ijaU,iKja,VW->KWUV', X_bbbb, v_xxxe, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/4 * einsum('ijaU,jKia,VW->KWUV', X_bbbb, v_xxxe, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('ijax,iKja,UVWx->KWUV', X_bbbb, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('ijax,iKja,UVxW->KWUV', X_bbbb, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('ijax,jKia,UVWx->KWUV', X_bbbb, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('ijax,jKia,UVxW->KWUV', X_bbbb, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaU,a,iVax,Wx->KWUV', X_abab, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaU,a,iVxa,Wx->KWUV', X_abab, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaU,a,ixWa,Vx->KWUV', X_abab, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaU,a,ixaW,Vx->KWUV', X_abab, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaU,i,iVax,Wx->KWUV', X_abab, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaU,i,iVxa,Wx->KWUV', X_abab, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaU,i,ixWa,Vx->KWUV', X_abab, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaU,i,ixaW,Vx->KWUV', X_abab, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKax,a,iUax,VW->KWUV', X_abab, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,a,iUay,VyWx->KWUV', X_abab, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,a,iUay,VyxW->KWUV', X_abab, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,a,iVay,UyWx->KWUV', X_abab, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,a,iVay,UyxW->KWUV', X_abab, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,a,iVya,UyWx->KWUV', X_abab, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,a,iVya,UyxW->KWUV', X_abab, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,a,iyWa,UVxy->KWUV', X_abab, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,a,iyWa,UVyx->KWUV', X_abab, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,a,iyaW,UVxy->KWUV', X_abab, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,a,iyaW,UVyx->KWUV', X_abab, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKax,i,iUax,VW->KWUV', X_abab, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,i,iUay,VyWx->KWUV', X_abab, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,i,iUay,VyxW->KWUV', X_abab, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,i,iVay,UyWx->KWUV', X_abab, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,i,iVay,UyxW->KWUV', X_abab, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,i,iVya,UyWx->KWUV', X_abab, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,i,iVya,UyxW->KWUV', X_abab, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,i,iyWa,UVxy->KWUV', X_abab, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,i,iyWa,UVyx->KWUV', X_abab, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,i,iyaW,UVxy->KWUV', X_abab, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,i,iyaW,UVyx->KWUV', X_abab, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaU,Vx,ixay,Wy->KWUV', X_abab, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaU,Vx,ixya,Wy->KWUV', X_abab, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaU,Wx,iyax,Vy->KWUV', X_abab, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaU,Wx,iyxa,Vy->KWUV', X_abab, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaU,xy,iVax,Wy->KWUV', X_abab, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaU,xy,iVxa,Wy->KWUV', X_abab, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaU,xy,ixWa,Vy->KWUV', X_abab, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaU,xy,ixaW,Vy->KWUV', X_abab, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKax,Uy,iyax,VW->KWUV', X_abab, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,Uy,iyaz,VzWx->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,Uy,iyaz,VzxW->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,Vy,iyaz,UzWx->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,Vy,iyaz,UzxW->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,Vy,iyza,UzWx->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,Vy,iyza,UzxW->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,Wy,izay,UVxz->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,Wy,izay,UVzx->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,Wy,izya,UVxz->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,Wy,izya,UVzx->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKax,xy,iUay,VW->KWUV', X_abab, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,yz,iUay,VzWx->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,yz,iUay,VzxW->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,yz,iVay,UzWx->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,yz,iVay,UzxW->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,yz,iVya,UzWx->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,yz,iVya,UzxW->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,yz,iyWa,UVxz->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,yz,iyWa,UVzx->KWUV', X_abab, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,yz,iyaW,UVxz->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,yz,iyaW,UVzx->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaU,iVax,xyzw,Wzyw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaU,iVxa,xyzw,Wzyw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaU,ixWa,xyzw,Vzyw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaU,ixaW,xyzw,Vzyw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaU,ixay,Vxzw,Wzyw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaU,ixay,Vzwx,Wwzy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaU,ixay,Vzyw,Wxzw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaU,ixay,Wyzw,Vzxw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaU,ixay,Wzwy,Vwzx->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaU,ixay,Wzxw,Vyzw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaU,ixya,Vxzw,Wzyw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKaU,ixya,Vzwx,Wwyz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKaU,ixya,Vzwx,Wwzy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKaU,ixya,Vzyw,Wxwz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKaU,ixya,Vzyw,Wxzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaU,ixya,Wyzw,Vzxw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKaU,ixya,Wzwy,Vwxz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKaU,ixya,Wzwy,Vwzx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKaU,ixya,Wzxw,Vywz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKaU,ixya,Wzxw,Vyzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iUay,Vzyw,Wxwz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iUay,Vzyw,Wxzw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKax,iUay,Vzyx,Wz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKax,iUay,xyzw,VzWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iUay,xzwy,VwWz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iUay,xzwy,VwzW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iUay,yzwu,VzuWxw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iUay,yzwu,VzuxWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKax,iVay,Uxyz,Wz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iVay,Uzyw,Wxwz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iVay,Uzyw,Wxzw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iVay,xzwy,UwWz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iVay,xzwy,UwzW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iVay,yzwu,UzuWwx->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iVay,yzwu,UzuwWx->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iVay,yzwu,UzuwxW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iVay,yzwu,UzuxWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iVay,yzwu,UzuxwW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKax,iVya,Uxyz,Wz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iVya,Uzyw,Wxwz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iVya,Uzyw,Wxzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iVya,xzwy,UwWz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iVya,xzwy,UwzW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iVya,yzwu,UzuWwx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iVya,yzwu,UzuwWx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iVya,yzwu,UzuwxW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iVya,yzwu,UzuxWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iVya,yzwu,UzuxwW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyWa,xzyw,UVwz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iyWa,xzyw,UVzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iyWa,yzwu,UVwxzu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyWa,yzwu,UVwzxu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyaW,xzyw,UVwz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iyaW,xzyw,UVzw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iyaW,yzwu,UVwxzu->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyaW,yzwu,UVwzxu->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKax,iyax,UyVz,Wz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKax,iyax,Uyzw,VwWz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iyax,Uzwy,VzWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyax,Uzwy,VzwW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyax,Vzwy,UzWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iyax,Vzwy,UzwW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iyax,Wzyw,UVwz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyax,Wzyw,UVzw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyaz,UwVy,Wxwz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iyaz,UwVy,Wxzw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyaz,Uwuy,VzwWux->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyaz,Uwuy,VzwWxu->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyaz,Uwuy,VzwuWx->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyaz,Uwuy,VzwuxW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyaz,Uwuy,VzwxWu->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iyaz,Uwzu,VwuWxy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyaz,Uwzu,VwuxWy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iyaz,Uwzx,VwWy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyaz,Uwzx,VwyW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKax,iyaz,UxVy,Wz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKax,iyaz,Uxwy,VzWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKax,iyaz,Uxzw,VwWy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iyaz,UyVw,Wxwz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyaz,UyVw,Wxzw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iyaz,Uywu,VzuWxw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyaz,Uywu,VzuxWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iyaz,Uywx,VzWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyaz,Uywx,VzwW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyaz,Vwuy,UzwWux->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iyaz,Vwuy,UzwxuW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyaz,Vwzu,UwuWyx->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyaz,Vwzu,UwuxWy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyaz,Vwzu,UwuxyW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyaz,Vwzu,UwuyWx->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyaz,Vwzu,UwuyxW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyaz,Vwzx,UwWy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iyaz,Vwzx,UwyW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyaz,Vywu,UzuWwx->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyaz,Vywu,UzuwWx->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyaz,Vywu,UzuwxW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyaz,Vywu,UzuxWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyaz,Vywu,UzuxwW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyaz,Vywx,UzWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iyaz,Vywx,UzwW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyaz,Wwuz,UVuwyx->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyaz,Wwuz,UVuxwy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyaz,Wwuz,UVuxyw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyaz,Wwuz,UVuywx->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyaz,Wwuz,UVuyxw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyaz,Wwxz,UVwy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iyaz,Wwxz,UVyw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyaz,Wwyu,UVzwxu->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iyaz,Wwyu,UVzxwu->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iyaz,Wzwu,UVwxyu->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyaz,Wzwu,UVwyxu->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iyaz,Wzxw,UVwy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyaz,Wzxw,UVyw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,UwVy,Wxwz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iyza,UwVy,Wxzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('iKax,iyza,Uwuy,VzwWux->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Uwuy,VzwuWx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Uwuy,VzwuxW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Uwuy,VzwxWu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Uwzu,VwuWxy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Uwzu,VwuWyx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Uwzu,VwuxWy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('iKax,iyza,Uwzu,VwuyxW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKax,iyza,UxVy,Wz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Uxwy,VzWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,Uxwy,VzwW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,Uxzw,VwWy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Uxzw,VwyW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('iKax,iyza,Vwuy,UzwWux->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('iKax,iyza,Vwuy,UzwuxW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Vwuy,UzwxWu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,Vwuy,UzwxuW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('iKax,iyza,Vwzu,UwuWyx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Vwzu,UwuxWy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,Vwzu,UwuxyW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('iKax,iyza,Vwzu,UwuyxW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Vywu,UzuWwx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Vywu,UzuwWx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Vywu,UzuwxW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,Vywu,UzuxWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Vywu,UzuxwW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,Vywx,UzWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iyza,Vywx,UzwW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Wwuz,UVuwyx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('iKax,iyza,Wwuz,UVuxwy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Wwuz,UVuxyw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Wwuz,UVuyxw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Wwyu,UVzuwx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Wwyu,UVzwxu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('iKax,iyza,Wwyu,UVzxuw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Wwyu,UVzxwu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iyza,Wzwu,UVwxyu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,Wzwu,UVwyxu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iyza,Wzxw,UVwy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,Wzxw,UVyw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaV,a,iUxa,Wx->KWUV', X_abba, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaV,a,ixWa,Ux->KWUV', X_abba, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaV,i,iUxa,Wx->KWUV', X_abba, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaV,i,ixWa,Ux->KWUV', X_abba, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKax,a,iUxa,VW->KWUV', X_abba, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,a,iUya,VyWx->KWUV', X_abba, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,a,iUya,VyxW->KWUV', X_abba, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,a,iyWa,UVxy->KWUV', X_abba, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,a,iyWa,UVyx->KWUV', X_abba, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKax,i,iUxa,VW->KWUV', X_abba, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,i,iUya,VyWx->KWUV', X_abba, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,i,iUya,VyxW->KWUV', X_abba, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,i,iyWa,UVxy->KWUV', X_abba, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,i,iyWa,UVyx->KWUV', X_abba, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaV,Ux,ixya,Wy->KWUV', X_abba, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaV,Wx,iyxa,Uy->KWUV', X_abba, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaV,xy,iUxa,Wy->KWUV', X_abba, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaV,xy,ixWa,Uy->KWUV', X_abba, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKax,Uy,iyxa,VW->KWUV', X_abba, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,Uy,iyza,VzWx->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,Uy,iyza,VzxW->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,Wy,izya,UVxz->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,Wy,izya,UVzx->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKax,xy,iUya,VW->KWUV', X_abba, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,yz,iUya,VzWx->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,yz,iUya,VzxW->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,yz,iyWa,UVxz->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,yz,iyWa,UVzx->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaV,iUxa,xyzw,Wzyw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKaV,ixWa,xyzw,Uzyw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaV,ixya,Uxzw,Wzyw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKaV,ixya,Uzwx,Wwyz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKaV,ixya,Uzwx,Wwzy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKaV,ixya,Uzyw,Wxwz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKaV,ixya,Uzyw,Wxzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKaV,ixya,Wyzw,Uzxw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKaV,ixya,Wzwy,Uwxz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKaV,ixya,Wzwy,Uwzx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKaV,ixya,Wzxw,Uywz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKaV,ixya,Wzxw,Uyzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKax,iUya,Vxyz,Wz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iUya,Vzyw,Wxwz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iUya,Vzyw,Wxzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKax,iUya,Vzyx,Wz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKax,iUya,xyzw,VzWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iUya,xzwy,VwWz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iUya,xzwy,VwzW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iUya,yzwu,VzuWxw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iUya,yzwu,VzuxWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iyWa,xzyw,UVwz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyWa,xzyw,UVzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyWa,yzwu,UVwuxz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyWa,yzwu,UVwuzx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyWa,yzwu,UVwxuz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyWa,yzwu,UVwzux->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyWa,yzwu,UVwzxu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKax,iyxa,UyVz,Wz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('iKax,iyxa,Uyzw,VwWz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iyxa,Uzwy,VzWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyxa,Uzwy,VzwW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyxa,Vzwy,UzWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iyxa,Vzwy,UzwW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iyxa,Wzyw,UVwz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyxa,Wzyw,UVzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Uwuy,VzwWux->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Uwuy,VzwWxu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Uwuy,VzwuxW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('iKax,iyza,Uwuy,VzwxWu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('iKax,iyza,Uwzu,VwuWyx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Uwzu,VwuxWy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Uwzu,VwuxyW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Uwzu,VwuyxW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iyza,Uwzx,VwWy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Uwzx,VwyW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,UyVw,Wxwz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,UyVw,Wxzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('iKax,iyza,UyVx,Wz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,Uywu,VzuWxw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Uywu,VzuxWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,Uywx,VzWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Uywx,VzwW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('iKax,iyza,Vwuy,UzwWux->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,Vwuy,UzwuWx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Vwuy,UzwuxW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('iKax,iyza,Vwuy,UzwxWu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('iKax,iyza,Vwzu,UwuWyx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('iKax,iyza,Vwzu,UwuxWy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,Vwzu,UwuyWx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Vwzu,UwuyxW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Vwzx,UwWy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iyza,Vwzx,UwyW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Vxwy,UzWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iyza,Vxwy,UzwW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,Vxzw,UwWy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iyza,Vxzw,UwyW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Wwuz,UVuwyx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Wwuz,UVuxwy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Wwuz,UVuywx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('iKax,iyza,Wwuz,UVuyxw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,Wwxz,UVwy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('iKax,iyza,Wwxz,UVyw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('iKax,iyza,Wwyu,UVzuwx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Wwyu,UVzuxw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Wwyu,UVzwxu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('iKax,iyza,Wwyu,UVzxuw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,Wzwu,UVwuxy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,Wzwu,UVwuyx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,Wzwu,UVwxuy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('iKax,iyza,Wzwu,UVwyux->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Wzwu,UVwyxu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('iKax,iyza,Wzxw,UVwy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('iKax,iyza,Wzxw,UVyw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('KiaU,a,iVax,Wx->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('KiaU,a,ixaW,Vx->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('KiaU,i,iVax,Wx->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('KiaU,i,ixaW,Vx->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('Kiax,a,iUax,VW->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,a,iUay,VyWx->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,a,iUay,VyxW->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('Kiax,a,iUxa,VW->KWUV', X_bbbb, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,a,iUya,VyWx->KWUV', X_bbbb, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,a,iUya,VyxW->KWUV', X_bbbb, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,a,iVay,UyWx->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,a,iVay,UyxW->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,a,iyaW,UVxy->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,a,iyaW,UVyx->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('Kiax,i,iUax,VW->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,i,iUay,VyWx->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,i,iUay,VyxW->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('Kiax,i,iUxa,VW->KWUV', X_bbbb, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,i,iUya,VyWx->KWUV', X_bbbb, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,i,iUya,VyxW->KWUV', X_bbbb, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,i,iVay,UyWx->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,i,iVay,UyxW->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,i,iyaW,UVxy->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,i,iyaW,UVyx->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('KiaU,Vx,ixay,Wy->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('KiaU,Wx,iyax,Vy->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('KiaU,xy,iVax,Wy->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('KiaU,xy,ixaW,Vy->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('Kiax,Uy,iyax,VW->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,Uy,iyaz,VzWx->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,Uy,iyaz,VzxW->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('Kiax,Uy,iyxa,VW->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,Uy,iyza,VzWx->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,Uy,iyza,VzxW->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,Vy,iyaz,UzWx->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,Vy,iyaz,UzxW->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,Wy,izay,UVxz->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,Wy,izay,UVzx->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('Kiax,xy,iUay,VW->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('Kiax,xy,iUya,VW->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,yz,iUay,VzWx->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,yz,iUay,VzxW->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,yz,iUya,VzWx->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,yz,iUya,VzxW->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,yz,iVay,UzWx->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,yz,iVay,UzxW->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,yz,iyaW,UVxz->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,yz,iyaW,UVzx->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('KiaU,iVax,xyzw,Wzyw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('KiaU,ixaW,xyzw,Vzyw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('KiaU,ixay,Vxzw,Wzyw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('KiaU,ixay,Vzwx,Wwzy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('KiaU,ixay,Vzyw,Wxzw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('KiaU,ixay,Wyzw,Vzxw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('KiaU,ixay,Wzwy,Vwzx->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('KiaU,ixay,Wzxw,Vyzw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('KiaU,ixya,Vzwx,Wwyz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('KiaU,ixya,Vzwx,Wwzy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('KiaU,ixya,Vzyw,Wxwz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('KiaU,ixya,Vzyw,Wxzw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('KiaU,ixya,Wzwy,Vwxz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('KiaU,ixya,Wzwy,Vwzx->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('KiaU,ixya,Wzxw,Vywz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('KiaU,ixya,Wzxw,Vyzw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iUay,Vzyw,Wxwz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iUay,Vzyw,Wxzw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('Kiax,iUay,Vzyx,Wz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('Kiax,iUay,xyzw,VzWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iUay,xzwy,VwWz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iUay,xzwy,VwzW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iUay,yzwu,VzuWxw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iUay,yzwu,VzuxWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iUya,Vzyw,Wxwz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iUya,Vzyw,Wxzw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('Kiax,iUya,Vzyx,Wz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('Kiax,iUya,xyzw,VzWw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iUya,xzwy,VwWz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iUya,xzwy,VwzW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iUya,yzwu,VzuWxw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iUya,yzwu,VzuxWw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('Kiax,iVay,Uxyz,Wz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iVay,Uzyw,Wxwz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iVay,Uzyw,Wxzw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iVay,xzwy,UwWz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iVay,xzwy,UwzW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iVay,yzwu,UzuWwx->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iVay,yzwu,UzuwWx->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iVay,yzwu,UzuwxW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iVay,yzwu,UzuxWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iVay,yzwu,UzuxwW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyaW,xzyw,UVwz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iyaW,xzyw,UVzw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iyaW,yzwu,UVwxzu->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyaW,yzwu,UVwzxu->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('Kiax,iyax,UyVz,Wz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('Kiax,iyax,Uyzw,VwWz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iyax,Uzwy,VzWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyax,Uzwy,VzwW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyax,Vzwy,UzWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iyax,Vzwy,UzwW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iyax,Wzyw,UVwz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyax,Wzyw,UVzw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyaz,UwVy,Wxwz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iyaz,UwVy,Wxzw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyaz,Uwuy,VzwWux->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyaz,Uwuy,VzwWxu->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyaz,Uwuy,VzwuWx->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyaz,Uwuy,VzwuxW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyaz,Uwuy,VzwxWu->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iyaz,Uwzu,VwuWxy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyaz,Uwzu,VwuxWy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iyaz,Uwzx,VwWy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyaz,Uwzx,VwyW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('Kiax,iyaz,UxVy,Wz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba += 1/2 * einsum('Kiax,iyaz,Uxwy,VzWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('Kiax,iyaz,Uxzw,VwWy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iyaz,UyVw,Wxwz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyaz,UyVw,Wxzw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iyaz,Uywu,VzuWxw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyaz,Uywu,VzuxWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iyaz,Uywx,VzWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyaz,Uywx,VzwW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyaz,Vwuy,UzwWux->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iyaz,Vwuy,UzwxuW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyaz,Vwzu,UwuWyx->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyaz,Vwzu,UwuxWy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyaz,Vwzu,UwuxyW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyaz,Vwzu,UwuyWx->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyaz,Vwzu,UwuyxW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyaz,Vwzx,UwWy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iyaz,Vwzx,UwyW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyaz,Vywu,UzuWwx->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyaz,Vywu,UzuwWx->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyaz,Vywu,UzuwxW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyaz,Vywu,UzuxWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyaz,Vywu,UzuxwW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyaz,Vywx,UzWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iyaz,Vywx,UzwW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyaz,Wwuz,UVuwyx->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyaz,Wwuz,UVuxwy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyaz,Wwuz,UVuxyw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyaz,Wwuz,UVuywx->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyaz,Wwuz,UVuyxw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyaz,Wwxz,UVwy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iyaz,Wwxz,UVyw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyaz,Wwyu,UVzwxu->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iyaz,Wwyu,UVzxwu->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iyaz,Wzwu,UVwxyu->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyaz,Wzwu,UVwyxu->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iyaz,Wzxw,UVwy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyaz,Wzxw,UVyw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('Kiax,iyxa,UyVz,Wz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_baba -= 1/2 * einsum('Kiax,iyxa,Uyzw,VwWz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iyxa,Uzwy,VzWw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyxa,Uzwy,VzwW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyxa,Vzwy,UzWw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iyxa,Vzwy,UzwW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iyxa,Wzyw,UVwz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyxa,Wzyw,UVzw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('Kiax,iyza,Uwuy,VzwWux->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyza,Uwuy,VzwWxu->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('Kiax,iyza,Uwuy,VzwuxW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('Kiax,iyza,Uwuy,VzwxWu->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyza,Uwzu,VwuWxy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('Kiax,iyza,Uwzu,VwuWyx->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('Kiax,iyza,Uwzu,VwuxWy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('Kiax,iyza,Uwzu,VwuyxW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iyza,Uwzx,VwWy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyza,Uwzx,VwyW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iyza,Uxwy,VzWw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyza,Uxwy,VzwW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iyza,Uxzw,VwWy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyza,Uxzw,VwyW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iyza,UyVw,Wxwz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyza,UyVw,Wxzw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iyza,Uywu,VzuWxw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyza,Uywu,VzuxWw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iyza,Uywx,VzWw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyza,Uywx,VzwW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('Kiax,iyza,Vwuy,UzwWux->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('Kiax,iyza,Vwuy,UzwuxW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('Kiax,iyza,Vwuy,UzwxWu->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyza,Vwuy,UzwxuW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('Kiax,iyza,Vwzu,UwuWyx->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('Kiax,iyza,Vwzu,UwuxWy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyza,Vwzu,UwuyWx->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('Kiax,iyza,Vwzu,UwuyxW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyza,Vwzx,UwWy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/3 * einsum('Kiax,iyza,Vwzx,UwyW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('Kiax,iyza,Wwuz,UVuwyx->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('Kiax,iyza,Wwuz,UVuxwy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyza,Wwuz,UVuywx->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('Kiax,iyza,Wwuz,UVuyxw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/6 * einsum('Kiax,iyza,Wwxz,UVwy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/3 * einsum('Kiax,iyza,Wwxz,UVyw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_baba += 1/12 * einsum('Kiax,iyza,Wwyu,UVzuwx->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('Kiax,iyza,Wwyu,UVzwxu->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/12 * einsum('Kiax,iyza,Wwyu,UVzxuw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_baba -= 1/6 * einsum('Kiax,iyza,Wwyu,UVzxwu->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma[caaa__baba] += ascontiguousarray(sigma_KWUV_baba).reshape(-1)

    sigma_KWUV_bbbb  = 1/2 * einsum('iKaU,iaVx,Wx->KWUV', X_abab, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKaU,iaxW,Vx->KWUV', X_abab, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKaV,iaUx,Wx->KWUV', X_abab, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKaV,iaxW,Ux->KWUV', X_abab, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,iaUx,VW->KWUV', X_abab, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iaUy,VyWx->KWUV', X_abab, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iaUy,VyxW->KWUV', X_abab, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,iaVx,UW->KWUV', X_abab, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iaVy,UyWx->KWUV', X_abab, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iaVy,UyxW->KWUV', X_abab, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iayW,UVxy->KWUV', X_abab, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iayW,UVyx->KWUV', X_abab, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('ijaU,jKia,VW->KWUV', X_abab, v_xxxe, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('ijaV,jKia,UW->KWUV', X_abab, v_xxxe, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('ijax,jKia,UVWx->KWUV', X_abab, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('ijax,jKia,UVxW->KWUV', X_abab, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,ixUa,VW->KWUV', X_abba, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,ixVa,UW->KWUV', X_abba, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/3 * einsum('iKax,iyUa,VyWx->KWUV', X_abba, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyUa,VyxW->KWUV', X_abba, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/3 * einsum('iKax,iyVa,UyWx->KWUV', X_abba, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyVa,UyxW->KWUV', X_abba, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaU,iWxa,Vx->KWUV', X_bbbb, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaU,iaVx,Wx->KWUV', X_bbbb, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaU,iaxW,Vx->KWUV', X_bbbb, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaU,ixVa,Wx->KWUV', X_bbbb, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaV,iWxa,Ux->KWUV', X_bbbb, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaV,iaUx,Wx->KWUV', X_bbbb, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaV,iaxW,Ux->KWUV', X_bbbb, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaV,ixUa,Wx->KWUV', X_bbbb, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iWya,UVxy->KWUV', X_bbbb, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iWya,UVyx->KWUV', X_bbbb, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,iaUx,VW->KWUV', X_bbbb, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iaUy,VyWx->KWUV', X_bbbb, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iaUy,VyxW->KWUV', X_bbbb, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,iaVx,UW->KWUV', X_bbbb, v_xeaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iaVy,UyWx->KWUV', X_bbbb, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iaVy,UyxW->KWUV', X_bbbb, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iayW,UVxy->KWUV', X_bbbb, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iayW,UVyx->KWUV', X_bbbb, v_xeaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,ixUa,VW->KWUV', X_bbbb, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,ixVa,UW->KWUV', X_bbbb, v_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyUa,VyWx->KWUV', X_bbbb, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyUa,VyxW->KWUV', X_bbbb, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyVa,UyWx->KWUV', X_bbbb, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyVa,UyxW->KWUV', X_bbbb, v_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/4 * einsum('ijaU,iKja,VW->KWUV', X_bbbb, v_xxxe, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/4 * einsum('ijaU,jKia,VW->KWUV', X_bbbb, v_xxxe, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/4 * einsum('ijaV,iKja,UW->KWUV', X_bbbb, v_xxxe, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/4 * einsum('ijaV,jKia,UW->KWUV', X_bbbb, v_xxxe, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('ijax,iKja,UVWx->KWUV', X_bbbb, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('ijax,iKja,UVxW->KWUV', X_bbbb, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('ijax,jKia,UVWx->KWUV', X_bbbb, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('ijax,jKia,UVxW->KWUV', X_bbbb, v_xxxe, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKaU,a,iVax,Wx->KWUV', X_abab, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKaU,a,ixaW,Vx->KWUV', X_abab, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKaU,i,iVax,Wx->KWUV', X_abab, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKaU,i,ixaW,Vx->KWUV', X_abab, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKaV,a,iUax,Wx->KWUV', X_abab, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKaV,a,ixaW,Ux->KWUV', X_abab, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKaV,i,iUax,Wx->KWUV', X_abab, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKaV,i,ixaW,Ux->KWUV', X_abab, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,a,iUax,VW->KWUV', X_abab, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,a,iUay,VyWx->KWUV', X_abab, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,a,iUay,VyxW->KWUV', X_abab, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,a,iVax,UW->KWUV', X_abab, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,a,iVay,UyWx->KWUV', X_abab, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,a,iVay,UyxW->KWUV', X_abab, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,a,iyaW,UVxy->KWUV', X_abab, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,a,iyaW,UVyx->KWUV', X_abab, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,i,iUax,VW->KWUV', X_abab, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,i,iUay,VyWx->KWUV', X_abab, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,i,iUay,VyxW->KWUV', X_abab, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,i,iVax,UW->KWUV', X_abab, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,i,iVay,UyWx->KWUV', X_abab, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,i,iVay,UyxW->KWUV', X_abab, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,i,iyaW,UVxy->KWUV', X_abab, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,i,iyaW,UVyx->KWUV', X_abab, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKaU,Vx,ixay,Wy->KWUV', X_abab, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKaU,Wx,iyax,Vy->KWUV', X_abab, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKaU,xy,iVax,Wy->KWUV', X_abab, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKaU,xy,ixaW,Vy->KWUV', X_abab, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKaV,Ux,ixay,Wy->KWUV', X_abab, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKaV,Wx,iyax,Uy->KWUV', X_abab, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKaV,xy,iUax,Wy->KWUV', X_abab, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKaV,xy,ixaW,Uy->KWUV', X_abab, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,Uy,iyax,VW->KWUV', X_abab, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,Uy,iyaz,VzWx->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,Uy,iyaz,VzxW->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,Vy,iyax,UW->KWUV', X_abab, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,Vy,iyaz,UzWx->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,Vy,iyaz,UzxW->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,Wy,izay,UVxz->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,Wy,izay,UVzx->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,xy,iUay,VW->KWUV', X_abab, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,xy,iVay,UW->KWUV', X_abab, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,yz,iUay,VzWx->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,yz,iUay,VzxW->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,yz,iVay,UzWx->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,yz,iVay,UzxW->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,yz,iyaW,UVxz->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,yz,iyaW,UVzx->KWUV', X_abab, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKaU,iVax,xyzw,Wzyw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKaU,ixaW,xyzw,Vzyw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKaU,ixay,Vxzw,Wzyw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKaU,ixay,Vzwx,Wwzy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKaU,ixay,Vzyw,Wxzw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKaU,ixay,Wyzw,Vzxw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKaU,ixay,Wzwy,Vwzx->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKaU,ixay,Wzxw,Vyzw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKaU,ixya,Vzwx,Wwyz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/3 * einsum('iKaU,ixya,Vzwx,Wwzy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKaU,ixya,Vzyw,Wxwz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/3 * einsum('iKaU,ixya,Vzyw,Wxzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKaU,ixya,Wzwy,Vwxz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/3 * einsum('iKaU,ixya,Wzwy,Vwzx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKaU,ixya,Wzxw,Vywz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/3 * einsum('iKaU,ixya,Wzxw,Vyzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKaV,iUax,xyzw,Wzyw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKaV,ixaW,xyzw,Uzyw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKaV,ixay,Uxzw,Wzyw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKaV,ixay,Uzwx,Wwzy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKaV,ixay,Uzyw,Wxzw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKaV,ixay,Wyzw,Uzxw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKaV,ixay,Wzwy,Uwzx->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKaV,ixay,Wzxw,Uyzw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKaV,ixya,Uzwx,Wwyz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/3 * einsum('iKaV,ixya,Uzwx,Wwzy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKaV,ixya,Uzyw,Wxwz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/3 * einsum('iKaV,ixya,Uzyw,Wxzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKaV,ixya,Wzwy,Uwxz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/3 * einsum('iKaV,ixya,Wzwy,Uwzx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKaV,ixya,Wzxw,Uywz->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/3 * einsum('iKaV,ixya,Wzxw,Uyzw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,iUay,Vxyz,Wz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iUay,Vzyw,Wxwz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iUay,Vzyw,Wxzw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,iUay,Vzyx,Wz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,iUay,xyzw,VzWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iUay,xzwy,VwWz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iUay,xzwy,VwzW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iUay,yzwu,VzuWxw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iUay,yzwu,VzuxWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,iVay,Uxyz,Wz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iVay,Uzyw,Wxwz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iVay,Uzyw,Wxzw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,iVay,Uzyx,Wz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,iVay,xyzw,UzWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iVay,xzwy,UwWz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iVay,xzwy,UwzW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iVay,yzwu,UzuWxw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iVay,yzwu,UzuxWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyaW,xzyw,UVwz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyaW,xzyw,UVzw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyaW,yzwu,UVwxzu->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyaW,yzwu,UVwzxu->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,iyax,UyVz,Wz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,iyax,Uyzw,VwWz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,iyax,UzVy,Wz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyax,Uzwy,VzWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyax,Uzwy,VzwW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,iyax,Vyzw,UwWz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyax,Vzwy,UzWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyax,Vzwy,UzwW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyax,Wzyw,UVwz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyax,Wzyw,UVzw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyaz,UwVy,Wxwz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyaz,UwVy,Wxzw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyaz,Uwuy,VzwWux->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyaz,Uwuy,VzwxuW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyaz,Uwzu,VwuWxy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyaz,Uwzu,VwuxWy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyaz,Uwzx,VwWy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyaz,Uwzx,VwyW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,iyaz,UxVy,Wz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,iyaz,Uxwy,VzWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,iyaz,Uxzw,VwWy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyaz,UyVw,Wxwz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyaz,UyVw,Wxzw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,iyaz,UyVx,Wz->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyaz,Uywu,VzuWxw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyaz,Uywu,VzuxWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyaz,Uywx,VzWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyaz,Uywx,VzwW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyaz,Vwuy,UzwWux->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyaz,Vwuy,UzwxuW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyaz,Vwzu,UwuWxy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyaz,Vwzu,UwuxWy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyaz,Vwzx,UwWy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyaz,Vwzx,UwyW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,iyaz,Vxwy,UzWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,iyaz,Vxzw,UwWy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyaz,Vywu,UzuWxw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyaz,Vywu,UzuxWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyaz,Vywx,UzWw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyaz,Vywx,UzwW->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyaz,Wwuz,UVuwxy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyaz,Wwuz,UVuxwy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyaz,Wwxz,UVwy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyaz,Wwxz,UVyw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyaz,Wwyu,UVzwxu->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyaz,Wwyu,UVzxwu->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyaz,Wzwu,UVwxyu->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyaz,Wzwu,UVwyxu->KWUV', X_abab, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyaz,Wzxw,UVwy->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyaz,Wzxw,UVyw->KWUV', X_abab, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('iKax,iyza,Uwuy,VzwWux->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Uwuy,VzwuxW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Uwuy,VzwxWu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyza,Uwuy,VzwxuW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyza,Uwzu,VwuWxy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Uwzu,VwuWyx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('iKax,iyza,Uwzu,VwuxWy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Uwzu,VwuyxW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/3 * einsum('iKax,iyza,Uxwy,VzWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyza,Uxwy,VzwW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/3 * einsum('iKax,iyza,Uxzw,VwWy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyza,Uxzw,VwyW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Vwuy,UzwWux->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('iKax,iyza,Vwuy,UzwuxW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('iKax,iyza,Vwuy,UzwxWu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyza,Vwuy,UzwxuW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyza,Vwzu,UwuWxy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('iKax,iyza,Vwzu,UwuWyx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Vwzu,UwuxWy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('iKax,iyza,Vwzu,UwuyxW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/3 * einsum('iKax,iyza,Vxwy,UzWw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyza,Vxwy,UzwW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/3 * einsum('iKax,iyza,Vxzw,UwWy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyza,Vxzw,UwyW->KWUV', X_abab, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyza,Wwuz,UVuwxy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Wwuz,UVuwyx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('iKax,iyza,Wwuz,UVuxwy->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Wwuz,UVuyxw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Wwyu,UVzuwx->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('iKax,iyza,Wwyu,UVzwxu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Wwyu,UVzxuw->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyza,Wwyu,UVzxwu->KWUV', X_abab, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,a,iUxa,VW->KWUV', X_abba, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/3 * einsum('iKax,a,iUya,VyWx->KWUV', X_abba, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,a,iUya,VyxW->KWUV', X_abba, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,a,iVxa,UW->KWUV', X_abba, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/3 * einsum('iKax,a,iVya,UyWx->KWUV', X_abba, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,a,iVya,UyxW->KWUV', X_abba, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,i,iUxa,VW->KWUV', X_abba, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/3 * einsum('iKax,i,iUya,VyWx->KWUV', X_abba, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,i,iUya,VyxW->KWUV', X_abba, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,i,iVxa,UW->KWUV', X_abba, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/3 * einsum('iKax,i,iVya,UyWx->KWUV', X_abba, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,i,iVya,UyxW->KWUV', X_abba, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,Uy,iyxa,VW->KWUV', X_abba, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/3 * einsum('iKax,Uy,iyza,VzWx->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,Uy,iyza,VzxW->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,Vy,iyxa,UW->KWUV', X_abba, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/3 * einsum('iKax,Vy,iyza,UzWx->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,Vy,iyza,UzxW->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,xy,iUya,VW->KWUV', X_abba, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,xy,iVya,UW->KWUV', X_abba, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/3 * einsum('iKax,yz,iUya,VzWx->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,yz,iUya,VzxW->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/3 * einsum('iKax,yz,iVya,UzWx->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,yz,iVya,UzxW->KWUV', X_abba, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iUya,Vzyw,Wxwz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/3 * einsum('iKax,iUya,Vzyw,Wxzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,iUya,Vzyx,Wz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,iUya,xyzw,VzWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/3 * einsum('iKax,iUya,xzwy,VwWz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iUya,xzwy,VwzW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/3 * einsum('iKax,iUya,yzwu,VzuWxw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iUya,yzwu,VzuxWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iVya,Uzyw,Wxwz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/3 * einsum('iKax,iVya,Uzyw,Wxzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,iVya,Uzyx,Wz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,iVya,xyzw,UzWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/3 * einsum('iKax,iVya,xzwy,UwWz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iVya,xzwy,UwzW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/3 * einsum('iKax,iVya,yzwu,UzuWxw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iVya,yzwu,UzuxWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,iyxa,UyVz,Wz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('iKax,iyxa,Uyzw,VwWz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,iyxa,UzVy,Wz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyxa,Uzwy,VzWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyxa,Uzwy,VzwW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('iKax,iyxa,Vyzw,UwWz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyxa,Vzwy,UzWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyxa,Vzwy,UzwW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyxa,Wzyw,UVwz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyxa,Wzyw,UVzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/3 * einsum('iKax,iyza,UwVy,Wxwz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyza,UwVy,Wxzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Uwuy,VzwWux->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyza,Uwuy,VzwWxu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('iKax,iyza,Uwuy,VzwuxW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Uwuy,VzwxWu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('iKax,iyza,Uwzu,VwuWyx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Uwzu,VwuxWy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyza,Uwzu,VwuyWx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Uwzu,VwuyxW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyza,Uwzx,VwWy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyza,Uwzx,VwyW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/3 * einsum('iKax,iyza,UyVw,Wxwz->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyza,UyVw,Wxzw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/3 * einsum('iKax,iyza,Uywu,VzuWxw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyza,Uywu,VzuxWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/3 * einsum('iKax,iyza,Uywx,VzWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyza,Uywx,VzwW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('iKax,iyza,Vwuy,UzwWux->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyza,Vwuy,UzwWxu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Vwuy,UzwuxW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('iKax,iyza,Vwuy,UzwxWu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Vwzu,UwuWyx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('iKax,iyza,Vwzu,UwuxWy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyza,Vwzu,UwuyWx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('iKax,iyza,Vwzu,UwuyxW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyza,Vwzx,UwWy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyza,Vwzx,UwyW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/3 * einsum('iKax,iyza,Vywu,UzuWxw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyza,Vywu,UzuxWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/3 * einsum('iKax,iyza,Vywx,UzWw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyza,Vywx,UzwW->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('iKax,iyza,Wwuz,UVuwyx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Wwuz,UVuxwy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyza,Wwuz,UVuywx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Wwuz,UVuyxw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyza,Wwxz,UVwy->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('iKax,iyza,Wwxz,UVyw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('iKax,iyza,Wwyu,UVzuwx->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('iKax,iyza,Wwyu,UVzwux->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Wwyu,UVzwxu->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('iKax,iyza,Wwyu,UVzxuw->KWUV', X_abba, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaU,a,iVax,Wx->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaU,a,iVxa,Wx->KWUV', X_bbbb, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaU,a,ixWa,Vx->KWUV', X_bbbb, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaU,a,ixaW,Vx->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaU,i,iVax,Wx->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaU,i,iVxa,Wx->KWUV', X_bbbb, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaU,i,ixWa,Vx->KWUV', X_bbbb, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaU,i,ixaW,Vx->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaV,a,iUax,Wx->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaV,a,iUxa,Wx->KWUV', X_bbbb, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaV,a,ixWa,Ux->KWUV', X_bbbb, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaV,a,ixaW,Ux->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaV,i,iUax,Wx->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaV,i,iUxa,Wx->KWUV', X_bbbb, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaV,i,ixWa,Ux->KWUV', X_bbbb, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaV,i,ixaW,Ux->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,a,iUax,VW->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,a,iUay,VyWx->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,a,iUay,VyxW->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,a,iUxa,VW->KWUV', X_bbbb, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,a,iUya,VyWx->KWUV', X_bbbb, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,a,iUya,VyxW->KWUV', X_bbbb, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,a,iVax,UW->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,a,iVay,UyWx->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,a,iVay,UyxW->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,a,iVxa,UW->KWUV', X_bbbb, e_extern, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,a,iVya,UyWx->KWUV', X_bbbb, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,a,iVya,UyxW->KWUV', X_bbbb, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,a,iyWa,UVxy->KWUV', X_bbbb, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,a,iyWa,UVyx->KWUV', X_bbbb, e_extern, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,a,iyaW,UVxy->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,a,iyaW,UVyx->KWUV', X_bbbb, e_extern, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,i,iUax,VW->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,i,iUay,VyWx->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,i,iUay,VyxW->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,i,iUxa,VW->KWUV', X_bbbb, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,i,iUya,VyWx->KWUV', X_bbbb, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,i,iUya,VyxW->KWUV', X_bbbb, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,i,iVax,UW->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,i,iVay,UyWx->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,i,iVay,UyxW->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,i,iVxa,UW->KWUV', X_bbbb, e_cvs, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,i,iVya,UyWx->KWUV', X_bbbb, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,i,iVya,UyxW->KWUV', X_bbbb, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,i,iyWa,UVxy->KWUV', X_bbbb, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,i,iyWa,UVyx->KWUV', X_bbbb, e_cvs, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,i,iyaW,UVxy->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,i,iyaW,UVyx->KWUV', X_bbbb, e_cvs, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaU,Vx,ixay,Wy->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaU,Vx,ixya,Wy->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaU,Wx,iyax,Vy->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaU,Wx,iyxa,Vy->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaU,xy,iVax,Wy->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaU,xy,iVxa,Wy->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaU,xy,ixWa,Vy->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaU,xy,ixaW,Vy->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaV,Ux,ixay,Wy->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaV,Ux,ixya,Wy->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaV,Wx,iyax,Uy->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaV,Wx,iyxa,Uy->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaV,xy,iUax,Wy->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaV,xy,iUxa,Wy->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaV,xy,ixWa,Uy->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaV,xy,ixaW,Uy->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,Uy,iyax,VW->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,Uy,iyaz,VzWx->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,Uy,iyaz,VzxW->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,Uy,iyxa,VW->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,Uy,iyza,VzWx->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,Uy,iyza,VzxW->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,Vy,iyax,UW->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,Vy,iyaz,UzWx->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,Vy,iyaz,UzxW->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,Vy,iyxa,UW->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,Vy,iyza,UzWx->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,Vy,iyza,UzxW->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,Wy,izay,UVxz->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,Wy,izay,UVzx->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,Wy,izya,UVxz->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,Wy,izya,UVzx->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,xy,iUay,VW->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,xy,iUya,VW->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,xy,iVay,UW->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,xy,iVya,UW->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,yz,iUay,VzWx->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,yz,iUay,VzxW->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,yz,iUya,VzWx->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,yz,iUya,VzxW->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,yz,iVay,UzWx->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,yz,iVay,UzxW->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,yz,iVya,UzWx->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,yz,iVya,UzxW->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,yz,iyWa,UVxz->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,yz,iyWa,UVzx->KWUV', X_bbbb, h_aa, t1_xaae, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,yz,iyaW,UVxz->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,yz,iyaW,UVzx->KWUV', X_bbbb, h_aa, t1_xaea, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaU,iVax,xyzw,Wzyw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaU,iVxa,xyzw,Wzyw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaU,ixWa,xyzw,Vzyw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaU,ixaW,xyzw,Vzyw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaU,ixay,Vxzw,Wzyw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaU,ixay,Vzwx,Wwzy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaU,ixay,Vzyw,Wxzw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaU,ixay,Wyzw,Vzxw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaU,ixay,Wzwy,Vwzx->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaU,ixay,Wzxw,Vyzw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaU,ixya,Vxzw,Wzyw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('KiaU,ixya,Vzwx,Wwyz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('KiaU,ixya,Vzwx,Wwzy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('KiaU,ixya,Vzyw,Wxwz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('KiaU,ixya,Vzyw,Wxzw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaU,ixya,Wyzw,Vzxw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('KiaU,ixya,Wzwy,Vwxz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('KiaU,ixya,Wzwy,Vwzx->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('KiaU,ixya,Wzxw,Vywz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('KiaU,ixya,Wzxw,Vyzw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaV,iUax,xyzw,Wzyw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaV,iUxa,xyzw,Wzyw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaV,ixWa,xyzw,Uzyw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaV,ixaW,xyzw,Uzyw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaV,ixay,Uxzw,Wzyw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaV,ixay,Uzwx,Wwzy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaV,ixay,Uzyw,Wxzw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaV,ixay,Wyzw,Uzxw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('KiaV,ixay,Wzwy,Uwzx->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaV,ixay,Wzxw,Uyzw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaV,ixya,Uxzw,Wzyw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('KiaV,ixya,Uzwx,Wwyz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('KiaV,ixya,Uzwx,Wwzy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('KiaV,ixya,Uzyw,Wxwz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('KiaV,ixya,Uzyw,Wxzw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('KiaV,ixya,Wyzw,Uzxw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('KiaV,ixya,Wzwy,Uwxz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('KiaV,ixya,Wzwy,Uwzx->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('KiaV,ixya,Wzxw,Uywz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('KiaV,ixya,Wzxw,Uyzw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,iUay,Vxyz,Wz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iUay,Vzyw,Wxwz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iUay,Vzyw,Wxzw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,iUay,Vzyx,Wz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,iUay,xyzw,VzWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iUay,xzwy,VwWz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iUay,xzwy,VwzW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iUay,yzwu,VzuWxw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iUay,yzwu,VzuxWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,iUya,Vxyz,Wz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iUya,Vzyw,Wxwz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iUya,Vzyw,Wxzw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,iUya,Vzyx,Wz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,iUya,xyzw,VzWw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iUya,xzwy,VwWz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iUya,xzwy,VwzW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iUya,yzwu,VzuWxw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iUya,yzwu,VzuxWw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,iVay,Uxyz,Wz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iVay,Uzyw,Wxwz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iVay,Uzyw,Wxzw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,iVay,Uzyx,Wz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,iVay,xyzw,UzWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iVay,xzwy,UwWz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iVay,xzwy,UwzW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iVay,yzwu,UzuWxw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iVay,yzwu,UzuxWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,iVya,Uxyz,Wz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iVya,Uzyw,Wxwz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iVya,Uzyw,Wxzw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,iVya,Uzyx,Wz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,iVya,xyzw,UzWw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iVya,xzwy,UwWz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iVya,xzwy,UwzW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iVya,yzwu,UzuWxw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iVya,yzwu,UzuxWw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyWa,xzyw,UVwz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyWa,xzyw,UVzw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyWa,yzwu,UVwxzu->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyWa,yzwu,UVwzxu->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyaW,xzyw,UVwz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyaW,xzyw,UVzw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyaW,yzwu,UVwxzu->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyaW,yzwu,UVwzxu->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,iyax,UyVz,Wz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,iyax,Uyzw,VwWz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,iyax,UzVy,Wz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyax,Uzwy,VzWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyax,Uzwy,VzwW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,iyax,Vyzw,UwWz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyax,Vzwy,UzWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyax,Vzwy,UzwW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyax,Wzyw,UVwz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyax,Wzyw,UVzw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyaz,UwVy,Wxwz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyaz,UwVy,Wxzw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyaz,Uwuy,VzwWux->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyaz,Uwuy,VzwxuW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyaz,Uwzu,VwuWxy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyaz,Uwzu,VwuxWy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyaz,Uwzx,VwWy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyaz,Uwzx,VwyW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,iyaz,UxVy,Wz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,iyaz,Uxwy,VzWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,iyaz,Uxzw,VwWy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyaz,UyVw,Wxwz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyaz,UyVw,Wxzw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,iyaz,UyVx,Wz->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyaz,Uywu,VzuWxw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyaz,Uywu,VzuxWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyaz,Uywx,VzWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyaz,Uywx,VzwW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyaz,Vwuy,UzwWux->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyaz,Vwuy,UzwxuW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyaz,Vwzu,UwuWxy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyaz,Vwzu,UwuxWy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyaz,Vwzx,UwWy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyaz,Vwzx,UwyW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,iyaz,Vxwy,UzWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,iyaz,Vxzw,UwWy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyaz,Vywu,UzuWxw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyaz,Vywu,UzuxWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyaz,Vywx,UzWw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyaz,Vywx,UzwW->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyaz,Wwuz,UVuwxy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyaz,Wwuz,UVuxwy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyaz,Wwxz,UVwy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyaz,Wwxz,UVyw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyaz,Wwyu,UVzwxu->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyaz,Wwyu,UVzxwu->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyaz,Wzwu,UVwxyu->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyaz,Wzwu,UVwyxu->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyaz,Wzxw,UVwy->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyaz,Wzxw,UVyw->KWUV', X_bbbb, t1_xaea, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,iyxa,UyVz,Wz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,iyxa,Uyzw,VwWz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,iyxa,UzVy,Wz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyxa,Uzwy,VzWw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyxa,Uzwy,VzwW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,iyxa,Vyzw,UwWz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyxa,Vzwy,UzWw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyxa,Vzwy,UzwW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyxa,Wzyw,UVwz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyxa,Wzyw,UVzw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyza,UwVy,Wxwz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyza,UwVy,Wxzw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('Kiax,iyza,Uwuy,VzwWux->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('Kiax,iyza,Uwuy,VzwuxW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('Kiax,iyza,Uwuy,VzwxWu->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('Kiax,iyza,Uwzu,VwuWyx->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('Kiax,iyza,Uwzu,VwuxWy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('Kiax,iyza,Uwzu,VwuyxW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyza,Uwzx,VwWy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyza,Uwzx,VwyW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/2 * einsum('Kiax,iyza,UxVy,Wz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyza,Uxwy,VzWw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyza,Uxwy,VzwW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyza,Uxzw,VwWy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyza,Uxzw,VwyW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyza,UyVw,Wxwz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyza,UyVw,Wxzw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/2 * einsum('Kiax,iyza,UyVx,Wz->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyza,Uywu,VzuWxw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyza,Uywu,VzuxWw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyza,Uywx,VzWw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyza,Uywx,VzwW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('Kiax,iyza,Vwuy,UzwWux->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('Kiax,iyza,Vwuy,UzwuxW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('Kiax,iyza,Vwuy,UzwxWu->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('Kiax,iyza,Vwzu,UwuWyx->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('Kiax,iyza,Vwzu,UwuxWy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/12 * einsum('Kiax,iyza,Vwzu,UwuyxW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyza,Vwzx,UwWy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyza,Vwzx,UwyW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyza,Vxwy,UzWw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyza,Vxwy,UzwW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyza,Vxzw,UwWy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyza,Vxzw,UwyW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyza,Vywu,UzuWxw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyza,Vywu,UzuxWw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyza,Vywx,UzWw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyza,Vywx,UzwW->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('Kiax,iyza,Wwuz,UVuwyx->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('Kiax,iyza,Wwuz,UVuxwy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('Kiax,iyza,Wwuz,UVuyxw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyza,Wwxz,UVwy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyza,Wwxz,UVyw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('Kiax,iyza,Wwyu,UVzuwx->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('Kiax,iyza,Wwyu,UVzwxu->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/12 * einsum('Kiax,iyza,Wwyu,UVzxuw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyza,Wzwu,UVwxyu->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyza,Wzwu,UVwyxu->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWUV_bbbb += 1/6 * einsum('Kiax,iyza,Wzxw,UVwy->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWUV_bbbb -= 1/6 * einsum('Kiax,iyza,Wzxw,UVyw->KWUV', X_bbbb, t1_xaae, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma[caaa__bbbb] += ascontiguousarray(sigma_KWUV_bbbb[:, :, aa_tril_ind[0], aa_tril_ind[1]]).reshape(-1)

    mr_adc.log.timer_debug("computing sigma H1 h1-h1 CAAA-CCEA", *cput1)

# CAEA <- CCEA
def compute_sigma_vector__H1__h1_h1__CAEA_CCEA(mr_adc, X_aaaa, X_abab, X_abba, X_bbbb, sigma):
    cput1 = (logger.process_clock(), logger.perf_counter())

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    #Excitation Manifold
    caea__aaaa = mr_adc.h1.caea__aaaa
    caea__abab = mr_adc.h1.caea__abab
    caea__baab = mr_adc.h1.caea__baab
    caea__bbbb = mr_adc.h1.caea__bbbb
    caea__baba = mr_adc.h1.caea__baba
    caea__abba = mr_adc.h1.caea__abba 
    
    ## Molecular Orbitals Energies
    e_cvs = mr_adc.mo_energy.x
    
    ## One-electron integrals
    h_xa = mr_adc.h1eff.xa
    h_aa = mr_adc.h1eff.aa

    ## Two-electron integrals
    v_xxxa = mr_adc.v2e.xxxa
    v_xaaa = mr_adc.v2e.xaaa
    v_xaee = mr_adc.v2e.xaee
    v_xeea = mr_adc.v2e.xeea
    v_aaaa = mr_adc.v2e.aaaa

    ## Amplitudes
    t1_xa = mr_adc.t1.xa
    t1_xaaa = mr_adc.t1.xaaa
    
    # Reduced Density Matrices
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa
    rdm_cccaaa = mr_adc.rdm.cccaaa

    sigma_KWCU_aaaa =- einsum('KiCU,iW->KWCU', X_aaaa, h_xa, optimize = einsum_type)
    sigma_KWCU_aaaa += einsum('KiCU,i,iW->KWCU', X_aaaa, e_cvs, t1_xa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iW,Ux->KWCU', X_aaaa, h_xa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= einsum('KiCU,Wx,ix->KWCU', X_aaaa, h_aa, t1_xa, optimize = einsum_type)
    sigma_KWCU_aaaa -= einsum('KiCU,iWxy,yx->KWCU', X_aaaa, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCU,ixyW,xy->KWCU', X_aaaa, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iWyx,Uy->KWCU', X_aaaa, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iWyz,Uzxy->KWCU', X_aaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,ixUy,Wy->KWCU', X_aaaa, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,ixyW,Uy->KWCU', X_aaaa, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyUx,Wy->KWCU', X_aaaa, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyUz,Wxyz->KWCU', X_aaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyUz,Wxzy->KWCU', X_aaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzW,Uyxz->KWCU', X_aaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzW,Uyzx->KWCU', X_aaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiaU,iaCx,Wx->KWCU', X_aaaa, v_xeea, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiaU,ixCa,Wx->KWCU', X_aaaa, v_xaee, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('Kiax,iaCx,UW->KWCU', X_aaaa, v_xeea, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('Kiax,iaCy,UyWx->KWCU', X_aaaa, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('Kiax,iaCy,UyxW->KWCU', X_aaaa, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('Kiax,ixCa,UW->KWCU', X_aaaa, v_xaee, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('Kiax,iyCa,UyWx->KWCU', X_aaaa, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('Kiax,iyCa,UyxW->KWCU', X_aaaa, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/4 * einsum('ijCU,iKjx,Wx->KWCU', X_aaaa, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/4 * einsum('ijCU,jKix,Wx->KWCU', X_aaaa, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/4 * einsum('ijCx,iKjx,UW->KWCU', X_aaaa, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/12 * einsum('ijCx,iKjy,UyWx->KWCU', X_aaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/12 * einsum('ijCx,iKjy,UyxW->KWCU', X_aaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/4 * einsum('ijCx,jKix,UW->KWCU', X_aaaa, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/12 * einsum('ijCx,jKiy,UyWx->KWCU', X_aaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/12 * einsum('ijCx,jKiy,UyxW->KWCU', X_aaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,ixUy,Wy->KWCU', X_abab, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,ixyW,Uy->KWCU', X_abab, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyUz,Wxyz->KWCU', X_abab, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/3 * einsum('KiCx,iyUz,Wxzy->KWCU', X_abab, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzW,Uyxz->KWCU', X_abab, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/3 * einsum('KiCx,iyzW,Uyzx->KWCU', X_abab, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('Kiax,ixCa,UW->KWCU', X_abab, v_xaee, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/3 * einsum('Kiax,iyCa,UyWx->KWCU', X_abab, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('Kiax,iyCa,UyxW->KWCU', X_abab, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('ijCx,iKjx,UW->KWCU', X_abab, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/3 * einsum('ijCx,iKjy,UyWx->KWCU', X_abab, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('ijCx,iKjy,UyxW->KWCU', X_abab, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiaU,iaCx,Wx->KWCU', X_abba, v_xeea, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('Kiax,iaCx,UW->KWCU', X_abba, v_xeea, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('Kiax,iaCy,UyWx->KWCU', X_abba, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('Kiax,iaCy,UyxW->KWCU', X_abba, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += einsum('KiCU,i,ixWy,yx->KWCU', X_aaaa, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCU,i,ixyW,yx->KWCU', X_aaaa, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,i,iUxy,Wy->KWCU', X_aaaa, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,i,iUyx,Wy->KWCU', X_aaaa, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,i,iUyz,Wxyz->KWCU', X_aaaa, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,i,iUyz,Wxzy->KWCU', X_aaaa, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,i,iW,Ux->KWCU', X_aaaa, e_cvs, t1_xa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,i,iyWx,Uy->KWCU', X_aaaa, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,i,iyWz,Uzxy->KWCU', X_aaaa, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,i,iyxW,Uy->KWCU', X_aaaa, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,i,iyzW,Uzxy->KWCU', X_aaaa, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,i,iyzW,Uzyx->KWCU', X_aaaa, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= einsum('KiCU,Wx,iyxz,yz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCU,Wx,iyzx,yz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += einsum('KiCU,xy,ixWz,yz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCU,xy,ixzW,yz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= einsum('KiCU,xy,izWx,yz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCU,xy,izxW,yz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,Uy,iyxz,Wz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,Uy,iyzw,Wxwz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,Uy,iyzw,Wxzw->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,Uy,iyzx,Wz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,Wy,iy,Ux->KWCU', X_aaaa, h_aa, t1_xa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,Wy,izwy,Uwxz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,Wy,izwy,Uwzx->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,Wy,izxy,Uz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,Wy,izyw,Uwxz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,Wy,izyx,Uz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,xy,iUyz,Wz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,xy,iUzy,Wz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,xy,izWy,Uz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,xy,izyW,Uz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,yz,iUwy,Wxwz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,yz,iUwy,Wxzw->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,yz,iUxy,Wz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,yz,iUyw,Wxwz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,yz,iUyw,Wxzw->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,yz,iUyx,Wz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,yz,iwWy,Uzxw->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,yz,iwyW,Uzwx->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,yz,iwyW,Uzxw->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,yz,iyWw,Uwxz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,yz,iyWx,Uz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,yz,iywW,Uwxz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,yz,iywW,Uwzx->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,yz,iyxW,Uz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= einsum('KiCU,ix,Wxyz,yz->KWCU', X_aaaa, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCU,ix,Wyzx,zy->KWCU', X_aaaa, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += einsum('KiCU,ixWy,xzwu,ywzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= einsum('KiCU,ixWy,yzwu,xwzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCU,ixyW,xzwu,ywzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCU,ixyW,yzwu,xwzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCU,ixyz,Wwuy,xwzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCU,ixyz,Wwuz,xwuy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCU,ixyz,Wwxu,yzwu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= einsum('KiCU,ixyz,Wywu,xuzw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= einsum('KiCU,ixyz,Wywz,xw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCU,ixyz,Wzwu,xuyw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCU,ixyz,Wzwy,xw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iUxy,yzwu,Wwzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iUyx,yzwu,Wwzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iUyz,xwuy,Wwuz->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iUyz,xwuy,Wwzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iUyz,xwuz,Wwuy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iUyz,xwuz,Wwyu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iUyz,xywu,Wuzw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iUyz,xywz,Ww->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iUyz,xzwu,Wuyw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iUyz,xzwy,Ww->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iUyz,ywuv,Wxuwzv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iUyz,ywuv,Wxuzwv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iUyz,zwuv,Wxuwyv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iUyz,zwuv,Wxuywv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iUyz,zwyu,Wxuw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iUyz,zwyu,Wxwu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iy,Uxyz,Wz->KWCU', X_aaaa, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iy,Uzyw,Wxwz->KWCU', X_aaaa, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iy,Uzyw,Wxzw->KWCU', X_aaaa, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iy,Uzyx,Wz->KWCU', X_aaaa, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iy,Wyxz,Uz->KWCU', X_aaaa, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iy,Wyzw,Uzxw->KWCU', X_aaaa, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iy,Wzwy,Uwxz->KWCU', X_aaaa, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iy,Wzwy,Uwzx->KWCU', X_aaaa, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iy,Wzxy,Uz->KWCU', X_aaaa, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyWx,yzwu,Uwzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iyWz,xwuz,Uuwy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyWz,xwyu,Uzwu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iyWz,xzwu,Uwyu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyWz,ywuv,Uzuxwv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iyWz,zwuv,Uwvxyu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iyxW,yzwu,Uwzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyxz,Uwuy,Wuwz->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iyxz,Uwzu,Wywu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyxz,Uywu,Wwzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyxz,Wwuz,Uuwy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iyxz,Wwyu,Uzwu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyxz,Wzwu,Uwyu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzW,xwuz,Uuwy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzW,xwuz,Uuyw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzW,xwyu,Uzuw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzW,xwyu,Uzwu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyzW,xzwu,Uwyu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzW,ywuv,Uzuwxv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzW,ywuv,Uzuxwv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzW,zwuv,Uwvxyu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzW,zwuv,Uwvyxu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Uuvy,Wxvuzw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Uuvy,Wxvzuw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyuzv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyzuv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Uuwx,Wyuz->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Uuwx,Wyzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Uuzv,Wxyuvw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Uuzv,Wxyvuw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iyzw,Uuzx,Wyuw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iyzw,Uxuy,Wuzw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyzw,Uxwu,Wyzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyzw,Uxzu,Wyuw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuwzv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuzwv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Uyux,Wuwz->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Uyux,Wuzw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Wuvw,Uzvuxy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Wuvw,Uzvxuy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvuyx->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvxyu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Wuxw,Uzuy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Wuxw,Uzyu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyzw,Wuxz,Uwuy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwuxv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwxuv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuxyv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuyxv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Wwuz,Uuxy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Wwuz,Uuyx->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Wwxu,Uzuy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Wwxu,Uzyu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyzw,Wwxz,Uy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iyzw,Wzuv,Uwuxyv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iyzw,Wzuw,Uuxy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iyzw,Wzxu,Uwuy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iyzw,Wzxw,Uy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzx,Uwuy,Wuwz->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzx,Uwuy,Wuzw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzx,Uwzu,Wyuw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzx,Uwzu,Wywu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iyzx,Uywu,Wwzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzx,Wwuz,Uuwy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzx,Wwuz,Uuyw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzx,Wwyu,Uzuw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzx,Wwyu,Uzwu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iyzx,Wzwu,Uwyu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,i,iUxy,Wy->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,i,iUyz,Wxyz->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/3 * einsum('KiCx,i,iUyz,Wxzy->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,i,iyxW,Uy->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,i,iyzW,Uzxy->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/3 * einsum('KiCx,i,iyzW,Uzyx->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,Uy,iyxz,Wz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/3 * einsum('KiCx,Uy,iyzw,Wxwz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,Uy,iyzw,Wxzw->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,Wy,izwy,Uwxz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/3 * einsum('KiCx,Wy,izwy,Uwzx->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,Wy,izxy,Uz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,xy,iUyz,Wz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,xy,izyW,Uz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,yz,iUwy,Wxwz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/3 * einsum('KiCx,yz,iUwy,Wxzw->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,yz,iUxy,Wz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/3 * einsum('KiCx,yz,iUyw,Wxwz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,yz,iUyw,Wxzw->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/3 * einsum('KiCx,yz,iwyW,Uzwx->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,yz,iwyW,Uzxw->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,yz,iywW,Uwxz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/3 * einsum('KiCx,yz,iywW,Uwzx->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,yz,iyxW,Uz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iUxy,yzwu,Wwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iUyz,xwuy,Wwuz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/3 * einsum('KiCx,iUyz,xwuy,Wwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/3 * einsum('KiCx,iUyz,xwuz,Wwuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iUyz,xwuz,Wwyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iUyz,xywu,Wuzw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iUyz,xywz,Ww->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iUyz,ywuv,Wxuwzv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/3 * einsum('KiCx,iUyz,ywuv,Wxuzwv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iUyz,zwuv,Wxuvwy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iUyz,zwuv,Wxuvyw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iUyz,zwuv,Wxuwvy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iUyz,zwuv,Wxuwyv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iUyz,zwuv,Wxuyvw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iUyz,zwyu,Wxuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/3 * einsum('KiCx,iUyz,zwyu,Wxwu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iy,Uzyw,Wxwz->KWCU', X_abab, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/3 * einsum('KiCx,iy,Uzyw,Wxzw->KWCU', X_abab, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iy,Uzyx,Wz->KWCU', X_abab, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iy,Wzwy,Uwxz->KWCU', X_abab, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/3 * einsum('KiCx,iy,Wzwy,Uwzx->KWCU', X_abab, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iy,Wzxy,Uz->KWCU', X_abab, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iyxW,yzwu,Uwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyxz,Uwuy,Wuwz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iyxz,Uwzu,Wywu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyxz,Uywu,Wwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyxz,Wwuz,Uuwy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iyxz,Wwyu,Uzwu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyxz,Wzwu,Uwyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzW,xwuz,Uuwy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/3 * einsum('KiCx,iyzW,xwuz,Uuyw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/3 * einsum('KiCx,iyzW,xwyu,Uzuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzW,xwyu,Uzwu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyzW,xzwu,Uwyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzW,ywuv,Uzuvwx->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzW,ywuv,Uzuvxw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzW,ywuv,Uzuwvx->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzW,ywuv,Uzuwxv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzW,ywuv,Uzuxvw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzW,zwuv,Uwvuxy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzW,zwuv,Uwvuyx->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzW,zwuv,Uwvxuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzW,zwuv,Uwvyux->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzW,zwuv,Uwvyxu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/3 * einsum('KiCx,iyzw,Uuvy,Wxvuzw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Uuvy,Wxvzuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyuvz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyuzv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyvuz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyvzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyzvu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/3 * einsum('KiCx,iyzw,Uuwx,Wyuz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Uuwx,Wyzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/3 * einsum('KiCx,iyzw,Uuzv,Wxyuvw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Uuzv,Wxyvuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/2 * einsum('KiCx,iyzw,Uuzx,Wyuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuvwz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuvzw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuwvz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuwzv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuzvw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/3 * einsum('KiCx,iyzw,Uyux,Wuwz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Uyux,Wuzw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/3 * einsum('KiCx,iyzw,Wuvw,Uzvuxy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Wuvw,Uzvxuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvuxy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvuyx->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvxuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvyux->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvyxu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/3 * einsum('KiCx,iyzw,Wuxw,Uzuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Wuxw,Uzyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyzw,Wuxz,Uwuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwuvx->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwuxv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwvux->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwvxu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwxvu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuvxy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuvyx->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuxvy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuyvx->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuyxv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Wwuz,Uuxy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/3 * einsum('KiCx,iyzw,Wwuz,Uuyx->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzw,Wwxu,Uzuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/3 * einsum('KiCx,iyzw,Wwxu,Uzyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/2 * einsum('KiCx,iyzw,Wwxz,Uy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/3 * einsum('KiCx,iyzx,Uwuy,Wuwz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzx,Uwuy,Wuzw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzx,Uwzu,Wyuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/3 * einsum('KiCx,iyzx,Uwzu,Wywu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/3 * einsum('KiCx,iyzx,Wwuz,Uuwy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa += 1/6 * einsum('KiCx,iyzx,Wwuz,Uuyw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/6 * einsum('KiCx,iyzx,Wwyu,Uzuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_aaaa -= 1/3 * einsum('KiCx,iyzx,Wwyu,Uzwu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma[caea__aaaa] += ascontiguousarray(sigma_KWCU_aaaa).reshape(-1)

    sigma_KWCU_abab =- einsum('KiCU,iW->KWCU', X_abab, h_xa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,ixUy,Wy->KWCU', X_aaaa, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,ixyW,Uy->KWCU', X_aaaa, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyUz,Wxyz->KWCU', X_aaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/3 * einsum('KiCx,iyUz,Wxzy->KWCU', X_aaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzW,Uyxz->KWCU', X_aaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/3 * einsum('KiCx,iyzW,Uyzx->KWCU', X_aaaa, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('Kiax,iaCx,UW->KWCU', X_aaaa, v_xeea, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/3 * einsum('Kiax,iaCy,UyWx->KWCU', X_aaaa, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('Kiax,iaCy,UyxW->KWCU', X_aaaa, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('Kiax,ixCa,UW->KWCU', X_aaaa, v_xaee, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/3 * einsum('Kiax,iyCa,UyWx->KWCU', X_aaaa, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('Kiax,iyCa,UyxW->KWCU', X_aaaa, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/4 * einsum('ijCx,iKjx,UW->KWCU', X_aaaa, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('ijCx,iKjy,UyWx->KWCU', X_aaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/12 * einsum('ijCx,iKjy,UyxW->KWCU', X_aaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/4 * einsum('ijCx,jKix,UW->KWCU', X_aaaa, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('ijCx,jKiy,UyWx->KWCU', X_aaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/12 * einsum('ijCx,jKiy,UyxW->KWCU', X_aaaa, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += einsum('KiCU,i,iW->KWCU', X_abab, e_cvs, t1_xa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iW,Ux->KWCU', X_abab, h_xa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= einsum('KiCU,Wx,ix->KWCU', X_abab, h_aa, t1_xa, optimize = einsum_type)
    sigma_KWCU_abab -= einsum('KiCU,iWxy,yx->KWCU', X_abab, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCU,ixyW,xy->KWCU', X_abab, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iWyx,Uy->KWCU', X_abab, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iWyz,Uzxy->KWCU', X_abab, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,ixUy,Wy->KWCU', X_abab, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,ixyW,Uy->KWCU', X_abab, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyUx,Wy->KWCU', X_abab, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyUz,Wxyz->KWCU', X_abab, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyUz,Wxzy->KWCU', X_abab, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzW,Uyxz->KWCU', X_abab, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzW,Uyzx->KWCU', X_abab, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiaU,ixCa,Wx->KWCU', X_abab, v_xaee, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('Kiax,ixCa,UW->KWCU', X_abab, v_xaee, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('Kiax,iyCa,UyWx->KWCU', X_abab, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('Kiax,iyCa,UyxW->KWCU', X_abab, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('ijCU,iKjx,Wx->KWCU', X_abab, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('ijCx,iKjx,UW->KWCU', X_abab, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('ijCx,iKjy,UyWx->KWCU', X_abab, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('ijCx,iKjy,UyxW->KWCU', X_abab, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('Kiax,iaCx,UW->KWCU', X_abba, v_xeea, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/3 * einsum('Kiax,iaCy,UyWx->KWCU', X_abba, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('Kiax,iaCy,UyxW->KWCU', X_abba, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,i,iUxy,Wy->KWCU', X_aaaa, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,i,iUyz,Wxyz->KWCU', X_aaaa, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/3 * einsum('KiCx,i,iUyz,Wxzy->KWCU', X_aaaa, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,i,iyxW,Uy->KWCU', X_aaaa, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,i,iyzW,Uzxy->KWCU', X_aaaa, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/3 * einsum('KiCx,i,iyzW,Uzyx->KWCU', X_aaaa, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,Uy,iyxz,Wz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/3 * einsum('KiCx,Uy,iyzw,Wxwz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,Uy,iyzw,Wxzw->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,Wy,izwy,Uwxz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/3 * einsum('KiCx,Wy,izwy,Uwzx->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,Wy,izxy,Uz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,xy,iUyz,Wz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,xy,izyW,Uz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,yz,iUwy,Wxwz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/3 * einsum('KiCx,yz,iUwy,Wxzw->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,yz,iUxy,Wz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/3 * einsum('KiCx,yz,iUyw,Wxwz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,yz,iUyw,Wxzw->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/3 * einsum('KiCx,yz,iwyW,Uzwx->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,yz,iwyW,Uzxw->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,yz,iywW,Uwxz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/3 * einsum('KiCx,yz,iywW,Uwzx->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,yz,iyxW,Uz->KWCU', X_aaaa, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iUxy,yzwu,Wwzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iUyz,xwuy,Wwuz->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/3 * einsum('KiCx,iUyz,xwuy,Wwzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/3 * einsum('KiCx,iUyz,xwuz,Wwuy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iUyz,xwuz,Wwyu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iUyz,xywu,Wuzw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iUyz,xywz,Ww->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iUyz,ywuv,Wxuwzv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/3 * einsum('KiCx,iUyz,ywuv,Wxuzwv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iUyz,zwuv,Wxuvwy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iUyz,zwuv,Wxuvyw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iUyz,zwuv,Wxuwvy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iUyz,zwuv,Wxuwyv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iUyz,zwuv,Wxuyvw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iUyz,zwyu,Wxuw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/3 * einsum('KiCx,iUyz,zwyu,Wxwu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iy,Uzyw,Wxwz->KWCU', X_aaaa, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/3 * einsum('KiCx,iy,Uzyw,Wxzw->KWCU', X_aaaa, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iy,Uzyx,Wz->KWCU', X_aaaa, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iy,Wzwy,Uwxz->KWCU', X_aaaa, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/3 * einsum('KiCx,iy,Wzwy,Uwzx->KWCU', X_aaaa, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iy,Wzxy,Uz->KWCU', X_aaaa, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iyxW,yzwu,Uwzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyxz,Uwuy,Wuwz->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iyxz,Uwzu,Wywu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyxz,Uywu,Wwzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyxz,Wwuz,Uuwy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iyxz,Wwyu,Uzwu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyxz,Wzwu,Uwyu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzW,xwuz,Uuwy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/3 * einsum('KiCx,iyzW,xwuz,Uuyw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/3 * einsum('KiCx,iyzW,xwyu,Uzuw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzW,xwyu,Uzwu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyzW,xzwu,Uwyu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzW,ywuv,Uzuvwx->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzW,ywuv,Uzuvxw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzW,ywuv,Uzuwvx->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzW,ywuv,Uzuwxv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzW,ywuv,Uzuxvw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzW,zwuv,Uwvuxy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzW,zwuv,Uwvuyx->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzW,zwuv,Uwvxuy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzW,zwuv,Uwvyux->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzW,zwuv,Uwvyxu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/3 * einsum('KiCx,iyzw,Uuvy,Wxvuzw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Uuvy,Wxvzuw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyuvz->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyuzv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyvuz->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyvzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyzvu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/3 * einsum('KiCx,iyzw,Uuwx,Wyuz->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Uuwx,Wyzu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/3 * einsum('KiCx,iyzw,Uuzv,Wxyuvw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Uuzv,Wxyvuw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iyzw,Uuzx,Wyuw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuvwz->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuvzw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuwvz->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuwzv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuzvw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/3 * einsum('KiCx,iyzw,Uyux,Wuwz->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Uyux,Wuzw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/3 * einsum('KiCx,iyzw,Wuvw,Uzvuxy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Wuvw,Uzvxuy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvuxy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvuyx->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvxuy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvyux->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvyxu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/3 * einsum('KiCx,iyzw,Wuxw,Uzuy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Wuxw,Uzyu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyzw,Wuxz,Uwuy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwuvx->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwuxv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwvux->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwvxu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwxvu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuvxy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuvyx->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuxvy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuyvx->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuyxv->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Wwuz,Uuxy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/3 * einsum('KiCx,iyzw,Wwuz,Uuyx->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Wwxu,Uzuy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/3 * einsum('KiCx,iyzw,Wwxu,Uzyu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyzw,Wwxz,Uy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/3 * einsum('KiCx,iyzx,Uwuy,Wuwz->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzx,Uwuy,Wuzw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzx,Uwzu,Wyuw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/3 * einsum('KiCx,iyzx,Uwzu,Wywu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/3 * einsum('KiCx,iyzx,Wwuz,Uuwy->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzx,Wwuz,Uuyw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzx,Wwyu,Uzuw->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/3 * einsum('KiCx,iyzx,Wwyu,Uzwu->KWCU', X_aaaa, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += einsum('KiCU,i,ixWy,yx->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCU,i,ixyW,yx->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,i,iUxy,Wy->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,i,iUyx,Wy->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,i,iUyz,Wxyz->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,i,iUyz,Wxzy->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,i,iW,Ux->KWCU', X_abab, e_cvs, t1_xa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,i,iyWx,Uy->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,i,iyWz,Uzxy->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,i,iyxW,Uy->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,i,iyzW,Uzxy->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,i,iyzW,Uzyx->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= einsum('KiCU,Wx,iyxz,yz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCU,Wx,iyzx,yz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += einsum('KiCU,xy,ixWz,yz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCU,xy,ixzW,yz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= einsum('KiCU,xy,izWx,yz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCU,xy,izxW,yz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,Uy,iyxz,Wz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,Uy,iyzw,Wxwz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,Uy,iyzw,Wxzw->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,Uy,iyzx,Wz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,Wy,iy,Ux->KWCU', X_abab, h_aa, t1_xa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,Wy,izwy,Uwxz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,Wy,izwy,Uwzx->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,Wy,izxy,Uz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,Wy,izyw,Uwxz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,Wy,izyx,Uz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,xy,iUyz,Wz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,xy,iUzy,Wz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,xy,izWy,Uz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,xy,izyW,Uz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,yz,iUwy,Wxwz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,yz,iUwy,Wxzw->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,yz,iUxy,Wz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,yz,iUyw,Wxwz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,yz,iUyw,Wxzw->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,yz,iUyx,Wz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,yz,iwWy,Uzxw->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,yz,iwyW,Uzwx->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,yz,iwyW,Uzxw->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,yz,iyWw,Uwxz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,yz,iyWx,Uz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,yz,iywW,Uwxz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,yz,iywW,Uwzx->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,yz,iyxW,Uz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= einsum('KiCU,ix,Wxyz,yz->KWCU', X_abab, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCU,ix,Wyzx,zy->KWCU', X_abab, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += einsum('KiCU,ixWy,xzwu,ywzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= einsum('KiCU,ixWy,yzwu,xwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCU,ixyW,xzwu,ywzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCU,ixyW,yzwu,xwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCU,ixyz,Wwuy,xwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCU,ixyz,Wwuz,xwuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCU,ixyz,Wwxu,yzwu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= einsum('KiCU,ixyz,Wywu,xuzw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= einsum('KiCU,ixyz,Wywz,xw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCU,ixyz,Wzwu,xuyw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCU,ixyz,Wzwy,xw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iUxy,yzwu,Wwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iUyx,yzwu,Wwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iUyz,xwuy,Wwuz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iUyz,xwuy,Wwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iUyz,xwuz,Wwuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iUyz,xwuz,Wwyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iUyz,xywu,Wuzw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iUyz,xywz,Ww->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iUyz,xzwu,Wuyw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iUyz,xzwy,Ww->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iUyz,ywuv,Wxuwzv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iUyz,ywuv,Wxuzwv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iUyz,zwuv,Wxuwyv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iUyz,zwuv,Wxuywv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iUyz,zwyu,Wxuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iUyz,zwyu,Wxwu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iy,Uxyz,Wz->KWCU', X_abab, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iy,Uzyw,Wxwz->KWCU', X_abab, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iy,Uzyw,Wxzw->KWCU', X_abab, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iy,Uzyx,Wz->KWCU', X_abab, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iy,Wyxz,Uz->KWCU', X_abab, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iy,Wyzw,Uzxw->KWCU', X_abab, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iy,Wzwy,Uwxz->KWCU', X_abab, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iy,Wzwy,Uwzx->KWCU', X_abab, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iy,Wzxy,Uz->KWCU', X_abab, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyWx,yzwu,Uwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iyWz,xwuz,Uuwy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyWz,xwyu,Uzwu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iyWz,xzwu,Uwyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyWz,ywuv,Uzuxwv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iyWz,zwuv,Uwvxyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iyxW,yzwu,Uwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyxz,Uwuy,Wuwz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iyxz,Uwzu,Wywu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyxz,Uywu,Wwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyxz,Wwuz,Uuwy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iyxz,Wwyu,Uzwu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyxz,Wzwu,Uwyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzW,xwuz,Uuwy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzW,xwuz,Uuyw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzW,xwyu,Uzuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzW,xwyu,Uzwu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyzW,xzwu,Uwyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzW,ywuv,Uzuwxv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzW,ywuv,Uzuxwv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzW,zwuv,Uwvxyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzW,zwuv,Uwvyxu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Uuvy,Wxvuzw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Uuvy,Wxvzuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyuzv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyzuv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Uuwx,Wyuz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Uuwx,Wyzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Uuzv,Wxyuvw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Uuzv,Wxyvuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iyzw,Uuzx,Wyuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iyzw,Uxuy,Wuzw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyzw,Uxwu,Wyzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyzw,Uxzu,Wyuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuwzv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuzwv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Uyux,Wuwz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Uyux,Wuzw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Wuvw,Uzvuxy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Wuvw,Uzvxuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvuyx->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvxyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Wuxw,Uzuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Wuxw,Uzyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyzw,Wuxz,Uwuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwuxv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwxuv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuxyv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuyxv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Wwuz,Uuxy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Wwuz,Uuyx->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzw,Wwxu,Uzuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzw,Wwxu,Uzyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/2 * einsum('KiCx,iyzw,Wwxz,Uy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iyzw,Wzuv,Uwuxyv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iyzw,Wzuw,Uuxy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iyzw,Wzxu,Uwuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iyzw,Wzxw,Uy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzx,Uwuy,Wuwz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzx,Uwuy,Wuzw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzx,Uwzu,Wyuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzx,Uwzu,Wywu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iyzx,Uywu,Wwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzx,Wwuz,Uuwy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzx,Wwuz,Uuyw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/6 * einsum('KiCx,iyzx,Wwyu,Uzuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab -= 1/6 * einsum('KiCx,iyzx,Wwyu,Uzwu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abab += 1/2 * einsum('KiCx,iyzx,Wzwu,Uwyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma[caea__abab] += ascontiguousarray(sigma_KWCU_abab).reshape(-1)

    sigma_KWCU_abba =- einsum('KiCU,iW->KWCU', X_abba, h_xa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiaU,iaCx,Wx->KWCU', X_aaaa, v_xeea, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('Kiax,iaCy,UyWx->KWCU', X_aaaa, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('Kiax,iaCy,UyxW->KWCU', X_aaaa, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += einsum('KiCU,i,iW->KWCU', X_abba, e_cvs, t1_xa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,iW,Ux->KWCU', X_abba, h_xa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba -= einsum('KiCU,Wx,ix->KWCU', X_abba, h_aa, t1_xa, optimize = einsum_type)
    sigma_KWCU_abba -= einsum('KiCU,iWxy,yx->KWCU', X_abba, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCU,ixyW,xy->KWCU', X_abba, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,iWyx,Uy->KWCU', X_abba, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,iWyz,Uzxy->KWCU', X_abba, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCx,iyUx,Wy->KWCU', X_abba, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba += 1/3 * einsum('KiCx,iyUz,Wxyz->KWCU', X_abba, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iyUz,Wxzy->KWCU', X_abba, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('KiCx,iyzW,Uyxz->KWCU', X_abba, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iyzW,Uyzx->KWCU', X_abba, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiaU,iaCx,Wx->KWCU', X_abba, v_xeea, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiaU,ixCa,Wx->KWCU', X_abba, v_xaee, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('Kiax,iaCy,UyWx->KWCU', X_abba, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('Kiax,iaCy,UyxW->KWCU', X_abba, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('Kiax,iyCa,UyWx->KWCU', X_abba, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/3 * einsum('Kiax,iyCa,UyxW->KWCU', X_abba, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('ijCU,iKjx,Wx->KWCU', X_abba, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('ijCx,iKjy,UyWx->KWCU', X_abba, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('ijCx,iKjy,UyxW->KWCU', X_abba, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += einsum('KiCU,i,ixWy,yx->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCU,i,ixyW,yx->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,i,iUyx,Wy->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('KiCx,i,iUyz,Wxyz->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,i,iUyz,Wxzy->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCx,i,iW,Ux->KWCU', X_abba, e_cvs, t1_xa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCx,i,iyWx,Uy->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCx,i,iyWz,Uzxy->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/3 * einsum('KiCx,i,iyzW,Uzxy->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,i,iyzW,Uzyx->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= einsum('KiCU,Wx,iyxz,yz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCU,Wx,iyzx,yz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba += einsum('KiCU,xy,ixWz,yz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCU,xy,ixzW,yz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba -= einsum('KiCU,xy,izWx,yz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCU,xy,izxW,yz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,Uy,iyzw,Wxwz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('KiCx,Uy,iyzw,Wxzw->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,Uy,iyzx,Wz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,Wy,iy,Ux->KWCU', X_abba, h_aa, t1_xa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('KiCx,Wy,izwy,Uwxz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,Wy,izwy,Uwzx->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,Wy,izyw,Uwxz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,Wy,izyx,Uz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCx,xy,iUzy,Wz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,xy,izWy,Uz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba += 1/3 * einsum('KiCx,yz,iUwy,Wxwz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,yz,iUwy,Wxzw->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,yz,iUyw,Wxwz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/3 * einsum('KiCx,yz,iUyw,Wxzw->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCx,yz,iUyx,Wz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,yz,iwWy,Uzxw->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,yz,iwyW,Uzwx->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('KiCx,yz,iwyW,Uzxw->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCx,yz,iyWw,Uwxz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCx,yz,iyWx,Uz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba += 1/3 * einsum('KiCx,yz,iywW,Uwxz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,yz,iywW,Uwzx->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= einsum('KiCU,ix,Wxyz,yz->KWCU', X_abba, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCU,ix,Wyzx,zy->KWCU', X_abba, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba += einsum('KiCU,ixWy,xzwu,ywzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= einsum('KiCU,ixWy,yzwu,xwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCU,ixyW,xzwu,ywzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCU,ixyW,yzwu,xwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCU,ixyz,Wwuy,xwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCU,ixyz,Wwuz,xwuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCU,ixyz,Wwxu,yzwu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= einsum('KiCU,ixyz,Wywu,xuzw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= einsum('KiCU,ixyz,Wywz,xw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCU,ixyz,Wzwu,xuyw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCU,ixyz,Wzwy,xw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCx,iUyx,yzwu,Wwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/3 * einsum('KiCx,iUyz,xwuy,Wwuz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iUyz,xwuy,Wwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iUyz,xwuz,Wwuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/3 * einsum('KiCx,iUyz,xwuz,Wwyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCx,iUyz,xzwu,Wuyw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCx,iUyz,xzwy,Ww->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iUyz,ywuv,Wxuvwz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iUyz,ywuv,Wxuvzw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iUyz,ywuv,Wxuwvz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iUyz,ywuv,Wxuwzv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iUyz,ywuv,Wxuzvw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iUyz,zwuv,Wxuwyv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/3 * einsum('KiCx,iUyz,zwuv,Wxuywv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/3 * einsum('KiCx,iUyz,zwyu,Wxuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iUyz,zwyu,Wxwu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCx,iy,Uxyz,Wz->KWCU', X_abba, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba += 1/3 * einsum('KiCx,iy,Uzyw,Wxwz->KWCU', X_abba, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iy,Uzyw,Wxzw->KWCU', X_abba, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,iy,Wyxz,Uz->KWCU', X_abba, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,iy,Wyzw,Uzxw->KWCU', X_abba, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('KiCx,iy,Wzwy,Uwxz->KWCU', X_abba, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iy,Wzwy,Uwzx->KWCU', X_abba, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCx,iyWx,yzwu,Uwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,iyWz,xwuz,Uuwy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCx,iyWz,xwyu,Uzwu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,iyWz,xzwu,Uwyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCx,iyWz,ywuv,Uzuxwv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,iyWz,zwuv,Uwvxyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('KiCx,iyzW,xwuz,Uuwy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iyzW,xwuz,Uuyw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iyzW,xwyu,Uzuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/3 * einsum('KiCx,iyzW,xwyu,Uzwu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iyzW,ywuv,Uzuwxv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/3 * einsum('KiCx,iyzW,ywuv,Uzuxwv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('KiCx,iyzW,zwuv,Uwvxyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iyzW,zwuv,Uwvyxu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iyzw,Uuvy,Wxvuwz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iyzw,Uuvy,Wxvwuz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iyzw,Uuvy,Wxvwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iyzw,Uuvy,Wxvzuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iyzw,Uuvy,Wxvzwu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyuzv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/3 * einsum('KiCx,iyzw,Uuwv,Wxyzuv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iyzw,Uuwx,Wyuz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/3 * einsum('KiCx,iyzw,Uuwx,Wyzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iyzw,Uuzv,Wxyuwv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iyzw,Uuzv,Wxyvuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iyzw,Uuzv,Wxyvwu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iyzw,Uuzv,Wxywuv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iyzw,Uuzv,Wxywvu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,iyzw,Uxuy,Wuzw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCx,iyzw,Uxwu,Wyzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/2 * einsum('KiCx,iyzw,Uxzu,Wyuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuwzv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('KiCx,iyzw,Uyuv,Wxuzwv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iyzw,Uyux,Wuwz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('KiCx,iyzw,Uyux,Wuzw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iyzw,Wuvw,Uzvuyx->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iyzw,Wuvw,Uzvxuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iyzw,Wuvw,Uzvxyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iyzw,Wuvw,Uzvyux->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iyzw,Wuvw,Uzvyxu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvuyx->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('KiCx,iyzw,Wuvz,Uwvxyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iyzw,Wuxw,Uzuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('KiCx,iyzw,Wuxw,Uzyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwuxv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/3 * einsum('KiCx,iyzw,Wuyv,Uzwxuv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('KiCx,iyzw,Wwuv,Uzuxyv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuyxv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('KiCx,iyzw,Wwuz,Uuxy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iyzw,Wwuz,Uuyx->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('KiCx,iyzw,Wwxu,Uzuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iyzw,Wwxu,Uzyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,iyzw,Wzuv,Uwuxyv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,iyzw,Wzuw,Uuxy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,iyzw,Wzxu,Uwuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,iyzw,Wzxw,Uy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iyzx,Uwuy,Wuwz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('KiCx,iyzx,Uwuy,Wuzw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/3 * einsum('KiCx,iyzx,Uwzu,Wyuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iyzx,Uwzu,Wywu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,iyzx,Uywu,Wwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/6 * einsum('KiCx,iyzx,Wwuz,Uuwy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba -= 1/3 * einsum('KiCx,iyzx,Wwuz,Uuyw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/3 * einsum('KiCx,iyzx,Wwyu,Uzuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/6 * einsum('KiCx,iyzx,Wwyu,Uzwu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_abba += 1/2 * einsum('KiCx,iyzx,Wzwu,Uwyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma[caea__abba] += ascontiguousarray(sigma_KWCU_abba).reshape(-1)

    sigma_KWCU_baab  = einsum('iKCU,iW->KWCU', X_abab, h_xa, optimize = einsum_type)
    sigma_KWCU_baab -= einsum('iKCU,i,iW->KWCU', X_abab, e_cvs, t1_xa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,iW,Ux->KWCU', X_abab, h_xa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab += einsum('iKCU,Wx,ix->KWCU', X_abab, h_aa, t1_xa, optimize = einsum_type)
    sigma_KWCU_baab += einsum('iKCU,iWxy,yx->KWCU', X_abab, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCU,ixyW,xy->KWCU', X_abab, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,iWyx,Uy->KWCU', X_abab, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,iWyz,Uzxy->KWCU', X_abab, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCx,iyUx,Wy->KWCU', X_abab, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab -= 1/3 * einsum('iKCx,iyUz,Wxyz->KWCU', X_abab, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iyUz,Wxzy->KWCU', X_abab, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/3 * einsum('iKCx,iyzW,Uyxz->KWCU', X_abab, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iyzW,Uyzx->KWCU', X_abab, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKaU,iaCx,Wx->KWCU', X_abab, v_xeea, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKaU,ixCa,Wx->KWCU', X_abab, v_xaee, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKax,iaCy,UyWx->KWCU', X_abab, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/3 * einsum('iKax,iaCy,UyxW->KWCU', X_abab, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKax,iyCa,UyWx->KWCU', X_abab, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/3 * einsum('iKax,iyCa,UyxW->KWCU', X_abab, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('ijCU,jKix,Wx->KWCU', X_abab, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('ijCx,jKiy,UyWx->KWCU', X_abab, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/3 * einsum('ijCx,jKiy,UyxW->KWCU', X_abab, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('KiaU,iaCx,Wx->KWCU', X_bbbb, v_xeea, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('Kiax,iaCy,UyWx->KWCU', X_bbbb, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/3 * einsum('Kiax,iaCy,UyxW->KWCU', X_bbbb, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= einsum('iKCU,i,ixWy,yx->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCU,i,ixyW,yx->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,i,iUyx,Wy->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab += 1/3 * einsum('iKCx,i,iUyz,Wxyz->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,i,iUyz,Wxzy->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCx,i,iW,Ux->KWCU', X_abab, e_cvs, t1_xa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCx,i,iyWx,Uy->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCx,i,iyWz,Uzxy->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/3 * einsum('iKCx,i,iyzW,Uzxy->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,i,iyzW,Uzyx->KWCU', X_abab, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += einsum('iKCU,Wx,iyxz,yz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCU,Wx,iyzx,yz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab -= einsum('iKCU,xy,ixWz,yz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCU,xy,ixzW,yz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab += einsum('iKCU,xy,izWx,yz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCU,xy,izxW,yz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,Uy,iyzw,Wxwz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/3 * einsum('iKCx,Uy,iyzw,Wxzw->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,Uy,iyzx,Wz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,Wy,iy,Ux->KWCU', X_abab, h_aa, t1_xa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab += 1/3 * einsum('iKCx,Wy,izwy,Uwxz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,Wy,izwy,Uwzx->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,Wy,izyw,Uwxz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,Wy,izyx,Uz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCx,xy,iUzy,Wz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,xy,izWy,Uz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab -= 1/3 * einsum('iKCx,yz,iUwy,Wxwz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,yz,iUwy,Wxzw->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,yz,iUyw,Wxwz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/3 * einsum('iKCx,yz,iUyw,Wxzw->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCx,yz,iUyx,Wz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,yz,iwWy,Uzxw->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,yz,iwyW,Uzwx->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/3 * einsum('iKCx,yz,iwyW,Uzxw->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCx,yz,iyWw,Uwxz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCx,yz,iyWx,Uz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab -= 1/3 * einsum('iKCx,yz,iywW,Uwxz->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,yz,iywW,Uwzx->KWCU', X_abab, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += einsum('iKCU,ix,Wxyz,yz->KWCU', X_abab, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCU,ix,Wyzx,zy->KWCU', X_abab, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab -= einsum('iKCU,ixWy,xzwu,ywzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += einsum('iKCU,ixWy,yzwu,xwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCU,ixyW,xzwu,ywzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCU,ixyW,yzwu,xwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCU,ixyz,Wwuy,xwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCU,ixyz,Wwuz,xwuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCU,ixyz,Wwxu,yzwu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += einsum('iKCU,ixyz,Wywu,xuzw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += einsum('iKCU,ixyz,Wywz,xw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCU,ixyz,Wzwu,xuyw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCU,ixyz,Wzwy,xw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCx,iUyx,yzwu,Wwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/3 * einsum('iKCx,iUyz,xwuy,Wwuz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iUyz,xwuy,Wwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iUyz,xwuz,Wwuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/3 * einsum('iKCx,iUyz,xwuz,Wwyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCx,iUyz,xzwu,Wuyw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCx,iUyz,xzwy,Ww->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iUyz,ywuv,Wxuvwz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iUyz,ywuv,Wxuvzw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iUyz,ywuv,Wxuwvz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iUyz,ywuv,Wxuwzv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iUyz,ywuv,Wxuzvw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iUyz,zwuv,Wxuwyv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/3 * einsum('iKCx,iUyz,zwuv,Wxuywv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/3 * einsum('iKCx,iUyz,zwyu,Wxuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iUyz,zwyu,Wxwu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCx,iy,Uxyz,Wz->KWCU', X_abab, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab -= 1/3 * einsum('iKCx,iy,Uzyw,Wxwz->KWCU', X_abab, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iy,Uzyw,Wxzw->KWCU', X_abab, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,iy,Wyxz,Uz->KWCU', X_abab, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,iy,Wyzw,Uzxw->KWCU', X_abab, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/3 * einsum('iKCx,iy,Wzwy,Uwxz->KWCU', X_abab, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iy,Wzwy,Uwzx->KWCU', X_abab, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCx,iyWx,yzwu,Uwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,iyWz,xwuz,Uuwy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCx,iyWz,xwyu,Uzwu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,iyWz,xzwu,Uwyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCx,iyWz,ywuv,Uzuxwv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,iyWz,zwuv,Uwvxyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/3 * einsum('iKCx,iyzW,xwuz,Uuwy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iyzW,xwuz,Uuyw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iyzW,xwyu,Uzuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/3 * einsum('iKCx,iyzW,xwyu,Uzwu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iyzW,ywuv,Uzuwxv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/3 * einsum('iKCx,iyzW,ywuv,Uzuxwv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/3 * einsum('iKCx,iyzW,zwuv,Uwvxyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iyzW,zwuv,Uwvyxu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iyzw,Uuvy,Wxvuwz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iyzw,Uuvy,Wxvwuz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iyzw,Uuvy,Wxvwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iyzw,Uuvy,Wxvzuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iyzw,Uuvy,Wxvzwu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iyzw,Uuwv,Wxyuzv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/3 * einsum('iKCx,iyzw,Uuwv,Wxyzuv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iyzw,Uuwx,Wyuz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/3 * einsum('iKCx,iyzw,Uuwx,Wyzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iyzw,Uuzv,Wxyuwv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iyzw,Uuzv,Wxyvuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iyzw,Uuzv,Wxyvwu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iyzw,Uuzv,Wxywuv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iyzw,Uuzv,Wxywvu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,iyzw,Uxuy,Wuzw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCx,iyzw,Uxwu,Wyzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/2 * einsum('iKCx,iyzw,Uxzu,Wyuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iyzw,Uyuv,Wxuwzv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/3 * einsum('iKCx,iyzw,Uyuv,Wxuzwv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iyzw,Uyux,Wuwz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/3 * einsum('iKCx,iyzw,Uyux,Wuzw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iyzw,Wuvw,Uzvuyx->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iyzw,Wuvw,Uzvxuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iyzw,Wuvw,Uzvxyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iyzw,Wuvw,Uzvyux->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iyzw,Wuvw,Uzvyxu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iyzw,Wuvz,Uwvuyx->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/3 * einsum('iKCx,iyzw,Wuvz,Uwvxyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iyzw,Wuxw,Uzuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/3 * einsum('iKCx,iyzw,Wuxw,Uzyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iyzw,Wuyv,Uzwuxv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/3 * einsum('iKCx,iyzw,Wuyv,Uzwxuv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/3 * einsum('iKCx,iyzw,Wwuv,Uzuxyv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iyzw,Wwuv,Uzuyxv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/3 * einsum('iKCx,iyzw,Wwuz,Uuxy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iyzw,Wwuz,Uuyx->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/3 * einsum('iKCx,iyzw,Wwxu,Uzuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iyzw,Wwxu,Uzyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,iyzw,Wzuv,Uwuxyv->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,iyzw,Wzuw,Uuxy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,iyzw,Wzxu,Uwuy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,iyzw,Wzxw,Uy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iyzx,Uwuy,Wuwz->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/3 * einsum('iKCx,iyzx,Uwuy,Wuzw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/3 * einsum('iKCx,iyzx,Uwzu,Wyuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iyzx,Uwzu,Wywu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,iyzx,Uywu,Wwzu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/6 * einsum('iKCx,iyzx,Wwuz,Uuwy->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab += 1/3 * einsum('iKCx,iyzx,Wwuz,Uuyw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/3 * einsum('iKCx,iyzx,Wwyu,Uzuw->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/6 * einsum('iKCx,iyzx,Wwyu,Uzwu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baab -= 1/2 * einsum('iKCx,iyzx,Wzwu,Uwyu->KWCU', X_abab, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma[caea__baab] += ascontiguousarray(sigma_KWCU_baab).reshape(-1)

    sigma_KWCU_baba  = einsum('iKCU,iW->KWCU', X_abba, h_xa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKax,iaCx,UW->KWCU', X_abab, v_xeea, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/3 * einsum('iKax,iaCy,UyWx->KWCU', X_abab, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKax,iaCy,UyxW->KWCU', X_abab, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= einsum('iKCU,i,iW->KWCU', X_abba, e_cvs, t1_xa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iW,Ux->KWCU', X_abba, h_xa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += einsum('iKCU,Wx,ix->KWCU', X_abba, h_aa, t1_xa, optimize = einsum_type)
    sigma_KWCU_baba += einsum('iKCU,iWxy,yx->KWCU', X_abba, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCU,ixyW,xy->KWCU', X_abba, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iWyx,Uy->KWCU', X_abba, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iWyz,Uzxy->KWCU', X_abba, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,ixUy,Wy->KWCU', X_abba, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,ixyW,Uy->KWCU', X_abba, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,iyUx,Wy->KWCU', X_abba, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyUz,Wxyz->KWCU', X_abba, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyUz,Wxzy->KWCU', X_abba, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzW,Uyxz->KWCU', X_abba, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzW,Uyzx->KWCU', X_abba, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKaU,ixCa,Wx->KWCU', X_abba, v_xaee, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKax,ixCa,UW->KWCU', X_abba, v_xaee, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKax,iyCa,UyWx->KWCU', X_abba, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKax,iyCa,UyxW->KWCU', X_abba, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('ijCU,jKix,Wx->KWCU', X_abba, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('ijCx,jKix,UW->KWCU', X_abba, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('ijCx,jKiy,UyWx->KWCU', X_abba, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('ijCx,jKiy,UyxW->KWCU', X_abba, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('KiCx,ixUy,Wy->KWCU', X_bbbb, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('KiCx,ixyW,Uy->KWCU', X_bbbb, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyUz,Wxyz->KWCU', X_bbbb, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/3 * einsum('KiCx,iyUz,Wxzy->KWCU', X_bbbb, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzW,Uyxz->KWCU', X_bbbb, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/3 * einsum('KiCx,iyzW,Uyzx->KWCU', X_bbbb, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('Kiax,iaCx,UW->KWCU', X_bbbb, v_xeea, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/3 * einsum('Kiax,iaCy,UyWx->KWCU', X_bbbb, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('Kiax,iaCy,UyxW->KWCU', X_bbbb, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('Kiax,ixCa,UW->KWCU', X_bbbb, v_xaee, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/3 * einsum('Kiax,iyCa,UyWx->KWCU', X_bbbb, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('Kiax,iyCa,UyxW->KWCU', X_bbbb, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/4 * einsum('ijCx,iKjx,UW->KWCU', X_bbbb, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('ijCx,iKjy,UyWx->KWCU', X_bbbb, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/12 * einsum('ijCx,iKjy,UyxW->KWCU', X_bbbb, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/4 * einsum('ijCx,jKix,UW->KWCU', X_bbbb, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('ijCx,jKiy,UyWx->KWCU', X_bbbb, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/12 * einsum('ijCx,jKiy,UyxW->KWCU', X_bbbb, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= einsum('iKCU,i,ixWy,yx->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCU,i,ixyW,yx->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,i,iUxy,Wy->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,i,iUyx,Wy->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,i,iUyz,Wxyz->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,i,iUyz,Wxzy->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,i,iW,Ux->KWCU', X_abba, e_cvs, t1_xa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,i,iyWx,Uy->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,i,iyWz,Uzxy->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,i,iyxW,Uy->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,i,iyzW,Uzxy->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,i,iyzW,Uzyx->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += einsum('iKCU,Wx,iyxz,yz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCU,Wx,iyzx,yz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= einsum('iKCU,xy,ixWz,yz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCU,xy,ixzW,yz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += einsum('iKCU,xy,izWx,yz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCU,xy,izxW,yz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,Uy,iyxz,Wz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,Uy,iyzw,Wxwz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,Uy,iyzw,Wxzw->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,Uy,iyzx,Wz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,Wy,iy,Ux->KWCU', X_abba, h_aa, t1_xa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,Wy,izwy,Uwxz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,Wy,izwy,Uwzx->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,Wy,izxy,Uz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,Wy,izyw,Uwxz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,Wy,izyx,Uz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,xy,iUyz,Wz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,xy,iUzy,Wz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,xy,izWy,Uz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,xy,izyW,Uz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,yz,iUwy,Wxwz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,yz,iUwy,Wxzw->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,yz,iUxy,Wz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,yz,iUyw,Wxwz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,yz,iUyw,Wxzw->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,yz,iUyx,Wz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,yz,iwWy,Uzxw->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,yz,iwyW,Uzwx->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,yz,iwyW,Uzxw->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,yz,iyWw,Uwxz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,yz,iyWx,Uz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,yz,iywW,Uwxz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,yz,iywW,Uwzx->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,yz,iyxW,Uz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += einsum('iKCU,ix,Wxyz,yz->KWCU', X_abba, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCU,ix,Wyzx,zy->KWCU', X_abba, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= einsum('iKCU,ixWy,xzwu,ywzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += einsum('iKCU,ixWy,yzwu,xwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCU,ixyW,xzwu,ywzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCU,ixyW,yzwu,xwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCU,ixyz,Wwuy,xwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCU,ixyz,Wwuz,xwuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCU,ixyz,Wwxu,yzwu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += einsum('iKCU,ixyz,Wywu,xuzw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += einsum('iKCU,ixyz,Wywz,xw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCU,ixyz,Wzwu,xuyw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCU,ixyz,Wzwy,xw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iUxy,yzwu,Wwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,iUyx,yzwu,Wwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iUyz,xwuy,Wwuz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iUyz,xwuy,Wwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iUyz,xwuz,Wwuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iUyz,xwuz,Wwyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iUyz,xywu,Wuzw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iUyz,xywz,Ww->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,iUyz,xzwu,Wuyw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,iUyz,xzwy,Ww->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iUyz,ywuv,Wxuwzv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iUyz,ywuv,Wxuzwv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iUyz,zwuv,Wxuwyv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iUyz,zwuv,Wxuywv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iUyz,zwyu,Wxuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iUyz,zwyu,Wxwu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,iy,Uxyz,Wz->KWCU', X_abba, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iy,Uzyw,Wxwz->KWCU', X_abba, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iy,Uzyw,Wxzw->KWCU', X_abba, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iy,Uzyx,Wz->KWCU', X_abba, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iy,Wyxz,Uz->KWCU', X_abba, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iy,Wyzw,Uzxw->KWCU', X_abba, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iy,Wzwy,Uwxz->KWCU', X_abba, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iy,Wzwy,Uwzx->KWCU', X_abba, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,iy,Wzxy,Uz->KWCU', X_abba, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,iyWx,yzwu,Uwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iyWz,xwuz,Uuwy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,iyWz,xwyu,Uzwu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iyWz,xzwu,Uwyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,iyWz,ywuv,Uzuxwv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iyWz,zwuv,Uwvxyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iyxW,yzwu,Uwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,iyxz,Uwuy,Wuwz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iyxz,Uwzu,Wywu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,iyxz,Uywu,Wwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,iyxz,Wwuz,Uuwy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iyxz,Wwyu,Uzwu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,iyxz,Wzwu,Uwyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzW,xwuz,Uuwy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzW,xwuz,Uuyw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzW,xwyu,Uzuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzW,xwyu,Uzwu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,iyzW,xzwu,Uwyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzW,ywuv,Uzuwxv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzW,ywuv,Uzuxwv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzW,zwuv,Uwvxyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzW,zwuv,Uwvyxu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzw,Uuvy,Wxvuzw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzw,Uuvy,Wxvzuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzw,Uuwv,Wxyuzv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzw,Uuwv,Wxyzuv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzw,Uuwx,Wyuz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzw,Uuwx,Wyzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzw,Uuzv,Wxyuvw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzw,Uuzv,Wxyvuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iyzw,Uuzx,Wyuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iyzw,Uxuy,Wuzw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,iyzw,Uxwu,Wyzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,iyzw,Uxzu,Wyuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzw,Uyuv,Wxuwzv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzw,Uyuv,Wxuzwv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzw,Uyux,Wuwz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzw,Uyux,Wuzw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzw,Wuvw,Uzvuxy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzw,Wuvw,Uzvxuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzw,Wuvz,Uwvuyx->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzw,Wuvz,Uwvxyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzw,Wuxw,Uzuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzw,Wuxw,Uzyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,iyzw,Wuxz,Uwuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzw,Wuyv,Uzwuxv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzw,Wuyv,Uzwxuv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzw,Wwuv,Uzuxyv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzw,Wwuv,Uzuyxv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzw,Wwuz,Uuxy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzw,Wwuz,Uuyx->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzw,Wwxu,Uzuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzw,Wwxu,Uzyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('iKCx,iyzw,Wwxz,Uy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iyzw,Wzuv,Uwuxyv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iyzw,Wzuw,Uuxy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iyzw,Wzxu,Uwuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iyzw,Wzxw,Uy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzx,Uwuy,Wuwz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzx,Uwuy,Wuzw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzx,Uwzu,Wyuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzx,Uwzu,Wywu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iyzx,Uywu,Wwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzx,Wwuz,Uuwy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzx,Wwuz,Uuyw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('iKCx,iyzx,Wwyu,Uzuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('iKCx,iyzx,Wwyu,Uzwu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('iKCx,iyzx,Wzwu,Uwyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('KiCx,i,iUxy,Wy->KWCU', X_bbbb, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,i,iUyz,Wxyz->KWCU', X_bbbb, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/3 * einsum('KiCx,i,iUyz,Wxzy->KWCU', X_bbbb, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('KiCx,i,iyxW,Uy->KWCU', X_bbbb, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,i,iyzW,Uzxy->KWCU', X_bbbb, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/3 * einsum('KiCx,i,iyzW,Uzyx->KWCU', X_bbbb, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('KiCx,Uy,iyxz,Wz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/3 * einsum('KiCx,Uy,iyzw,Wxwz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,Uy,iyzw,Wxzw->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,Wy,izwy,Uwxz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/3 * einsum('KiCx,Wy,izwy,Uwzx->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('KiCx,Wy,izxy,Uz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('KiCx,xy,iUyz,Wz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('KiCx,xy,izyW,Uz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,yz,iUwy,Wxwz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/3 * einsum('KiCx,yz,iUwy,Wxzw->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('KiCx,yz,iUxy,Wz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/3 * einsum('KiCx,yz,iUyw,Wxwz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,yz,iUyw,Wxzw->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/3 * einsum('KiCx,yz,iwyW,Uzwx->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,yz,iwyW,Uzxw->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,yz,iywW,Uwxz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/3 * einsum('KiCx,yz,iywW,Uwzx->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('KiCx,yz,iyxW,Uz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('KiCx,iUxy,yzwu,Wwzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iUyz,xwuy,Wwuz->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/3 * einsum('KiCx,iUyz,xwuy,Wwzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/3 * einsum('KiCx,iUyz,xwuz,Wwuy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iUyz,xwuz,Wwyu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('KiCx,iUyz,xywu,Wuzw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('KiCx,iUyz,xywz,Ww->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iUyz,ywuv,Wxuwzv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/3 * einsum('KiCx,iUyz,ywuv,Wxuzwv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iUyz,zwuv,Wxuvwy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iUyz,zwuv,Wxuvyw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iUyz,zwuv,Wxuwvy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iUyz,zwuv,Wxuwyv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iUyz,zwuv,Wxuyvw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iUyz,zwyu,Wxuw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/3 * einsum('KiCx,iUyz,zwyu,Wxwu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iy,Uzyw,Wxwz->KWCU', X_bbbb, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/3 * einsum('KiCx,iy,Uzyw,Wxzw->KWCU', X_bbbb, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('KiCx,iy,Uzyx,Wz->KWCU', X_bbbb, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iy,Wzwy,Uwxz->KWCU', X_bbbb, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/3 * einsum('KiCx,iy,Wzwy,Uwzx->KWCU', X_bbbb, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('KiCx,iy,Wzxy,Uz->KWCU', X_bbbb, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('KiCx,iyxW,yzwu,Uwzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('KiCx,iyxz,Uwuy,Wuwz->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('KiCx,iyxz,Uwzu,Wywu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('KiCx,iyxz,Uywu,Wwzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('KiCx,iyxz,Wwuz,Uuwy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('KiCx,iyxz,Wwyu,Uzwu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('KiCx,iyxz,Wzwu,Uwyu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzW,xwuz,Uuwy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/3 * einsum('KiCx,iyzW,xwuz,Uuyw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/3 * einsum('KiCx,iyzW,xwyu,Uzuw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzW,xwyu,Uzwu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('KiCx,iyzW,xzwu,Uwyu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzW,ywuv,Uzuvwx->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzW,ywuv,Uzuvxw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzW,ywuv,Uzuwvx->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzW,ywuv,Uzuwxv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzW,ywuv,Uzuxvw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzW,zwuv,Uwvuxy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzW,zwuv,Uwvuyx->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzW,zwuv,Uwvxuy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzW,zwuv,Uwvyux->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzW,zwuv,Uwvyxu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/3 * einsum('KiCx,iyzw,Uuvy,Wxvuzw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzw,Uuvy,Wxvzuw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyuvz->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyuzv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyvuz->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyvzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyzvu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/3 * einsum('KiCx,iyzw,Uuwx,Wyuz->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzw,Uuwx,Wyzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/3 * einsum('KiCx,iyzw,Uuzv,Wxyuvw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzw,Uuzv,Wxyvuw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/2 * einsum('KiCx,iyzw,Uuzx,Wyuw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuvwz->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuvzw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuwvz->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuwzv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuzvw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/3 * einsum('KiCx,iyzw,Uyux,Wuwz->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzw,Uyux,Wuzw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/3 * einsum('KiCx,iyzw,Wuvw,Uzvuxy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzw,Wuvw,Uzvxuy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvuxy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvuyx->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvxuy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvyux->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvyxu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/3 * einsum('KiCx,iyzw,Wuxw,Uzuy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzw,Wuxw,Uzyu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('KiCx,iyzw,Wuxz,Uwuy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwuvx->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwuxv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwvux->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwvxu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwxvu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuvxy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuvyx->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuxvy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuyvx->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuyxv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzw,Wwuz,Uuxy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/3 * einsum('KiCx,iyzw,Wwuz,Uuyx->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzw,Wwxu,Uzuy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/3 * einsum('KiCx,iyzw,Wwxu,Uzyu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/2 * einsum('KiCx,iyzw,Wwxz,Uy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_baba += 1/3 * einsum('KiCx,iyzx,Uwuy,Wuwz->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzx,Uwuy,Wuzw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzx,Uwzu,Wyuw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/3 * einsum('KiCx,iyzx,Uwzu,Wywu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/3 * einsum('KiCx,iyzx,Wwuz,Uuwy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba += 1/6 * einsum('KiCx,iyzx,Wwuz,Uuyw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/6 * einsum('KiCx,iyzx,Wwyu,Uzuw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_baba -= 1/3 * einsum('KiCx,iyzx,Wwyu,Uzwu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma[caea__baba] += ascontiguousarray(sigma_KWCU_baba).reshape(-1)

    sigma_KWCU_bbbb =- einsum('KiCU,iW->KWCU', X_bbbb, h_xa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('iKaU,iaCx,Wx->KWCU', X_abab, v_xeea, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('iKax,iaCx,UW->KWCU', X_abab, v_xeea, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKax,iaCy,UyWx->KWCU', X_abab, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKax,iaCy,UyxW->KWCU', X_abab, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('iKCx,ixUy,Wy->KWCU', X_abba, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('iKCx,ixyW,Uy->KWCU', X_abba, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyUz,Wxyz->KWCU', X_abba, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/3 * einsum('iKCx,iyUz,Wxzy->KWCU', X_abba, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzW,Uyxz->KWCU', X_abba, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/3 * einsum('iKCx,iyzW,Uyzx->KWCU', X_abba, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('iKax,ixCa,UW->KWCU', X_abba, v_xaee, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/3 * einsum('iKax,iyCa,UyWx->KWCU', X_abba, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKax,iyCa,UyxW->KWCU', X_abba, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('ijCx,jKix,UW->KWCU', X_abba, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/3 * einsum('ijCx,jKiy,UyWx->KWCU', X_abba, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('ijCx,jKiy,UyxW->KWCU', X_abba, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += einsum('KiCU,i,iW->KWCU', X_bbbb, e_cvs, t1_xa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iW,Ux->KWCU', X_bbbb, h_xa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= einsum('KiCU,Wx,ix->KWCU', X_bbbb, h_aa, t1_xa, optimize = einsum_type)
    sigma_KWCU_bbbb -= einsum('KiCU,iWxy,yx->KWCU', X_bbbb, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCU,ixyW,xy->KWCU', X_bbbb, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iWyx,Uy->KWCU', X_bbbb, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iWyz,Uzxy->KWCU', X_bbbb, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,ixUy,Wy->KWCU', X_bbbb, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,ixyW,Uy->KWCU', X_bbbb, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,iyUx,Wy->KWCU', X_bbbb, v_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyUz,Wxyz->KWCU', X_bbbb, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyUz,Wxzy->KWCU', X_bbbb, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzW,Uyxz->KWCU', X_bbbb, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzW,Uyzx->KWCU', X_bbbb, v_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiaU,iaCx,Wx->KWCU', X_bbbb, v_xeea, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiaU,ixCa,Wx->KWCU', X_bbbb, v_xaee, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('Kiax,iaCx,UW->KWCU', X_bbbb, v_xeea, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('Kiax,iaCy,UyWx->KWCU', X_bbbb, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('Kiax,iaCy,UyxW->KWCU', X_bbbb, v_xeea, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('Kiax,ixCa,UW->KWCU', X_bbbb, v_xaee, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('Kiax,iyCa,UyWx->KWCU', X_bbbb, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('Kiax,iyCa,UyxW->KWCU', X_bbbb, v_xaee, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/4 * einsum('ijCU,iKjx,Wx->KWCU', X_bbbb, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/4 * einsum('ijCU,jKix,Wx->KWCU', X_bbbb, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/4 * einsum('ijCx,iKjx,UW->KWCU', X_bbbb, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/12 * einsum('ijCx,iKjy,UyWx->KWCU', X_bbbb, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/12 * einsum('ijCx,iKjy,UyxW->KWCU', X_bbbb, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/4 * einsum('ijCx,jKix,UW->KWCU', X_bbbb, v_xxxa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/12 * einsum('ijCx,jKiy,UyWx->KWCU', X_bbbb, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/12 * einsum('ijCx,jKiy,UyxW->KWCU', X_bbbb, v_xxxa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('iKCx,i,iUxy,Wy->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,i,iUyz,Wxyz->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/3 * einsum('iKCx,i,iUyz,Wxzy->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('iKCx,i,iyxW,Uy->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,i,iyzW,Uzxy->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/3 * einsum('iKCx,i,iyzW,Uzyx->KWCU', X_abba, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('iKCx,Uy,iyxz,Wz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/3 * einsum('iKCx,Uy,iyzw,Wxwz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,Uy,iyzw,Wxzw->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,Wy,izwy,Uwxz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/3 * einsum('iKCx,Wy,izwy,Uwzx->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('iKCx,Wy,izxy,Uz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('iKCx,xy,iUyz,Wz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('iKCx,xy,izyW,Uz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,yz,iUwy,Wxwz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/3 * einsum('iKCx,yz,iUwy,Wxzw->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('iKCx,yz,iUxy,Wz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/3 * einsum('iKCx,yz,iUyw,Wxwz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,yz,iUyw,Wxzw->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/3 * einsum('iKCx,yz,iwyW,Uzwx->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,yz,iwyW,Uzxw->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,yz,iywW,Uwxz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/3 * einsum('iKCx,yz,iywW,Uwzx->KWCU', X_abba, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('iKCx,yz,iyxW,Uz->KWCU', X_abba, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('iKCx,iUxy,yzwu,Wwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iUyz,xwuy,Wwuz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/3 * einsum('iKCx,iUyz,xwuy,Wwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/3 * einsum('iKCx,iUyz,xwuz,Wwuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iUyz,xwuz,Wwyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('iKCx,iUyz,xywu,Wuzw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('iKCx,iUyz,xywz,Ww->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iUyz,ywuv,Wxuwzv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/3 * einsum('iKCx,iUyz,ywuv,Wxuzwv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iUyz,zwuv,Wxuvwy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iUyz,zwuv,Wxuvyw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iUyz,zwuv,Wxuwvy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iUyz,zwuv,Wxuwyv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iUyz,zwuv,Wxuyvw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iUyz,zwyu,Wxuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/3 * einsum('iKCx,iUyz,zwyu,Wxwu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iy,Uzyw,Wxwz->KWCU', X_abba, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/3 * einsum('iKCx,iy,Uzyw,Wxzw->KWCU', X_abba, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('iKCx,iy,Uzyx,Wz->KWCU', X_abba, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iy,Wzwy,Uwxz->KWCU', X_abba, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/3 * einsum('iKCx,iy,Wzwy,Uwzx->KWCU', X_abba, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('iKCx,iy,Wzxy,Uz->KWCU', X_abba, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('iKCx,iyxW,yzwu,Uwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('iKCx,iyxz,Uwuy,Wuwz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('iKCx,iyxz,Uwzu,Wywu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('iKCx,iyxz,Uywu,Wwzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('iKCx,iyxz,Wwuz,Uuwy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('iKCx,iyxz,Wwyu,Uzwu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('iKCx,iyxz,Wzwu,Uwyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzW,xwuz,Uuwy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/3 * einsum('iKCx,iyzW,xwuz,Uuyw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/3 * einsum('iKCx,iyzW,xwyu,Uzuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzW,xwyu,Uzwu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('iKCx,iyzW,xzwu,Uwyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzW,ywuv,Uzuvwx->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzW,ywuv,Uzuvxw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzW,ywuv,Uzuwvx->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzW,ywuv,Uzuwxv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzW,ywuv,Uzuxvw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzW,zwuv,Uwvuxy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzW,zwuv,Uwvuyx->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzW,zwuv,Uwvxuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzW,zwuv,Uwvyux->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzW,zwuv,Uwvyxu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/3 * einsum('iKCx,iyzw,Uuvy,Wxvuzw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzw,Uuvy,Wxvzuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzw,Uuwv,Wxyuvz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzw,Uuwv,Wxyuzv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzw,Uuwv,Wxyvuz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzw,Uuwv,Wxyvzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzw,Uuwv,Wxyzvu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/3 * einsum('iKCx,iyzw,Uuwx,Wyuz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzw,Uuwx,Wyzu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/3 * einsum('iKCx,iyzw,Uuzv,Wxyuvw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzw,Uuzv,Wxyvuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('iKCx,iyzw,Uuzx,Wyuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzw,Uyuv,Wxuvwz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzw,Uyuv,Wxuvzw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzw,Uyuv,Wxuwvz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzw,Uyuv,Wxuwzv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzw,Uyuv,Wxuzvw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/3 * einsum('iKCx,iyzw,Uyux,Wuwz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzw,Uyux,Wuzw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/3 * einsum('iKCx,iyzw,Wuvw,Uzvuxy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzw,Wuvw,Uzvxuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzw,Wuvz,Uwvuxy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzw,Wuvz,Uwvuyx->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzw,Wuvz,Uwvxuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzw,Wuvz,Uwvyux->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzw,Wuvz,Uwvyxu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/3 * einsum('iKCx,iyzw,Wuxw,Uzuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzw,Wuxw,Uzyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('iKCx,iyzw,Wuxz,Uwuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzw,Wuyv,Uzwuvx->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzw,Wuyv,Uzwuxv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzw,Wuyv,Uzwvux->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzw,Wuyv,Uzwvxu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzw,Wuyv,Uzwxvu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzw,Wwuv,Uzuvxy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzw,Wwuv,Uzuvyx->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzw,Wwuv,Uzuxvy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzw,Wwuv,Uzuyvx->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzw,Wwuv,Uzuyxv->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzw,Wwuz,Uuxy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/3 * einsum('iKCx,iyzw,Wwuz,Uuyx->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzw,Wwxu,Uzuy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/3 * einsum('iKCx,iyzw,Wwxu,Uzyu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('iKCx,iyzw,Wwxz,Uy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/3 * einsum('iKCx,iyzx,Uwuy,Wuwz->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzx,Uwuy,Wuzw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzx,Uwzu,Wyuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/3 * einsum('iKCx,iyzx,Uwzu,Wywu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/3 * einsum('iKCx,iyzx,Wwuz,Uuwy->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('iKCx,iyzx,Wwuz,Uuyw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('iKCx,iyzx,Wwyu,Uzuw->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/3 * einsum('iKCx,iyzx,Wwyu,Uzwu->KWCU', X_abba, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += einsum('KiCU,i,ixWy,yx->KWCU', X_bbbb, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCU,i,ixyW,yx->KWCU', X_bbbb, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,i,iUxy,Wy->KWCU', X_bbbb, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,i,iUyx,Wy->KWCU', X_bbbb, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,i,iUyz,Wxyz->KWCU', X_bbbb, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,i,iUyz,Wxzy->KWCU', X_bbbb, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,i,iW,Ux->KWCU', X_bbbb, e_cvs, t1_xa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,i,iyWx,Uy->KWCU', X_bbbb, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,i,iyWz,Uzxy->KWCU', X_bbbb, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,i,iyxW,Uy->KWCU', X_bbbb, e_cvs, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,i,iyzW,Uzxy->KWCU', X_bbbb, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,i,iyzW,Uzyx->KWCU', X_bbbb, e_cvs, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= einsum('KiCU,Wx,iyxz,yz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCU,Wx,iyzx,yz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += einsum('KiCU,xy,ixWz,yz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCU,xy,ixzW,yz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= einsum('KiCU,xy,izWx,yz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCU,xy,izxW,yz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,Uy,iyxz,Wz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,Uy,iyzw,Wxwz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,Uy,iyzw,Wxzw->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,Uy,iyzx,Wz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,Wy,iy,Ux->KWCU', X_bbbb, h_aa, t1_xa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,Wy,izwy,Uwxz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,Wy,izwy,Uwzx->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,Wy,izxy,Uz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,Wy,izyw,Uwxz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,Wy,izyx,Uz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,xy,iUyz,Wz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,xy,iUzy,Wz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,xy,izWy,Uz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,xy,izyW,Uz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,yz,iUwy,Wxwz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,yz,iUwy,Wxzw->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,yz,iUxy,Wz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,yz,iUyw,Wxwz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,yz,iUyw,Wxzw->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,yz,iUyx,Wz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,yz,iwWy,Uzxw->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,yz,iwyW,Uzwx->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,yz,iwyW,Uzxw->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,yz,iyWw,Uwxz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,yz,iyWx,Uz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,yz,iywW,Uwxz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,yz,iywW,Uwzx->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,yz,iyxW,Uz->KWCU', X_bbbb, h_aa, t1_xaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= einsum('KiCU,ix,Wxyz,yz->KWCU', X_bbbb, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCU,ix,Wyzx,zy->KWCU', X_bbbb, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += einsum('KiCU,ixWy,xzwu,ywzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= einsum('KiCU,ixWy,yzwu,xwzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCU,ixyW,xzwu,ywzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCU,ixyW,yzwu,xwzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCU,ixyz,Wwuy,xwzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCU,ixyz,Wwuz,xwuy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCU,ixyz,Wwxu,yzwu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= einsum('KiCU,ixyz,Wywu,xuzw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= einsum('KiCU,ixyz,Wywz,xw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCU,ixyz,Wzwu,xuyw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCU,ixyz,Wzwy,xw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iUxy,yzwu,Wwzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,iUyx,yzwu,Wwzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iUyz,xwuy,Wwuz->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iUyz,xwuy,Wwzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iUyz,xwuz,Wwuy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iUyz,xwuz,Wwyu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iUyz,xywu,Wuzw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iUyz,xywz,Ww->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,iUyz,xzwu,Wuyw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,iUyz,xzwy,Ww->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iUyz,ywuv,Wxuwzv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iUyz,ywuv,Wxuzwv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iUyz,zwuv,Wxuwyv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iUyz,zwuv,Wxuywv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iUyz,zwyu,Wxuw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iUyz,zwyu,Wxwu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,iy,Uxyz,Wz->KWCU', X_bbbb, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iy,Uzyw,Wxwz->KWCU', X_bbbb, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iy,Uzyw,Wxzw->KWCU', X_bbbb, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iy,Uzyx,Wz->KWCU', X_bbbb, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iy,Wyxz,Uz->KWCU', X_bbbb, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iy,Wyzw,Uzxw->KWCU', X_bbbb, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iy,Wzwy,Uwxz->KWCU', X_bbbb, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iy,Wzwy,Uwzx->KWCU', X_bbbb, t1_xa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,iy,Wzxy,Uz->KWCU', X_bbbb, t1_xa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,iyWx,yzwu,Uwzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iyWz,xwuz,Uuwy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,iyWz,xwyu,Uzwu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iyWz,xzwu,Uwyu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,iyWz,ywuv,Uzuxwv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iyWz,zwuv,Uwvxyu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iyxW,yzwu,Uwzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,iyxz,Uwuy,Wuwz->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iyxz,Uwzu,Wywu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,iyxz,Uywu,Wwzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,iyxz,Wwuz,Uuwy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iyxz,Wwyu,Uzwu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,iyxz,Wzwu,Uwyu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzW,xwuz,Uuwy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzW,xwuz,Uuyw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzW,xwyu,Uzuw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzW,xwyu,Uzwu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,iyzW,xzwu,Uwyu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzW,ywuv,Uzuwxv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzW,ywuv,Uzuxwv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzW,zwuv,Uwvxyu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzW,zwuv,Uwvyxu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzw,Uuvy,Wxvuzw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzw,Uuvy,Wxvzuw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyuzv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzw,Uuwv,Wxyzuv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzw,Uuwx,Wyuz->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzw,Uuwx,Wyzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzw,Uuzv,Wxyuvw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzw,Uuzv,Wxyvuw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iyzw,Uuzx,Wyuw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iyzw,Uxuy,Wuzw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,iyzw,Uxwu,Wyzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,iyzw,Uxzu,Wyuw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuwzv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzw,Uyuv,Wxuzwv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzw,Uyux,Wuwz->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzw,Uyux,Wuzw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzw,Wuvw,Uzvuxy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzw,Wuvw,Uzvxuy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvuyx->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzw,Wuvz,Uwvxyu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzw,Wuxw,Uzuy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzw,Wuxw,Uzyu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,iyzw,Wuxz,Uwuy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwuxv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzw,Wuyv,Uzwxuv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuxyv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzw,Wwuv,Uzuyxv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzw,Wwuz,Uuxy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzw,Wwuz,Uuyx->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzw,Wwxu,Uzuy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzw,Wwxu,Uzyu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/2 * einsum('KiCx,iyzw,Wwxz,Uy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iyzw,Wzuv,Uwuxyv->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_cccaaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iyzw,Wzuw,Uuxy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iyzw,Wzxu,Uwuy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iyzw,Wzxw,Uy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ca, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzx,Uwuy,Wuwz->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzx,Uwuy,Wuzw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzx,Uwzu,Wyuw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzx,Uwzu,Wywu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iyzx,Uywu,Wwzu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzx,Wwuz,Uuwy->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzx,Wwuz,Uuyw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/6 * einsum('KiCx,iyzx,Wwyu,Uzuw->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb -= 1/6 * einsum('KiCx,iyzx,Wwyu,Uzwu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma_KWCU_bbbb += 1/2 * einsum('KiCx,iyzx,Wzwu,Uwyu->KWCU', X_bbbb, t1_xaaa, v_aaaa, rdm_ccaa, optimize = einsum_type)
    sigma[caea__bbbb] += ascontiguousarray(sigma_KWCU_bbbb).reshape(-1)
 
    mr_adc.log.timer_debug("computing sigma H1 h1-h1 CAEA-CCEA", *cput1)

# CVAA <- CCEA
def compute_sigma_vector__H1__h1_h1__CVAA_CCEA(mr_adc, X_aaaa, X_abab, X_abba, X_bbbb, sigma):
    cput1 = (logger.process_clock(), logger.perf_counter())

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    #Excitation Manifold
    cvaa__aaaa = mr_adc.h1.cvaa__aaaa
    cvaa__abab = mr_adc.h1.cvaa__abab
    cvaa__baba = mr_adc.h1.cvaa__baba
    cvaa__bbbb = mr_adc.h1.cvaa__bbbb 

    ## Indices
    aa_tril_ind = mr_adc.h1.aa_tril_ind 

    ## Two-electron integrals
    v_xvae = mr_adc.v2e.xvae
    v_vaex = mr_adc.v2e.vaex

    # Reduced Density Matrices
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa

    sigma_KLWU_aaaa  = einsum('KiaU,LWai->KLWU', X_aaaa, v_vaex, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KiaU,iLWa->KLWU', X_aaaa, v_xvae, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KiaW,LUai->KLWU', X_aaaa, v_vaex, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KiaW,iLUa->KLWU', X_aaaa, v_xvae, optimize = einsum_type)
    sigma_KLWU_aaaa += einsum('KiaU,LWai->KLWU', X_abba, v_vaex, optimize = einsum_type)
    sigma_KLWU_aaaa -= einsum('KiaW,LUai->KLWU', X_abba, v_vaex, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KiaU,Lxai,Wx->KLWU', X_aaaa, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KiaU,iLxa,Wx->KLWU', X_aaaa, v_xvae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KiaW,Lxai,Ux->KLWU', X_aaaa, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KiaW,iLxa,Ux->KLWU', X_aaaa, v_xvae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('Kiax,LUai,Wx->KLWU', X_aaaa, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('Kiax,LWai,Ux->KLWU', X_aaaa, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('Kiax,Lyai,UWxy->KLWU', X_aaaa, v_vaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('Kiax,Lyai,UWyx->KLWU', X_aaaa, v_vaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('Kiax,iLUa,Wx->KLWU', X_aaaa, v_xvae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('Kiax,iLWa,Ux->KLWU', X_aaaa, v_xvae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('Kiax,iLya,UWxy->KLWU', X_aaaa, v_xvae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('Kiax,iLya,UWyx->KLWU', X_aaaa, v_xvae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('KiaU,Lxai,Wx->KLWU', X_abba, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('KiaW,Lxai,Ux->KLWU', X_abba, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/2 * einsum('Kiax,LUai,Wx->KLWU', X_abba, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/2 * einsum('Kiax,LWai,Ux->KLWU', X_abba, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_aaaa += 1/6 * einsum('Kiax,Lyai,UWxy->KLWU', X_abba, v_vaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_aaaa -= 1/6 * einsum('Kiax,Lyai,UWyx->KLWU', X_abba, v_vaex, rdm_ccaa, optimize = einsum_type)
    sigma[cvaa__aaaa] += ascontiguousarray(sigma_KLWU_aaaa[:, :, aa_tril_ind[0], aa_tril_ind[1]]).reshape(-1) 

    sigma_KLWU_abab =- einsum('KiaW,LUai->KLWU', X_aaaa, v_vaex, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KiaU,iLWa->KLWU', X_abab, v_xvae, optimize = einsum_type)
    sigma_KLWU_abab -= einsum('KiaW,LUai->KLWU', X_abba, v_vaex, optimize = einsum_type)
    sigma_KLWU_abab += einsum('KiaW,iLUa->KLWU', X_abba, v_xvae, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KiaW,Lxai,Ux->KLWU', X_aaaa, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('Kiax,LUai,Wx->KLWU', X_aaaa, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('Kiax,Lyai,UWxy->KLWU', X_aaaa, v_vaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('Kiax,Lyai,UWyx->KLWU', X_aaaa, v_vaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KiaU,iLxa,Wx->KLWU', X_abab, v_xvae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('Kiax,iLWa,Ux->KLWU', X_abab, v_xvae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('Kiax,iLya,UWxy->KLWU', X_abab, v_xvae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('Kiax,iLya,UWyx->KLWU', X_abab, v_xvae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('KiaW,Lxai,Ux->KLWU', X_abba, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('KiaW,iLxa,Ux->KLWU', X_abba, v_xvae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/2 * einsum('Kiax,LUai,Wx->KLWU', X_abba, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab -= 1/6 * einsum('Kiax,Lyai,UWxy->KLWU', X_abba, v_vaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/3 * einsum('Kiax,Lyai,UWyx->KLWU', X_abba, v_vaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab -= 1/2 * einsum('Kiax,iLUa,Wx->KLWU', X_abba, v_xvae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_abab += 1/6 * einsum('Kiax,iLya,UWxy->KLWU', X_abba, v_xvae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_abab += 1/3 * einsum('Kiax,iLya,UWyx->KLWU', X_abba, v_xvae, rdm_ccaa, optimize = einsum_type)
    sigma[cvaa__abab] += ascontiguousarray(sigma_KLWU_abab).reshape(-1) 

    sigma_KLWU_baba  = einsum('iKaW,LUai->KLWU', X_abab, v_vaex, optimize = einsum_type)
    sigma_KLWU_baba -= einsum('iKaW,iLUa->KLWU', X_abab, v_xvae, optimize = einsum_type)
    sigma_KLWU_baba += einsum('iKaU,iLWa->KLWU', X_abba, v_xvae, optimize = einsum_type)
    sigma_KLWU_baba -= einsum('KiaW,LUai->KLWU', X_bbbb, v_vaex, optimize = einsum_type)
    sigma_KLWU_baba -= 1/2 * einsum('iKaW,Lxai,Ux->KLWU', X_abab, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_baba += 1/2 * einsum('iKaW,iLxa,Ux->KLWU', X_abab, v_xvae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_baba -= 1/2 * einsum('iKax,LUai,Wx->KLWU', X_abab, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_baba += 1/6 * einsum('iKax,Lyai,UWxy->KLWU', X_abab, v_vaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_baba += 1/3 * einsum('iKax,Lyai,UWyx->KLWU', X_abab, v_vaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_baba += 1/2 * einsum('iKax,iLUa,Wx->KLWU', X_abab, v_xvae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_baba -= 1/6 * einsum('iKax,iLya,UWxy->KLWU', X_abab, v_xvae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_baba -= 1/3 * einsum('iKax,iLya,UWyx->KLWU', X_abab, v_xvae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_baba -= 1/2 * einsum('iKaU,iLxa,Wx->KLWU', X_abba, v_xvae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_baba -= 1/2 * einsum('iKax,iLWa,Ux->KLWU', X_abba, v_xvae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_baba += 1/3 * einsum('iKax,iLya,UWxy->KLWU', X_abba, v_xvae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_baba += 1/6 * einsum('iKax,iLya,UWyx->KLWU', X_abba, v_xvae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_baba += 1/2 * einsum('KiaW,Lxai,Ux->KLWU', X_bbbb, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_baba += 1/2 * einsum('Kiax,LUai,Wx->KLWU', X_bbbb, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_baba -= 1/6 * einsum('Kiax,Lyai,UWxy->KLWU', X_bbbb, v_vaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_baba -= 1/3 * einsum('Kiax,Lyai,UWyx->KLWU', X_bbbb, v_vaex, rdm_ccaa, optimize = einsum_type)
    sigma[cvaa__baba] += ascontiguousarray(sigma_KLWU_baba).reshape(-1) 

    sigma_KLWU_bbbb =- einsum('iKaU,LWai->KLWU', X_abab, v_vaex, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('iKaW,LUai->KLWU', X_abab, v_vaex, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KiaU,LWai->KLWU', X_bbbb, v_vaex, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KiaU,iLWa->KLWU', X_bbbb, v_xvae, optimize = einsum_type)
    sigma_KLWU_bbbb -= einsum('KiaW,LUai->KLWU', X_bbbb, v_vaex, optimize = einsum_type)
    sigma_KLWU_bbbb += einsum('KiaW,iLUa->KLWU', X_bbbb, v_xvae, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('iKaU,Lxai,Wx->KLWU', X_abab, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('iKaW,Lxai,Ux->KLWU', X_abab, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('iKax,LUai,Wx->KLWU', X_abab, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('iKax,LWai,Ux->KLWU', X_abab, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('iKax,Lyai,UWxy->KLWU', X_abab, v_vaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('iKax,Lyai,UWyx->KLWU', X_abab, v_vaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KiaU,Lxai,Wx->KLWU', X_bbbb, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KiaU,iLxa,Wx->KLWU', X_bbbb, v_xvae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('KiaW,Lxai,Ux->KLWU', X_bbbb, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('KiaW,iLxa,Ux->KLWU', X_bbbb, v_xvae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('Kiax,LUai,Wx->KLWU', X_bbbb, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('Kiax,LWai,Ux->KLWU', X_bbbb, v_vaex, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('Kiax,Lyai,UWxy->KLWU', X_bbbb, v_vaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('Kiax,Lyai,UWyx->KLWU', X_bbbb, v_vaex, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/2 * einsum('Kiax,iLUa,Wx->KLWU', X_bbbb, v_xvae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/2 * einsum('Kiax,iLWa,Ux->KLWU', X_bbbb, v_xvae, rdm_ca, optimize = einsum_type)
    sigma_KLWU_bbbb -= 1/6 * einsum('Kiax,iLya,UWxy->KLWU', X_bbbb, v_xvae, rdm_ccaa, optimize = einsum_type)
    sigma_KLWU_bbbb += 1/6 * einsum('Kiax,iLya,UWyx->KLWU', X_bbbb, v_xvae, rdm_ccaa, optimize = einsum_type)
    sigma[cvaa__bbbb] += ascontiguousarray(sigma_KLWU_bbbb[:, :, aa_tril_ind[0], aa_tril_ind[1]]).reshape(-1) 

    mr_adc.log.timer_debug("computing sigma H1 h1-h1 CVAA-CCEA", *cput1)

# CVEA <- CCEA
def compute_sigma_vector__H1__h1_h1__CVEA_CCEA(mr_adc, X_aaaa, X_abab, X_abba, X_bbbb, sigma):
    cput1 = (logger.process_clock(), logger.perf_counter())

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    #Excitation Manifold
    cvea__aaaa = mr_adc.h1.cvea__aaaa
    cvea__abab = mr_adc.h1.cvea__abab
    cvea__baab = mr_adc.h1.cvea__baab
    cvea__bbbb = mr_adc.h1.cvea__bbbb
    cvea__baba = mr_adc.h1.cvea__baba
    cvea__abba = mr_adc.h1.cvea__abba 
 
    ## Two-electron integrals
    v_xxvx = mr_adc.v2e.xxvx
    v_xvee = mr_adc.v2e.xvee
    v_vxaa = mr_adc.v2e.vxaa
    v_vaax = mr_adc.v2e.vaax
    v_veex = mr_adc.v2e.veex

    # Reduced Density Matrices
    rdm_ca = mr_adc.rdm.ca
    rdm_ccaa = mr_adc.rdm.ccaa

    sigma_KLCW_aaaa  = einsum('KiCx,LWxi->KLCW', X_aaaa, v_vaax, optimize = einsum_type)
    sigma_KLCW_aaaa -= einsum('KiCx,LixW->KLCW', X_aaaa, v_vxaa, optimize = einsum_type)
    sigma_KLCW_aaaa += einsum('KiaW,LCai->KLCW', X_aaaa, v_veex, optimize = einsum_type)
    sigma_KLCW_aaaa -= einsum('KiaW,iLCa->KLCW', X_aaaa, v_xvee, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('ijCW,KiLj->KLCW', X_aaaa, v_xxvx, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('ijCW,KjLi->KLCW', X_aaaa, v_xxvx, optimize = einsum_type)
    sigma_KLCW_aaaa += einsum('KiCx,LWxi->KLCW', X_abab, v_vaax, optimize = einsum_type)
    sigma_KLCW_aaaa += einsum('KiaW,LCai->KLCW', X_abba, v_veex, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('KiCx,LWyi,xy->KLCW', X_aaaa, v_vaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('KiCx,Lixy,Wy->KLCW', X_aaaa, v_vxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('KiCx,LiyW,xy->KLCW', X_aaaa, v_vxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('KiCx,Liyz,Wyxz->KLCW', X_aaaa, v_vxaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('KiCx,Lyxi,Wy->KLCW', X_aaaa, v_vaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/6 * einsum('KiCx,Lyzi,Wzxy->KLCW', X_aaaa, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/6 * einsum('KiCx,Lyzi,Wzyx->KLCW', X_aaaa, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('Kiax,LCai,Wx->KLCW', X_aaaa, v_veex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/2 * einsum('Kiax,iLCa,Wx->KLCW', X_aaaa, v_xvee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/4 * einsum('ijCx,KiLj,Wx->KLCW', X_aaaa, v_xxvx, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/4 * einsum('ijCx,KjLi,Wx->KLCW', X_aaaa, v_xxvx, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('KiCx,LWyi,xy->KLCW', X_abab, v_vaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('KiCx,Lyxi,Wy->KLCW', X_abab, v_vaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/6 * einsum('KiCx,Lyzi,Wzxy->KLCW', X_abab, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/3 * einsum('KiCx,Lyzi,Wzyx->KLCW', X_abab, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('Kiax,LCai,Wx->KLCW', X_abba, v_veex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa -= 1/2 * einsum('KiCx,Liyz,yz,Wx->KLCW', X_aaaa, v_vxaa, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_aaaa += 1/4 * einsum('KiCx,Lyzi,zy,Wx->KLCW', X_aaaa, v_vaax, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma[cvea__aaaa] += ascontiguousarray(sigma_KLCW_aaaa).reshape(-1)

    sigma_KLCW_abab  = einsum('KiCx,LWxi->KLCW', X_aaaa, v_vaax, optimize = einsum_type)
    sigma_KLCW_abab += einsum('KiCx,LWxi->KLCW', X_abab, v_vaax, optimize = einsum_type)
    sigma_KLCW_abab -= einsum('KiCx,LixW->KLCW', X_abab, v_vxaa, optimize = einsum_type)
    sigma_KLCW_abab -= einsum('KiaW,iLCa->KLCW', X_abab, v_xvee, optimize = einsum_type)
    sigma_KLCW_abab += einsum('ijCW,KiLj->KLCW', X_abab, v_xxvx, optimize = einsum_type)
    sigma_KLCW_abab -= 1/2 * einsum('KiCx,LWyi,xy->KLCW', X_aaaa, v_vaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab -= 1/2 * einsum('KiCx,Lyxi,Wy->KLCW', X_aaaa, v_vaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab += 1/6 * einsum('KiCx,Lyzi,Wzxy->KLCW', X_aaaa, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abab += 1/3 * einsum('KiCx,Lyzi,Wzyx->KLCW', X_aaaa, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abab -= 1/2 * einsum('KiCx,LWyi,xy->KLCW', X_abab, v_vaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab += 1/2 * einsum('KiCx,Lixy,Wy->KLCW', X_abab, v_vxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab += 1/2 * einsum('KiCx,LiyW,xy->KLCW', X_abab, v_vxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab += 1/2 * einsum('KiCx,Liyz,Wyxz->KLCW', X_abab, v_vxaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abab -= 1/2 * einsum('KiCx,Lyxi,Wy->KLCW', X_abab, v_vaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab -= 1/6 * einsum('KiCx,Lyzi,Wzxy->KLCW', X_abab, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abab += 1/6 * einsum('KiCx,Lyzi,Wzyx->KLCW', X_abab, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abab += 1/2 * einsum('Kiax,iLCa,Wx->KLCW', X_abab, v_xvee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab -= 1/2 * einsum('ijCx,KiLj,Wx->KLCW', X_abab, v_xxvx, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab -= 1/2 * einsum('KiCx,Liyz,yz,Wx->KLCW', X_abab, v_vxaa, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abab += 1/4 * einsum('KiCx,Lyzi,zy,Wx->KLCW', X_abab, v_vaax, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma[cvea__abab] += ascontiguousarray(sigma_KLCW_abab).reshape(-1)

    sigma_KLCW_abba  = einsum('KiaW,LCai->KLCW', X_aaaa, v_veex, optimize = einsum_type)
    sigma_KLCW_abba -= einsum('KiCx,LixW->KLCW', X_abba, v_vxaa, optimize = einsum_type)
    sigma_KLCW_abba += einsum('KiaW,LCai->KLCW', X_abba, v_veex, optimize = einsum_type)
    sigma_KLCW_abba -= einsum('KiaW,iLCa->KLCW', X_abba, v_xvee, optimize = einsum_type)
    sigma_KLCW_abba += einsum('ijCW,KiLj->KLCW', X_abba, v_xxvx, optimize = einsum_type)
    sigma_KLCW_abba -= 1/2 * einsum('Kiax,LCai,Wx->KLCW', X_aaaa, v_veex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba += 1/2 * einsum('KiCx,Lixy,Wy->KLCW', X_abba, v_vxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba += 1/2 * einsum('KiCx,LiyW,xy->KLCW', X_abba, v_vxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba += 1/2 * einsum('KiCx,Liyz,Wyxz->KLCW', X_abba, v_vxaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abba -= 1/3 * einsum('KiCx,Lyzi,Wzxy->KLCW', X_abba, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abba -= 1/6 * einsum('KiCx,Lyzi,Wzyx->KLCW', X_abba, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_abba -= 1/2 * einsum('Kiax,LCai,Wx->KLCW', X_abba, v_veex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba += 1/2 * einsum('Kiax,iLCa,Wx->KLCW', X_abba, v_xvee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba -= 1/2 * einsum('ijCx,KiLj,Wx->KLCW', X_abba, v_xxvx, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba -= 1/2 * einsum('KiCx,Liyz,yz,Wx->KLCW', X_abba, v_vxaa, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_abba += 1/4 * einsum('KiCx,Lyzi,zy,Wx->KLCW', X_abba, v_vaax, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma[cvea__abba] += ascontiguousarray(sigma_KLCW_abba).reshape(-1)

    sigma_KLCW_baab  = einsum('iKCx,LixW->KLCW', X_abab, v_vxaa, optimize = einsum_type)
    sigma_KLCW_baab -= einsum('iKaW,LCai->KLCW', X_abab, v_veex, optimize = einsum_type)
    sigma_KLCW_baab += einsum('iKaW,iLCa->KLCW', X_abab, v_xvee, optimize = einsum_type)
    sigma_KLCW_baab -= einsum('ijCW,KjLi->KLCW', X_abab, v_xxvx, optimize = einsum_type)
    sigma_KLCW_baab += einsum('KiaW,LCai->KLCW', X_bbbb, v_veex, optimize = einsum_type)
    sigma_KLCW_baab -= 1/2 * einsum('iKCx,Lixy,Wy->KLCW', X_abab, v_vxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_baab -= 1/2 * einsum('iKCx,LiyW,xy->KLCW', X_abab, v_vxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_baab -= 1/2 * einsum('iKCx,Liyz,Wyxz->KLCW', X_abab, v_vxaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_baab += 1/3 * einsum('iKCx,Lyzi,Wzxy->KLCW', X_abab, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_baab += 1/6 * einsum('iKCx,Lyzi,Wzyx->KLCW', X_abab, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_baab += 1/2 * einsum('iKax,LCai,Wx->KLCW', X_abab, v_veex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_baab -= 1/2 * einsum('iKax,iLCa,Wx->KLCW', X_abab, v_xvee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_baab += 1/2 * einsum('ijCx,KjLi,Wx->KLCW', X_abab, v_xxvx, rdm_ca, optimize = einsum_type)
    sigma_KLCW_baab -= 1/2 * einsum('Kiax,LCai,Wx->KLCW', X_bbbb, v_veex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_baab += 1/2 * einsum('iKCx,Liyz,yz,Wx->KLCW', X_abab, v_vxaa, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_baab -= 1/4 * einsum('iKCx,Lyzi,zy,Wx->KLCW', X_abab, v_vaax, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma[cvea__baab] += ascontiguousarray(sigma_KLCW_baab).reshape(-1)

    sigma_KLCW_baba =- einsum('iKCx,LWxi->KLCW', X_abba, v_vaax, optimize = einsum_type)
    sigma_KLCW_baba += einsum('iKCx,LixW->KLCW', X_abba, v_vxaa, optimize = einsum_type)
    sigma_KLCW_baba += einsum('iKaW,iLCa->KLCW', X_abba, v_xvee, optimize = einsum_type)
    sigma_KLCW_baba -= einsum('ijCW,KjLi->KLCW', X_abba, v_xxvx, optimize = einsum_type)
    sigma_KLCW_baba += einsum('KiCx,LWxi->KLCW', X_bbbb, v_vaax, optimize = einsum_type)
    sigma_KLCW_baba += 1/2 * einsum('iKCx,LWyi,xy->KLCW', X_abba, v_vaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_baba -= 1/2 * einsum('iKCx,Lixy,Wy->KLCW', X_abba, v_vxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_baba -= 1/2 * einsum('iKCx,LiyW,xy->KLCW', X_abba, v_vxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_baba -= 1/2 * einsum('iKCx,Liyz,Wyxz->KLCW', X_abba, v_vxaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_baba += 1/2 * einsum('iKCx,Lyxi,Wy->KLCW', X_abba, v_vaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_baba += 1/6 * einsum('iKCx,Lyzi,Wzxy->KLCW', X_abba, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_baba -= 1/6 * einsum('iKCx,Lyzi,Wzyx->KLCW', X_abba, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_baba -= 1/2 * einsum('iKax,iLCa,Wx->KLCW', X_abba, v_xvee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_baba += 1/2 * einsum('ijCx,KjLi,Wx->KLCW', X_abba, v_xxvx, rdm_ca, optimize = einsum_type)
    sigma_KLCW_baba -= 1/2 * einsum('KiCx,LWyi,xy->KLCW', X_bbbb, v_vaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_baba -= 1/2 * einsum('KiCx,Lyxi,Wy->KLCW', X_bbbb, v_vaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_baba += 1/6 * einsum('KiCx,Lyzi,Wzxy->KLCW', X_bbbb, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_baba += 1/3 * einsum('KiCx,Lyzi,Wzyx->KLCW', X_bbbb, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_baba += 1/2 * einsum('iKCx,Liyz,yz,Wx->KLCW', X_abba, v_vxaa, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_baba -= 1/4 * einsum('iKCx,Lyzi,zy,Wx->KLCW', X_abba, v_vaax, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma[cvea__baba] += ascontiguousarray(sigma_KLCW_baba).reshape(-1)

    sigma_KLCW_bbbb =- einsum('iKaW,LCai->KLCW', X_abab, v_veex, optimize = einsum_type)
    sigma_KLCW_bbbb -= einsum('iKCx,LWxi->KLCW', X_abba, v_vaax, optimize = einsum_type)
    sigma_KLCW_bbbb += einsum('KiCx,LWxi->KLCW', X_bbbb, v_vaax, optimize = einsum_type)
    sigma_KLCW_bbbb -= einsum('KiCx,LixW->KLCW', X_bbbb, v_vxaa, optimize = einsum_type)
    sigma_KLCW_bbbb += einsum('KiaW,LCai->KLCW', X_bbbb, v_veex, optimize = einsum_type)
    sigma_KLCW_bbbb -= einsum('KiaW,iLCa->KLCW', X_bbbb, v_xvee, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('ijCW,KiLj->KLCW', X_bbbb, v_xxvx, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('ijCW,KjLi->KLCW', X_bbbb, v_xxvx, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('iKax,LCai,Wx->KLCW', X_abab, v_veex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('iKCx,LWyi,xy->KLCW', X_abba, v_vaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('iKCx,Lyxi,Wy->KLCW', X_abba, v_vaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/6 * einsum('iKCx,Lyzi,Wzxy->KLCW', X_abba, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/3 * einsum('iKCx,Lyzi,Wzyx->KLCW', X_abba, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('KiCx,LWyi,xy->KLCW', X_bbbb, v_vaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('KiCx,Lixy,Wy->KLCW', X_bbbb, v_vxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('KiCx,LiyW,xy->KLCW', X_bbbb, v_vxaa, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('KiCx,Liyz,Wyxz->KLCW', X_bbbb, v_vxaa, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('KiCx,Lyxi,Wy->KLCW', X_bbbb, v_vaax, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/6 * einsum('KiCx,Lyzi,Wzxy->KLCW', X_bbbb, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/6 * einsum('KiCx,Lyzi,Wzyx->KLCW', X_bbbb, v_vaax, rdm_ccaa, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('Kiax,LCai,Wx->KLCW', X_bbbb, v_veex, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/2 * einsum('Kiax,iLCa,Wx->KLCW', X_bbbb, v_xvee, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/4 * einsum('ijCx,KiLj,Wx->KLCW', X_bbbb, v_xxvx, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/4 * einsum('ijCx,KjLi,Wx->KLCW', X_bbbb, v_xxvx, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb -= 1/2 * einsum('KiCx,Liyz,yz,Wx->KLCW', X_bbbb, v_vxaa, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma_KLCW_bbbb += 1/4 * einsum('KiCx,Lyzi,zy,Wx->KLCW', X_bbbb, v_vaax, rdm_ca, rdm_ca, optimize = einsum_type)
    sigma[cvea__bbbb] += ascontiguousarray(sigma_KLCW_bbbb).reshape(-1)

    mr_adc.log.timer_debug("computing sigma H1 h1-h1 CVEA-CCEA", *cput1)

# CVEE <- CCEA
def compute_sigma_vector__H1__h1_h1__CVEE_CCEA(mr_adc, X_aaaa, X_abab, X_abba, X_bbbb, sigma):
    cput1 = (logger.process_clock(), logger.perf_counter())

    # Einsum definition from kernel
    einsum = mr_adc.interface.einsum
    einsum_type = mr_adc.interface.einsum_type

    #Excitation Manifold
    cvee__aaaa = mr_adc.h1.cvee__aaaa
    cvee__abab = mr_adc.h1.cvee__abab
    cvee__baba = mr_adc.h1.cvee__baba
    cvee__bbbb = mr_adc.h1.cvee__bbbb 

    ## Indices
    ee_tril_ind = mr_adc.h1.ee_tril_ind 

    ## Two-electron integrals
    v_xaev = mr_adc.v2e.xaev
    v_vxae = mr_adc.v2e.vxae

    # Reduced Density Matrices
    rdm_ca = mr_adc.rdm.ca
 
    sigma_KLCD_aaaa =- einsum('KiCx,LixD->KLCD', X_aaaa, v_vxae, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('KiCx,ixDL->KLCD', X_aaaa, v_xaev, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('KiDx,LixC->KLCD', X_aaaa, v_vxae, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('KiDx,ixCL->KLCD', X_aaaa, v_xaev, optimize = einsum_type)
    sigma_KLCD_aaaa += einsum('KiCx,ixDL->KLCD', X_abab, v_xaev, optimize = einsum_type)
    sigma_KLCD_aaaa -= einsum('KiDx,ixCL->KLCD', X_abab, v_xaev, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KiCx,LiyD,xy->KLCD', X_aaaa, v_vxae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KiCx,iyDL,xy->KLCD', X_aaaa, v_xaev, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KiDx,LiyC,xy->KLCD', X_aaaa, v_vxae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KiDx,iyCL,xy->KLCD', X_aaaa, v_xaev, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa -= 1/2 * einsum('KiCx,iyDL,xy->KLCD', X_abab, v_xaev, rdm_ca, optimize = einsum_type)
    sigma_KLCD_aaaa += 1/2 * einsum('KiDx,iyCL,xy->KLCD', X_abab, v_xaev, rdm_ca, optimize = einsum_type)
    sigma[cvee__aaaa] += ascontiguousarray(sigma_KLCD_aaaa[:, :, ee_tril_ind[0], ee_tril_ind[1]]).reshape(-1)

    sigma_KLCD_abab  = einsum('KiCx,ixDL->KLCD', X_aaaa, v_xaev, optimize = einsum_type)
    sigma_KLCD_abab -= einsum('KiCx,LixD->KLCD', X_abab, v_vxae, optimize = einsum_type)
    sigma_KLCD_abab += einsum('KiCx,ixDL->KLCD', X_abab, v_xaev, optimize = einsum_type)
    sigma_KLCD_abab += einsum('KiDx,LixC->KLCD', X_abba, v_vxae, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KiCx,iyDL,xy->KLCD', X_aaaa, v_xaev, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab += 1/2 * einsum('KiCx,LiyD,xy->KLCD', X_abab, v_vxae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KiCx,iyDL,xy->KLCD', X_abab, v_xaev, rdm_ca, optimize = einsum_type)
    sigma_KLCD_abab -= 1/2 * einsum('KiDx,LiyC,xy->KLCD', X_abba, v_vxae, rdm_ca, optimize = einsum_type)
    sigma[cvee__abab] += ascontiguousarray(sigma_KLCD_abab).reshape(-1)

    sigma_KLCD_baba =- einsum('iKDx,LixC->KLCD', X_abab, v_vxae, optimize = einsum_type)
    sigma_KLCD_baba += einsum('iKCx,LixD->KLCD', X_abba, v_vxae, optimize = einsum_type)
    sigma_KLCD_baba -= einsum('iKCx,ixDL->KLCD', X_abba, v_xaev, optimize = einsum_type)
    sigma_KLCD_baba += einsum('KiCx,ixDL->KLCD', X_bbbb, v_xaev, optimize = einsum_type)
    sigma_KLCD_baba += 1/2 * einsum('iKDx,LiyC,xy->KLCD', X_abab, v_vxae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_baba -= 1/2 * einsum('iKCx,LiyD,xy->KLCD', X_abba, v_vxae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_baba += 1/2 * einsum('iKCx,iyDL,xy->KLCD', X_abba, v_xaev, rdm_ca, optimize = einsum_type)
    sigma_KLCD_baba -= 1/2 * einsum('KiCx,iyDL,xy->KLCD', X_bbbb, v_xaev, rdm_ca, optimize = einsum_type)
    sigma[cvee__baba] += ascontiguousarray(sigma_KLCD_baba).reshape(-1)

    sigma_KLCD_bbbb =- einsum('iKCx,ixDL->KLCD', X_abba, v_xaev, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('iKDx,ixCL->KLCD', X_abba, v_xaev, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('KiCx,LixD->KLCD', X_bbbb, v_vxae, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('KiCx,ixDL->KLCD', X_bbbb, v_xaev, optimize = einsum_type)
    sigma_KLCD_bbbb += einsum('KiDx,LixC->KLCD', X_bbbb, v_vxae, optimize = einsum_type)
    sigma_KLCD_bbbb -= einsum('KiDx,ixCL->KLCD', X_bbbb, v_xaev, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('iKCx,iyDL,xy->KLCD', X_abba, v_xaev, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('iKDx,iyCL,xy->KLCD', X_abba, v_xaev, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('KiCx,LiyD,xy->KLCD', X_bbbb, v_vxae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('KiCx,iyDL,xy->KLCD', X_bbbb, v_xaev, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb -= 1/2 * einsum('KiDx,LiyC,xy->KLCD', X_bbbb, v_vxae, rdm_ca, optimize = einsum_type)
    sigma_KLCD_bbbb += 1/2 * einsum('KiDx,iyCL,xy->KLCD', X_bbbb, v_xaev, rdm_ca, optimize = einsum_type)
    sigma[cvee__bbbb] += ascontiguousarray(sigma_KLCD_bbbb[:, :, ee_tril_ind[0], ee_tril_ind[1]]).reshape(-1)

    mr_adc.log.timer_debug("computing sigma H1 h1-h1 CVEE-CCEA", *cput1)

